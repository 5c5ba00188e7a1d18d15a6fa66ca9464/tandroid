package org.telegram.ui.Cells;

import android.animation.Animator;
import android.animation.AnimatorListenerAdapter;
import android.animation.AnimatorSet;
import android.animation.Keyframe;
import android.animation.ObjectAnimator;
import android.animation.PropertyValuesHolder;
import android.animation.ValueAnimator;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Context;
import android.content.res.ColorStateList;
import android.graphics.Bitmap;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.ColorFilter;
import android.graphics.LinearGradient;
import android.graphics.Paint;
import android.graphics.Path;
import android.graphics.PorterDuff;
import android.graphics.PorterDuffColorFilter;
import android.graphics.Rect;
import android.graphics.RectF;
import android.graphics.Region;
import android.graphics.Shader;
import android.graphics.Typeface;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.graphics.drawable.RippleDrawable;
import android.net.Uri;
import android.os.Build;
import android.os.Bundle;
import android.os.SystemClock;
import android.text.Layout;
import android.text.Spannable;
import android.text.SpannableString;
import android.text.SpannableStringBuilder;
import android.text.Spanned;
import android.text.StaticLayout;
import android.text.TextPaint;
import android.text.TextUtils;
import android.text.style.CharacterStyle;
import android.text.style.ClickableSpan;
import android.text.style.URLSpan;
import android.util.Property;
import android.util.SparseArray;
import android.util.StateSet;
import android.view.MotionEvent;
import android.view.View;
import android.view.ViewConfiguration;
import android.view.ViewGroup;
import android.view.ViewStructure;
import android.view.accessibility.AccessibilityEvent;
import android.view.accessibility.AccessibilityManager;
import android.view.accessibility.AccessibilityNodeInfo;
import android.view.accessibility.AccessibilityNodeProvider;
import android.widget.Toast;
import androidx.core.content.ContextCompat;
import androidx.core.graphics.ColorUtils;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Locale;
import java.util.Stack;
import java.util.concurrent.atomic.AtomicReference;
import org.telegram.PhoneFormat.PhoneFormat;
import org.telegram.messenger.AccountInstance;
import org.telegram.messenger.AndroidUtilities;
import org.telegram.messenger.ApplicationLoader;
import org.telegram.messenger.ChatObject;
import org.telegram.messenger.ContactsController;
import org.telegram.messenger.DialogObject;
import org.telegram.messenger.DocumentObject;
import org.telegram.messenger.DownloadController;
import org.telegram.messenger.Emoji;
import org.telegram.messenger.FileLoader;
import org.telegram.messenger.FileLog;
import org.telegram.messenger.ImageLoader;
import org.telegram.messenger.ImageLocation;
import org.telegram.messenger.ImageReceiver;
import org.telegram.messenger.LocaleController;
import org.telegram.messenger.MediaController;
import org.telegram.messenger.MediaDataController;
import org.telegram.messenger.MessageObject;
import org.telegram.messenger.MessagesController;
import org.telegram.messenger.NotificationCenter;
import org.telegram.messenger.R;
import org.telegram.messenger.SendMessagesHelper;
import org.telegram.messenger.SharedConfig;
import org.telegram.messenger.SvgHelper;
import org.telegram.messenger.UserConfig;
import org.telegram.messenger.UserObject;
import org.telegram.messenger.Utilities;
import org.telegram.messenger.VideoEditedInfo;
import org.telegram.messenger.WebFile;
import org.telegram.messenger.browser.Browser;
import org.telegram.messenger.video.VideoPlayerRewinder;
import org.telegram.tgnet.ConnectionsManager;
import org.telegram.tgnet.TLObject;
import org.telegram.tgnet.TLRPC$Chat;
import org.telegram.tgnet.TLRPC$ChatInvite;
import org.telegram.tgnet.TLRPC$ChatPhoto;
import org.telegram.tgnet.TLRPC$Document;
import org.telegram.tgnet.TLRPC$DocumentAttribute;
import org.telegram.tgnet.TLRPC$EmojiStatus;
import org.telegram.tgnet.TLRPC$FileLocation;
import org.telegram.tgnet.TLRPC$GeoPoint;
import org.telegram.tgnet.TLRPC$KeyboardButton;
import org.telegram.tgnet.TLRPC$Message;
import org.telegram.tgnet.TLRPC$MessageEntity;
import org.telegram.tgnet.TLRPC$MessageFwdHeader;
import org.telegram.tgnet.TLRPC$MessageMedia;
import org.telegram.tgnet.TLRPC$MessagePeerReaction;
import org.telegram.tgnet.TLRPC$MessageReplies;
import org.telegram.tgnet.TLRPC$PageBlock;
import org.telegram.tgnet.TLRPC$Peer;
import org.telegram.tgnet.TLRPC$PhoneCallDiscardReason;
import org.telegram.tgnet.TLRPC$Photo;
import org.telegram.tgnet.TLRPC$PhotoSize;
import org.telegram.tgnet.TLRPC$Poll;
import org.telegram.tgnet.TLRPC$PollResults;
import org.telegram.tgnet.TLRPC$Reaction;
import org.telegram.tgnet.TLRPC$ReactionCount;
import org.telegram.tgnet.TLRPC$ReplyMarkup;
import org.telegram.tgnet.TLRPC$TL_documentAttributeAudio;
import org.telegram.tgnet.TLRPC$TL_documentAttributeImageSize;
import org.telegram.tgnet.TLRPC$TL_documentAttributeVideo;
import org.telegram.tgnet.TLRPC$TL_emojiStatus;
import org.telegram.tgnet.TLRPC$TL_emojiStatusUntil;
import org.telegram.tgnet.TLRPC$TL_fileLocationUnavailable;
import org.telegram.tgnet.TLRPC$TL_game;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonBuy;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonCallback;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonGame;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonRequestGeoLocation;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonRow;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonSwitchInline;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonUrl;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonUrlAuth;
import org.telegram.tgnet.TLRPC$TL_keyboardButtonWebView;
import org.telegram.tgnet.TLRPC$TL_messageActionPhoneCall;
import org.telegram.tgnet.TLRPC$TL_messageEmpty;
import org.telegram.tgnet.TLRPC$TL_messageExtendedMediaPreview;
import org.telegram.tgnet.TLRPC$TL_messageMediaGame;
import org.telegram.tgnet.TLRPC$TL_messageMediaGeoLive;
import org.telegram.tgnet.TLRPC$TL_messageMediaInvoice;
import org.telegram.tgnet.TLRPC$TL_messageMediaPoll;
import org.telegram.tgnet.TLRPC$TL_messageMediaWebPage;
import org.telegram.tgnet.TLRPC$TL_messageReactions;
import org.telegram.tgnet.TLRPC$TL_messages_stickerSet;
import org.telegram.tgnet.TLRPC$TL_page;
import org.telegram.tgnet.TLRPC$TL_pageBlockCollage;
import org.telegram.tgnet.TLRPC$TL_pageBlockSlideshow;
import org.telegram.tgnet.TLRPC$TL_peerChannel;
import org.telegram.tgnet.TLRPC$TL_peerChat;
import org.telegram.tgnet.TLRPC$TL_peerUser;
import org.telegram.tgnet.TLRPC$TL_phoneCallDiscardReasonBusy;
import org.telegram.tgnet.TLRPC$TL_phoneCallDiscardReasonMissed;
import org.telegram.tgnet.TLRPC$TL_photo;
import org.telegram.tgnet.TLRPC$TL_photoSize;
import org.telegram.tgnet.TLRPC$TL_photoSizeEmpty;
import org.telegram.tgnet.TLRPC$TL_photoStrippedSize;
import org.telegram.tgnet.TLRPC$TL_pollAnswer;
import org.telegram.tgnet.TLRPC$TL_pollAnswerVoters;
import org.telegram.tgnet.TLRPC$TL_reactionEmoji;
import org.telegram.tgnet.TLRPC$TL_replyInlineMarkup;
import org.telegram.tgnet.TLRPC$TL_user;
import org.telegram.tgnet.TLRPC$TL_webDocument;
import org.telegram.tgnet.TLRPC$TL_webPage;
import org.telegram.tgnet.TLRPC$TL_webPageAttributeTheme;
import org.telegram.tgnet.TLRPC$ThemeSettings;
import org.telegram.tgnet.TLRPC$User;
import org.telegram.tgnet.TLRPC$UserProfilePhoto;
import org.telegram.tgnet.TLRPC$VideoSize;
import org.telegram.tgnet.TLRPC$WebDocument;
import org.telegram.tgnet.TLRPC$WebPage;
import org.telegram.ui.ActionBar.Theme;
import org.telegram.ui.Cells.TextSelectionHelper;
import org.telegram.ui.ChatActivity;
import org.telegram.ui.Components.AnimatedEmojiDrawable;
import org.telegram.ui.Components.AnimatedEmojiSpan;
import org.telegram.ui.Components.AnimatedFileDrawable;
import org.telegram.ui.Components.AnimatedNumberLayout;
import org.telegram.ui.Components.AnimationProperties;
import org.telegram.ui.Components.AudioVisualizerDrawable;
import org.telegram.ui.Components.AvatarDrawable;
import org.telegram.ui.Components.BackgroundGradientDrawable;
import org.telegram.ui.Components.CheckBoxBase;
import org.telegram.ui.Components.CubicBezierInterpolator;
import org.telegram.ui.Components.EmptyStubSpan;
import org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate;
import org.telegram.ui.Components.InfiniteProgress;
import org.telegram.ui.Components.LinkPath;
import org.telegram.ui.Components.LinkSpanDrawable;
import org.telegram.ui.Components.MessageBackgroundDrawable;
import org.telegram.ui.Components.MotionBackgroundDrawable;
import org.telegram.ui.Components.MsgClockDrawable;
import org.telegram.ui.Components.Point;
import org.telegram.ui.Components.RLottieDrawable;
import org.telegram.ui.Components.RadialProgress2;
import org.telegram.ui.Components.Reactions.ReactionsLayoutInBubble;
import org.telegram.ui.Components.RecyclerListView;
import org.telegram.ui.Components.RoundVideoPlayingDrawable;
import org.telegram.ui.Components.SeekBar;
import org.telegram.ui.Components.SeekBarAccessibilityDelegate;
import org.telegram.ui.Components.SeekBarWaveform;
import org.telegram.ui.Components.SlotsDrawable;
import org.telegram.ui.Components.StaticLayoutEx;
import org.telegram.ui.Components.TextStyleSpan;
import org.telegram.ui.Components.TimerParticles;
import org.telegram.ui.Components.TranscribeButton;
import org.telegram.ui.Components.TypefaceSpan;
import org.telegram.ui.Components.URLSpanBotCommand;
import org.telegram.ui.Components.URLSpanBrowser;
import org.telegram.ui.Components.URLSpanMono;
import org.telegram.ui.Components.URLSpanNoUnderline;
import org.telegram.ui.Components.VideoForwardDrawable;
import org.telegram.ui.Components.spoilers.SpoilerEffect;
import org.telegram.ui.PhotoViewer;
import org.telegram.ui.PinchToZoomHelper;
import org.telegram.ui.SecretMediaViewer;
import org.webrtc.MediaStreamTrack;
/* loaded from: classes3.dex */
public class ChatMessageCell extends BaseCell implements SeekBar.SeekBarDelegate, ImageReceiver.ImageReceiverDelegate, DownloadController.FileDownloadProgressListener, TextSelectionHelper.SelectableView, NotificationCenter.NotificationCenterDelegate {
    private static float[] radii = new float[8];
    private final boolean ALPHA_PROPERTY_WORKAROUND;
    public Property<ChatMessageCell, Float> ANIMATION_OFFSET_X;
    private int TAG;
    CharSequence accessibilityText;
    private SparseArray<Rect> accessibilityVirtualViewBounds;
    private int addedCaptionHeight;
    private boolean addedForTest;
    private int additionalTimeOffsetY;
    private StaticLayout adminLayout;
    private boolean allowAssistant;
    private float alphaInternal;
    private int animateFromStatusDrawableParams;
    private boolean animatePollAnswer;
    private boolean animatePollAnswerAlpha;
    private boolean animatePollAvatars;
    private int animateToStatusDrawableParams;
    public AnimatedEmojiSpan.EmojiGroupedSpans animatedEmojiDescriptionStack;
    public AnimatedEmojiSpan.EmojiGroupedSpans animatedEmojiReplyStack;
    public AnimatedEmojiSpan.EmojiGroupedSpans animatedEmojiStack;
    private int animatingDrawVideoImageButton;
    private float animatingDrawVideoImageButtonProgress;
    private float animatingLoadingProgressProgress;
    private int animatingNoSound;
    private boolean animatingNoSoundPlaying;
    private float animatingNoSoundProgress;
    private float animationOffsetX;
    private boolean animationRunning;
    private boolean attachedToWindow;
    private StaticLayout authorLayout;
    private int authorX;
    private boolean autoPlayingMedia;
    private int availableTimeWidth;
    private AvatarDrawable avatarDrawable;
    private ImageReceiver avatarImage;
    private boolean avatarPressed;
    private Theme.MessageDrawable.PathDrawParams backgroundCacheParams;
    private MessageBackgroundDrawable backgroundDrawable;
    private int backgroundDrawableLeft;
    private int backgroundDrawableRight;
    private int backgroundDrawableTop;
    private int backgroundHeight;
    private int backgroundWidth;
    private int blurredViewBottomOffset;
    private int blurredViewTopOffset;
    private ArrayList<BotButton> botButtons;
    private HashMap<String, BotButton> botButtonsByData;
    private HashMap<String, BotButton> botButtonsByPosition;
    private String botButtonsLayout;
    private boolean bottomNearToSet;
    private int buttonPressed;
    private int buttonState;
    private int buttonX;
    private int buttonY;
    private final boolean canDrawBackgroundInParent;
    private boolean canStreamVideo;
    private int captionHeight;
    private StaticLayout captionLayout;
    private int captionOffsetX;
    private AtomicReference<Layout> captionPatchedSpoilersLayout;
    private List<SpoilerEffect> captionSpoilers;
    private Stack<SpoilerEffect> captionSpoilersPool;
    private int captionWidth;
    private float captionX;
    private float captionY;
    private CheckBoxBase checkBox;
    private boolean checkBoxAnimationInProgress;
    private float checkBoxAnimationProgress;
    private int checkBoxTranslation;
    private boolean checkBoxVisible;
    private boolean checkOnlyButtonPressed;
    private String closeTimeText;
    private int closeTimeWidth;
    private int commentArrowX;
    private AvatarDrawable[] commentAvatarDrawables;
    private ImageReceiver[] commentAvatarImages;
    private boolean[] commentAvatarImagesVisible;
    private boolean commentButtonPressed;
    private Rect commentButtonRect;
    private boolean commentDrawUnread;
    private StaticLayout commentLayout;
    private AnimatedNumberLayout commentNumberLayout;
    private int commentNumberWidth;
    private InfiniteProgress commentProgress;
    private float commentProgressAlpha;
    private long commentProgressLastUpadteTime;
    private int commentUnreadX;
    private int commentWidth;
    private int commentX;
    private AvatarDrawable contactAvatarDrawable;
    private float controlsAlpha;
    private int currentAccount;
    private Theme.MessageDrawable currentBackgroundDrawable;
    private Theme.MessageDrawable currentBackgroundSelectedDrawable;
    private CharSequence currentCaption;
    private TLRPC$Chat currentChat;
    private int currentFocusedVirtualView;
    private TLRPC$Chat currentForwardChannel;
    private String currentForwardName;
    private String currentForwardNameString;
    private TLRPC$User currentForwardUser;
    private int currentMapProvider;
    private MessageObject currentMessageObject;
    private MessageObject.GroupedMessages currentMessagesGroup;
    private Object currentNameStatus;
    private AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable currentNameStatusDrawable;
    private String currentNameString;
    private TLRPC$FileLocation currentPhoto;
    private String currentPhotoFilter;
    private String currentPhotoFilterThumb;
    private TLRPC$PhotoSize currentPhotoObject;
    private TLRPC$PhotoSize currentPhotoObjectThumb;
    private BitmapDrawable currentPhotoObjectThumbStripped;
    private MessageObject.GroupedMessagePosition currentPosition;
    private String currentRepliesString;
    private TLRPC$PhotoSize currentReplyPhoto;
    private float currentSelectedBackgroundAlpha;
    private String currentTimeString;
    private String currentUnlockString;
    private String currentUrl;
    private TLRPC$User currentUser;
    private TLRPC$User currentViaBotUser;
    private String currentViewsString;
    private WebFile currentWebFile;
    private ChatMessageCellDelegate delegate;
    private RectF deleteProgressRect;
    private StaticLayout descriptionLayout;
    private int descriptionX;
    private int descriptionY;
    private Runnable diceFinishCallback;
    private boolean disallowLongPress;
    private StaticLayout docTitleLayout;
    private int docTitleOffsetX;
    private int docTitleWidth;
    private TLRPC$Document documentAttach;
    private int documentAttachType;
    private boolean drawBackground;
    private boolean drawCommentButton;
    private boolean drawCommentNumber;
    public boolean drawForBlur;
    private boolean drawForwardedName;
    public boolean drawFromPinchToZoom;
    private boolean drawImageButton;
    private boolean drawInstantView;
    private int drawInstantViewType;
    private boolean drawMediaCheckBox;
    private boolean drawName;
    private boolean drawNameLayout;
    private boolean drawPhotoImage;
    public boolean drawPinnedBottom;
    private boolean drawPinnedTop;
    private boolean drawRadialCheckBackground;
    private boolean drawSelectionBackground;
    private int drawSideButton;
    private boolean drawTime;
    private float drawTimeX;
    private float drawTimeY;
    private boolean drawVideoImageButton;
    private boolean drawVideoSize;
    private StaticLayout durationLayout;
    private int durationWidth;
    private boolean edited;
    boolean enterTransitionInProgress;
    private boolean firstCircleLength;
    private int firstVisibleBlockNum;
    private boolean flipImage;
    private boolean forceNotDrawTime;
    private boolean forwardBotPressed;
    private int forwardNameCenterX;
    private float[] forwardNameOffsetX;
    private boolean forwardNamePressed;
    private float forwardNameX;
    private int forwardNameY;
    private StaticLayout[] forwardedNameLayout;
    private int forwardedNameWidth;
    private boolean fullyDraw;
    private boolean gamePreviewPressed;
    private LinearGradient gradientShader;
    private boolean groupPhotoInvisible;
    private MessageObject.GroupedMessages groupedMessagesToSet;
    private boolean hadLongPress;
    public boolean hasDiscussion;
    private boolean hasEmbed;
    private boolean hasGamePreview;
    private boolean hasInvoicePreview;
    private boolean hasLinkPreview;
    private int hasMiniProgress;
    private boolean hasNewLineForTime;
    private boolean hasOldCaptionPreview;
    private boolean hasPsaHint;
    private int highlightProgress;
    private float hintButtonProgress;
    private boolean hintButtonVisible;
    private int imageBackgroundColor;
    private int imageBackgroundGradientColor1;
    private int imageBackgroundGradientColor2;
    private int imageBackgroundGradientColor3;
    private int imageBackgroundGradientRotation;
    private float imageBackgroundIntensity;
    private int imageBackgroundSideColor;
    private int imageBackgroundSideWidth;
    private boolean imageDrawn;
    private boolean imagePressed;
    boolean imageReceiversAttachState;
    private boolean inLayout;
    private StaticLayout infoLayout;
    private int infoWidth;
    private int infoX;
    private boolean instantButtonPressed;
    private RectF instantButtonRect;
    private boolean instantPressed;
    private int instantTextLeftX;
    private boolean instantTextNewLine;
    private int instantTextX;
    private StaticLayout instantViewLayout;
    private int instantWidth;
    private Runnable invalidateRunnable;
    private boolean invalidateSpoilersParent;
    private boolean invalidatesParent;
    private boolean isAvatarVisible;
    public boolean isBlurred;
    public boolean isBot;
    private boolean isCaptionSpoilerPressed;
    public boolean isChat;
    private boolean isCheckPressed;
    private boolean isHighlighted;
    private boolean isHighlightedAnimated;
    public boolean isMegagroup;
    public boolean isPinned;
    public boolean isPinnedChat;
    private boolean isPlayingRound;
    private boolean isPressed;
    public boolean isRepliesChat;
    private boolean isRoundVideo;
    private boolean isSmallImage;
    private boolean isSpoilerRevealing;
    public boolean isThreadChat;
    private boolean isThreadPost;
    private boolean isUpdating;
    private int keyboardHeight;
    private long lastAnimationTime;
    private long lastCheckBoxAnimationTime;
    private long lastControlsAlphaChangeTime;
    private int lastDeleteDate;
    private float lastDrawingAudioProgress;
    private int lastHeight;
    private long lastHighlightProgressTime;
    private long lastLoadingSizeTotal;
    private long lastNamesAnimationTime;
    private TLRPC$Poll lastPoll;
    private long lastPollCloseTime;
    private ArrayList<TLRPC$TL_pollAnswerVoters> lastPollResults;
    private int lastPollResultsVoters;
    private String lastPostAuthor;
    private TLRPC$TL_messageReactions lastReactions;
    private int lastRepliesCount;
    private TLRPC$Message lastReplyMessage;
    private long lastSeekUpdateTime;
    private int lastSendState;
    int lastSize;
    private int lastTime;
    private float lastTouchX;
    private float lastTouchY;
    private int lastViewsCount;
    private int lastVisibleBlockNum;
    private WebFile lastWebFile;
    private int lastWidth;
    private int layoutHeight;
    private int layoutWidth;
    private int linkBlockNum;
    private int linkPreviewHeight;
    private boolean linkPreviewPressed;
    private int linkSelectionBlockNum;
    public long linkedChatId;
    private LinkSpanDrawable.LinkCollector links;
    private StaticLayout loadingProgressLayout;
    private boolean locationExpired;
    private ImageReceiver locationImageReceiver;
    private boolean mediaBackground;
    private CheckBoxBase mediaCheckBox;
    private int mediaOffsetY;
    private boolean mediaWasInvisible;
    private MessageObject messageObjectToSet;
    private int miniButtonPressed;
    private int miniButtonState;
    private MotionBackgroundDrawable motionBackgroundDrawable;
    private StaticLayout nameLayout;
    private int nameLayoutWidth;
    private float nameOffsetX;
    private int nameWidth;
    private float nameX;
    private float nameY;
    private int namesOffset;
    private boolean needNewVisiblePart;
    public boolean needReplyImage;
    private int noSoundCenterX;
    private boolean otherPressed;
    private int otherX;
    private int otherY;
    private int overideShouldDrawTimeOnMedia;
    int parentBoundsBottom;
    float parentBoundsTop;
    private int parentHeight;
    public float parentViewTopOffset;
    private int parentWidth;
    private StaticLayout performerLayout;
    private int performerX;
    private ImageReceiver photoImage;
    private boolean photoImageOutOfBounds;
    private boolean photoNotSet;
    private TLObject photoParentObject;
    private StaticLayout photosCountLayout;
    private int photosCountWidth;
    public boolean pinnedBottom;
    public boolean pinnedTop;
    private float pollAnimationProgress;
    private float pollAnimationProgressTime;
    private AvatarDrawable[] pollAvatarDrawables;
    private ImageReceiver[] pollAvatarImages;
    private boolean[] pollAvatarImagesVisible;
    private ArrayList<PollButton> pollButtons;
    private CheckBoxBase[] pollCheckBox;
    private boolean pollClosed;
    private boolean pollHintPressed;
    private int pollHintX;
    private int pollHintY;
    private boolean pollUnvoteInProgress;
    private boolean pollVoteInProgress;
    private int pollVoteInProgressNum;
    private boolean pollVoted;
    private int pressedBotButton;
    private AnimatedEmojiSpan pressedEmoji;
    private LinkSpanDrawable pressedLink;
    private int pressedLinkType;
    private int[] pressedState;
    private int pressedVoteButton;
    private float psaButtonProgress;
    private boolean psaButtonVisible;
    private int psaHelpX;
    private int psaHelpY;
    private boolean psaHintPressed;
    private RadialProgress2 radialProgress;
    public final ReactionsLayoutInBubble reactionsLayoutInBubble;
    private RectF rect;
    private Path rectPath;
    private StaticLayout repliesLayout;
    private int repliesTextWidth;
    public ImageReceiver replyImageReceiver;
    public StaticLayout replyNameLayout;
    private int replyNameOffset;
    private int replyNameWidth;
    private boolean replyPanelIsForward;
    private boolean replyPressed;
    public List<SpoilerEffect> replySpoilers;
    private Stack<SpoilerEffect> replySpoilersPool;
    public int replyStartX;
    public int replyStartY;
    public StaticLayout replyTextLayout;
    private int replyTextOffset;
    private int replyTextWidth;
    private final Theme.ResourcesProvider resourcesProvider;
    private float roundPlayingDrawableProgress;
    private float roundProgressAlpha;
    float roundSeekbarOutAlpha;
    float roundSeekbarOutProgress;
    int roundSeekbarTouched;
    private float roundToPauseProgress;
    private float roundToPauseProgress2;
    private RoundVideoPlayingDrawable roundVideoPlayingDrawable;
    private Path sPath;
    private boolean scheduledInvalidate;
    private Rect scrollRect;
    private SeekBar seekBar;
    private SeekBarAccessibilityDelegate seekBarAccessibilityDelegate;
    private SeekBarWaveform seekBarWaveform;
    private int seekBarX;
    private int seekBarY;
    float seekbarRoundX;
    float seekbarRoundY;
    private float selectedBackgroundProgress;
    private Paint selectionOverlayPaint;
    private Drawable[] selectorDrawable;
    private int[] selectorDrawableMaskType;
    private AnimatorSet shakeAnimation;
    public boolean shouldCheckVisibleOnScreen;
    private boolean sideButtonPressed;
    private float sideStartX;
    private float sideStartY;
    private StaticLayout siteNameLayout;
    private boolean siteNameRtl;
    private int siteNameWidth;
    private float slidingOffsetX;
    private StaticLayout songLayout;
    private int songX;
    private SpoilerEffect spoilerPressed;
    private AtomicReference<Layout> spoilersPatchedReplyTextLayout;
    private boolean statusDrawableAnimationInProgress;
    private ValueAnimator statusDrawableAnimator;
    private float statusDrawableProgress;
    private int substractBackgroundHeight;
    private int textX;
    private int textY;
    private float timeAlpha;
    private int timeAudioX;
    private StaticLayout timeLayout;
    private boolean timePressed;
    private int timeTextWidth;
    private boolean timeWasInvisible;
    private int timeWidth;
    private int timeWidthAudio;
    private int timeX;
    private TimerParticles timerParticles;
    private float timerTransitionProgress;
    private StaticLayout titleLayout;
    private int titleX;
    private float toSeekBarProgress;
    private boolean topNearToSet;
    private long totalChangeTime;
    private int totalCommentWidth;
    private int totalHeight;
    private int totalVisibleBlocksCount;
    private TranscribeButton transcribeButton;
    private float transcribeX;
    private float transcribeY;
    private final TransitionParams transitionParams;
    float transitionYOffsetForDrawables;
    private float unlockAlpha;
    private StaticLayout unlockLayout;
    private SpoilerEffect unlockSpoilerEffect;
    private Path unlockSpoilerPath;
    private float[] unlockSpoilerRadii;
    private int unlockTextWidth;
    private float unlockX;
    private float unlockY;
    private int unmovedTextX;
    private Runnable unregisterFlagSecure;
    private ArrayList<LinkPath> urlPathCache;
    private ArrayList<LinkPath> urlPathSelection;
    private boolean useSeekBarWaveform;
    private boolean useTranscribeButton;
    private int viaNameWidth;
    private TypefaceSpan viaSpan1;
    private TypefaceSpan viaSpan2;
    private int viaWidth;
    private boolean vibrateOnPollVote;
    private int videoButtonPressed;
    private int videoButtonX;
    private int videoButtonY;
    VideoForwardDrawable videoForwardDrawable;
    private StaticLayout videoInfoLayout;
    VideoPlayerRewinder videoPlayerRewinder;
    private RadialProgress2 videoRadialProgress;
    private float viewTop;
    private StaticLayout viewsLayout;
    private int viewsTextWidth;
    private boolean visibleOnScreen;
    private float voteCurrentCircleLength;
    private float voteCurrentProgressTime;
    private long voteLastUpdateTime;
    private float voteRadOffset;
    private boolean voteRisingCircleLength;
    private boolean wasLayout;
    private boolean wasPinned;
    private boolean wasSending;
    private int widthBeforeNewTimeLine;
    private int widthForButtons;
    private boolean willRemoved;

    /* loaded from: classes3.dex */
    public interface ChatMessageCellDelegate {

        /* loaded from: classes3.dex */
        public final /* synthetic */ class -CC {
            public static boolean $default$canDrawOutboundsContent(ChatMessageCellDelegate chatMessageCellDelegate) {
                return true;
            }

            public static boolean $default$canPerformActions(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static void $default$didLongPress(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didLongPressBotButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC$KeyboardButton tLRPC$KeyboardButton) {
            }

            public static boolean $default$didLongPressChannelAvatar(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC$Chat tLRPC$Chat, int i, float f, float f2) {
                return false;
            }

            public static boolean $default$didLongPressUserAvatar(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC$User tLRPC$User, float f, float f2) {
                return false;
            }

            public static boolean $default$didPressAnimatedEmoji(ChatMessageCellDelegate chatMessageCellDelegate, AnimatedEmojiSpan animatedEmojiSpan) {
                return false;
            }

            public static void $default$didPressBotButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC$KeyboardButton tLRPC$KeyboardButton) {
            }

            public static void $default$didPressCancelSendButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressChannelAvatar(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC$Chat tLRPC$Chat, int i, float f, float f2) {
            }

            public static void $default$didPressCommentButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressExtendedMediaPreview(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC$KeyboardButton tLRPC$KeyboardButton) {
            }

            public static void $default$didPressHiddenForward(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressHint(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i) {
            }

            public static void $default$didPressImage(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didPressInstantButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i) {
            }

            public static void $default$didPressOther(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, float f, float f2) {
            }

            public static void $default$didPressReaction(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC$ReactionCount tLRPC$ReactionCount, boolean z) {
            }

            public static void $default$didPressReplyMessage(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, int i) {
            }

            public static void $default$didPressSideButton(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressTime(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
            }

            public static void $default$didPressUrl(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, CharacterStyle characterStyle, boolean z) {
            }

            public static void $default$didPressUserAvatar(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, TLRPC$User tLRPC$User, float f, float f2) {
            }

            public static void $default$didPressViaBot(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, String str) {
            }

            public static void $default$didPressViaBotNotInline(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, long j) {
            }

            public static void $default$didPressVoteButtons(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell, ArrayList arrayList, int i, int i2, int i3) {
            }

            public static void $default$didStartVideoStream(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject) {
            }

            public static String $default$getAdminRank(ChatMessageCellDelegate chatMessageCellDelegate, long j) {
                return null;
            }

            public static PinchToZoomHelper $default$getPinchToZoomHelper(ChatMessageCellDelegate chatMessageCellDelegate) {
                return null;
            }

            public static TextSelectionHelper.ChatListTextSelectionHelper $default$getTextSelectionHelper(ChatMessageCellDelegate chatMessageCellDelegate) {
                return null;
            }

            public static boolean $default$hasSelectedMessages(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static void $default$invalidateBlur(ChatMessageCellDelegate chatMessageCellDelegate) {
            }

            public static boolean $default$isLandscape(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static boolean $default$keyboardIsOpened(ChatMessageCellDelegate chatMessageCellDelegate) {
                return false;
            }

            public static void $default$needOpenWebView(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject, String str, String str2, String str3, String str4, int i, int i2) {
            }

            public static boolean $default$needPlayMessage(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject) {
                return false;
            }

            public static void $default$needReloadPolls(ChatMessageCellDelegate chatMessageCellDelegate) {
            }

            public static void $default$needShowPremiumFeatures(ChatMessageCellDelegate chatMessageCellDelegate, String str) {
            }

            public static boolean $default$onAccessibilityAction(ChatMessageCellDelegate chatMessageCellDelegate, int i, Bundle bundle) {
                return false;
            }

            public static void $default$onDiceFinished(ChatMessageCellDelegate chatMessageCellDelegate) {
            }

            public static void $default$setShouldNotRepeatSticker(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject) {
            }

            public static boolean $default$shouldDrawThreadProgress(ChatMessageCellDelegate chatMessageCellDelegate, ChatMessageCell chatMessageCell) {
                return false;
            }

            public static boolean $default$shouldRepeatSticker(ChatMessageCellDelegate chatMessageCellDelegate, MessageObject messageObject) {
                return true;
            }

            public static void $default$videoTimerReached(ChatMessageCellDelegate chatMessageCellDelegate) {
            }
        }

        boolean canDrawOutboundsContent();

        boolean canPerformActions();

        void didLongPress(ChatMessageCell chatMessageCell, float f, float f2);

        void didLongPressBotButton(ChatMessageCell chatMessageCell, TLRPC$KeyboardButton tLRPC$KeyboardButton);

        boolean didLongPressChannelAvatar(ChatMessageCell chatMessageCell, TLRPC$Chat tLRPC$Chat, int i, float f, float f2);

        boolean didLongPressUserAvatar(ChatMessageCell chatMessageCell, TLRPC$User tLRPC$User, float f, float f2);

        boolean didPressAnimatedEmoji(AnimatedEmojiSpan animatedEmojiSpan);

        void didPressBotButton(ChatMessageCell chatMessageCell, TLRPC$KeyboardButton tLRPC$KeyboardButton);

        void didPressCancelSendButton(ChatMessageCell chatMessageCell);

        void didPressChannelAvatar(ChatMessageCell chatMessageCell, TLRPC$Chat tLRPC$Chat, int i, float f, float f2);

        void didPressCommentButton(ChatMessageCell chatMessageCell);

        void didPressExtendedMediaPreview(ChatMessageCell chatMessageCell, TLRPC$KeyboardButton tLRPC$KeyboardButton);

        void didPressHiddenForward(ChatMessageCell chatMessageCell);

        void didPressHint(ChatMessageCell chatMessageCell, int i);

        void didPressImage(ChatMessageCell chatMessageCell, float f, float f2);

        void didPressInstantButton(ChatMessageCell chatMessageCell, int i);

        void didPressOther(ChatMessageCell chatMessageCell, float f, float f2);

        void didPressReaction(ChatMessageCell chatMessageCell, TLRPC$ReactionCount tLRPC$ReactionCount, boolean z);

        void didPressReplyMessage(ChatMessageCell chatMessageCell, int i);

        void didPressSideButton(ChatMessageCell chatMessageCell);

        void didPressTime(ChatMessageCell chatMessageCell);

        void didPressUrl(ChatMessageCell chatMessageCell, CharacterStyle characterStyle, boolean z);

        void didPressUserAvatar(ChatMessageCell chatMessageCell, TLRPC$User tLRPC$User, float f, float f2);

        void didPressViaBot(ChatMessageCell chatMessageCell, String str);

        void didPressViaBotNotInline(ChatMessageCell chatMessageCell, long j);

        void didPressVoteButtons(ChatMessageCell chatMessageCell, ArrayList<TLRPC$TL_pollAnswer> arrayList, int i, int i2, int i3);

        void didStartVideoStream(MessageObject messageObject);

        String getAdminRank(long j);

        PinchToZoomHelper getPinchToZoomHelper();

        TextSelectionHelper.ChatListTextSelectionHelper getTextSelectionHelper();

        boolean hasSelectedMessages();

        void invalidateBlur();

        boolean isLandscape();

        boolean keyboardIsOpened();

        void needOpenWebView(MessageObject messageObject, String str, String str2, String str3, String str4, int i, int i2);

        boolean needPlayMessage(MessageObject messageObject);

        void needReloadPolls();

        void needShowPremiumFeatures(String str);

        boolean onAccessibilityAction(int i, Bundle bundle);

        void onDiceFinished();

        void setShouldNotRepeatSticker(MessageObject messageObject);

        boolean shouldDrawThreadProgress(ChatMessageCell chatMessageCell);

        boolean shouldRepeatSticker(MessageObject messageObject);

        void videoTimerReached();
    }

    private boolean intersect(float f, float f2, float f3, float f4) {
        return f <= f3 ? f2 >= f3 : f <= f4;
    }

    public RadialProgress2 getRadialProgress() {
        return this.radialProgress;
    }

    public void setEnterTransitionInProgress(boolean z) {
        this.enterTransitionInProgress = z;
        invalidate();
    }

    public ReactionsLayoutInBubble.ReactionButton getReactionButton(ReactionsLayoutInBubble.VisibleReaction visibleReaction) {
        return this.reactionsLayoutInBubble.getReactionButton(visibleReaction);
    }

    public MessageObject getPrimaryMessageObject() {
        MessageObject messageObject = this.currentMessageObject;
        MessageObject findPrimaryMessageObject = (messageObject == null || this.currentMessagesGroup == null || !messageObject.hasValidGroupId()) ? null : this.currentMessagesGroup.findPrimaryMessageObject();
        return findPrimaryMessageObject != null ? findPrimaryMessageObject : this.currentMessageObject;
    }

    @Override // org.telegram.messenger.NotificationCenter.NotificationCenterDelegate
    public void didReceivedNotification(int i, int i2, Object... objArr) {
        TLRPC$User tLRPC$User;
        if (i == NotificationCenter.startSpoilers) {
            setSpoilersSuppressed(false);
        } else if (i == NotificationCenter.stopSpoilers) {
            setSpoilersSuppressed(true);
        } else if (i != NotificationCenter.userInfoDidLoad || (tLRPC$User = this.currentUser) == null || tLRPC$User.id != ((Long) objArr[0]).longValue()) {
        } else {
            setAvatar(this.currentMessageObject);
        }
    }

    private void setAvatar(MessageObject messageObject) {
        TLRPC$Chat tLRPC$Chat;
        if (messageObject == null) {
            return;
        }
        if (this.isAvatarVisible) {
            Drawable drawable = messageObject.customAvatarDrawable;
            if (drawable != null) {
                this.avatarImage.setImageBitmap(drawable);
                return;
            }
            TLRPC$User tLRPC$User = this.currentUser;
            if (tLRPC$User != null) {
                TLRPC$UserProfilePhoto tLRPC$UserProfilePhoto = tLRPC$User.photo;
                if (tLRPC$UserProfilePhoto != null) {
                    this.currentPhoto = tLRPC$UserProfilePhoto.photo_small;
                } else {
                    this.currentPhoto = null;
                }
                this.avatarDrawable.setInfo(tLRPC$User);
                this.avatarImage.setForUserOrChat(this.currentUser, this.avatarDrawable, null, true);
                return;
            }
            TLRPC$Chat tLRPC$Chat2 = this.currentChat;
            if (tLRPC$Chat2 != null) {
                TLRPC$ChatPhoto tLRPC$ChatPhoto = tLRPC$Chat2.photo;
                if (tLRPC$ChatPhoto != null) {
                    this.currentPhoto = tLRPC$ChatPhoto.photo_small;
                } else {
                    this.currentPhoto = null;
                }
                this.avatarDrawable.setInfo(tLRPC$Chat2);
                this.avatarImage.setForUserOrChat(this.currentChat, this.avatarDrawable);
                return;
            } else if (messageObject.isSponsored()) {
                TLRPC$ChatInvite tLRPC$ChatInvite = messageObject.sponsoredChatInvite;
                if (tLRPC$ChatInvite != null && (tLRPC$Chat = tLRPC$ChatInvite.chat) != null) {
                    this.avatarDrawable.setInfo(tLRPC$Chat);
                    this.avatarImage.setForUserOrChat(messageObject.sponsoredChatInvite.chat, this.avatarDrawable);
                    return;
                }
                this.avatarDrawable.setInfo(tLRPC$ChatInvite);
                TLRPC$Photo tLRPC$Photo = messageObject.sponsoredChatInvite.photo;
                if (tLRPC$Photo == null) {
                    return;
                }
                this.avatarImage.setImage(ImageLocation.getForPhoto(tLRPC$Photo.sizes.get(0), tLRPC$Photo), "50_50", this.avatarDrawable, null, null, 0);
                return;
            } else {
                this.currentPhoto = null;
                this.avatarDrawable.setInfo(messageObject.getFromChatId(), null, null);
                this.avatarImage.setImage(null, null, this.avatarDrawable, null, null, 0);
                return;
            }
        }
        this.currentPhoto = null;
    }

    public void setSpoilersSuppressed(boolean z) {
        for (SpoilerEffect spoilerEffect : this.captionSpoilers) {
            spoilerEffect.setSuppressUpdates(z);
        }
        for (SpoilerEffect spoilerEffect2 : this.replySpoilers) {
            spoilerEffect2.setSuppressUpdates(z);
        }
        if (getMessageObject() == null || getMessageObject().textLayoutBlocks == null) {
            return;
        }
        Iterator<MessageObject.TextLayoutBlock> it = getMessageObject().textLayoutBlocks.iterator();
        while (it.hasNext()) {
            for (SpoilerEffect spoilerEffect3 : it.next().spoilers) {
                spoilerEffect3.setSuppressUpdates(z);
            }
        }
    }

    public boolean hasSpoilers() {
        if ((!hasCaptionLayout() || this.captionSpoilers.isEmpty()) && (this.replyTextLayout == null || this.replySpoilers.isEmpty())) {
            if (getMessageObject() == null || getMessageObject().textLayoutBlocks == null) {
                return false;
            }
            Iterator<MessageObject.TextLayoutBlock> it = getMessageObject().textLayoutBlocks.iterator();
            while (it.hasNext()) {
                if (!it.next().spoilers.isEmpty()) {
                    return true;
                }
            }
            return false;
        }
        return true;
    }

    private void updateSpoilersVisiblePart(int i, int i2) {
        if (hasCaptionLayout()) {
            float f = -this.captionY;
            for (SpoilerEffect spoilerEffect : this.captionSpoilers) {
                spoilerEffect.setVisibleBounds(0.0f, i + f, getWidth(), i2 + f);
            }
        }
        StaticLayout staticLayout = this.replyTextLayout;
        if (staticLayout != null) {
            float height = (-this.replyStartY) - staticLayout.getHeight();
            for (SpoilerEffect spoilerEffect2 : this.replySpoilers) {
                spoilerEffect2.setVisibleBounds(0.0f, i + height, getWidth(), i2 + height);
            }
        }
        if (getMessageObject() == null || getMessageObject().textLayoutBlocks == null) {
            return;
        }
        Iterator<MessageObject.TextLayoutBlock> it = getMessageObject().textLayoutBlocks.iterator();
        while (it.hasNext()) {
            MessageObject.TextLayoutBlock next = it.next();
            for (SpoilerEffect spoilerEffect3 : next.spoilers) {
                spoilerEffect3.setVisibleBounds(0.0f, (i - next.textYOffset) - this.textY, getWidth(), (i2 - next.textYOffset) - this.textY);
            }
        }
    }

    public void setScrimReaction(String str) {
        this.reactionsLayoutInBubble.setScrimReaction(str);
    }

    public void drawScrimReaction(Canvas canvas, String str) {
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null) {
            int i = groupedMessagePosition.flags;
            if ((i & 8) == 0 || (i & 1) == 0) {
                return;
            }
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        if (!reactionsLayoutInBubble.isSmall) {
            reactionsLayoutInBubble.draw(canvas, this.transitionParams.animateChangeProgress, str);
        }
    }

    public boolean checkUnreadReactions(float f, int i) {
        if (!this.reactionsLayoutInBubble.hasUnreadReactions) {
            return false;
        }
        float y = getY();
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        float f2 = y + reactionsLayoutInBubble.y;
        return f2 > f && (f2 + ((float) reactionsLayoutInBubble.height)) - ((float) AndroidUtilities.dp(16.0f)) < ((float) i);
    }

    public void markReactionsAsRead() {
        this.reactionsLayoutInBubble.hasUnreadReactions = false;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        messageObject.markReactionsAsRead();
    }

    public void setVisibleOnScreen(boolean z) {
        if (this.visibleOnScreen != z) {
            this.visibleOnScreen = z;
            checkImageReceiversAttachState();
        }
    }

    public void setParentBounds(float f, int i) {
        this.parentBoundsTop = f;
        this.parentBoundsBottom = i;
        if (this.photoImageOutOfBounds) {
            float y = getY() + this.photoImage.getImageY();
            if (this.photoImage.getImageHeight() + y < this.parentBoundsTop || y > this.parentBoundsBottom) {
                return;
            }
            invalidate();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* loaded from: classes3.dex */
    public static class BotButton {
        private int angle;
        private TLRPC$KeyboardButton button;
        private int height;
        private boolean isInviteButton;
        private long lastUpdateTime;
        private float progressAlpha;
        private StaticLayout title;
        private int width;
        private int x;
        private int y;

        private BotButton() {
        }

        static /* synthetic */ float access$2716(BotButton botButton, float f) {
            float f2 = botButton.progressAlpha + f;
            botButton.progressAlpha = f2;
            return f2;
        }

        static /* synthetic */ float access$2724(BotButton botButton, float f) {
            float f2 = botButton.progressAlpha - f;
            botButton.progressAlpha = f2;
            return f2;
        }

        static /* synthetic */ int access$2816(BotButton botButton, float f) {
            int i = (int) (botButton.angle + f);
            botButton.angle = i;
            return i;
        }

        static /* synthetic */ int access$2820(BotButton botButton, int i) {
            int i2 = botButton.angle - i;
            botButton.angle = i2;
            return i2;
        }
    }

    /* loaded from: classes3.dex */
    public static class PollButton {
        private TLRPC$TL_pollAnswer answer;
        private boolean chosen;
        private boolean correct;
        private int count;
        private float decimal;
        public int height;
        private int percent;
        private float percentProgress;
        private boolean prevChosen;
        private int prevPercent;
        private float prevPercentProgress;
        private StaticLayout title;
        public int x;
        public int y;

        static /* synthetic */ int access$1712(PollButton pollButton, int i) {
            int i2 = pollButton.percent + i;
            pollButton.percent = i2;
            return i2;
        }

        static /* synthetic */ float access$2424(PollButton pollButton, float f) {
            float f2 = pollButton.decimal - f;
            pollButton.decimal = f2;
            return f2;
        }
    }

    public ChatMessageCell(Context context) {
        this(context, false, null);
    }

    public ChatMessageCell(Context context, boolean z, Theme.ResourcesProvider resourcesProvider) {
        super(context);
        this.reactionsLayoutInBubble = new ReactionsLayoutInBubble(this);
        this.scrollRect = new Rect();
        this.imageBackgroundGradientRotation = 45;
        this.selectorDrawable = new Drawable[2];
        this.selectorDrawableMaskType = new int[2];
        this.instantButtonRect = new RectF();
        this.pressedState = new int[]{16842910, 16842919};
        this.deleteProgressRect = new RectF();
        this.rect = new RectF();
        this.timeAlpha = 1.0f;
        this.controlsAlpha = 1.0f;
        this.links = new LinkSpanDrawable.LinkCollector(this);
        this.urlPathCache = new ArrayList<>();
        this.urlPathSelection = new ArrayList<>();
        this.rectPath = new Path();
        this.pollButtons = new ArrayList<>();
        this.botButtons = new ArrayList<>();
        this.botButtonsByData = new HashMap<>();
        this.botButtonsByPosition = new HashMap<>();
        this.currentAccount = UserConfig.selectedAccount;
        this.isCheckPressed = true;
        this.drawBackground = true;
        this.backgroundWidth = 100;
        this.commentButtonRect = new Rect();
        this.spoilersPatchedReplyTextLayout = new AtomicReference<>();
        this.forwardedNameLayout = new StaticLayout[2];
        this.forwardNameOffsetX = new float[2];
        this.drawTime = true;
        this.unlockAlpha = 1.0f;
        this.unlockSpoilerEffect = new SpoilerEffect();
        this.unlockSpoilerPath = new Path();
        this.unlockSpoilerRadii = new float[8];
        this.ALPHA_PROPERTY_WORKAROUND = Build.VERSION.SDK_INT == 28;
        this.alphaInternal = 1.0f;
        this.transitionParams = new TransitionParams();
        this.diceFinishCallback = new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell.1
            @Override // java.lang.Runnable
            public void run() {
                if (ChatMessageCell.this.delegate != null) {
                    ChatMessageCell.this.delegate.onDiceFinished();
                }
            }
        };
        this.invalidateRunnable = new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell.2
            @Override // java.lang.Runnable
            public void run() {
                ChatMessageCell.this.checkLocationExpired();
                if (ChatMessageCell.this.locationExpired) {
                    ChatMessageCell.this.invalidate();
                    ChatMessageCell.this.scheduledInvalidate = false;
                    return;
                }
                ChatMessageCell chatMessageCell = ChatMessageCell.this;
                chatMessageCell.invalidate(((int) chatMessageCell.rect.left) - 5, ((int) ChatMessageCell.this.rect.top) - 5, ((int) ChatMessageCell.this.rect.right) + 5, ((int) ChatMessageCell.this.rect.bottom) + 5);
                if (!ChatMessageCell.this.scheduledInvalidate) {
                    return;
                }
                AndroidUtilities.runOnUIThread(ChatMessageCell.this.invalidateRunnable, 1000L);
            }
        };
        this.accessibilityVirtualViewBounds = new SparseArray<>();
        this.currentFocusedVirtualView = -1;
        this.backgroundCacheParams = new Theme.MessageDrawable.PathDrawParams();
        this.replySpoilers = new ArrayList();
        this.replySpoilersPool = new Stack<>();
        this.captionSpoilers = new ArrayList();
        this.captionSpoilersPool = new Stack<>();
        this.captionPatchedSpoilersLayout = new AtomicReference<>();
        this.sPath = new Path();
        this.hadLongPress = false;
        this.ANIMATION_OFFSET_X = new Property<ChatMessageCell, Float>(this, Float.class, "animationOffsetX") { // from class: org.telegram.ui.Cells.ChatMessageCell.7
            @Override // android.util.Property
            public Float get(ChatMessageCell chatMessageCell) {
                return Float.valueOf(chatMessageCell.animationOffsetX);
            }

            @Override // android.util.Property
            public void set(ChatMessageCell chatMessageCell, Float f) {
                chatMessageCell.setAnimationOffsetX(f.floatValue());
            }
        };
        this.resourcesProvider = resourcesProvider;
        this.canDrawBackgroundInParent = z;
        this.backgroundDrawable = new MessageBackgroundDrawable(this);
        ImageReceiver imageReceiver = new ImageReceiver();
        this.avatarImage = imageReceiver;
        imageReceiver.setAllowLoadingOnAttachedOnly(true);
        this.avatarImage.setRoundRadius(AndroidUtilities.dp(21.0f));
        this.avatarDrawable = new AvatarDrawable();
        ImageReceiver imageReceiver2 = new ImageReceiver(this);
        this.replyImageReceiver = imageReceiver2;
        imageReceiver2.setAllowLoadingOnAttachedOnly(true);
        this.replyImageReceiver.setRoundRadius(AndroidUtilities.dp(2.0f));
        ImageReceiver imageReceiver3 = new ImageReceiver(this);
        this.locationImageReceiver = imageReceiver3;
        imageReceiver3.setAllowLoadingOnAttachedOnly(true);
        this.locationImageReceiver.setRoundRadius(AndroidUtilities.dp(26.1f));
        this.TAG = DownloadController.getInstance(this.currentAccount).generateObserverTag();
        this.contactAvatarDrawable = new AvatarDrawable();
        ImageReceiver imageReceiver4 = new ImageReceiver(this);
        this.photoImage = imageReceiver4;
        imageReceiver4.setAllowLoadingOnAttachedOnly(true);
        this.photoImage.setUseRoundForThumbDrawable(true);
        this.photoImage.setDelegate(this);
        this.radialProgress = new RadialProgress2(this, resourcesProvider);
        RadialProgress2 radialProgress2 = new RadialProgress2(this, resourcesProvider);
        this.videoRadialProgress = radialProgress2;
        radialProgress2.setDrawBackground(false);
        this.videoRadialProgress.setCircleRadius(AndroidUtilities.dp(15.0f));
        SeekBar seekBar = new SeekBar(this);
        this.seekBar = seekBar;
        seekBar.setDelegate(this);
        SeekBarWaveform seekBarWaveform = new SeekBarWaveform(context);
        this.seekBarWaveform = seekBarWaveform;
        seekBarWaveform.setDelegate(this);
        this.seekBarWaveform.setParentView(this);
        this.seekBarAccessibilityDelegate = new FloatSeekBarAccessibilityDelegate() { // from class: org.telegram.ui.Cells.ChatMessageCell.3
            @Override // org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate
            public float getProgress() {
                if (ChatMessageCell.this.currentMessageObject.isMusic()) {
                    return ChatMessageCell.this.seekBar.getProgress();
                }
                if (ChatMessageCell.this.currentMessageObject.isVoice()) {
                    return ChatMessageCell.this.useSeekBarWaveform ? ChatMessageCell.this.seekBarWaveform.getProgress() : ChatMessageCell.this.seekBar.getProgress();
                } else if (!ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                    return 0.0f;
                } else {
                    return ChatMessageCell.this.currentMessageObject.audioProgress;
                }
            }

            @Override // org.telegram.ui.Components.FloatSeekBarAccessibilityDelegate
            public void setProgress(float f) {
                if (ChatMessageCell.this.currentMessageObject.isMusic()) {
                    ChatMessageCell.this.seekBar.setProgress(f);
                } else if (ChatMessageCell.this.currentMessageObject.isVoice()) {
                    if (ChatMessageCell.this.useSeekBarWaveform) {
                        ChatMessageCell.this.seekBarWaveform.setProgress(f);
                    } else {
                        ChatMessageCell.this.seekBar.setProgress(f);
                    }
                } else if (!ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                    return;
                } else {
                    ChatMessageCell.this.currentMessageObject.audioProgress = f;
                }
                ChatMessageCell.this.onSeekBarDrag(f);
                ChatMessageCell.this.invalidate();
            }
        };
        this.roundVideoPlayingDrawable = new RoundVideoPlayingDrawable(this, resourcesProvider);
        setImportantForAccessibility(1);
    }

    private void createPollUI() {
        if (this.pollAvatarImages != null) {
            return;
        }
        this.pollAvatarImages = new ImageReceiver[3];
        this.pollAvatarDrawables = new AvatarDrawable[3];
        this.pollAvatarImagesVisible = new boolean[3];
        int i = 0;
        while (true) {
            ImageReceiver[] imageReceiverArr = this.pollAvatarImages;
            if (i >= imageReceiverArr.length) {
                break;
            }
            imageReceiverArr[i] = new ImageReceiver(this);
            this.pollAvatarImages[i].setRoundRadius(AndroidUtilities.dp(8.0f));
            this.pollAvatarDrawables[i] = new AvatarDrawable();
            this.pollAvatarDrawables[i].setTextSize(AndroidUtilities.dp(6.0f));
            i++;
        }
        this.pollCheckBox = new CheckBoxBase[10];
        int i2 = 0;
        while (true) {
            CheckBoxBase[] checkBoxBaseArr = this.pollCheckBox;
            if (i2 >= checkBoxBaseArr.length) {
                return;
            }
            checkBoxBaseArr[i2] = new CheckBoxBase(this, 20, this.resourcesProvider);
            this.pollCheckBox[i2].setDrawUnchecked(false);
            this.pollCheckBox[i2].setBackgroundType(9);
            i2++;
        }
    }

    private void createCommentUI() {
        if (this.commentAvatarImages != null) {
            return;
        }
        this.commentAvatarImages = new ImageReceiver[3];
        this.commentAvatarDrawables = new AvatarDrawable[3];
        this.commentAvatarImagesVisible = new boolean[3];
        int i = 0;
        while (true) {
            ImageReceiver[] imageReceiverArr = this.commentAvatarImages;
            if (i >= imageReceiverArr.length) {
                return;
            }
            imageReceiverArr[i] = new ImageReceiver(this);
            this.commentAvatarImages[i].setRoundRadius(AndroidUtilities.dp(12.0f));
            this.commentAvatarDrawables[i] = new AvatarDrawable();
            this.commentAvatarDrawables[i].setTextSize(AndroidUtilities.dp(8.0f));
            i++;
        }
    }

    public void resetPressedLink(int i) {
        if (i != -1) {
            this.links.removeLinks(Integer.valueOf(i));
        } else {
            this.links.clear();
        }
        this.pressedEmoji = null;
        if (this.pressedLink != null) {
            if (this.pressedLinkType != i && i != -1) {
                return;
            }
            this.pressedLink = null;
            this.pressedLinkType = -1;
            invalidate();
        }
    }

    private void resetUrlPaths() {
        if (this.urlPathSelection.isEmpty()) {
            return;
        }
        this.urlPathCache.addAll(this.urlPathSelection);
        this.urlPathSelection.clear();
    }

    private LinkPath obtainNewUrlPath() {
        LinkPath linkPath;
        if (!this.urlPathCache.isEmpty()) {
            linkPath = this.urlPathCache.get(0);
            this.urlPathCache.remove(0);
        } else {
            linkPath = new LinkPath(true);
        }
        linkPath.reset();
        this.urlPathSelection.add(linkPath);
        return linkPath;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int[] getRealSpanStartAndEnd(Spannable spannable, CharacterStyle characterStyle) {
        int i;
        int i2;
        boolean z;
        TextStyleSpan.TextStyleRun style;
        TLRPC$MessageEntity tLRPC$MessageEntity;
        if (!(characterStyle instanceof URLSpanBrowser) || (style = ((URLSpanBrowser) characterStyle).getStyle()) == null || (tLRPC$MessageEntity = style.urlEntity) == null) {
            i = 0;
            i2 = 0;
            z = false;
        } else {
            i2 = tLRPC$MessageEntity.offset;
            i = tLRPC$MessageEntity.length + i2;
            z = true;
        }
        if (!z) {
            i2 = spannable.getSpanStart(characterStyle);
            i = spannable.getSpanEnd(characterStyle);
        }
        return new int[]{i2, i};
    }

    /* JADX WARN: Removed duplicated region for block: B:132:0x0277 A[Catch: Exception -> 0x02b1, TryCatch #1 {Exception -> 0x02b1, blocks: (B:34:0x0077, B:36:0x008c, B:37:0x0092, B:39:0x00b4, B:41:0x00bf, B:43:0x00cf, B:48:0x00e0, B:50:0x00ec, B:52:0x00ef, B:54:0x00f5, B:59:0x00ff, B:61:0x0105, B:63:0x010b, B:65:0x0111, B:67:0x0115, B:69:0x0273, B:71:0x0119, B:72:0x0126, B:74:0x012a, B:76:0x0132, B:79:0x0159, B:128:0x0268, B:130:0x0265, B:132:0x0277, B:134:0x027d, B:136:0x0283, B:138:0x028c, B:140:0x0292, B:141:0x0298, B:143:0x02a2, B:146:0x00e3, B:147:0x00d5, B:81:0x0164, B:83:0x0196, B:84:0x0198, B:86:0x01a2, B:88:0x01ae, B:90:0x01c5, B:92:0x01c8, B:94:0x01d3, B:96:0x01f6, B:103:0x01b9, B:105:0x01f9, B:107:0x01ff, B:109:0x0203, B:111:0x020f, B:113:0x022e, B:115:0x0231, B:117:0x023c, B:125:0x021e), top: B:33:0x0077, inners: #0 }] */
    /* JADX WARN: Removed duplicated region for block: B:59:0x00ff A[Catch: Exception -> 0x02b1, TryCatch #1 {Exception -> 0x02b1, blocks: (B:34:0x0077, B:36:0x008c, B:37:0x0092, B:39:0x00b4, B:41:0x00bf, B:43:0x00cf, B:48:0x00e0, B:50:0x00ec, B:52:0x00ef, B:54:0x00f5, B:59:0x00ff, B:61:0x0105, B:63:0x010b, B:65:0x0111, B:67:0x0115, B:69:0x0273, B:71:0x0119, B:72:0x0126, B:74:0x012a, B:76:0x0132, B:79:0x0159, B:128:0x0268, B:130:0x0265, B:132:0x0277, B:134:0x027d, B:136:0x0283, B:138:0x028c, B:140:0x0292, B:141:0x0298, B:143:0x02a2, B:146:0x00e3, B:147:0x00d5, B:81:0x0164, B:83:0x0196, B:84:0x0198, B:86:0x01a2, B:88:0x01ae, B:90:0x01c5, B:92:0x01c8, B:94:0x01d3, B:96:0x01f6, B:103:0x01b9, B:105:0x01f9, B:107:0x01ff, B:109:0x0203, B:111:0x020f, B:113:0x022e, B:115:0x0231, B:117:0x023c, B:125:0x021e), top: B:33:0x0077, inners: #0 }] */
    /* JADX WARN: Removed duplicated region for block: B:63:0x010b A[Catch: Exception -> 0x02b1, TryCatch #1 {Exception -> 0x02b1, blocks: (B:34:0x0077, B:36:0x008c, B:37:0x0092, B:39:0x00b4, B:41:0x00bf, B:43:0x00cf, B:48:0x00e0, B:50:0x00ec, B:52:0x00ef, B:54:0x00f5, B:59:0x00ff, B:61:0x0105, B:63:0x010b, B:65:0x0111, B:67:0x0115, B:69:0x0273, B:71:0x0119, B:72:0x0126, B:74:0x012a, B:76:0x0132, B:79:0x0159, B:128:0x0268, B:130:0x0265, B:132:0x0277, B:134:0x027d, B:136:0x0283, B:138:0x028c, B:140:0x0292, B:141:0x0298, B:143:0x02a2, B:146:0x00e3, B:147:0x00d5, B:81:0x0164, B:83:0x0196, B:84:0x0198, B:86:0x01a2, B:88:0x01ae, B:90:0x01c5, B:92:0x01c8, B:94:0x01d3, B:96:0x01f6, B:103:0x01b9, B:105:0x01f9, B:107:0x01ff, B:109:0x0203, B:111:0x020f, B:113:0x022e, B:115:0x0231, B:117:0x023c, B:125:0x021e), top: B:33:0x0077, inners: #0 }] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkTextBlockMotionEvent(MotionEvent motionEvent) {
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        int i;
        boolean z;
        boolean z2;
        AnimatedEmojiSpan animatedEmojiSpan;
        CharacterStyle[] characterStyleArr;
        CharacterStyle[] characterStyleArr2;
        MessageObject messageObject = this.currentMessageObject;
        int i2 = messageObject.type;
        if ((i2 == 0 || i2 == 19) && (arrayList = messageObject.textLayoutBlocks) != null && !arrayList.isEmpty() && (this.currentMessageObject.messageText instanceof Spannable) && (motionEvent.getAction() == 0 || (motionEvent.getAction() == 1 && this.pressedLinkType == 1))) {
            int x = (int) motionEvent.getX();
            int y = (int) motionEvent.getY();
            int i3 = this.textX;
            if (x >= i3 && y >= (i = this.textY)) {
                MessageObject messageObject2 = this.currentMessageObject;
                if (x <= i3 + messageObject2.textWidth && y <= messageObject2.textHeight + i) {
                    int i4 = y - i;
                    int i5 = 0;
                    for (int i6 = 0; i6 < this.currentMessageObject.textLayoutBlocks.size() && this.currentMessageObject.textLayoutBlocks.get(i6).textYOffset <= i4; i6++) {
                        i5 = i6;
                    }
                    try {
                        MessageObject.TextLayoutBlock textLayoutBlock = this.currentMessageObject.textLayoutBlocks.get(i5);
                        float f = x;
                        float f2 = this.textX;
                        float f3 = textLayoutBlock.isRtl() ? this.currentMessageObject.textXOffset : 0.0f;
                        int i7 = (int) (i4 - textLayoutBlock.textYOffset);
                        int lineForVertical = textLayoutBlock.textLayout.getLineForVertical(i7);
                        float f4 = (int) (f - (f2 - f3));
                        int offsetForHorizontal = textLayoutBlock.charactersOffset + textLayoutBlock.textLayout.getOffsetForHorizontal(lineForVertical, f4);
                        float lineLeft = textLayoutBlock.textLayout.getLineLeft(lineForVertical);
                        if (lineLeft <= f4 && lineLeft + textLayoutBlock.textLayout.getLineWidth(lineForVertical) >= f4) {
                            Spannable spannable = (Spannable) this.currentMessageObject.messageText;
                            CharacterStyle[] characterStyleArr3 = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                            if (characterStyleArr3 != null && characterStyleArr3.length != 0) {
                                z = false;
                                if (characterStyleArr3 != null || characterStyleArr3.length == 0) {
                                    characterStyleArr3 = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, AnimatedEmojiSpan.class);
                                    z = false;
                                }
                                if (characterStyleArr3.length != 0 && (!(characterStyleArr3[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled)) {
                                    z2 = false;
                                    if (!z2 && !AndroidUtilities.isAccessibilityScreenReaderEnabled()) {
                                        if (motionEvent.getAction() != 0) {
                                            if (characterStyleArr3[0] instanceof AnimatedEmojiSpan) {
                                                AnimatedEmojiSpan animatedEmojiSpan2 = this.pressedEmoji;
                                                if (animatedEmojiSpan2 == null || animatedEmojiSpan2 != characterStyleArr3[0]) {
                                                    resetPressedLink(1);
                                                    this.pressedEmoji = (AnimatedEmojiSpan) characterStyleArr3[0];
                                                    this.pressedLinkType = 1;
                                                }
                                            } else {
                                                LinkSpanDrawable linkSpanDrawable = this.pressedLink;
                                                if (linkSpanDrawable == null || linkSpanDrawable.getSpan() != characterStyleArr3[0]) {
                                                    this.links.removeLink(this.pressedLink);
                                                    LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(characterStyleArr3[0], this.resourcesProvider, f4, i7, spanSupportsLongPress(characterStyleArr3[0]));
                                                    this.pressedLink = linkSpanDrawable2;
                                                    linkSpanDrawable2.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outLinkSelectBackground" : "chat_linkSelectBackground"));
                                                    this.linkBlockNum = i5;
                                                    this.pressedLinkType = 1;
                                                    try {
                                                        LinkPath obtainNewPath = this.pressedLink.obtainNewPath();
                                                        int[] realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                                        int i8 = realSpanStartAndEnd[0];
                                                        int i9 = textLayoutBlock.charactersOffset;
                                                        realSpanStartAndEnd[0] = i8 - i9;
                                                        realSpanStartAndEnd[1] = realSpanStartAndEnd[1] - i9;
                                                        obtainNewPath.setCurrentLayout(textLayoutBlock.textLayout, realSpanStartAndEnd[0], 0.0f);
                                                        textLayoutBlock.textLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], obtainNewPath);
                                                        if (realSpanStartAndEnd[1] >= textLayoutBlock.charactersEnd) {
                                                            for (int i10 = i5 + 1; i10 < this.currentMessageObject.textLayoutBlocks.size(); i10++) {
                                                                MessageObject.TextLayoutBlock textLayoutBlock2 = this.currentMessageObject.textLayoutBlocks.get(i10);
                                                                if (z) {
                                                                    int i11 = textLayoutBlock2.charactersOffset;
                                                                    characterStyleArr2 = (CharacterStyle[]) spannable.getSpans(i11, i11, URLSpanMono.class);
                                                                } else {
                                                                    int i12 = textLayoutBlock2.charactersOffset;
                                                                    characterStyleArr2 = (CharacterStyle[]) spannable.getSpans(i12, i12, ClickableSpan.class);
                                                                }
                                                                if (characterStyleArr2 == null || characterStyleArr2.length == 0 || characterStyleArr2[0] != this.pressedLink.getSpan()) {
                                                                    break;
                                                                }
                                                                LinkPath obtainNewPath2 = this.pressedLink.obtainNewPath();
                                                                obtainNewPath2.setCurrentLayout(textLayoutBlock2.textLayout, 0, textLayoutBlock2.textYOffset - textLayoutBlock.textYOffset);
                                                                int i13 = (realSpanStartAndEnd[1] + textLayoutBlock.charactersOffset) - textLayoutBlock2.charactersOffset;
                                                                textLayoutBlock2.textLayout.getSelectionPath(0, i13, obtainNewPath2);
                                                                if (i13 < textLayoutBlock2.charactersEnd - 1) {
                                                                    break;
                                                                }
                                                            }
                                                        }
                                                        if (realSpanStartAndEnd[0] <= textLayoutBlock.charactersOffset) {
                                                            int i14 = 0;
                                                            for (int i15 = i5 - 1; i15 >= 0; i15--) {
                                                                MessageObject.TextLayoutBlock textLayoutBlock3 = this.currentMessageObject.textLayoutBlocks.get(i15);
                                                                if (z) {
                                                                    int i16 = textLayoutBlock3.charactersEnd;
                                                                    characterStyleArr = (CharacterStyle[]) spannable.getSpans(i16 - 1, i16 - 1, URLSpanMono.class);
                                                                } else {
                                                                    int i17 = textLayoutBlock3.charactersEnd;
                                                                    characterStyleArr = (CharacterStyle[]) spannable.getSpans(i17 - 1, i17 - 1, ClickableSpan.class);
                                                                }
                                                                if (characterStyleArr == null || characterStyleArr.length == 0 || characterStyleArr[0] != this.pressedLink.getSpan()) {
                                                                    break;
                                                                }
                                                                LinkPath obtainNewPath3 = this.pressedLink.obtainNewPath();
                                                                i14 -= textLayoutBlock3.height;
                                                                int i18 = realSpanStartAndEnd[0];
                                                                int i19 = textLayoutBlock.charactersOffset;
                                                                int i20 = textLayoutBlock3.charactersOffset;
                                                                int i21 = (i18 + i19) - i20;
                                                                int i22 = (realSpanStartAndEnd[1] + i19) - i20;
                                                                obtainNewPath3.setCurrentLayout(textLayoutBlock3.textLayout, i21, i14);
                                                                textLayoutBlock3.textLayout.getSelectionPath(i21, i22, obtainNewPath3);
                                                                if (i21 > textLayoutBlock3.charactersOffset) {
                                                                    break;
                                                                }
                                                            }
                                                        }
                                                    } catch (Exception e) {
                                                        FileLog.e(e);
                                                    }
                                                    this.links.addLink(this.pressedLink, 1);
                                                }
                                            }
                                            invalidate();
                                            return true;
                                        } else if ((characterStyleArr3[0] instanceof AnimatedEmojiSpan) && (animatedEmojiSpan = this.pressedEmoji) == characterStyleArr3[0]) {
                                            if (this.delegate.didPressAnimatedEmoji(animatedEmojiSpan)) {
                                                resetPressedLink(1);
                                                this.pressedEmoji = null;
                                                return true;
                                            }
                                            resetPressedLink(1);
                                            this.pressedEmoji = null;
                                        } else if (characterStyleArr3[0] == this.pressedLink.getSpan()) {
                                            this.delegate.didPressUrl(this, this.pressedLink.getSpan(), false);
                                            resetPressedLink(1);
                                            return true;
                                        }
                                    }
                                }
                                z2 = true;
                                if (!z2) {
                                    if (motionEvent.getAction() != 0) {
                                    }
                                }
                            }
                            characterStyleArr3 = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, URLSpanMono.class);
                            z = true;
                            if (characterStyleArr3 != null) {
                            }
                            characterStyleArr3 = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, AnimatedEmojiSpan.class);
                            z = false;
                            if (characterStyleArr3.length != 0) {
                                z2 = false;
                                if (!z2) {
                                }
                            }
                            z2 = true;
                            if (!z2) {
                            }
                        }
                    } catch (Exception e2) {
                        FileLog.e(e2);
                    }
                }
            }
            resetPressedLink(1);
        }
        return false;
    }

    /* JADX WARN: Removed duplicated region for block: B:63:0x00c5 A[Catch: Exception -> 0x0142, TryCatch #1 {Exception -> 0x0142, blocks: (B:39:0x0055, B:41:0x0074, B:43:0x007f, B:45:0x008d, B:48:0x009a, B:50:0x00a6, B:52:0x00a9, B:54:0x00af, B:59:0x00b9, B:61:0x00bf, B:63:0x00c5, B:64:0x013e, B:67:0x00d1, B:69:0x00d5, B:71:0x00dd, B:74:0x0104, B:77:0x0133, B:80:0x0130, B:83:0x009d, B:84:0x0090, B:76:0x010d), top: B:38:0x0055, inners: #0 }] */
    /* JADX WARN: Removed duplicated region for block: B:67:0x00d1 A[Catch: Exception -> 0x0142, TryCatch #1 {Exception -> 0x0142, blocks: (B:39:0x0055, B:41:0x0074, B:43:0x007f, B:45:0x008d, B:48:0x009a, B:50:0x00a6, B:52:0x00a9, B:54:0x00af, B:59:0x00b9, B:61:0x00bf, B:63:0x00c5, B:64:0x013e, B:67:0x00d1, B:69:0x00d5, B:71:0x00dd, B:74:0x0104, B:77:0x0133, B:80:0x0130, B:83:0x009d, B:84:0x0090, B:76:0x010d), top: B:38:0x0055, inners: #0 }] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkCaptionMotionEvent(MotionEvent motionEvent) {
        boolean z;
        if ((this.currentCaption instanceof Spannable) && this.captionLayout != null && (motionEvent.getAction() == 0 || ((this.linkPreviewPressed || this.pressedLink != null || this.pressedEmoji != null) && motionEvent.getAction() == 1))) {
            int y = (int) motionEvent.getY();
            float x = (int) motionEvent.getX();
            float f = this.captionX;
            if (x >= f && x <= f + this.captionWidth) {
                float f2 = y;
                float f3 = this.captionY;
                if (f2 >= f3 && f2 <= f3 + this.captionHeight) {
                    if (motionEvent.getAction() == 0) {
                        try {
                            int i = (int) (x - this.captionX);
                            int i2 = (int) (f2 - this.captionY);
                            int lineForVertical = this.captionLayout.getLineForVertical(i2);
                            float f4 = i;
                            int offsetForHorizontal = this.captionLayout.getOffsetForHorizontal(lineForVertical, f4);
                            float lineLeft = this.captionLayout.getLineLeft(lineForVertical);
                            if (lineLeft <= f4 && lineLeft + this.captionLayout.getLineWidth(lineForVertical) >= f4) {
                                Spannable spannable = (Spannable) this.currentCaption;
                                CharacterStyle[] characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                                if (characterStyleArr == null || characterStyleArr.length == 0) {
                                    characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, URLSpanMono.class);
                                }
                                if (characterStyleArr == null || characterStyleArr.length == 0) {
                                    characterStyleArr = (CharacterStyle[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, AnimatedEmojiSpan.class);
                                }
                                if (characterStyleArr.length != 0 && (!(characterStyleArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled)) {
                                    z = false;
                                    if (!z && !AndroidUtilities.isAccessibilityScreenReaderEnabled()) {
                                        if (!(characterStyleArr[0] instanceof AnimatedEmojiSpan)) {
                                            resetPressedLink(3);
                                            this.pressedLinkType = 3;
                                            this.pressedEmoji = (AnimatedEmojiSpan) characterStyleArr[0];
                                        } else {
                                            LinkSpanDrawable linkSpanDrawable = this.pressedLink;
                                            if (linkSpanDrawable == null || linkSpanDrawable.getSpan() != characterStyleArr[0]) {
                                                this.links.removeLink(this.pressedLink);
                                                LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(characterStyleArr[0], this.resourcesProvider, f4, i2, spanSupportsLongPress(characterStyleArr[0]));
                                                this.pressedLink = linkSpanDrawable2;
                                                linkSpanDrawable2.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outLinkSelectBackground" : "chat_linkSelectBackground"));
                                                this.pressedLinkType = 3;
                                                try {
                                                    LinkPath obtainNewPath = this.pressedLink.obtainNewPath();
                                                    int[] realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                                    obtainNewPath.setCurrentLayout(this.captionLayout, realSpanStartAndEnd[0], 0.0f);
                                                    this.captionLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], obtainNewPath);
                                                } catch (Exception e) {
                                                    FileLog.e(e);
                                                }
                                                this.links.addLink(this.pressedLink, 3);
                                            }
                                        }
                                        invalidateWithParent();
                                        return true;
                                    }
                                }
                                z = true;
                                if (!z) {
                                    if (!(characterStyleArr[0] instanceof AnimatedEmojiSpan)) {
                                    }
                                    invalidateWithParent();
                                    return true;
                                }
                            }
                        } catch (Exception e2) {
                            FileLog.e(e2);
                        }
                    } else if (this.pressedLinkType == 3) {
                        AnimatedEmojiSpan animatedEmojiSpan = this.pressedEmoji;
                        if (animatedEmojiSpan != null) {
                            if (this.delegate.didPressAnimatedEmoji(animatedEmojiSpan)) {
                                resetPressedLink(3);
                                this.pressedEmoji = null;
                                return true;
                            }
                            resetPressedLink(3);
                            this.pressedEmoji = null;
                            return false;
                        }
                        this.delegate.didPressUrl(this, this.pressedLink.getSpan(), false);
                        resetPressedLink(3);
                        return true;
                    }
                }
            }
            resetPressedLink(3);
        }
        return false;
    }

    /* JADX WARN: Removed duplicated region for block: B:60:0x00ec  */
    /* JADX WARN: Removed duplicated region for block: B:68:0x00ef  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkGameMotionEvent(MotionEvent motionEvent) {
        boolean z;
        LinkSpanDrawable linkSpanDrawable;
        int i;
        int i2;
        if (!this.hasGamePreview) {
            return false;
        }
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        if (motionEvent.getAction() == 0) {
            if (this.drawPhotoImage && this.drawImageButton && this.buttonState != -1 && x >= (i = this.buttonX) && x <= i + AndroidUtilities.dp(48.0f) && y >= (i2 = this.buttonY) && y <= i2 + AndroidUtilities.dp(48.0f) && this.radialProgress.getIcon() != 4) {
                this.buttonPressed = 1;
                invalidate();
                return true;
            } else if (this.drawPhotoImage && this.photoImage.isInsideImage(x, y)) {
                this.gamePreviewPressed = true;
                return true;
            } else if (this.descriptionLayout != null && y >= this.descriptionY) {
                try {
                    int dp = x - ((this.unmovedTextX + AndroidUtilities.dp(10.0f)) + this.descriptionX);
                    int i3 = y - this.descriptionY;
                    int lineForVertical = this.descriptionLayout.getLineForVertical(i3);
                    float f = dp;
                    int offsetForHorizontal = this.descriptionLayout.getOffsetForHorizontal(lineForVertical, f);
                    float lineLeft = this.descriptionLayout.getLineLeft(lineForVertical);
                    if (lineLeft <= f && lineLeft + this.descriptionLayout.getLineWidth(lineForVertical) >= f) {
                        Spannable spannable = (Spannable) this.currentMessageObject.linkDescription;
                        ClickableSpan[] clickableSpanArr = (ClickableSpan[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                        if (clickableSpanArr.length != 0 && (!(clickableSpanArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled)) {
                            z = false;
                            if (!z && !AndroidUtilities.isAccessibilityScreenReaderEnabled()) {
                                linkSpanDrawable = this.pressedLink;
                                if (linkSpanDrawable != null || linkSpanDrawable.getSpan() != clickableSpanArr[0]) {
                                    this.links.removeLink(this.pressedLink);
                                    LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(clickableSpanArr[0], this.resourcesProvider, f, i3, spanSupportsLongPress(clickableSpanArr[0]));
                                    this.pressedLink = linkSpanDrawable2;
                                    linkSpanDrawable2.setColor(getThemedColor(!this.currentMessageObject.isOutOwner() ? "chat_outLinkSelectBackground" : "chat_linkSelectBackground"));
                                    this.linkBlockNum = -10;
                                    this.pressedLinkType = 2;
                                    try {
                                        LinkPath obtainNewPath = this.pressedLink.obtainNewPath();
                                        int[] realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                        obtainNewPath.setCurrentLayout(this.descriptionLayout, realSpanStartAndEnd[0], 0.0f);
                                        this.descriptionLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], obtainNewPath);
                                    } catch (Exception e) {
                                        FileLog.e(e);
                                    }
                                    this.links.addLink(this.pressedLink, 2);
                                }
                                invalidate();
                                return true;
                            }
                        }
                        z = true;
                        if (!z) {
                            linkSpanDrawable = this.pressedLink;
                            if (linkSpanDrawable != null) {
                            }
                            this.links.removeLink(this.pressedLink);
                            LinkSpanDrawable linkSpanDrawable22 = new LinkSpanDrawable(clickableSpanArr[0], this.resourcesProvider, f, i3, spanSupportsLongPress(clickableSpanArr[0]));
                            this.pressedLink = linkSpanDrawable22;
                            linkSpanDrawable22.setColor(getThemedColor(!this.currentMessageObject.isOutOwner() ? "chat_outLinkSelectBackground" : "chat_linkSelectBackground"));
                            this.linkBlockNum = -10;
                            this.pressedLinkType = 2;
                            LinkPath obtainNewPath2 = this.pressedLink.obtainNewPath();
                            int[] realSpanStartAndEnd2 = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                            obtainNewPath2.setCurrentLayout(this.descriptionLayout, realSpanStartAndEnd2[0], 0.0f);
                            this.descriptionLayout.getSelectionPath(realSpanStartAndEnd2[0], realSpanStartAndEnd2[1], obtainNewPath2);
                            this.links.addLink(this.pressedLink, 2);
                            invalidate();
                            return true;
                        }
                    }
                } catch (Exception e2) {
                    FileLog.e(e2);
                }
            }
        } else if (motionEvent.getAction() == 1) {
            if (this.pressedLinkType == 2 || this.gamePreviewPressed || this.buttonPressed != 0) {
                if (this.buttonPressed != 0) {
                    this.buttonPressed = 0;
                    playSoundEffect(0);
                    didPressButton(true, false);
                    invalidate();
                } else {
                    LinkSpanDrawable linkSpanDrawable3 = this.pressedLink;
                    if (linkSpanDrawable3 != null) {
                        if (linkSpanDrawable3.getSpan() instanceof URLSpan) {
                            Browser.openUrl(getContext(), ((URLSpan) this.pressedLink.getSpan()).getURL());
                        } else if (this.pressedLink.getSpan() instanceof ClickableSpan) {
                            ((ClickableSpan) this.pressedLink.getSpan()).onClick(this);
                        }
                        resetPressedLink(2);
                    } else {
                        this.gamePreviewPressed = false;
                        int i4 = 0;
                        while (true) {
                            if (i4 >= this.botButtons.size()) {
                                break;
                            }
                            BotButton botButton = this.botButtons.get(i4);
                            if (botButton.button instanceof TLRPC$TL_keyboardButtonGame) {
                                playSoundEffect(0);
                                this.delegate.didPressBotButton(this, botButton.button);
                                invalidate();
                                break;
                            }
                            i4++;
                        }
                        resetPressedLink(2);
                        return true;
                    }
                }
            } else {
                resetPressedLink(2);
            }
        }
        return false;
    }

    private boolean checkTranscribeButtonMotionEvent(MotionEvent motionEvent) {
        TranscribeButton transcribeButton;
        return this.useTranscribeButton && (transcribeButton = this.transcribeButton) != null && transcribeButton.onTouch(motionEvent.getAction(), motionEvent.getX() - this.transcribeX, motionEvent.getY() - this.transcribeY);
    }

    /* JADX WARN: Removed duplicated region for block: B:50:0x00e9  */
    /* JADX WARN: Removed duplicated region for block: B:58:0x00ec  */
    /* JADX WARN: Removed duplicated region for block: B:76:0x0164  */
    /* JADX WARN: Removed duplicated region for block: B:78:0x016a  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkLinkPreviewMotionEvent(MotionEvent motionEvent) {
        boolean z;
        int i;
        int i2;
        int i3;
        int i4;
        boolean z2;
        LinkSpanDrawable linkSpanDrawable;
        if (this.currentMessageObject.type == 0 && this.hasLinkPreview) {
            int x = (int) motionEvent.getX();
            int y = (int) motionEvent.getY();
            int i5 = this.unmovedTextX;
            if (x >= i5 && x <= i5 + this.backgroundWidth) {
                int i6 = this.textY;
                int i7 = this.currentMessageObject.textHeight;
                if (y >= i6 + i7) {
                    if (y <= i6 + i7 + this.linkPreviewHeight + AndroidUtilities.dp((this.drawInstantView ? 46 : 0) + 8)) {
                        if (motionEvent.getAction() == 0) {
                            if (this.descriptionLayout != null && y >= this.descriptionY) {
                                try {
                                    int dp = x - ((this.unmovedTextX + AndroidUtilities.dp(10.0f)) + this.descriptionX);
                                    int i8 = y - this.descriptionY;
                                    if (i8 <= this.descriptionLayout.getHeight()) {
                                        int lineForVertical = this.descriptionLayout.getLineForVertical(i8);
                                        float f = dp;
                                        int offsetForHorizontal = this.descriptionLayout.getOffsetForHorizontal(lineForVertical, f);
                                        float lineLeft = this.descriptionLayout.getLineLeft(lineForVertical);
                                        if (lineLeft <= f && lineLeft + this.descriptionLayout.getLineWidth(lineForVertical) >= f) {
                                            Spannable spannable = (Spannable) this.currentMessageObject.linkDescription;
                                            ClickableSpan[] clickableSpanArr = (ClickableSpan[]) spannable.getSpans(offsetForHorizontal, offsetForHorizontal, ClickableSpan.class);
                                            if (clickableSpanArr.length != 0 && (!(clickableSpanArr[0] instanceof URLSpanBotCommand) || URLSpanBotCommand.enabled)) {
                                                z2 = false;
                                                if (!z2 && !AndroidUtilities.isAccessibilityScreenReaderEnabled()) {
                                                    linkSpanDrawable = this.pressedLink;
                                                    if (linkSpanDrawable != null || linkSpanDrawable.getSpan() != clickableSpanArr[0]) {
                                                        this.links.removeLink(this.pressedLink);
                                                        LinkSpanDrawable linkSpanDrawable2 = new LinkSpanDrawable(clickableSpanArr[0], this.resourcesProvider, x, y, spanSupportsLongPress(clickableSpanArr[0]));
                                                        this.pressedLink = linkSpanDrawable2;
                                                        linkSpanDrawable2.setColor(getThemedColor(!this.currentMessageObject.isOutOwner() ? "chat_outLinkSelectBackground" : "chat_linkSelectBackground"));
                                                        this.linkBlockNum = -10;
                                                        this.pressedLinkType = 2;
                                                        startCheckLongPress();
                                                        try {
                                                            LinkPath obtainNewPath = this.pressedLink.obtainNewPath();
                                                            int[] realSpanStartAndEnd = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                                            obtainNewPath.setCurrentLayout(this.descriptionLayout, realSpanStartAndEnd[0], 0.0f);
                                                            this.descriptionLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], obtainNewPath);
                                                        } catch (Exception e) {
                                                            FileLog.e(e);
                                                        }
                                                        this.links.addLink(this.pressedLink, 2);
                                                    }
                                                    invalidate();
                                                    return true;
                                                }
                                            }
                                            z2 = true;
                                            if (!z2) {
                                                linkSpanDrawable = this.pressedLink;
                                                if (linkSpanDrawable != null) {
                                                }
                                                this.links.removeLink(this.pressedLink);
                                                LinkSpanDrawable linkSpanDrawable22 = new LinkSpanDrawable(clickableSpanArr[0], this.resourcesProvider, x, y, spanSupportsLongPress(clickableSpanArr[0]));
                                                this.pressedLink = linkSpanDrawable22;
                                                linkSpanDrawable22.setColor(getThemedColor(!this.currentMessageObject.isOutOwner() ? "chat_outLinkSelectBackground" : "chat_linkSelectBackground"));
                                                this.linkBlockNum = -10;
                                                this.pressedLinkType = 2;
                                                startCheckLongPress();
                                                LinkPath obtainNewPath2 = this.pressedLink.obtainNewPath();
                                                int[] realSpanStartAndEnd2 = getRealSpanStartAndEnd(spannable, this.pressedLink.getSpan());
                                                obtainNewPath2.setCurrentLayout(this.descriptionLayout, realSpanStartAndEnd2[0], 0.0f);
                                                this.descriptionLayout.getSelectionPath(realSpanStartAndEnd2[0], realSpanStartAndEnd2[1], obtainNewPath2);
                                                this.links.addLink(this.pressedLink, 2);
                                                invalidate();
                                                return true;
                                            }
                                        }
                                    }
                                } catch (Exception e2) {
                                    FileLog.e(e2);
                                }
                            }
                            if (this.pressedLink == null) {
                                int dp2 = AndroidUtilities.dp(48.0f);
                                if (this.miniButtonState >= 0) {
                                    int dp3 = AndroidUtilities.dp(27.0f);
                                    int i9 = this.buttonX;
                                    if (x >= i9 + dp3 && x <= i9 + dp3 + dp2) {
                                        int i10 = this.buttonY;
                                        if (y >= i10 + dp3 && y <= i10 + dp3 + dp2) {
                                            z = true;
                                            if (!z) {
                                                this.miniButtonPressed = 1;
                                                invalidate();
                                                return true;
                                            } else if (this.drawVideoImageButton && this.buttonState != -1 && x >= (i3 = this.videoButtonX) && x <= i3 + AndroidUtilities.dp(34.0f) + Math.max(this.infoWidth, this.docTitleWidth) && y >= (i4 = this.videoButtonY) && y <= i4 + AndroidUtilities.dp(30.0f)) {
                                                this.videoButtonPressed = 1;
                                                invalidate();
                                                return true;
                                            } else if (this.drawPhotoImage && this.drawImageButton && this.buttonState != -1 && ((!this.checkOnlyButtonPressed && this.photoImage.isInsideImage(x, y)) || (x >= (i = this.buttonX) && x <= i + AndroidUtilities.dp(48.0f) && y >= (i2 = this.buttonY) && y <= i2 + AndroidUtilities.dp(48.0f) && this.radialProgress.getIcon() != 4))) {
                                                this.buttonPressed = 1;
                                                invalidate();
                                                return true;
                                            } else if (this.drawInstantView) {
                                                this.instantPressed = true;
                                                this.selectorDrawableMaskType[0] = 0;
                                                if (Build.VERSION.SDK_INT >= 21) {
                                                    Drawable[] drawableArr = this.selectorDrawable;
                                                    if (drawableArr[0] != null && drawableArr[0].getBounds().contains(x, y)) {
                                                        this.selectorDrawable[0].setHotspot(x, y);
                                                        this.selectorDrawable[0].setState(this.pressedState);
                                                        this.instantButtonPressed = true;
                                                    }
                                                }
                                                invalidate();
                                                return true;
                                            } else if (this.documentAttachType != 1 && this.drawPhotoImage && this.photoImage.isInsideImage(x, y)) {
                                                this.linkPreviewPressed = true;
                                                TLRPC$WebPage tLRPC$WebPage = MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage;
                                                if (this.documentAttachType != 2 || this.buttonState != -1 || !SharedConfig.autoplayGifs || (this.photoImage.getAnimation() != null && TextUtils.isEmpty(tLRPC$WebPage.embed_url))) {
                                                    return true;
                                                }
                                                this.linkPreviewPressed = false;
                                                return false;
                                            }
                                        }
                                    }
                                }
                                z = false;
                                if (!z) {
                                }
                            }
                        } else if (motionEvent.getAction() == 1) {
                            if (this.instantPressed) {
                                ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                                if (chatMessageCellDelegate != null) {
                                    chatMessageCellDelegate.didPressInstantButton(this, this.drawInstantViewType);
                                }
                                playSoundEffect(0);
                                if (Build.VERSION.SDK_INT >= 21) {
                                    Drawable[] drawableArr2 = this.selectorDrawable;
                                    if (drawableArr2[0] != null) {
                                        drawableArr2[0].setState(StateSet.NOTHING);
                                    }
                                }
                                this.instantButtonPressed = false;
                                this.instantPressed = false;
                                invalidate();
                            } else if (this.pressedLinkType == 2 || this.buttonPressed != 0 || this.miniButtonPressed != 0 || this.videoButtonPressed != 0 || this.linkPreviewPressed) {
                                if (this.videoButtonPressed == 1) {
                                    this.videoButtonPressed = 0;
                                    playSoundEffect(0);
                                    didPressButton(true, true);
                                    invalidate();
                                } else if (this.buttonPressed != 0) {
                                    this.buttonPressed = 0;
                                    playSoundEffect(0);
                                    if (this.drawVideoImageButton) {
                                        didClickedImage();
                                    } else {
                                        didPressButton(true, false);
                                    }
                                    invalidate();
                                } else if (this.miniButtonPressed != 0) {
                                    this.miniButtonPressed = 0;
                                    playSoundEffect(0);
                                    didPressMiniButton(true);
                                    invalidate();
                                } else {
                                    LinkSpanDrawable linkSpanDrawable3 = this.pressedLink;
                                    if (linkSpanDrawable3 != null) {
                                        if (linkSpanDrawable3.getSpan() instanceof URLSpan) {
                                            this.delegate.didPressUrl(this, this.pressedLink.getSpan(), false);
                                        } else if (this.pressedLink.getSpan() instanceof ClickableSpan) {
                                            ((ClickableSpan) this.pressedLink.getSpan()).onClick(this);
                                        }
                                        resetPressedLink(2);
                                    } else {
                                        AnimatedEmojiSpan animatedEmojiSpan = this.pressedEmoji;
                                        if (animatedEmojiSpan != null && this.delegate.didPressAnimatedEmoji(animatedEmojiSpan)) {
                                            this.pressedEmoji = null;
                                            resetPressedLink(2);
                                        } else {
                                            int i11 = this.documentAttachType;
                                            if (i11 == 7) {
                                                if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || MediaController.getInstance().isMessagePaused()) {
                                                    this.delegate.needPlayMessage(this.currentMessageObject);
                                                } else {
                                                    MediaController.getInstance().lambda$startAudioAgain$7(this.currentMessageObject);
                                                }
                                            } else if (i11 == 2 && this.drawImageButton) {
                                                int i12 = this.buttonState;
                                                if (i12 == -1) {
                                                    if (SharedConfig.autoplayGifs) {
                                                        this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY);
                                                    } else {
                                                        this.buttonState = 2;
                                                        this.currentMessageObject.gifState = 1.0f;
                                                        this.photoImage.setAllowStartAnimation(false);
                                                        this.photoImage.stopAnimation();
                                                        this.radialProgress.setIcon(getIconForCurrentState(), false, true);
                                                        invalidate();
                                                        playSoundEffect(0);
                                                    }
                                                } else if (i12 == 2 || i12 == 0) {
                                                    didPressButton(true, false);
                                                    playSoundEffect(0);
                                                }
                                            } else {
                                                TLRPC$WebPage tLRPC$WebPage2 = MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage;
                                                if (tLRPC$WebPage2 != null && !TextUtils.isEmpty(tLRPC$WebPage2.embed_url)) {
                                                    this.delegate.needOpenWebView(this.currentMessageObject, tLRPC$WebPage2.embed_url, tLRPC$WebPage2.site_name, tLRPC$WebPage2.title, tLRPC$WebPage2.url, tLRPC$WebPage2.embed_width, tLRPC$WebPage2.embed_height);
                                                } else {
                                                    int i13 = this.buttonState;
                                                    if (i13 == -1 || i13 == 3) {
                                                        this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY);
                                                        playSoundEffect(0);
                                                    } else if (tLRPC$WebPage2 != null) {
                                                        Browser.openUrl(getContext(), tLRPC$WebPage2.url);
                                                    }
                                                }
                                            }
                                            resetPressedLink(2);
                                            return true;
                                        }
                                    }
                                }
                            } else if (!this.hadLongPress) {
                                this.hadLongPress = false;
                                resetPressedLink(2);
                            }
                        } else if (motionEvent.getAction() == 2 && this.instantButtonPressed && Build.VERSION.SDK_INT >= 21) {
                            Drawable[] drawableArr3 = this.selectorDrawable;
                            if (drawableArr3[0] != null) {
                                drawableArr3[0].setHotspot(x, y);
                            }
                        }
                    }
                }
            }
        }
        return false;
    }

    private boolean checkPollButtonMotionEvent(MotionEvent motionEvent) {
        int i;
        int i2;
        if (this.currentMessageObject.eventId != 0 || this.pollVoteInProgress || this.pollUnvoteInProgress || this.pollButtons.isEmpty()) {
            return false;
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.type != 17 || !messageObject.isSent()) {
            return false;
        }
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        if (motionEvent.getAction() == 0) {
            this.pressedVoteButton = -1;
            this.pollHintPressed = false;
            if (this.hintButtonVisible && (i = this.pollHintX) != -1 && x >= i && x <= i + AndroidUtilities.dp(40.0f) && y >= (i2 = this.pollHintY) && y <= i2 + AndroidUtilities.dp(40.0f)) {
                this.pollHintPressed = true;
                this.selectorDrawableMaskType[0] = 3;
                if (Build.VERSION.SDK_INT >= 21) {
                    Drawable[] drawableArr = this.selectorDrawable;
                    if (drawableArr[0] != null) {
                        drawableArr[0].setBounds(this.pollHintX - AndroidUtilities.dp(8.0f), this.pollHintY - AndroidUtilities.dp(8.0f), this.pollHintX + AndroidUtilities.dp(32.0f), this.pollHintY + AndroidUtilities.dp(32.0f));
                        this.selectorDrawable[0].setHotspot(x, y);
                        this.selectorDrawable[0].setState(this.pressedState);
                    }
                }
                invalidate();
            } else {
                for (int i3 = 0; i3 < this.pollButtons.size(); i3++) {
                    PollButton pollButton = this.pollButtons.get(i3);
                    int dp = (pollButton.y + this.namesOffset) - AndroidUtilities.dp(13.0f);
                    int i4 = pollButton.x;
                    if (x >= i4 && x <= (i4 + this.backgroundWidth) - AndroidUtilities.dp(31.0f) && y >= dp && y <= pollButton.height + dp + AndroidUtilities.dp(26.0f)) {
                        this.pressedVoteButton = i3;
                        if (!this.pollVoted && !this.pollClosed) {
                            this.selectorDrawableMaskType[0] = 1;
                            if (Build.VERSION.SDK_INT >= 21) {
                                Drawable[] drawableArr2 = this.selectorDrawable;
                                if (drawableArr2[0] != null) {
                                    drawableArr2[0].setBounds(pollButton.x - AndroidUtilities.dp(9.0f), dp, (pollButton.x + this.backgroundWidth) - AndroidUtilities.dp(22.0f), pollButton.height + dp + AndroidUtilities.dp(26.0f));
                                    this.selectorDrawable[0].setHotspot(x, y);
                                    this.selectorDrawable[0].setState(this.pressedState);
                                }
                            }
                            invalidate();
                        }
                    }
                }
                return false;
            }
            return true;
        } else if (motionEvent.getAction() == 1) {
            if (this.pollHintPressed) {
                playSoundEffect(0);
                this.delegate.didPressHint(this, 0);
                this.pollHintPressed = false;
                if (Build.VERSION.SDK_INT < 21) {
                    return false;
                }
                Drawable[] drawableArr3 = this.selectorDrawable;
                if (drawableArr3[0] == null) {
                    return false;
                }
                drawableArr3[0].setState(StateSet.NOTHING);
                return false;
            } else if (this.pressedVoteButton == -1) {
                return false;
            } else {
                playSoundEffect(0);
                if (Build.VERSION.SDK_INT >= 21) {
                    Drawable[] drawableArr4 = this.selectorDrawable;
                    if (drawableArr4[0] != null) {
                        drawableArr4[0].setState(StateSet.NOTHING);
                    }
                }
                if (this.currentMessageObject.scheduled) {
                    Toast.makeText(getContext(), LocaleController.getString("MessageScheduledVote", R.string.MessageScheduledVote), 1).show();
                } else {
                    PollButton pollButton2 = this.pollButtons.get(this.pressedVoteButton);
                    TLRPC$TL_pollAnswer tLRPC$TL_pollAnswer = pollButton2.answer;
                    if (this.pollVoted || this.pollClosed) {
                        ArrayList<TLRPC$TL_pollAnswer> arrayList = new ArrayList<>();
                        arrayList.add(tLRPC$TL_pollAnswer);
                        this.delegate.didPressVoteButtons(this, arrayList, pollButton2.count, pollButton2.x + AndroidUtilities.dp(50.0f), this.namesOffset + pollButton2.y);
                    } else if (this.lastPoll.multiple_choice) {
                        if (this.currentMessageObject.checkedVotes.contains(tLRPC$TL_pollAnswer)) {
                            this.currentMessageObject.checkedVotes.remove(tLRPC$TL_pollAnswer);
                            this.pollCheckBox[this.pressedVoteButton].setChecked(false, true);
                        } else {
                            this.currentMessageObject.checkedVotes.add(tLRPC$TL_pollAnswer);
                            this.pollCheckBox[this.pressedVoteButton].setChecked(true, true);
                        }
                    } else {
                        this.pollVoteInProgressNum = this.pressedVoteButton;
                        this.pollVoteInProgress = true;
                        this.vibrateOnPollVote = true;
                        this.voteCurrentProgressTime = 0.0f;
                        this.firstCircleLength = true;
                        this.voteCurrentCircleLength = 360.0f;
                        this.voteRisingCircleLength = false;
                        ArrayList<TLRPC$TL_pollAnswer> arrayList2 = new ArrayList<>();
                        arrayList2.add(tLRPC$TL_pollAnswer);
                        this.delegate.didPressVoteButtons(this, arrayList2, -1, 0, 0);
                    }
                }
                this.pressedVoteButton = -1;
                invalidate();
                return false;
            }
        } else if (motionEvent.getAction() != 2) {
            return false;
        } else {
            if ((this.pressedVoteButton == -1 && !this.pollHintPressed) || Build.VERSION.SDK_INT < 21) {
                return false;
            }
            Drawable[] drawableArr5 = this.selectorDrawable;
            if (drawableArr5[0] == null) {
                return false;
            }
            drawableArr5[0].setHotspot(x, y);
            return false;
        }
    }

    private boolean checkInstantButtonMotionEvent(MotionEvent motionEvent) {
        if (this.currentMessageObject.isSponsored() || (this.drawInstantView && this.currentMessageObject.type != 0)) {
            int x = (int) motionEvent.getX();
            int y = (int) motionEvent.getY();
            int i = 2;
            if (motionEvent.getAction() == 0) {
                if (this.drawInstantView) {
                    float f = x;
                    float f2 = y;
                    if (this.instantButtonRect.contains(f, f2)) {
                        int[] iArr = this.selectorDrawableMaskType;
                        if (this.lastPoll == null) {
                            i = 0;
                        }
                        iArr[0] = i;
                        this.instantPressed = true;
                        if (Build.VERSION.SDK_INT >= 21 && this.selectorDrawable[0] != null && this.instantButtonRect.contains(f, f2)) {
                            this.selectorDrawable[0].setHotspot(f, f2);
                            this.selectorDrawable[0].setState(this.pressedState);
                            this.instantButtonPressed = true;
                        }
                        invalidate();
                        return true;
                    }
                }
            } else if (motionEvent.getAction() == 1) {
                if (this.instantPressed) {
                    ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                    if (chatMessageCellDelegate != null) {
                        if (this.lastPoll != null) {
                            MessageObject messageObject = this.currentMessageObject;
                            if (messageObject.scheduled) {
                                Toast.makeText(getContext(), LocaleController.getString("MessageScheduledVoteResults", R.string.MessageScheduledVoteResults), 1).show();
                            } else if (this.pollVoted || this.pollClosed) {
                                chatMessageCellDelegate.didPressInstantButton(this, this.drawInstantViewType);
                            } else {
                                if (!messageObject.checkedVotes.isEmpty()) {
                                    this.pollVoteInProgressNum = -1;
                                    this.pollVoteInProgress = true;
                                    this.vibrateOnPollVote = true;
                                    this.voteCurrentProgressTime = 0.0f;
                                    this.firstCircleLength = true;
                                    this.voteCurrentCircleLength = 360.0f;
                                    this.voteRisingCircleLength = false;
                                }
                                this.delegate.didPressVoteButtons(this, this.currentMessageObject.checkedVotes, -1, 0, this.namesOffset);
                            }
                        } else {
                            chatMessageCellDelegate.didPressInstantButton(this, this.drawInstantViewType);
                        }
                    }
                    playSoundEffect(0);
                    if (Build.VERSION.SDK_INT >= 21) {
                        Drawable[] drawableArr = this.selectorDrawable;
                        if (drawableArr[0] != null) {
                            drawableArr[0].setState(StateSet.NOTHING);
                        }
                    }
                    this.instantButtonPressed = false;
                    this.instantPressed = false;
                    invalidate();
                }
            } else if (motionEvent.getAction() == 2 && this.instantButtonPressed && Build.VERSION.SDK_INT >= 21) {
                Drawable[] drawableArr2 = this.selectorDrawable;
                if (drawableArr2[0] != null) {
                    drawableArr2[0].setHotspot(x, y);
                }
            }
            return false;
        }
        return false;
    }

    private void invalidateWithParent() {
        if (this.currentMessagesGroup != null && getParent() != null) {
            ((ViewGroup) getParent()).invalidate();
        }
        invalidate();
    }

    private boolean checkCommentButtonMotionEvent(MotionEvent motionEvent) {
        int i = 0;
        if (!this.drawCommentButton) {
            return false;
        }
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null && (groupedMessagePosition.flags & 1) == 0 && this.commentButtonRect.contains(x, y)) {
            ViewGroup viewGroup = (ViewGroup) getParent();
            int childCount = viewGroup.getChildCount();
            while (true) {
                if (i >= childCount) {
                    break;
                }
                View childAt = viewGroup.getChildAt(i);
                if (childAt != this && (childAt instanceof ChatMessageCell)) {
                    ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                    if (chatMessageCell.drawCommentButton && chatMessageCell.currentMessagesGroup == this.currentMessagesGroup && (chatMessageCell.currentPosition.flags & 1) != 0) {
                        MotionEvent obtain = MotionEvent.obtain(0L, 0L, motionEvent.getActionMasked(), (motionEvent.getX() + getLeft()) - chatMessageCell.getLeft(), (motionEvent.getY() + getTop()) - chatMessageCell.getTop(), 0);
                        chatMessageCell.checkCommentButtonMotionEvent(obtain);
                        obtain.recycle();
                        break;
                    }
                }
                i++;
            }
            return true;
        }
        if (motionEvent.getAction() == 0) {
            if (this.commentButtonRect.contains(x, y)) {
                if (this.currentMessageObject.isSent()) {
                    this.selectorDrawableMaskType[1] = 2;
                    this.commentButtonPressed = true;
                    if (Build.VERSION.SDK_INT >= 21) {
                        Drawable[] drawableArr = this.selectorDrawable;
                        if (drawableArr[1] != null) {
                            drawableArr[1].setHotspot(x, y);
                            this.selectorDrawable[1].setState(this.pressedState);
                        }
                    }
                    invalidateWithParent();
                }
                return true;
            }
        } else if (motionEvent.getAction() == 1) {
            if (this.commentButtonPressed) {
                ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                if (chatMessageCellDelegate != null) {
                    if (this.isRepliesChat) {
                        chatMessageCellDelegate.didPressSideButton(this);
                    } else {
                        chatMessageCellDelegate.didPressCommentButton(this);
                    }
                }
                playSoundEffect(0);
                if (Build.VERSION.SDK_INT >= 21) {
                    Drawable[] drawableArr2 = this.selectorDrawable;
                    if (drawableArr2[1] != null) {
                        drawableArr2[1].setState(StateSet.NOTHING);
                    }
                }
                this.commentButtonPressed = false;
                invalidateWithParent();
            }
        } else if (motionEvent.getAction() == 2 && this.commentButtonPressed && Build.VERSION.SDK_INT >= 21) {
            Drawable[] drawableArr3 = this.selectorDrawable;
            if (drawableArr3[1] != null) {
                drawableArr3[1].setHotspot(x, y);
            }
        }
        return false;
    }

    /* JADX WARN: Type inference failed for: r11v24, types: [boolean] */
    private boolean checkOtherButtonMotionEvent(MotionEvent motionEvent) {
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        int i = this.documentAttachType;
        if ((i == 5 || i == 1) && (groupedMessagePosition = this.currentPosition) != null && (groupedMessagePosition.flags & 4) == 0) {
            return false;
        }
        int i2 = this.currentMessageObject.type;
        boolean z = i2 == 16;
        if (!z) {
            z = (i == 1 || i2 == 12 || i == 5 || i == 4 || i == 2 || i2 == 8) && !this.hasGamePreview && !this.hasInvoicePreview;
        }
        if (!z) {
            return false;
        }
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        if (motionEvent.getAction() == 0) {
            MessageObject messageObject = this.currentMessageObject;
            if (messageObject.type == 16) {
                ?? isVideoCall = messageObject.isVideoCall();
                int i3 = this.otherX;
                if (x >= i3) {
                    if (x <= i3 + AndroidUtilities.dp((isVideoCall == 0 ? 202 : 200) + 30) && y >= this.otherY - AndroidUtilities.dp(14.0f) && y <= this.otherY + AndroidUtilities.dp(50.0f)) {
                        this.otherPressed = true;
                        this.selectorDrawableMaskType[0] = 4;
                        if (Build.VERSION.SDK_INT >= 21 && this.selectorDrawable[0] != null) {
                            int dp = this.otherX + AndroidUtilities.dp(isVideoCall == 0 ? 202.0f : 200.0f) + (Theme.chat_msgInCallDrawable[isVideoCall == true ? 1 : 0].getIntrinsicWidth() / 2);
                            int intrinsicHeight = this.otherY + (Theme.chat_msgInCallDrawable[isVideoCall].getIntrinsicHeight() / 2);
                            this.selectorDrawable[0].setBounds(dp - AndroidUtilities.dp(20.0f), intrinsicHeight - AndroidUtilities.dp(20.0f), dp + AndroidUtilities.dp(20.0f), intrinsicHeight + AndroidUtilities.dp(20.0f));
                            this.selectorDrawable[0].setHotspot(x, y);
                            this.selectorDrawable[0].setState(this.pressedState);
                        }
                        invalidate();
                        return true;
                    }
                }
            } else if (x >= this.otherX - AndroidUtilities.dp(20.0f) && x <= this.otherX + AndroidUtilities.dp(20.0f) && y >= this.otherY - AndroidUtilities.dp(4.0f) && y <= this.otherY + AndroidUtilities.dp(30.0f)) {
                this.otherPressed = true;
                invalidate();
                return true;
            }
        } else if (motionEvent.getAction() == 1) {
            if (this.otherPressed) {
                if (this.currentMessageObject.type == 16 && Build.VERSION.SDK_INT >= 21) {
                    Drawable[] drawableArr = this.selectorDrawable;
                    if (drawableArr[0] != null) {
                        drawableArr[0].setState(StateSet.NOTHING);
                    }
                }
                this.otherPressed = false;
                playSoundEffect(0);
                this.delegate.didPressOther(this, this.otherX, this.otherY);
                invalidate();
                return true;
            }
        } else if (motionEvent.getAction() == 2 && this.currentMessageObject.type == 16 && this.otherPressed && Build.VERSION.SDK_INT >= 21) {
            Drawable[] drawableArr2 = this.selectorDrawable;
            if (drawableArr2[0] != null) {
                drawableArr2[0].setHotspot(x, y);
            }
        }
        return false;
    }

    private boolean checkDateMotionEvent(MotionEvent motionEvent) {
        if (!this.currentMessageObject.isImportedForward()) {
            return false;
        }
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        if (motionEvent.getAction() == 0) {
            float f = x;
            float f2 = this.drawTimeX;
            if (f < f2 || f > f2 + this.timeWidth) {
                return false;
            }
            float f3 = y;
            float f4 = this.drawTimeY;
            if (f3 < f4 || f3 > f4 + AndroidUtilities.dp(20.0f)) {
                return false;
            }
            this.timePressed = true;
            invalidate();
        } else if (motionEvent.getAction() != 1 || !this.timePressed) {
            return false;
        } else {
            this.timePressed = false;
            playSoundEffect(0);
            this.delegate.didPressTime(this);
            invalidate();
        }
        return true;
    }

    private boolean checkRoundSeekbar(MotionEvent motionEvent) {
        if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || !MediaController.getInstance().isMessagePaused()) {
            return false;
        }
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        if (motionEvent.getAction() == 0) {
            float f = x;
            if (f >= this.seekbarRoundX - AndroidUtilities.dp(20.0f) && f <= this.seekbarRoundX + AndroidUtilities.dp(20.0f)) {
                float f2 = y;
                if (f2 >= this.seekbarRoundY - AndroidUtilities.dp(20.0f) && f2 <= this.seekbarRoundY + AndroidUtilities.dp(20.0f)) {
                    getParent().requestDisallowInterceptTouchEvent(true);
                    cancelCheckLongPress();
                    this.roundSeekbarTouched = 1;
                    invalidate();
                }
            }
            float centerX = f - this.photoImage.getCenterX();
            float centerY = y - this.photoImage.getCenterY();
            float imageWidth = (this.photoImage.getImageWidth() - AndroidUtilities.dp(64.0f)) / 2.0f;
            float f3 = (centerX * centerX) + (centerY * centerY);
            if (f3 < ((this.photoImage.getImageWidth() / 2.0f) * this.photoImage.getImageWidth()) / 2.0f && f3 > imageWidth * imageWidth) {
                getParent().requestDisallowInterceptTouchEvent(true);
                cancelCheckLongPress();
                this.roundSeekbarTouched = 1;
                invalidate();
            }
        } else if (this.roundSeekbarTouched == 1 && motionEvent.getAction() == 2) {
            float degrees = ((float) Math.toDegrees(Math.atan2(y - this.photoImage.getCenterY(), x - this.photoImage.getCenterX()))) + 90.0f;
            if (degrees < 0.0f) {
                degrees += 360.0f;
            }
            float f4 = degrees / 360.0f;
            if (Math.abs(this.currentMessageObject.audioProgress - f4) > 0.9f) {
                if (this.roundSeekbarOutAlpha == 0.0f) {
                    performHapticFeedback(3);
                }
                this.roundSeekbarOutAlpha = 1.0f;
                this.roundSeekbarOutProgress = this.currentMessageObject.audioProgress;
            }
            long currentTimeMillis = System.currentTimeMillis();
            if (currentTimeMillis - this.lastSeekUpdateTime > 100) {
                MediaController.getInstance().seekToProgress(this.currentMessageObject, f4);
                this.lastSeekUpdateTime = currentTimeMillis;
            }
            this.currentMessageObject.audioProgress = f4;
            updatePlayingMessageProgress();
        }
        if ((motionEvent.getAction() == 1 || motionEvent.getAction() == 3) && this.roundSeekbarTouched != 0) {
            if (motionEvent.getAction() == 1) {
                float degrees2 = ((float) Math.toDegrees(Math.atan2(y - this.photoImage.getCenterY(), x - this.photoImage.getCenterX()))) + 90.0f;
                if (degrees2 < 0.0f) {
                    degrees2 += 360.0f;
                }
                float f5 = degrees2 / 360.0f;
                this.currentMessageObject.audioProgress = f5;
                MediaController.getInstance().seekToProgress(this.currentMessageObject, f5);
                updatePlayingMessageProgress();
            }
            MediaController.getInstance().playMessage(this.currentMessageObject);
            this.roundSeekbarTouched = 0;
            getParent().requestDisallowInterceptTouchEvent(false);
        }
        return this.roundSeekbarTouched != 0;
    }

    /* JADX WARN: Removed duplicated region for block: B:105:0x0199  */
    /* JADX WARN: Removed duplicated region for block: B:25:0x0051  */
    /* JADX WARN: Removed duplicated region for block: B:28:0x01c0  */
    /* JADX WARN: Removed duplicated region for block: B:44:0x0058  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkPhotoImageMotionEvent(MotionEvent motionEvent) {
        boolean z;
        MessageObject messageObject;
        int i;
        int i2;
        int i3;
        int i4;
        boolean z2 = true;
        if ((this.drawPhotoImage || this.documentAttachType == 1) && (!this.currentMessageObject.isSending() || this.buttonState == 1)) {
            int x = (int) motionEvent.getX();
            int y = (int) motionEvent.getY();
            if (motionEvent.getAction() == 0) {
                int dp = AndroidUtilities.dp(48.0f);
                if (this.miniButtonState >= 0) {
                    int dp2 = AndroidUtilities.dp(27.0f);
                    int i5 = this.buttonX;
                    if (x >= i5 + dp2 && x <= i5 + dp2 + dp) {
                        int i6 = this.buttonY;
                        if (y >= i6 + dp2 && y <= i6 + dp2 + dp) {
                            z = true;
                            if (!z) {
                                this.miniButtonPressed = 1;
                                invalidate();
                            } else if (this.buttonState != -1 && this.radialProgress.getIcon() != 4 && x >= (i3 = this.buttonX) && x <= i3 + dp && y >= (i4 = this.buttonY) && y <= i4 + dp) {
                                this.buttonPressed = 1;
                                invalidate();
                            } else if (this.drawVideoImageButton && this.buttonState != -1 && x >= (i = this.videoButtonX) && x <= i + AndroidUtilities.dp(34.0f) + Math.max(this.infoWidth, this.docTitleWidth) && y >= (i2 = this.videoButtonY) && y <= i2 + AndroidUtilities.dp(30.0f)) {
                                this.videoButtonPressed = 1;
                                invalidate();
                            } else if (this.documentAttachType == 1) {
                                float f = x;
                                if (f >= this.photoImage.getImageX() && f <= (this.photoImage.getImageX() + this.backgroundWidth) - AndroidUtilities.dp(50.0f)) {
                                    float f2 = y;
                                    if (f2 >= this.photoImage.getImageY() && f2 <= this.photoImage.getImageY() + this.photoImage.getImageHeight()) {
                                        this.imagePressed = true;
                                    }
                                }
                                z2 = false;
                            } else {
                                if (!this.currentMessageObject.isAnyKindOfSticker() || this.currentMessageObject.getInputStickerSet() != null || this.currentMessageObject.isAnimatedEmoji() || this.currentMessageObject.isDice()) {
                                    float f3 = x;
                                    if (f3 >= this.photoImage.getImageX() && f3 <= this.photoImage.getImageX() + this.photoImage.getImageWidth()) {
                                        float f4 = y;
                                        if (f4 >= this.photoImage.getImageY() && f4 <= this.photoImage.getImageY() + this.photoImage.getImageHeight()) {
                                            if (this.isRoundVideo) {
                                                if (((f3 - this.photoImage.getCenterX()) * (f3 - this.photoImage.getCenterX())) + ((f4 - this.photoImage.getCenterY()) * (f4 - this.photoImage.getCenterY())) < (this.photoImage.getImageWidth() / 2.0f) * (this.photoImage.getImageWidth() / 2.0f)) {
                                                    this.imagePressed = true;
                                                }
                                            } else {
                                                this.imagePressed = true;
                                            }
                                            messageObject = this.currentMessageObject;
                                            if (messageObject.type == 12) {
                                                long j = MessageObject.getMedia(messageObject.messageOwner).user_id;
                                                TLRPC$User tLRPC$User = null;
                                                if (j != 0) {
                                                    tLRPC$User = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(j));
                                                }
                                                if (tLRPC$User == null) {
                                                    this.imagePressed = false;
                                                }
                                            }
                                        }
                                    }
                                    z2 = false;
                                    messageObject = this.currentMessageObject;
                                    if (messageObject.type == 12) {
                                    }
                                }
                                z2 = false;
                            }
                            if (this.imagePressed) {
                                if (this.currentMessageObject.isSendError()) {
                                    this.imagePressed = false;
                                    return false;
                                } else if (this.currentMessageObject.type == 8 && this.buttonState == -1 && SharedConfig.autoplayGifs && this.photoImage.getAnimation() == null) {
                                    this.imagePressed = false;
                                    return false;
                                }
                            }
                            return z2;
                        }
                    }
                }
                z = false;
                if (!z) {
                }
                if (this.imagePressed) {
                }
                return z2;
            } else if (motionEvent.getAction() != 1) {
                return false;
            } else {
                if (this.videoButtonPressed == 1) {
                    this.videoButtonPressed = 0;
                    playSoundEffect(0);
                    didPressButton(true, true);
                    invalidate();
                    return false;
                } else if (this.buttonPressed == 1) {
                    this.buttonPressed = 0;
                    playSoundEffect(0);
                    if (this.drawVideoImageButton) {
                        didClickedImage();
                    } else {
                        didPressButton(true, false);
                    }
                    invalidate();
                    return false;
                } else if (this.miniButtonPressed == 1) {
                    this.miniButtonPressed = 0;
                    playSoundEffect(0);
                    didPressMiniButton(true);
                    invalidate();
                    return false;
                } else if (!this.imagePressed) {
                    return false;
                } else {
                    this.imagePressed = false;
                    int i7 = this.buttonState;
                    if (i7 == -1 || i7 == 2 || i7 == 3 || this.drawVideoImageButton) {
                        playSoundEffect(0);
                        didClickedImage();
                    } else if (i7 == 0) {
                        playSoundEffect(0);
                        didPressButton(true, false);
                    }
                    invalidate();
                    return false;
                }
            }
        }
        return false;
    }

    /* JADX WARN: Code restructure failed: missing block: B:111:0x0114, code lost:
        if (r3 <= (r0 + r6)) goto L54;
     */
    /* JADX WARN: Code restructure failed: missing block: B:53:0x00da, code lost:
        if (r3 <= (r0 + r6)) goto L54;
     */
    /* JADX WARN: Code restructure failed: missing block: B:54:0x00dc, code lost:
        r0 = true;
     */
    /* JADX WARN: Removed duplicated region for block: B:42:0x00c5  */
    /* JADX WARN: Removed duplicated region for block: B:57:0x011e  */
    /* JADX WARN: Removed duplicated region for block: B:65:0x012e  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean checkAudioMotionEvent(MotionEvent motionEvent) {
        boolean onTouch;
        boolean z;
        boolean z2;
        int i;
        int i2 = this.documentAttachType;
        if ((i2 == 3 || i2 == 5) && !AndroidUtilities.isAccessibilityScreenReaderEnabled()) {
            int x = (int) motionEvent.getX();
            int y = (int) motionEvent.getY();
            if (this.useSeekBarWaveform) {
                onTouch = this.seekBarWaveform.onTouch(motionEvent.getAction(), (motionEvent.getX() - this.seekBarX) - AndroidUtilities.dp(13.0f), motionEvent.getY() - this.seekBarY);
            } else {
                onTouch = MediaController.getInstance().isPlayingMessage(this.currentMessageObject) ? this.seekBar.onTouch(motionEvent.getAction(), motionEvent.getX() - this.seekBarX, motionEvent.getY() - this.seekBarY) : false;
            }
            if (onTouch) {
                if (!this.useSeekBarWaveform && motionEvent.getAction() == 0) {
                    getParent().requestDisallowInterceptTouchEvent(true);
                } else if (this.useSeekBarWaveform && !this.seekBarWaveform.isStartDraging() && motionEvent.getAction() == 1) {
                    didPressButton(true, false);
                }
                this.disallowLongPress = true;
                invalidate();
                return onTouch;
            }
            int dp = AndroidUtilities.dp(36.0f);
            if (this.miniButtonState >= 0) {
                int dp2 = AndroidUtilities.dp(27.0f);
                int i3 = this.buttonX;
                if (x >= i3 + dp2 && x <= i3 + dp2 + dp) {
                    int i4 = this.buttonY;
                    if (y >= i4 + dp2 && y <= i4 + dp2 + dp) {
                        z = true;
                        if (!z) {
                            int i5 = this.buttonState;
                            if (i5 == 0 || i5 == 1 || i5 == 2) {
                                if (x >= this.buttonX - AndroidUtilities.dp(12.0f) && x <= (this.buttonX - AndroidUtilities.dp(12.0f)) + this.backgroundWidth) {
                                    boolean z3 = this.drawInstantView;
                                    if (y >= (z3 ? this.buttonY : this.namesOffset + this.mediaOffsetY)) {
                                        if (z3) {
                                            i = this.buttonY;
                                        } else {
                                            i = this.namesOffset + this.mediaOffsetY;
                                            dp = AndroidUtilities.dp(82.0f);
                                        }
                                    }
                                }
                            } else {
                                int i6 = this.buttonX;
                                if (x >= i6) {
                                    if (x <= i6 + dp) {
                                        int i7 = this.buttonY;
                                        if (y >= i7) {
                                        }
                                    }
                                }
                            }
                            if (motionEvent.getAction() == 0) {
                                if (!z2 && !z) {
                                    return onTouch;
                                }
                                if (z2) {
                                    this.buttonPressed = 1;
                                } else {
                                    this.miniButtonPressed = 1;
                                }
                                invalidate();
                                return true;
                            } else if (this.buttonPressed != 0) {
                                if (motionEvent.getAction() == 1) {
                                    this.buttonPressed = 0;
                                    playSoundEffect(0);
                                    didPressButton(true, false);
                                    invalidate();
                                    return onTouch;
                                } else if (motionEvent.getAction() == 3) {
                                    this.buttonPressed = 0;
                                    invalidate();
                                    return onTouch;
                                } else if (motionEvent.getAction() != 2 || z2) {
                                    return onTouch;
                                } else {
                                    this.buttonPressed = 0;
                                    invalidate();
                                    return onTouch;
                                }
                            } else if (this.miniButtonPressed == 0) {
                                return onTouch;
                            } else {
                                if (motionEvent.getAction() == 1) {
                                    this.miniButtonPressed = 0;
                                    playSoundEffect(0);
                                    didPressMiniButton(true);
                                    invalidate();
                                    return onTouch;
                                } else if (motionEvent.getAction() == 3) {
                                    this.miniButtonPressed = 0;
                                    invalidate();
                                    return onTouch;
                                } else if (motionEvent.getAction() != 2 || z) {
                                    return onTouch;
                                } else {
                                    this.miniButtonPressed = 0;
                                    invalidate();
                                    return onTouch;
                                }
                            }
                        }
                        z2 = false;
                        if (motionEvent.getAction() == 0) {
                        }
                    }
                }
            }
            z = false;
            if (!z) {
            }
            z2 = false;
            if (motionEvent.getAction() == 0) {
            }
        } else {
            return false;
        }
    }

    public boolean checkSpoilersMotionEvent(MotionEvent motionEvent) {
        int i;
        MessageObject.GroupedMessages groupedMessages;
        if (this.currentMessageObject.hasValidGroupId() && (groupedMessages = this.currentMessagesGroup) != null && !groupedMessages.isDocuments) {
            ViewGroup viewGroup = (ViewGroup) getParent();
            for (int i2 = 0; i2 < viewGroup.getChildCount(); i2++) {
                View childAt = viewGroup.getChildAt(i2);
                if (childAt instanceof ChatMessageCell) {
                    ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                    MessageObject.GroupedMessages currentMessagesGroup = chatMessageCell.getCurrentMessagesGroup();
                    MessageObject.GroupedMessagePosition currentPosition = chatMessageCell.getCurrentPosition();
                    if (currentMessagesGroup != null && currentMessagesGroup.groupId == this.currentMessagesGroup.groupId) {
                        int i3 = currentPosition.flags;
                        if ((i3 & 8) != 0 && (i3 & 1) != 0 && chatMessageCell != this) {
                            motionEvent.offsetLocation(getLeft() - chatMessageCell.getLeft(), getTop() - chatMessageCell.getTop());
                            boolean checkSpoilersMotionEvent = chatMessageCell.checkSpoilersMotionEvent(motionEvent);
                            motionEvent.offsetLocation(-(getLeft() - chatMessageCell.getLeft()), -(getTop() - chatMessageCell.getTop()));
                            return checkSpoilersMotionEvent;
                        }
                    }
                }
            }
        }
        if (this.isSpoilerRevealing) {
            return false;
        }
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        int actionMasked = motionEvent.getActionMasked();
        if (actionMasked == 0) {
            int i4 = this.textX;
            if (x >= i4 && y >= (i = this.textY)) {
                MessageObject messageObject = this.currentMessageObject;
                if (x <= i4 + messageObject.textWidth && y <= i + messageObject.textHeight) {
                    ArrayList<MessageObject.TextLayoutBlock> arrayList = messageObject.textLayoutBlocks;
                    for (int i5 = 0; i5 < arrayList.size() && arrayList.get(i5).textYOffset <= y; i5++) {
                        MessageObject.TextLayoutBlock textLayoutBlock = arrayList.get(i5);
                        int i6 = textLayoutBlock.isRtl() ? (int) this.currentMessageObject.textXOffset : 0;
                        for (SpoilerEffect spoilerEffect : textLayoutBlock.spoilers) {
                            if (spoilerEffect.getBounds().contains((x - this.textX) + i6, (int) ((y - this.textY) - textLayoutBlock.textYOffset))) {
                                this.spoilerPressed = spoilerEffect;
                                this.isCaptionSpoilerPressed = false;
                                return true;
                            }
                        }
                    }
                }
            }
            if (hasCaptionLayout()) {
                float f = x;
                float f2 = this.captionX;
                if (f >= f2) {
                    float f3 = y;
                    if (f3 >= this.captionY && f <= f2 + this.captionLayout.getWidth() && f3 <= this.captionY + this.captionLayout.getHeight()) {
                        for (SpoilerEffect spoilerEffect2 : this.captionSpoilers) {
                            if (spoilerEffect2.getBounds().contains((int) (f - this.captionX), (int) (f3 - this.captionY))) {
                                this.spoilerPressed = spoilerEffect2;
                                this.isCaptionSpoilerPressed = true;
                                return true;
                            }
                        }
                    }
                }
            }
        } else if (actionMasked == 1 && this.spoilerPressed != null) {
            playSoundEffect(0);
            this.sPath.rewind();
            if (this.isCaptionSpoilerPressed) {
                for (SpoilerEffect spoilerEffect3 : this.captionSpoilers) {
                    Rect bounds = spoilerEffect3.getBounds();
                    this.sPath.addRect(bounds.left, bounds.top, bounds.right, bounds.bottom, Path.Direction.CW);
                }
            } else {
                Iterator<MessageObject.TextLayoutBlock> it = this.currentMessageObject.textLayoutBlocks.iterator();
                while (it.hasNext()) {
                    MessageObject.TextLayoutBlock next = it.next();
                    for (SpoilerEffect spoilerEffect4 : next.spoilers) {
                        Rect bounds2 = spoilerEffect4.getBounds();
                        float f4 = next.textYOffset;
                        this.sPath.addRect(bounds2.left, bounds2.top + f4, bounds2.right, bounds2.bottom + f4, Path.Direction.CW);
                    }
                }
            }
            this.sPath.computeBounds(this.rect, false);
            float sqrt = (float) Math.sqrt(Math.pow(this.rect.width(), 2.0d) + Math.pow(this.rect.height(), 2.0d));
            this.isSpoilerRevealing = true;
            this.spoilerPressed.setOnRippleEndCallback(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda2
                @Override // java.lang.Runnable
                public final void run() {
                    ChatMessageCell.this.lambda$checkSpoilersMotionEvent$1();
                }
            });
            if (this.isCaptionSpoilerPressed) {
                for (SpoilerEffect spoilerEffect5 : this.captionSpoilers) {
                    spoilerEffect5.startRipple(x - this.captionX, y - this.captionY, sqrt);
                }
            } else {
                ArrayList<MessageObject.TextLayoutBlock> arrayList2 = this.currentMessageObject.textLayoutBlocks;
                if (arrayList2 != null) {
                    Iterator<MessageObject.TextLayoutBlock> it2 = arrayList2.iterator();
                    while (it2.hasNext()) {
                        MessageObject.TextLayoutBlock next2 = it2.next();
                        int i7 = next2.isRtl() ? (int) this.currentMessageObject.textXOffset : 0;
                        for (SpoilerEffect spoilerEffect6 : next2.spoilers) {
                            spoilerEffect6.startRipple((x - this.textX) + i7, (y - next2.textYOffset) - this.textY, sqrt);
                        }
                    }
                }
            }
            if (getParent() instanceof RecyclerListView) {
                ViewGroup viewGroup2 = (ViewGroup) getParent();
                for (int i8 = 0; i8 < viewGroup2.getChildCount(); i8++) {
                    View childAt2 = viewGroup2.getChildAt(i8);
                    if (childAt2 instanceof ChatMessageCell) {
                        final ChatMessageCell chatMessageCell2 = (ChatMessageCell) childAt2;
                        if (chatMessageCell2.getMessageObject() != null && chatMessageCell2.getMessageObject().getReplyMsgId() == getMessageObject().getId() && !chatMessageCell2.replySpoilers.isEmpty()) {
                            chatMessageCell2.replySpoilers.get(0).setOnRippleEndCallback(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda5
                                @Override // java.lang.Runnable
                                public final void run() {
                                    ChatMessageCell.this.lambda$checkSpoilersMotionEvent$3(chatMessageCell2);
                                }
                            });
                            for (SpoilerEffect spoilerEffect7 : chatMessageCell2.replySpoilers) {
                                spoilerEffect7.startRipple(spoilerEffect7.getBounds().centerX(), spoilerEffect7.getBounds().centerY(), sqrt);
                            }
                        }
                    }
                }
            }
            this.spoilerPressed = null;
            return true;
        }
        return false;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkSpoilersMotionEvent$1() {
        post(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda1
            @Override // java.lang.Runnable
            public final void run() {
                ChatMessageCell.this.lambda$checkSpoilersMotionEvent$0();
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkSpoilersMotionEvent$0() {
        this.isSpoilerRevealing = false;
        getMessageObject().isSpoilersRevealed = true;
        if (this.isCaptionSpoilerPressed) {
            this.captionSpoilers.clear();
        } else {
            ArrayList<MessageObject.TextLayoutBlock> arrayList = this.currentMessageObject.textLayoutBlocks;
            if (arrayList != null) {
                Iterator<MessageObject.TextLayoutBlock> it = arrayList.iterator();
                while (it.hasNext()) {
                    it.next().spoilers.clear();
                }
            }
        }
        invalidate();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkSpoilersMotionEvent$3(final ChatMessageCell chatMessageCell) {
        post(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda3
            @Override // java.lang.Runnable
            public final void run() {
                ChatMessageCell.lambda$checkSpoilersMotionEvent$2(ChatMessageCell.this);
            }
        });
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ void lambda$checkSpoilersMotionEvent$2(ChatMessageCell chatMessageCell) {
        chatMessageCell.getMessageObject().replyMessageObject.isSpoilersRevealed = true;
        chatMessageCell.replySpoilers.clear();
        chatMessageCell.invalidate();
    }

    private boolean checkBotButtonMotionEvent(MotionEvent motionEvent) {
        int dp;
        if (this.botButtons.isEmpty() || this.currentMessageObject.eventId != 0) {
            return false;
        }
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        if (motionEvent.getAction() == 0) {
            if (this.currentMessageObject.isOutOwner()) {
                dp = (getMeasuredWidth() - this.widthForButtons) - AndroidUtilities.dp(10.0f);
            } else {
                dp = this.backgroundDrawableLeft + AndroidUtilities.dp(this.mediaBackground ? 1.0f : 7.0f);
            }
            for (int i = 0; i < this.botButtons.size(); i++) {
                BotButton botButton = this.botButtons.get(i);
                int dp2 = (botButton.y + this.layoutHeight) - AndroidUtilities.dp(2.0f);
                if (x >= botButton.x + dp && x <= botButton.x + dp + botButton.width && y >= dp2 && y <= dp2 + botButton.height) {
                    this.pressedBotButton = i;
                    invalidate();
                    final int i2 = this.pressedBotButton;
                    postDelayed(new Runnable() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda4
                        @Override // java.lang.Runnable
                        public final void run() {
                            ChatMessageCell.this.lambda$checkBotButtonMotionEvent$4(i2);
                        }
                    }, ViewConfiguration.getLongPressTimeout() - 1);
                    return true;
                }
            }
            return false;
        } else if (motionEvent.getAction() != 1 || this.pressedBotButton == -1) {
            return false;
        } else {
            playSoundEffect(0);
            if (this.currentMessageObject.scheduled) {
                Toast.makeText(getContext(), LocaleController.getString("MessageScheduledBotAction", R.string.MessageScheduledBotAction), 1).show();
            } else {
                BotButton botButton2 = this.botButtons.get(this.pressedBotButton);
                if (botButton2.button != null) {
                    this.delegate.didPressBotButton(this, botButton2.button);
                }
            }
            this.pressedBotButton = -1;
            invalidate();
            return false;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$checkBotButtonMotionEvent$4(int i) {
        int i2 = this.pressedBotButton;
        if (i == i2) {
            if (!this.currentMessageObject.scheduled) {
                BotButton botButton = this.botButtons.get(i2);
                if (botButton.button != null) {
                    cancelCheckLongPress();
                    this.delegate.didLongPressBotButton(this, botButton.button);
                }
            }
            this.pressedBotButton = -1;
            invalidate();
        }
    }

    /* JADX WARN: Code restructure failed: missing block: B:433:0x05cc, code lost:
        if (r4 > (r0 + org.telegram.messenger.AndroidUtilities.dp(32 + ((r19.drawSideButton != 3 || r19.commentLayout == null) ? 0 : 18)))) goto L435;
     */
    @Override // android.view.View
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public boolean onTouchEvent(MotionEvent motionEvent) {
        boolean z;
        int i;
        int i2;
        TLRPC$Chat tLRPC$Chat;
        int i3;
        int i4;
        int i5;
        int i6;
        int i7;
        if (this.currentMessageObject == null || !this.delegate.canPerformActions() || this.animationRunning) {
            checkTextSelection(motionEvent);
            return super.onTouchEvent(motionEvent);
        }
        boolean z2 = true;
        if (checkTextSelection(motionEvent) || checkRoundSeekbar(motionEvent) || checkReactionsTouchEvent(motionEvent)) {
            return true;
        }
        VideoPlayerRewinder videoPlayerRewinder = this.videoPlayerRewinder;
        int i8 = 0;
        if (videoPlayerRewinder != null && videoPlayerRewinder.rewindCount > 0) {
            if (motionEvent.getAction() != 1 && motionEvent.getAction() != 3) {
                return true;
            }
            getParent().requestDisallowInterceptTouchEvent(false);
            this.videoPlayerRewinder.cancelRewind();
            return false;
        }
        this.disallowLongPress = false;
        this.lastTouchX = motionEvent.getX();
        float y = motionEvent.getY();
        this.lastTouchY = y;
        this.backgroundDrawable.setTouchCoords(this.lastTouchX, y);
        boolean checkSpoilersMotionEvent = checkSpoilersMotionEvent(motionEvent);
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkTextBlockMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkPinchToZoom(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkDateMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkTextSelection(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkOtherButtonMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkCaptionMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkTranscribeButtonMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkAudioMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkLinkPreviewMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkInstantButtonMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkCommentButtonMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkGameMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkPhotoImageMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkBotButtonMotionEvent(motionEvent);
        }
        if (!checkSpoilersMotionEvent) {
            checkSpoilersMotionEvent = checkPollButtonMotionEvent(motionEvent);
        }
        if (motionEvent.getAction() == 3) {
            this.spoilerPressed = null;
            this.isCaptionSpoilerPressed = false;
            this.buttonPressed = 0;
            this.miniButtonPressed = 0;
            this.pressedBotButton = -1;
            this.pressedVoteButton = -1;
            this.pollHintPressed = false;
            this.psaHintPressed = false;
            this.linkPreviewPressed = false;
            this.otherPressed = false;
            this.sideButtonPressed = false;
            this.imagePressed = false;
            this.timePressed = false;
            this.gamePreviewPressed = false;
            this.commentButtonPressed = false;
            this.instantButtonPressed = false;
            this.instantPressed = false;
            if (Build.VERSION.SDK_INT >= 21) {
                int i9 = 0;
                while (true) {
                    Drawable[] drawableArr = this.selectorDrawable;
                    if (i9 >= drawableArr.length) {
                        break;
                    }
                    if (drawableArr[i9] != null) {
                        drawableArr[i9].setState(StateSet.NOTHING);
                    }
                    i9++;
                }
            }
            if (this.hadLongPress) {
                if (this.pressedLinkType != 2) {
                    this.hadLongPress = false;
                }
                this.pressedLink = null;
                this.pressedEmoji = null;
                this.pressedLinkType = -1;
            } else {
                resetPressedLink(-1);
            }
            z = false;
        } else {
            z = checkSpoilersMotionEvent;
        }
        updateRadialProgressBackground();
        if (!this.disallowLongPress && z && motionEvent.getAction() == 0) {
            startCheckLongPress();
        }
        if (motionEvent.getAction() != 0 && motionEvent.getAction() != 2) {
            cancelCheckLongPress();
        }
        if (z) {
            return z;
        }
        float x = motionEvent.getX();
        float y2 = motionEvent.getY();
        if (motionEvent.getAction() == 0) {
            ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
            if (chatMessageCellDelegate != null && !chatMessageCellDelegate.canPerformActions()) {
                return z;
            }
            if (this.isAvatarVisible && this.avatarImage.isInsideImage(x, getTop() + y2)) {
                this.avatarPressed = true;
            } else {
                if (this.psaButtonVisible && this.hasPsaHint) {
                    int i10 = this.psaHelpX;
                    if (x >= i10 && x <= i10 + AndroidUtilities.dp(40.0f)) {
                        int i11 = this.psaHelpY;
                        if (y2 >= i11 && y2 <= i11 + AndroidUtilities.dp(40.0f)) {
                            this.psaHintPressed = true;
                            createSelectorDrawable(0);
                            this.selectorDrawableMaskType[0] = 3;
                            if (Build.VERSION.SDK_INT >= 21) {
                                Drawable[] drawableArr2 = this.selectorDrawable;
                                if (drawableArr2[0] != null) {
                                    drawableArr2[0].setBounds(this.psaHelpX - AndroidUtilities.dp(8.0f), this.psaHelpY - AndroidUtilities.dp(8.0f), this.psaHelpX + AndroidUtilities.dp(32.0f), this.psaHelpY + AndroidUtilities.dp(32.0f));
                                    this.selectorDrawable[0].setHotspot(x, y2);
                                    this.selectorDrawable[0].setState(this.pressedState);
                                }
                            }
                            invalidate();
                        }
                    }
                }
                if (this.drawForwardedName && this.forwardedNameLayout[0] != null) {
                    float f = this.forwardNameX;
                    if (x >= f && x <= f + this.forwardedNameWidth) {
                        int i12 = this.forwardNameY;
                        if (y2 >= i12 && y2 <= i12 + AndroidUtilities.dp(32.0f)) {
                            if (this.viaWidth != 0 && x >= this.forwardNameX + this.viaNameWidth + AndroidUtilities.dp(4.0f)) {
                                this.forwardBotPressed = true;
                            } else {
                                this.forwardNamePressed = true;
                            }
                        }
                    }
                }
                if (this.drawNameLayout && this.nameLayout != null && (i7 = this.viaWidth) != 0) {
                    float f2 = this.nameX;
                    int i13 = this.viaNameWidth;
                    if (x >= i13 + f2 && x <= f2 + i13 + i7 && y2 >= this.nameY - AndroidUtilities.dp(4.0f) && y2 <= this.nameY + AndroidUtilities.dp(20.0f)) {
                        this.forwardBotPressed = true;
                    }
                }
                if (this.drawSideButton != 0) {
                    float f3 = this.sideStartX;
                    if (x >= f3 && x <= f3 + AndroidUtilities.dp(40.0f)) {
                        float f4 = this.sideStartY;
                        if (y2 >= f4) {
                            if (this.drawSideButton == 3 && this.commentLayout != null) {
                                i8 = 18;
                            }
                            if (y2 <= f4 + AndroidUtilities.dp(32 + i8)) {
                                if (this.currentMessageObject.isSent()) {
                                    this.sideButtonPressed = true;
                                }
                                invalidate();
                            }
                        }
                    }
                }
                if (this.replyNameLayout != null) {
                    if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                        i5 = this.replyStartX;
                        i6 = Math.max(this.replyNameWidth, this.replyTextWidth);
                    } else {
                        i5 = this.replyStartX;
                        i6 = this.backgroundDrawableRight;
                    }
                    int i14 = i5 + i6;
                    if (x >= this.replyStartX && x <= i14) {
                        int i15 = this.replyStartY;
                        if (y2 >= i15 && y2 <= i15 + AndroidUtilities.dp(35.0f)) {
                            this.replyPressed = true;
                        }
                    }
                }
                z2 = z;
            }
            if (z2) {
                startCheckLongPress();
            }
            return z2;
        }
        if (motionEvent.getAction() != 2) {
            cancelCheckLongPress();
        }
        if (this.avatarPressed) {
            if (motionEvent.getAction() == 1) {
                this.avatarPressed = false;
                playSoundEffect(0);
                ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                if (chatMessageCellDelegate2 == null) {
                    return z;
                }
                TLRPC$User tLRPC$User = this.currentUser;
                if (tLRPC$User != null) {
                    if (tLRPC$User.id == 0) {
                        chatMessageCellDelegate2.didPressHiddenForward(this);
                        return z;
                    }
                    chatMessageCellDelegate2.didPressUserAvatar(this, tLRPC$User, this.lastTouchX, this.lastTouchY);
                    return z;
                }
                TLRPC$Chat tLRPC$Chat2 = this.currentChat;
                if (tLRPC$Chat2 != null) {
                    TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader = this.currentMessageObject.messageOwner.fwd_from;
                    if (tLRPC$MessageFwdHeader != null) {
                        if ((tLRPC$MessageFwdHeader.flags & 16) != 0) {
                            i4 = tLRPC$MessageFwdHeader.saved_from_msg_id;
                            tLRPC$Chat = tLRPC$Chat2;
                        } else {
                            i4 = tLRPC$MessageFwdHeader.channel_post;
                            tLRPC$Chat = this.currentForwardChannel;
                        }
                        i3 = i4;
                    } else {
                        tLRPC$Chat = tLRPC$Chat2;
                        i3 = 0;
                    }
                    chatMessageCellDelegate2.didPressChannelAvatar(this, tLRPC$Chat != null ? tLRPC$Chat : tLRPC$Chat2, i3, this.lastTouchX, this.lastTouchY);
                    return z;
                }
                MessageObject messageObject = this.currentMessageObject;
                if (messageObject == null || messageObject.sponsoredChatInvite == null) {
                    return z;
                }
                chatMessageCellDelegate2.didPressInstantButton(this, this.drawInstantViewType);
                return z;
            } else if (motionEvent.getAction() == 3) {
                this.avatarPressed = false;
                return z;
            } else if (motionEvent.getAction() != 2 || !this.isAvatarVisible || this.avatarImage.isInsideImage(x, y2 + getTop())) {
                return z;
            } else {
                this.avatarPressed = false;
                return z;
            }
        } else if (this.psaHintPressed) {
            if (motionEvent.getAction() != 1) {
                return z;
            }
            playSoundEffect(0);
            this.delegate.didPressHint(this, 1);
            this.psaHintPressed = false;
            if (Build.VERSION.SDK_INT >= 21) {
                Drawable[] drawableArr3 = this.selectorDrawable;
                if (drawableArr3[0] != null) {
                    drawableArr3[0].setState(StateSet.NOTHING);
                }
            }
            invalidate();
            return z;
        } else if (this.forwardNamePressed) {
            if (motionEvent.getAction() == 1) {
                this.forwardNamePressed = false;
                playSoundEffect(0);
                ChatMessageCellDelegate chatMessageCellDelegate3 = this.delegate;
                if (chatMessageCellDelegate3 == null) {
                    return z;
                }
                TLRPC$Chat tLRPC$Chat3 = this.currentForwardChannel;
                if (tLRPC$Chat3 != null) {
                    chatMessageCellDelegate3.didPressChannelAvatar(this, tLRPC$Chat3, this.currentMessageObject.messageOwner.fwd_from.channel_post, this.lastTouchX, this.lastTouchY);
                    return z;
                }
                TLRPC$User tLRPC$User2 = this.currentForwardUser;
                if (tLRPC$User2 != null) {
                    chatMessageCellDelegate3.didPressUserAvatar(this, tLRPC$User2, this.lastTouchX, this.lastTouchY);
                    return z;
                } else if (this.currentForwardName == null) {
                    return z;
                } else {
                    chatMessageCellDelegate3.didPressHiddenForward(this);
                    return z;
                }
            } else if (motionEvent.getAction() == 3) {
                this.forwardNamePressed = false;
                return z;
            } else if (motionEvent.getAction() != 2) {
                return z;
            } else {
                float f5 = this.forwardNameX;
                if (x >= f5 && x <= f5 + this.forwardedNameWidth) {
                    int i16 = this.forwardNameY;
                    if (y2 >= i16 && y2 <= i16 + AndroidUtilities.dp(32.0f)) {
                        return z;
                    }
                }
                this.forwardNamePressed = false;
                return z;
            }
        } else if (this.forwardBotPressed) {
            if (motionEvent.getAction() == 1) {
                this.forwardBotPressed = false;
                playSoundEffect(0);
                ChatMessageCellDelegate chatMessageCellDelegate4 = this.delegate;
                if (chatMessageCellDelegate4 == null) {
                    return z;
                }
                TLRPC$User tLRPC$User3 = this.currentViaBotUser;
                if (tLRPC$User3.bot_inline_placeholder == null) {
                    chatMessageCellDelegate4.didPressViaBotNotInline(this, tLRPC$User3 != null ? tLRPC$User3.id : 0L);
                    return z;
                }
                chatMessageCellDelegate4.didPressViaBot(this, tLRPC$User3 != null ? tLRPC$User3.username : this.currentMessageObject.messageOwner.via_bot_name);
                return z;
            } else if (motionEvent.getAction() == 3) {
                this.forwardBotPressed = false;
                return z;
            } else if (motionEvent.getAction() != 2) {
                return z;
            } else {
                if (this.drawForwardedName && this.forwardedNameLayout[0] != null) {
                    float f6 = this.forwardNameX;
                    if (x >= f6 && x <= f6 + this.forwardedNameWidth) {
                        int i17 = this.forwardNameY;
                        if (y2 >= i17 && y2 <= i17 + AndroidUtilities.dp(32.0f)) {
                            return z;
                        }
                    }
                    this.forwardBotPressed = false;
                    return z;
                }
                float f7 = this.nameX;
                int i18 = this.viaNameWidth;
                if (x >= i18 + f7 && x <= f7 + i18 + this.viaWidth && y2 >= this.nameY - AndroidUtilities.dp(4.0f) && y2 <= this.nameY + AndroidUtilities.dp(20.0f)) {
                    return z;
                }
                this.forwardBotPressed = false;
                return z;
            }
        } else if (this.replyPressed) {
            if (motionEvent.getAction() == 1) {
                this.replyPressed = false;
                playSoundEffect(0);
                if (this.replyPanelIsForward) {
                    ChatMessageCellDelegate chatMessageCellDelegate5 = this.delegate;
                    if (chatMessageCellDelegate5 == null) {
                        return z;
                    }
                    TLRPC$Chat tLRPC$Chat4 = this.currentForwardChannel;
                    if (tLRPC$Chat4 != null) {
                        chatMessageCellDelegate5.didPressChannelAvatar(this, tLRPC$Chat4, this.currentMessageObject.messageOwner.fwd_from.channel_post, this.lastTouchX, this.lastTouchY);
                        return z;
                    }
                    TLRPC$User tLRPC$User4 = this.currentForwardUser;
                    if (tLRPC$User4 != null) {
                        chatMessageCellDelegate5.didPressUserAvatar(this, tLRPC$User4, this.lastTouchX, this.lastTouchY);
                        return z;
                    } else if (this.currentForwardName == null) {
                        return z;
                    } else {
                        chatMessageCellDelegate5.didPressHiddenForward(this);
                        return z;
                    }
                } else if (this.delegate == null || !this.currentMessageObject.hasValidReplyMessageObject()) {
                    return z;
                } else {
                    this.delegate.didPressReplyMessage(this, this.currentMessageObject.getReplyMsgId());
                    return z;
                }
            } else if (motionEvent.getAction() == 3) {
                this.replyPressed = false;
                return z;
            } else if (motionEvent.getAction() != 2) {
                return z;
            } else {
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    i = this.replyStartX;
                    i2 = Math.max(this.replyNameWidth, this.replyTextWidth);
                } else {
                    i = this.replyStartX;
                    i2 = this.backgroundDrawableRight;
                }
                int i19 = i + i2;
                if (x >= this.replyStartX && x <= i19) {
                    int i20 = this.replyStartY;
                    if (y2 >= i20 && y2 <= i20 + AndroidUtilities.dp(35.0f)) {
                        return z;
                    }
                }
                this.replyPressed = false;
                return z;
            }
        } else if (!this.sideButtonPressed) {
            return z;
        } else {
            if (motionEvent.getAction() == 1) {
                this.sideButtonPressed = false;
                playSoundEffect(0);
                ChatMessageCellDelegate chatMessageCellDelegate6 = this.delegate;
                if (chatMessageCellDelegate6 != null) {
                    if (this.drawSideButton == 3) {
                        chatMessageCellDelegate6.didPressCommentButton(this);
                    } else {
                        chatMessageCellDelegate6.didPressSideButton(this);
                    }
                }
            } else if (motionEvent.getAction() == 3) {
                this.sideButtonPressed = false;
            } else if (motionEvent.getAction() == 2) {
                float f8 = this.sideStartX;
                if (x >= f8 && x <= f8 + AndroidUtilities.dp(40.0f)) {
                    float f9 = this.sideStartY;
                    if (y2 >= f9) {
                    }
                }
                this.sideButtonPressed = false;
            }
            invalidate();
            return z;
        }
    }

    private boolean checkReactionsTouchEvent(MotionEvent motionEvent) {
        MessageObject.GroupedMessages groupedMessages;
        if (this.currentMessageObject.hasValidGroupId() && (groupedMessages = this.currentMessagesGroup) != null && !groupedMessages.isDocuments) {
            ViewGroup viewGroup = (ViewGroup) getParent();
            if (viewGroup == null) {
                return false;
            }
            for (int i = 0; i < viewGroup.getChildCount(); i++) {
                View childAt = viewGroup.getChildAt(i);
                if (childAt instanceof ChatMessageCell) {
                    ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                    MessageObject.GroupedMessages currentMessagesGroup = chatMessageCell.getCurrentMessagesGroup();
                    MessageObject.GroupedMessagePosition currentPosition = chatMessageCell.getCurrentPosition();
                    if (currentMessagesGroup != null && currentMessagesGroup.groupId == this.currentMessagesGroup.groupId) {
                        int i2 = currentPosition.flags;
                        if ((i2 & 8) != 0 && (i2 & 1) != 0) {
                            if (chatMessageCell == this) {
                                return this.reactionsLayoutInBubble.chekTouchEvent(motionEvent);
                            }
                            motionEvent.offsetLocation(getLeft() - chatMessageCell.getLeft(), getTop() - chatMessageCell.getTop());
                            boolean chekTouchEvent = chatMessageCell.reactionsLayoutInBubble.chekTouchEvent(motionEvent);
                            motionEvent.offsetLocation(-(getLeft() - chatMessageCell.getLeft()), -(getTop() - chatMessageCell.getTop()));
                            return chekTouchEvent;
                        }
                    }
                }
            }
            return false;
        }
        return this.reactionsLayoutInBubble.chekTouchEvent(motionEvent);
    }

    private boolean checkPinchToZoom(MotionEvent motionEvent) {
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        PinchToZoomHelper pinchToZoomHelper = chatMessageCellDelegate == null ? null : chatMessageCellDelegate.getPinchToZoomHelper();
        if (this.currentMessageObject == null || !this.photoImage.hasNotThumb() || pinchToZoomHelper == null || this.currentMessageObject.isSticker() || this.currentMessageObject.isAnimatedEmoji()) {
            return false;
        }
        if ((this.currentMessageObject.isVideo() && !this.autoPlayingMedia) || this.isRoundVideo || this.currentMessageObject.isAnimatedSticker()) {
            return false;
        }
        if ((this.currentMessageObject.isDocument() && !this.currentMessageObject.isGif()) || this.currentMessageObject.needDrawBluredPreview()) {
            return false;
        }
        return pinchToZoomHelper.checkPinchToZoom(motionEvent, this, this.photoImage, this.currentMessageObject);
    }

    private boolean checkTextSelection(MotionEvent motionEvent) {
        MessageObject messageObject;
        TLRPC$Message tLRPC$Message;
        int i;
        int dp;
        int i2;
        MessageObject.GroupedMessages groupedMessages;
        TextSelectionHelper.ChatListTextSelectionHelper textSelectionHelper = this.delegate.getTextSelectionHelper();
        if (textSelectionHelper == null || MessagesController.getInstance(this.currentAccount).isChatNoForwards(this.currentMessageObject.getChatId()) || ((tLRPC$Message = (messageObject = this.currentMessageObject).messageOwner) != null && tLRPC$Message.noforwards)) {
            return false;
        }
        ArrayList<MessageObject.TextLayoutBlock> arrayList = messageObject.textLayoutBlocks;
        if (!(arrayList != null && !arrayList.isEmpty()) && !hasCaptionLayout()) {
            return false;
        }
        if ((!this.drawSelectionBackground && this.currentMessagesGroup == null) || (this.currentMessagesGroup != null && !this.delegate.hasSelectedMessages())) {
            return false;
        }
        if (this.currentMessageObject.hasValidGroupId() && (groupedMessages = this.currentMessagesGroup) != null && !groupedMessages.isDocuments) {
            ViewGroup viewGroup = (ViewGroup) getParent();
            for (int i3 = 0; i3 < viewGroup.getChildCount(); i3++) {
                View childAt = viewGroup.getChildAt(i3);
                if (childAt instanceof ChatMessageCell) {
                    ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                    MessageObject.GroupedMessages currentMessagesGroup = chatMessageCell.getCurrentMessagesGroup();
                    MessageObject.GroupedMessagePosition currentPosition = chatMessageCell.getCurrentPosition();
                    if (currentMessagesGroup != null && currentMessagesGroup.groupId == this.currentMessagesGroup.groupId) {
                        int i4 = currentPosition.flags;
                        if ((i4 & 8) != 0 && (i4 & 1) != 0) {
                            textSelectionHelper.setMaybeTextCord((int) chatMessageCell.captionX, (int) chatMessageCell.captionY);
                            textSelectionHelper.setMessageObject(chatMessageCell);
                            if (chatMessageCell == this) {
                                return textSelectionHelper.onTouchEvent(motionEvent);
                            }
                            motionEvent.offsetLocation(getLeft() - chatMessageCell.getLeft(), getTop() - chatMessageCell.getTop());
                            boolean onTouchEvent = textSelectionHelper.onTouchEvent(motionEvent);
                            motionEvent.offsetLocation(-(getLeft() - chatMessageCell.getLeft()), -(getTop() - chatMessageCell.getTop()));
                            return onTouchEvent;
                        }
                    }
                }
            }
            return false;
        }
        if (hasCaptionLayout()) {
            textSelectionHelper.setIsDescription(false);
            textSelectionHelper.setMaybeTextCord((int) this.captionX, (int) this.captionY);
        } else if (this.descriptionLayout != null && motionEvent.getY() > this.descriptionY) {
            textSelectionHelper.setIsDescription(true);
            if (this.hasGamePreview) {
                i2 = this.unmovedTextX - AndroidUtilities.dp(10.0f);
            } else {
                if (this.hasInvoicePreview) {
                    i = this.unmovedTextX;
                    dp = AndroidUtilities.dp(1.0f);
                } else {
                    i = this.unmovedTextX;
                    dp = AndroidUtilities.dp(1.0f);
                }
                i2 = i + dp;
            }
            textSelectionHelper.setMaybeTextCord(i2 + AndroidUtilities.dp(10.0f) + this.descriptionX, this.descriptionY);
        } else {
            textSelectionHelper.setIsDescription(false);
            textSelectionHelper.setMaybeTextCord(this.textX, this.textY);
        }
        textSelectionHelper.setMessageObject(this);
        return textSelectionHelper.onTouchEvent(motionEvent);
    }

    private void updateSelectionTextPosition() {
        int i;
        int dp;
        int i2;
        if (getDelegate() == null || getDelegate().getTextSelectionHelper() == null || !getDelegate().getTextSelectionHelper().isSelected(this.currentMessageObject)) {
            return;
        }
        int textSelectionType = getDelegate().getTextSelectionHelper().getTextSelectionType(this);
        if (textSelectionType == TextSelectionHelper.ChatListTextSelectionHelper.TYPE_DESCRIPTION) {
            if (this.hasGamePreview) {
                i2 = this.unmovedTextX - AndroidUtilities.dp(10.0f);
            } else {
                if (this.hasInvoicePreview) {
                    i = this.unmovedTextX;
                    dp = AndroidUtilities.dp(1.0f);
                } else {
                    i = this.unmovedTextX;
                    dp = AndroidUtilities.dp(1.0f);
                }
                i2 = i + dp;
            }
            getDelegate().getTextSelectionHelper().updateTextPosition(i2 + AndroidUtilities.dp(10.0f) + this.descriptionX, this.descriptionY);
        } else if (textSelectionType == TextSelectionHelper.ChatListTextSelectionHelper.TYPE_CAPTION) {
            getDelegate().getTextSelectionHelper().updateTextPosition((int) this.captionX, (int) this.captionY);
        } else {
            getDelegate().getTextSelectionHelper().updateTextPosition(this.textX, this.textY);
        }
    }

    public ArrayList<PollButton> getPollButtons() {
        return this.pollButtons;
    }

    public void updatePlayingMessageProgress() {
        String formatShortDuration;
        int i;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        VideoPlayerRewinder videoPlayerRewinder = this.videoPlayerRewinder;
        if (videoPlayerRewinder != null && videoPlayerRewinder.rewindCount != 0 && videoPlayerRewinder.rewindByBackSeek) {
            messageObject.audioProgress = videoPlayerRewinder.getVideoProgress();
        }
        int i2 = 0;
        if (this.documentAttachType == 4) {
            if (this.infoLayout != null && (PhotoViewer.isPlayingMessage(this.currentMessageObject) || MediaController.getInstance().isGoingToShowMessageObject(this.currentMessageObject))) {
                return;
            }
            AnimatedFileDrawable animation = this.photoImage.getAnimation();
            if (animation != null) {
                MessageObject messageObject2 = this.currentMessageObject;
                i2 = animation.getDurationMs() / 1000;
                messageObject2.audioPlayerDuration = i2;
                MessageObject messageObject3 = this.currentMessageObject;
                TLRPC$Message tLRPC$Message = messageObject3.messageOwner;
                if (tLRPC$Message.ttl > 0 && tLRPC$Message.destroyTime == 0 && !messageObject3.needDrawBluredPreview() && this.currentMessageObject.isVideo() && animation.hasBitmap()) {
                    this.delegate.didStartVideoStream(this.currentMessageObject);
                }
            }
            if (i2 == 0) {
                i2 = this.currentMessageObject.getDuration();
            }
            if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                float f = i2;
                i2 = (int) (f - (this.currentMessageObject.audioProgress * f));
            } else if (animation != null) {
                if (i2 != 0) {
                    i2 -= animation.getCurrentProgressMs() / 1000;
                }
                if (this.delegate != null && animation.getCurrentProgressMs() >= 3000) {
                    this.delegate.videoTimerReached();
                }
            }
            if (this.lastTime == i2) {
                return;
            }
            String formatShortDuration2 = AndroidUtilities.formatShortDuration(i2);
            this.infoWidth = (int) Math.ceil(Theme.chat_infoPaint.measureText(formatShortDuration2));
            this.infoLayout = new StaticLayout(formatShortDuration2, Theme.chat_infoPaint, this.infoWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            this.lastTime = i2;
        } else if (this.isRoundVideo) {
            TLRPC$Document document = this.currentMessageObject.getDocument();
            int i3 = 0;
            while (true) {
                if (i3 >= document.attributes.size()) {
                    i = 0;
                    break;
                }
                TLRPC$DocumentAttribute tLRPC$DocumentAttribute = document.attributes.get(i3);
                if (tLRPC$DocumentAttribute instanceof TLRPC$TL_documentAttributeVideo) {
                    i = tLRPC$DocumentAttribute.duration;
                    break;
                }
                i3++;
            }
            if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                i = Math.max(0, i - this.currentMessageObject.audioProgressSec);
            }
            if (this.lastTime != i) {
                this.lastTime = i;
                String formatLongDuration = AndroidUtilities.formatLongDuration(i);
                this.timeWidthAudio = (int) Math.ceil(Theme.chat_timePaint.measureText(formatLongDuration));
                this.durationLayout = new StaticLayout(formatLongDuration, Theme.chat_timePaint, this.timeWidthAudio, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            }
            float f2 = this.currentMessageObject.audioProgress;
            if (f2 != 0.0f) {
                this.lastDrawingAudioProgress = f2;
                if (f2 > 0.9f) {
                    this.lastDrawingAudioProgress = 1.0f;
                }
            }
            invalidate();
        } else if (this.documentAttach == null) {
        } else {
            if (this.useSeekBarWaveform) {
                if (!this.seekBarWaveform.isDragging()) {
                    this.seekBarWaveform.setProgress(this.currentMessageObject.audioProgress, true);
                }
            } else if (!this.seekBar.isDragging()) {
                this.seekBar.setProgress(this.currentMessageObject.audioProgress);
                this.seekBar.setBufferedProgress(this.currentMessageObject.bufferedProgress);
            }
            if (this.documentAttachType == 3) {
                if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                    int i4 = 0;
                    while (true) {
                        if (i4 >= this.documentAttach.attributes.size()) {
                            break;
                        }
                        TLRPC$DocumentAttribute tLRPC$DocumentAttribute2 = this.documentAttach.attributes.get(i4);
                        if (tLRPC$DocumentAttribute2 instanceof TLRPC$TL_documentAttributeAudio) {
                            i2 = tLRPC$DocumentAttribute2.duration;
                            break;
                        }
                        i4++;
                    }
                } else {
                    i2 = this.currentMessageObject.audioProgressSec;
                }
                if (this.lastTime != i2) {
                    this.lastTime = i2;
                    String formatLongDuration2 = AndroidUtilities.formatLongDuration(i2);
                    this.timeWidthAudio = (int) Math.ceil(Theme.chat_audioTimePaint.measureText(formatLongDuration2));
                    this.durationLayout = new StaticLayout(formatLongDuration2, Theme.chat_audioTimePaint, this.timeWidthAudio, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                }
            } else {
                int duration = this.currentMessageObject.getDuration();
                if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                    i2 = this.currentMessageObject.audioProgressSec;
                }
                if (this.lastTime != i2) {
                    this.lastTime = i2;
                    this.durationLayout = new StaticLayout(AndroidUtilities.formatShortDuration(i2, duration), Theme.chat_audioTimePaint, (int) Math.ceil(Theme.chat_audioTimePaint.measureText(formatShortDuration)), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                }
            }
            invalidate();
        }
    }

    public void setFullyDraw(boolean z) {
        this.fullyDraw = z;
    }

    public void setParentViewSize(int i, int i2) {
        Theme.MessageDrawable messageDrawable;
        this.parentWidth = i;
        this.parentHeight = i2;
        this.backgroundHeight = i2;
        if ((this.currentMessageObject == null || !hasGradientService() || !this.currentMessageObject.shouldDrawWithoutBackground()) && ((messageDrawable = this.currentBackgroundDrawable) == null || messageDrawable.getGradientShader() == null)) {
            return;
        }
        invalidate();
    }

    public void setVisiblePart(int i, int i2, int i3, float f, float f2, int i4, int i5, int i6, int i7) {
        MessageObject.TextLayoutBlock textLayoutBlock;
        this.parentWidth = i4;
        this.parentHeight = i5;
        this.backgroundHeight = i5;
        this.blurredViewTopOffset = i6;
        this.blurredViewBottomOffset = i7;
        this.viewTop = f2;
        if (i3 != i5 || f != this.parentViewTopOffset) {
            this.parentViewTopOffset = f;
            this.parentHeight = i3;
        }
        if (this.currentMessageObject != null && hasGradientService() && this.currentMessageObject.shouldDrawWithoutBackground()) {
            invalidate();
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.textLayoutBlocks == null) {
            return;
        }
        int i8 = i - this.textY;
        int i9 = 0;
        for (int i10 = 0; i10 < this.currentMessageObject.textLayoutBlocks.size() && this.currentMessageObject.textLayoutBlocks.get(i10).textYOffset <= i8; i10++) {
            i9 = i10;
        }
        int i11 = -1;
        int i12 = -1;
        int i13 = 0;
        while (i9 < this.currentMessageObject.textLayoutBlocks.size()) {
            float f3 = this.currentMessageObject.textLayoutBlocks.get(i9).textYOffset;
            float f4 = i8;
            if (intersect(f3, textLayoutBlock.height + f3, f4, i8 + i2)) {
                if (i11 == -1) {
                    i11 = i9;
                }
                i13++;
                i12 = i9;
            } else if (f3 > f4) {
                break;
            }
            i9++;
        }
        if (this.lastVisibleBlockNum != i12 || this.firstVisibleBlockNum != i11 || this.totalVisibleBlocksCount != i13) {
            this.lastVisibleBlockNum = i12;
            this.firstVisibleBlockNum = i11;
            this.totalVisibleBlocksCount = i13;
            invalidate();
        } else if (this.animatedEmojiStack != null) {
            for (int i14 = 0; i14 < this.animatedEmojiStack.holders.size(); i14++) {
                AnimatedEmojiSpan.AnimatedEmojiHolder animatedEmojiHolder = this.animatedEmojiStack.holders.get(i14);
                if (animatedEmojiHolder != null && animatedEmojiHolder.skipDraw && !animatedEmojiHolder.outOfBounds((this.parentBoundsTop - getY()) - animatedEmojiHolder.drawingYOffset, (this.parentBoundsBottom - getY()) - animatedEmojiHolder.drawingYOffset)) {
                    invalidate();
                    return;
                }
            }
        }
    }

    public static StaticLayout generateStaticLayout(CharSequence charSequence, TextPaint textPaint, int i, int i2, int i3, int i4) {
        SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder(charSequence);
        StaticLayout staticLayout = new StaticLayout(charSequence, textPaint, i2, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
        int i5 = i;
        int i6 = 0;
        for (int i7 = 0; i7 < i3; i7++) {
            staticLayout.getLineDirections(i7);
            if (staticLayout.getLineLeft(i7) != 0.0f || staticLayout.isRtlCharAt(staticLayout.getLineStart(i7)) || staticLayout.isRtlCharAt(staticLayout.getLineEnd(i7))) {
                i5 = i2;
            }
            int lineEnd = staticLayout.getLineEnd(i7);
            if (lineEnd == charSequence.length()) {
                break;
            }
            int i8 = (lineEnd - 1) + i6;
            if (spannableStringBuilder.charAt(i8) == ' ') {
                spannableStringBuilder.replace(i8, i8 + 1, (CharSequence) "\n");
            } else if (spannableStringBuilder.charAt(i8) != '\n') {
                spannableStringBuilder.insert(i8, (CharSequence) "\n");
                i6++;
            }
            if (i7 == staticLayout.getLineCount() - 1 || i7 == i4 - 1) {
                break;
            }
        }
        int i9 = i5;
        return StaticLayoutEx.createStaticLayout(spannableStringBuilder, textPaint, i9, Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(1.0f), false, TextUtils.TruncateAt.END, i9, i4, true);
    }

    private void didClickedImage() {
        ChatMessageCellDelegate chatMessageCellDelegate;
        TLRPC$WebPage tLRPC$WebPage;
        boolean z;
        TLRPC$MessageMedia tLRPC$MessageMedia;
        TLRPC$ReplyMarkup tLRPC$ReplyMarkup;
        MessageObject messageObject = this.currentMessageObject;
        int i = messageObject.type;
        if (i == 20) {
            TLRPC$Message tLRPC$Message = messageObject.messageOwner;
            if (tLRPC$Message == null || (tLRPC$MessageMedia = tLRPC$Message.media) == null || tLRPC$MessageMedia.extended_media == null || (tLRPC$ReplyMarkup = tLRPC$Message.reply_markup) == null) {
                return;
            }
            Iterator<TLRPC$TL_keyboardButtonRow> it = tLRPC$ReplyMarkup.rows.iterator();
            while (it.hasNext()) {
                Iterator<TLRPC$KeyboardButton> it2 = it.next().buttons.iterator();
                if (it2.hasNext()) {
                    this.delegate.didPressExtendedMediaPreview(this, it2.next());
                    return;
                }
            }
        } else if (i == 1 || messageObject.isAnyKindOfSticker()) {
            int i2 = this.buttonState;
            if (i2 == -1) {
                this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY);
            } else if (i2 != 0) {
            } else {
                didPressButton(true, false);
            }
        } else {
            MessageObject messageObject2 = this.currentMessageObject;
            int i3 = messageObject2.type;
            if (i3 == 12) {
                long j = MessageObject.getMedia(messageObject2.messageOwner).user_id;
                TLRPC$User tLRPC$User = null;
                if (j != 0) {
                    tLRPC$User = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(j));
                }
                this.delegate.didPressUserAvatar(this, tLRPC$User, this.lastTouchX, this.lastTouchY);
            } else if (i3 == 5) {
                if (this.buttonState != -1) {
                    didPressButton(true, false);
                } else if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || MediaController.getInstance().isMessagePaused()) {
                    this.delegate.needPlayMessage(this.currentMessageObject);
                } else {
                    MediaController.getInstance().lambda$startAudioAgain$7(this.currentMessageObject);
                }
            } else if (i3 == 8) {
                int i4 = this.buttonState;
                if (i4 == -1 || (i4 == 1 && this.canStreamVideo && this.autoPlayingMedia)) {
                    this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY);
                } else if (i4 != 2 && i4 != 0) {
                } else {
                    didPressButton(true, false);
                }
            } else {
                int i5 = this.documentAttachType;
                if (i5 == 4) {
                    int i6 = this.buttonState;
                    if (i6 == -1 || ((z = this.drawVideoImageButton) && (this.autoPlayingMedia || (SharedConfig.streamMedia && this.canStreamVideo)))) {
                        this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY);
                    } else if (z) {
                        didPressButton(true, true);
                    } else if (i6 != 0 && i6 != 3) {
                    } else {
                        didPressButton(true, false);
                    }
                } else if (i3 == 4) {
                    this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY);
                } else if (i5 == 1) {
                    if (this.buttonState != -1) {
                        return;
                    }
                    this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY);
                } else if (i5 == 2) {
                    if (this.buttonState != -1 || (tLRPC$WebPage = MessageObject.getMedia(messageObject2.messageOwner).webpage) == null) {
                        return;
                    }
                    String str = tLRPC$WebPage.embed_url;
                    if (str != null && str.length() != 0) {
                        this.delegate.needOpenWebView(this.currentMessageObject, tLRPC$WebPage.embed_url, tLRPC$WebPage.site_name, tLRPC$WebPage.description, tLRPC$WebPage.url, tLRPC$WebPage.embed_width, tLRPC$WebPage.embed_height);
                    } else {
                        Browser.openUrl(getContext(), tLRPC$WebPage.url);
                    }
                } else if (this.hasInvoicePreview) {
                    if (this.buttonState != -1) {
                        return;
                    }
                    this.delegate.didPressImage(this, this.lastTouchX, this.lastTouchY);
                } else if (Build.VERSION.SDK_INT < 26 || (chatMessageCellDelegate = this.delegate) == null) {
                } else {
                    if (i3 == 16) {
                        chatMessageCellDelegate.didLongPress(this, 0.0f, 0.0f);
                    } else {
                        chatMessageCellDelegate.didPressOther(this, this.otherX, this.otherY);
                    }
                }
            }
        }
    }

    private void updateSecretTimeText(MessageObject messageObject) {
        String secretTimeString;
        if (messageObject == null || !messageObject.needDrawBluredPreview() || (secretTimeString = messageObject.getSecretTimeString()) == null) {
            return;
        }
        int ceil = (int) Math.ceil(Theme.chat_infoPaint.measureText(secretTimeString));
        this.infoWidth = ceil;
        this.infoLayout = new StaticLayout(TextUtils.ellipsize(secretTimeString, Theme.chat_infoPaint, ceil, TextUtils.TruncateAt.END), Theme.chat_infoPaint, this.infoWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
        invalidate();
    }

    /* JADX WARN: Removed duplicated region for block: B:19:0x0048  */
    /* JADX WARN: Removed duplicated region for block: B:22:0x00ce  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean isPhotoDataChanged(MessageObject messageObject) {
        int i;
        TLRPC$MessageMedia tLRPC$MessageMedia;
        String formapMapUrl;
        int i2;
        int i3 = messageObject.type;
        if (i3 == 0 || i3 == 14) {
            return false;
        }
        if (i3 == 4) {
            if (this.currentUrl == null) {
                return true;
            }
            TLRPC$GeoPoint tLRPC$GeoPoint = messageObject.messageOwner.media.geo;
            double d = tLRPC$GeoPoint.lat;
            double d2 = tLRPC$GeoPoint._long;
            if (((int) messageObject.getDialogId()) == 0 && (i2 = SharedConfig.mapPreviewType) != 0) {
                if (i2 == 1) {
                    i = 4;
                } else if (i2 == 3) {
                    i = 1;
                }
                tLRPC$MessageMedia = messageObject.messageOwner.media;
                if (!(tLRPC$MessageMedia instanceof TLRPC$TL_messageMediaGeoLive)) {
                    int dp = this.backgroundWidth - AndroidUtilities.dp(21.0f);
                    int dp2 = AndroidUtilities.dp(195.0f);
                    double d3 = 268435456;
                    Double.isNaN(d3);
                    double d4 = d3 / 3.141592653589793d;
                    double d5 = (d * 3.141592653589793d) / 180.0d;
                    Double.isNaN(d3);
                    double round = Math.round(d3 - ((Math.log((Math.sin(d5) + 1.0d) / (1.0d - Math.sin(d5))) * d4) / 2.0d)) - (AndroidUtilities.dp(10.3f) << 6);
                    Double.isNaN(round);
                    Double.isNaN(d3);
                    int i4 = this.currentAccount;
                    float f = AndroidUtilities.density;
                    formapMapUrl = AndroidUtilities.formapMapUrl(i4, ((1.5707963267948966d - (Math.atan(Math.exp((round - d3) / d4)) * 2.0d)) * 180.0d) / 3.141592653589793d, d2, (int) (dp / f), (int) (dp2 / f), false, 15, i);
                } else if (!TextUtils.isEmpty(tLRPC$MessageMedia.title)) {
                    int dp3 = this.backgroundWidth - AndroidUtilities.dp(21.0f);
                    int dp4 = AndroidUtilities.dp(195.0f);
                    int i5 = this.currentAccount;
                    float f2 = AndroidUtilities.density;
                    formapMapUrl = AndroidUtilities.formapMapUrl(i5, d, d2, (int) (dp3 / f2), (int) (dp4 / f2), true, 15, i);
                } else {
                    int dp5 = this.backgroundWidth - AndroidUtilities.dp(12.0f);
                    int dp6 = AndroidUtilities.dp(195.0f);
                    int i6 = this.currentAccount;
                    float f3 = AndroidUtilities.density;
                    formapMapUrl = AndroidUtilities.formapMapUrl(i6, d, d2, (int) (dp5 / f3), (int) (dp6 / f3), true, 15, i);
                }
                return !formapMapUrl.equals(this.currentUrl);
            }
            i = -1;
            tLRPC$MessageMedia = messageObject.messageOwner.media;
            if (!(tLRPC$MessageMedia instanceof TLRPC$TL_messageMediaGeoLive)) {
            }
            return !formapMapUrl.equals(this.currentUrl);
        }
        TLRPC$PhotoSize tLRPC$PhotoSize = this.currentPhotoObject;
        if (tLRPC$PhotoSize == null || (tLRPC$PhotoSize.location instanceof TLRPC$TL_fileLocationUnavailable)) {
            return i3 == 1 || i3 == 20 || i3 == 5 || i3 == 3 || i3 == 8 || messageObject.isAnyKindOfSticker();
        } else if (this.currentMessageObject != null && this.photoNotSet) {
            return FileLoader.getInstance(this.currentAccount).getPathToMessage(this.currentMessageObject.messageOwner).exists();
        } else {
            return false;
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getRepliesCount() {
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null && !groupedMessages.messages.isEmpty()) {
            return this.currentMessagesGroup.messages.get(0).getRepliesCount();
        }
        return this.currentMessageObject.getRepliesCount();
    }

    private ArrayList<TLRPC$Peer> getRecentRepliers() {
        TLRPC$MessageReplies tLRPC$MessageReplies;
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null && !groupedMessages.messages.isEmpty() && (tLRPC$MessageReplies = this.currentMessagesGroup.messages.get(0).messageOwner.replies) != null) {
            return tLRPC$MessageReplies.recent_repliers;
        }
        TLRPC$MessageReplies tLRPC$MessageReplies2 = this.currentMessageObject.messageOwner.replies;
        if (tLRPC$MessageReplies2 == null) {
            return null;
        }
        return tLRPC$MessageReplies2.recent_repliers;
    }

    public void updateAnimatedEmojis() {
        if (!this.imageReceiversAttachState) {
            return;
        }
        boolean z = false;
        int cacheTypeForEnterView = this.currentMessageObject.wasJustSent ? AnimatedEmojiDrawable.getCacheTypeForEnterView() : 0;
        StaticLayout staticLayout = this.captionLayout;
        if (staticLayout != null) {
            this.animatedEmojiStack = AnimatedEmojiSpan.update(cacheTypeForEnterView, (View) this, false, this.animatedEmojiStack, staticLayout);
            return;
        }
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        if (chatMessageCellDelegate == null || !chatMessageCellDelegate.canDrawOutboundsContent()) {
            z = true;
        }
        this.animatedEmojiStack = AnimatedEmojiSpan.update(cacheTypeForEnterView, this, z, this.animatedEmojiStack, this.currentMessageObject.textLayoutBlocks);
    }

    private void updateCaptionSpoilers() {
        this.captionSpoilersPool.addAll(this.captionSpoilers);
        this.captionSpoilers.clear();
        if (this.captionLayout == null || getMessageObject().isSpoilersRevealed) {
            return;
        }
        SpoilerEffect.addSpoilers(this, this.captionLayout, this.captionSpoilersPool, this.captionSpoilers);
    }

    /* JADX WARN: Removed duplicated region for block: B:75:0x00da  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private boolean isUserDataChanged() {
        TLRPC$FileLocation tLRPC$FileLocation;
        TLRPC$FileLocation tLRPC$FileLocation2;
        TLRPC$PhotoSize tLRPC$PhotoSize;
        String str;
        String forwardedName;
        String str2;
        MessageObject messageObject;
        MessageObject messageObject2;
        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader;
        TLRPC$ChatPhoto tLRPC$ChatPhoto;
        TLRPC$UserProfilePhoto tLRPC$UserProfilePhoto;
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3 == null || this.hasLinkPreview || MessageObject.getMedia(messageObject3.messageOwner) == null || !(MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage instanceof TLRPC$TL_webPage)) {
            MessageObject messageObject4 = this.currentMessageObject;
            if (messageObject4 != null && (this.currentUser != null || this.currentChat != null)) {
                int i = this.lastSendState;
                TLRPC$Message tLRPC$Message = messageObject4.messageOwner;
                if (i != tLRPC$Message.send_state || this.lastDeleteDate != tLRPC$Message.destroyTime || this.lastViewsCount != tLRPC$Message.views || this.lastRepliesCount != getRepliesCount() || this.lastReactions != this.currentMessageObject.messageOwner.reactions) {
                    return true;
                }
                updateCurrentUserAndChat();
                String str3 = null;
                if (this.isAvatarVisible) {
                    TLRPC$User tLRPC$User = this.currentUser;
                    if (tLRPC$User != null && (tLRPC$UserProfilePhoto = tLRPC$User.photo) != null) {
                        tLRPC$FileLocation = tLRPC$UserProfilePhoto.photo_small;
                    } else {
                        TLRPC$Chat tLRPC$Chat = this.currentChat;
                        if (tLRPC$Chat != null && (tLRPC$ChatPhoto = tLRPC$Chat.photo) != null) {
                            tLRPC$FileLocation = tLRPC$ChatPhoto.photo_small;
                        }
                    }
                    if (this.replyTextLayout != null && (messageObject2 = this.currentMessageObject.replyMessageObject) != null && (!this.isThreadChat || (tLRPC$MessageFwdHeader = messageObject2.messageOwner.fwd_from) == null || tLRPC$MessageFwdHeader.channel_post == 0)) {
                        return true;
                    }
                    tLRPC$FileLocation2 = this.currentPhoto;
                    if ((tLRPC$FileLocation2 != null && tLRPC$FileLocation != null) || ((tLRPC$FileLocation2 != null && tLRPC$FileLocation == null) || (tLRPC$FileLocation2 != null && (tLRPC$FileLocation2.local_id != tLRPC$FileLocation.local_id || tLRPC$FileLocation2.volume_id != tLRPC$FileLocation.volume_id)))) {
                        return true;
                    }
                    if (this.replyNameLayout != null || (messageObject = this.currentMessageObject.replyMessageObject) == null || (tLRPC$PhotoSize = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 40)) == null || this.currentMessageObject.replyMessageObject.isAnyKindOfSticker()) {
                        tLRPC$PhotoSize = null;
                    }
                    if (this.currentReplyPhoto != null && tLRPC$PhotoSize != null) {
                        return true;
                    }
                    if (isNeedAuthorName()) {
                        str3 = getAuthorName();
                    }
                    str = this.currentNameString;
                    if ((str != null && str3 != null) || ((str != null && str3 == null) || (str != null && !str.equals(str3)))) {
                        return true;
                    }
                    if (this.drawForwardedName && this.currentMessageObject.needDrawForwarded()) {
                        forwardedName = this.currentMessageObject.getForwardedName();
                        str2 = this.currentForwardNameString;
                        if (str2 != null && forwardedName != null) {
                            return true;
                        }
                        if (str2 == null && forwardedName == null) {
                            return true;
                        }
                        return str2 == null && !str2.equals(forwardedName);
                    }
                }
                tLRPC$FileLocation = null;
                if (this.replyTextLayout != null) {
                }
                tLRPC$FileLocation2 = this.currentPhoto;
                if (tLRPC$FileLocation2 != null) {
                }
                if (this.replyNameLayout != null) {
                }
                tLRPC$PhotoSize = null;
                if (this.currentReplyPhoto != null) {
                }
                if (isNeedAuthorName()) {
                }
                str = this.currentNameString;
                if (str != null) {
                }
                if (this.drawForwardedName) {
                    forwardedName = this.currentMessageObject.getForwardedName();
                    str2 = this.currentForwardNameString;
                    if (str2 != null) {
                    }
                    if (str2 == null) {
                    }
                    if (str2 == null) {
                    }
                }
            }
            return false;
        }
        return true;
    }

    public ImageReceiver getPhotoImage() {
        return this.photoImage;
    }

    public int getNoSoundIconCenterX() {
        return this.noSoundCenterX;
    }

    public int getForwardNameCenterX() {
        float f;
        TLRPC$User tLRPC$User = this.currentUser;
        if (tLRPC$User != null && tLRPC$User.id == 0) {
            f = this.avatarImage.getCenterX();
        } else {
            f = this.forwardNameX + this.forwardNameCenterX;
        }
        return (int) f;
    }

    public int getChecksX() {
        return this.layoutWidth - AndroidUtilities.dp(SharedConfig.bubbleRadius >= 10 ? 27.3f : 25.3f);
    }

    public int getChecksY() {
        float f;
        int intrinsicHeight;
        if (this.currentMessageObject.shouldDrawWithoutBackground()) {
            f = this.drawTimeY;
            intrinsicHeight = getThemedDrawable("drawableMsgStickerCheck").getIntrinsicHeight();
        } else {
            f = this.drawTimeY;
            intrinsicHeight = Theme.chat_msgMediaCheckDrawable.getIntrinsicHeight();
        }
        return (int) (f - intrinsicHeight);
    }

    public TLRPC$User getCurrentUser() {
        return this.currentUser;
    }

    @Override // android.view.ViewGroup, android.view.View
    protected void onDetachedFromWindow() {
        super.onDetachedFromWindow();
        NotificationCenter.getGlobalInstance().removeObserver(this, NotificationCenter.startSpoilers);
        NotificationCenter.getGlobalInstance().removeObserver(this, NotificationCenter.stopSpoilers);
        NotificationCenter.getInstance(this.currentAccount).removeObserver(this, NotificationCenter.userInfoDidLoad);
        cancelShakeAnimation();
        if (this.animationRunning) {
            return;
        }
        CheckBoxBase checkBoxBase = this.checkBox;
        if (checkBoxBase != null) {
            checkBoxBase.onDetachedFromWindow();
        }
        CheckBoxBase checkBoxBase2 = this.mediaCheckBox;
        if (checkBoxBase2 != null) {
            checkBoxBase2.onDetachedFromWindow();
        }
        if (this.pollCheckBox != null) {
            int i = 0;
            while (true) {
                CheckBoxBase[] checkBoxBaseArr = this.pollCheckBox;
                if (i >= checkBoxBaseArr.length) {
                    break;
                }
                checkBoxBaseArr[i].onDetachedFromWindow();
                i++;
            }
        }
        this.attachedToWindow = false;
        this.avatarImage.onDetachedFromWindow();
        checkImageReceiversAttachState();
        if (this.addedForTest && this.currentUrl != null && this.currentWebFile != null) {
            ImageLoader.getInstance().removeTestWebFile(this.currentUrl);
            this.addedForTest = false;
        }
        DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
        if (getDelegate() != null && getDelegate().getTextSelectionHelper() != null) {
            getDelegate().getTextSelectionHelper().onChatMessageCellDetached(this);
        }
        this.transitionParams.onDetach();
        if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
            Theme.getCurrentAudiVisualizerDrawable().setParentView(null);
        }
        ValueAnimator valueAnimator = this.statusDrawableAnimator;
        if (valueAnimator != null) {
            valueAnimator.removeAllListeners();
            this.statusDrawableAnimator.cancel();
        }
        this.reactionsLayoutInBubble.onDetachFromWindow();
        this.statusDrawableAnimationInProgress = false;
        Runnable runnable = this.unregisterFlagSecure;
        if (runnable == null) {
            return;
        }
        runnable.run();
        this.unregisterFlagSecure = null;
    }

    @Override // android.view.ViewGroup, android.view.View
    protected void onAttachedToWindow() {
        super.onAttachedToWindow();
        NotificationCenter.getGlobalInstance().addObserver(this, NotificationCenter.startSpoilers);
        NotificationCenter.getGlobalInstance().addObserver(this, NotificationCenter.stopSpoilers);
        NotificationCenter.getInstance(this.currentAccount).addObserver(this, NotificationCenter.userInfoDidLoad);
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null) {
            messageObject.animateComments = false;
        }
        MessageObject messageObject2 = this.messageObjectToSet;
        if (messageObject2 != null) {
            messageObject2.animateComments = false;
            setMessageContent(messageObject2, this.groupedMessagesToSet, this.bottomNearToSet, this.topNearToSet);
            this.messageObjectToSet = null;
            this.groupedMessagesToSet = null;
        }
        CheckBoxBase checkBoxBase = this.checkBox;
        if (checkBoxBase != null) {
            checkBoxBase.onAttachedToWindow();
        }
        CheckBoxBase checkBoxBase2 = this.mediaCheckBox;
        if (checkBoxBase2 != null) {
            checkBoxBase2.onAttachedToWindow();
        }
        if (this.pollCheckBox != null) {
            int i = 0;
            while (true) {
                CheckBoxBase[] checkBoxBaseArr = this.pollCheckBox;
                if (i >= checkBoxBaseArr.length) {
                    break;
                }
                checkBoxBaseArr[i].onAttachedToWindow();
                i++;
            }
        }
        this.attachedToWindow = true;
        float f = 0.0f;
        this.animationOffsetX = 0.0f;
        this.slidingOffsetX = 0.0f;
        this.checkBoxTranslation = 0;
        updateTranslation();
        this.avatarImage.setParentView((View) getParent());
        this.avatarImage.onAttachedToWindow();
        checkImageReceiversAttachState();
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3 != null) {
            setAvatar(messageObject3);
        }
        int i2 = this.documentAttachType;
        if (i2 == 4 && this.autoPlayingMedia) {
            boolean isPlayingMessage = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
            this.animatingNoSoundPlaying = isPlayingMessage;
            this.animatingNoSoundProgress = isPlayingMessage ? 0.0f : 1.0f;
            this.animatingNoSound = 0;
        } else {
            this.animatingNoSoundPlaying = false;
            this.animatingNoSoundProgress = 0.0f;
            this.animatingDrawVideoImageButtonProgress = ((i2 == 4 || i2 == 2) && this.drawVideoSize) ? 1.0f : 0.0f;
        }
        if (getDelegate() != null && getDelegate().getTextSelectionHelper() != null) {
            getDelegate().getTextSelectionHelper().onChatMessageCellAttached(this);
        }
        if (this.documentAttachType == 5) {
            if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                f = 1.0f;
            }
            this.toSeekBarProgress = f;
        }
        this.reactionsLayoutInBubble.onAttachToWindow();
        updateFlagSecure();
        MessageObject messageObject4 = this.currentMessageObject;
        if (messageObject4 == null || messageObject4.type != 20 || this.unlockLayout == null) {
            return;
        }
        invalidate();
    }

    private void checkImageReceiversAttachState() {
        boolean z = true;
        boolean z2 = this.attachedToWindow && (this.visibleOnScreen || !this.shouldCheckVisibleOnScreen);
        if (z2 == this.imageReceiversAttachState) {
            return;
        }
        this.imageReceiversAttachState = z2;
        if (z2) {
            this.radialProgress.onAttachedToWindow();
            this.videoRadialProgress.onAttachedToWindow();
            if (this.pollAvatarImages != null) {
                int i = 0;
                while (true) {
                    ImageReceiver[] imageReceiverArr = this.pollAvatarImages;
                    if (i >= imageReceiverArr.length) {
                        break;
                    }
                    imageReceiverArr[i].onAttachedToWindow();
                    i++;
                }
            }
            if (this.commentAvatarImages != null) {
                int i2 = 0;
                while (true) {
                    ImageReceiver[] imageReceiverArr2 = this.commentAvatarImages;
                    if (i2 >= imageReceiverArr2.length) {
                        break;
                    }
                    imageReceiverArr2[i2].onAttachedToWindow();
                    i2++;
                }
            }
            this.replyImageReceiver.onAttachedToWindow();
            this.locationImageReceiver.onAttachedToWindow();
            if (this.photoImage.onAttachedToWindow()) {
                if (this.drawPhotoImage) {
                    updateButtonState(false, false, false);
                }
            } else {
                updateButtonState(false, false, false);
            }
            MessageObject messageObject = this.currentMessageObject;
            TLRPC$PhotoSize tLRPC$PhotoSize = null;
            if (messageObject != null && (this.isRoundVideo || messageObject.isVideo())) {
                checkVideoPlayback(true, null);
            }
            MessageObject messageObject2 = this.currentMessageObject;
            if (messageObject2 != null && !messageObject2.mediaExists) {
                int canDownloadMedia = DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject.messageOwner);
                TLRPC$Document document = this.currentMessageObject.getDocument();
                if (!(MessageObject.isStickerDocument(document) || MessageObject.isAnimatedStickerDocument(document, true) || MessageObject.isGifDocument(document) || MessageObject.isRoundVideoDocument(document))) {
                    if (document == null) {
                        tLRPC$PhotoSize = FileLoader.getClosestPhotoSizeWithSize(this.currentMessageObject.photoThumbs, AndroidUtilities.getPhotoSize());
                    }
                    int i3 = 2;
                    if (canDownloadMedia == 2 || (canDownloadMedia == 1 && this.currentMessageObject.isVideo())) {
                        if (document != null && !this.currentMessageObject.shouldEncryptPhotoOrVideo() && this.currentMessageObject.canStreamVideo()) {
                            FileLoader.getInstance(this.currentAccount).loadFile(document, this.currentMessageObject, 1, 10);
                        }
                    } else if (canDownloadMedia != 0) {
                        if (document != null) {
                            FileLoader fileLoader = FileLoader.getInstance(this.currentAccount);
                            MessageObject messageObject3 = this.currentMessageObject;
                            if (!MessageObject.isVideoDocument(document) || !this.currentMessageObject.shouldEncryptPhotoOrVideo()) {
                                i3 = 0;
                            }
                            fileLoader.loadFile(document, messageObject3, 1, i3);
                        } else if (tLRPC$PhotoSize != null) {
                            FileLoader fileLoader2 = FileLoader.getInstance(this.currentAccount);
                            ImageLocation forObject = ImageLocation.getForObject(tLRPC$PhotoSize, this.currentMessageObject.photoThumbsObject);
                            MessageObject messageObject4 = this.currentMessageObject;
                            fileLoader2.loadFile(forObject, messageObject4, null, 1, messageObject4.shouldEncryptPhotoOrVideo() ? 2 : 0);
                        }
                    }
                    updateButtonState(false, false, false);
                }
            }
            this.animatedEmojiReplyStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiReplyStack, this.replyTextLayout);
            this.animatedEmojiDescriptionStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiDescriptionStack, this.descriptionLayout);
            updateAnimatedEmojis();
            return;
        }
        this.radialProgress.onDetachedFromWindow();
        this.videoRadialProgress.onDetachedFromWindow();
        if (this.pollAvatarImages != null) {
            int i4 = 0;
            while (true) {
                ImageReceiver[] imageReceiverArr3 = this.pollAvatarImages;
                if (i4 >= imageReceiverArr3.length) {
                    break;
                }
                imageReceiverArr3[i4].onDetachedFromWindow();
                i4++;
            }
        }
        if (this.commentAvatarImages != null) {
            int i5 = 0;
            while (true) {
                ImageReceiver[] imageReceiverArr4 = this.commentAvatarImages;
                if (i5 >= imageReceiverArr4.length) {
                    break;
                }
                imageReceiverArr4[i5].onDetachedFromWindow();
                i5++;
            }
        }
        this.replyImageReceiver.onDetachedFromWindow();
        this.locationImageReceiver.onDetachedFromWindow();
        this.photoImage.onDetachedFromWindow();
        MessageObject messageObject5 = this.currentMessageObject;
        if (messageObject5 != null && !messageObject5.mediaExists && !messageObject5.putInDownloadsStore && !DownloadController.getInstance(this.currentAccount).isDownloading(this.currentMessageObject.messageOwner.id)) {
            TLRPC$Document document2 = this.currentMessageObject.getDocument();
            if (!MessageObject.isStickerDocument(document2) && !MessageObject.isAnimatedStickerDocument(document2, true) && !MessageObject.isGifDocument(document2) && !MessageObject.isRoundVideoDocument(document2)) {
                z = false;
            }
            if (!z) {
                if (document2 != null) {
                    FileLoader.getInstance(this.currentAccount).cancelLoadFile(document2);
                } else {
                    TLRPC$PhotoSize closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(this.currentMessageObject.photoThumbs, AndroidUtilities.getPhotoSize());
                    if (closestPhotoSizeWithSize != null) {
                        FileLoader.getInstance(this.currentAccount).cancelLoadFile(closestPhotoSizeWithSize);
                    }
                }
            }
        }
        AnimatedEmojiSpan.release(this, this.animatedEmojiDescriptionStack);
        AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
        AnimatedEmojiSpan.release(this, this.animatedEmojiStack);
    }

    /* JADX WARN: Can't wrap try/catch for region: R(167:1|(1:4284)|7|(1:9)(1:4283)|10|(1:12)(1:4282)|13|(1:15)(1:4281)|16|(1:20)(1:4280)|21|(27:25|(2:27|(1:33)(1:35))|36|37|(1:45)(1:4278)|46|(1:48)(1:4265)|(1:52)|53|(1:4264)|(1:77)|78|(9:82|(1:84)(1:4262)|(1:90)(1:4261)|(1:94)|95|(3:99|(1:101)(1:4259)|102)(1:4260)|103|(5:107|(1:111)|112|(1:116)(1:118)|117)|(3:135|(1:(2:147|148)(2:137|(1:139)(1:140)))|(3:142|(1:144)(1:146)|145)))(1:4263)|(4:151|(1:153)(1:158)|154|(1:156)(1:157))|159|(1:173)(70:231|(2:4256|(1:4258))(2:233|234)|235|(5:239|(1:245)(1:4252)|246|(1:252)(1:4251)|253)(1:4253)|254|(1:264)(1:4250)|265|(1:267)(1:4249)|268|(1:274)(1:4248)|275|(1:287)(1:4247)|288|(1:296)(1:4246)|297|(1:299)(1:4245)|300|(5:4222|(1:4230)(1:4244)|4231|(1:4243)|4234)(2:302|303)|304|(1:306)|307|(2:4207|(2:4208|(1:4217)(3:4210|(2:4212|4213)(2:4215|4216)|4214)))(0)|309|310|(1:4204)|314|(1:4203)|316|317|(1:321)(1:4198)|322|(1:324)|325|(1:4197)|328|329|(2:4154|(1:4158)(5:4159|(1:4161)(1:4194)|(3:4169|(6:4172|(2:4174|(2:4176|(1:4179)(1:4181)))(1:4184)|4183|(1:4182)(1:4179)|4181|4170)|4185)(0)|4186|(1:4188)(3:4189|(1:4191)(1:4193)|4192)))|(2:334|(1:340))|341|(1:345)(1:4153)|346|(2:4064|(11:4068|(1:4070)|4071|(4:4073|(1:(1:4076)(1:4133))(1:(1:4135)(1:4136))|4077|(5:4082|(2:4083|(1:4110)(2:(1:(1:4090)(2:4087|4088))(8:4091|(2:4093|(1:4095)(6:4108|(1:(1:4099)(1:4106))(1:4107)|4100|(1:4102)(1:4105)|4103|4104))(1:4109)|4096|(0)(0)|4100|(0)(0)|4103|4104)|4089))|4111|(3:4120|(1:4122)(1:4124)|4123)(3:4113|4114|(1:4116))|4117)(2:4125|(2:4127|(2:4128|(1:4131)(1:4130)))(0)))(1:4137)|4132|4111|(5:4118|4120|(0)(0)|4123|4117)|4113|4114|(0)|4117)(5:4138|(1:4148)(2:4140|4141)|4142|(1:4144)(1:4146)|4145))(2:353|354)|355|(3:357|(2:359|(1:(2:362|(2:364|(30:366|(1:372)(1:2216)|373|(3:377|(1:387)(1:385)|386)|392|(1:394)(1:2215)|395|(1:2214)(1:397)|398|(2:400|(3:402|(1:404)(1:2199)|405)(3:2200|(1:2204)(1:2206)|2205))(1:2207)|406|(15:408|(2:410|(2:412|(78:414|(3:416|(2:418|(77:430|(1:432)(1:1709)|433|434|(1:(1:437))(6:1698|(1:1702)|1703|(1:1705)|1706|(1:1708))|438|(56:442|(2:446|(1:448))(1:1696)|449|450|(1:452)|453|(4:455|(1:457)|458|(2:(1:463)(3:1669|(4:1672|(3:1674|(1:1679)(2:1676|1677)|1678)|1680|1681)|1671)|464)(3:1682|(1:1686)(3:1687|(1:1689)|1671)|464))(3:1690|(1:1692)(1:1694)|1693)|465|(1:469)|470|(2:474|(1:478)(1:479))|(1:491)|492|(1:496)|(5:1646|(3:1649|(1:1653)(3:1655|(2:1657|(2:1659|1660)(3:1662|(1:1664)|1665))(1:1666)|1661)|1647)|1668|1660|1661)|(1:1641)|501|(1:505)|506|(1:512)|513|(1:515)(4:1632|(3:1635|(1:1638)(1:1637)|1633)|1640|1639)|516|(1:518)|519|(1:521)(1:1631)|522|(1:524)(1:1630)|525|(1:527)|528|(3:530|(3:534|(1:536)(1:538)|537)|539)(1:1629)|540|(8:542|(1:544)(1:1459)|545|(3:547|(2:549|(1:551))|(4:554|555|(1:557)|558))|1458|555|(0)|558)(13:1460|(4:1466|(4:1469|(2:1471|(1:(2:1474|1475)(1:1477))(4:1479|(1:1481)(1:1484)|1482|1483))(4:1485|(1:1487)(1:1490)|1488|1489)|1476|1467)|1491|1478)|1496|(1:1498)|1499|(1:1501)(3:1623|(2:1624|(1:1627)(1:1626))|1628)|1502|(1:1506)(2:1614|(1:1618)(2:1619|(1:1621)(1:1622)))|1507|(1:1509)(1:1613)|1510|(4:1517|(7:1519|(11:1535|(4:1574|(5:1610|1582|(4:1585|(2:1587|(1:(2:1590|1591)(1:1593))(4:1595|(1:1597)(1:1600)|1598|1599))(4:1601|(1:1603)(1:1606)|1604|1605)|1592|1583)|1607|1594)|1577|(1:1580)(1:1579))(1:1537)|1538|(1:1542)(2:1565|(1:1569)(2:1570|(1:1572)(1:1573)))|1543|(1:1553)|1554|(1:1556)|1557|(1:1564)|1563)|1523|(2:1525|(1:1527)(3:1528|1529|1530))|1531|1532|1530)|1611|1612)|1516)|559|(1:561)(7:1388|1389|1390|(2:1454|1455)(1:1392)|1393|(1:1395)(11:(2:1398|1399)(5:1432|1433|(1:(2:1452|1453)(6:1435|1436|1437|1438|1439|(1:1441)(1:1442)))|1444|(1:1446)(1:1447))|1400|(1:1425)|1403|1404|1405|(3:1420|1411|1412)|1408|(2:1415|1416)|1411|1412)|1396)|562|(4:1356|(1:1358)(1:1387)|1359|(6:1361|(1:1363)|1364|(1:1366)(1:1386)|1367|(2:1369|(3:1373|(2:1375|(1:1377))|1378)(1:(4:1380|(1:1382)|1383|(1:1385))))))|564|565|(3:1352|(1:1354)|1355)|569|(2:571|(1:573))|574|(3:1336|(2:1344|(1:1346))(1:1338)|1339)(3:576|577|(2:581|(1:583)(1:1327)))|584|(1:590)(1:1326)|591|(1:1325)(1:593)|594|(1:599)|600|(2:1312|(1:1314)(5:1315|(1:1319)(1:1321)|1320|603|(4:605|(2:607|(3:609|(3:613|(3:618|(1:620)(1:1148)|621)(4:(1:1152)|1153|(1:1155)(1:1157)|1156)|622)(7:1158|(2:1160|(1:1162)(1:1249))(1:1250)|1163|(1:1167)(1:1248)|1168|(2:1173|(4:1200|1201|(1:1203)|(5:1210|(1:1212)|1213|(1:1215)(1:1217)|1216)(2:1218|(1:1223)(1:1224)))(2:1175|(1:(5:1182|(1:1184)|1185|(1:1187)(1:1190)|1188)(1:1191))(3:1192|(1:1194)(1:1196)|1195)))(3:1231|(1:1237)(2:(1:1242)|1243)|1238)|1189)|623)(2:1251|(2:1253|(1:1255)(3:1257|(1:1259)(1:1283)|(2:1273|(1:1277)(3:1278|(1:1280)(1:1282)|1281))(4:1261|1262|(1:1264)(1:1266)|1265)))(1:1284)))(3:1285|(1:1287)(1:1289)|1288)|1256|623)(3:1290|(1:1296)(3:1297|(2:(1:1301)|1302)|1256)|623)))|602|603|(0)(0))(1:1697)|1695|450|(0)|453|(0)(0)|465|(2:467|469)|470|(4:472|474|(2:476|478)|479)|(4:481|483|487|491)|492|(2:494|496)|(0)|1642|1644|1646|(1:1647)|1668|1660|1661|(0)|1641|501|(2:503|505)|506|(3:508|510|512)|513|(0)(0)|516|(0)|519|(0)(0)|522|(0)(0)|525|(0)|528|(0)(0)|540|(0)(0)|559|(0)(0)|562|(0)|564|565|(1:567)(4:1347|1352|(0)|1355)|569|(0)|574|(17:1336|(18:1340|1342|1344|(0)|1339|584|(13:586|588|590|591|(9:1323|1325|594|(2:597|599)|600|(4:1304|1306|1312|(0)(0))|602|603|(0)(0))|593|594|(0)|600|(0)|602|603|(0)(0))|1326|591|(0)|593|594|(0)|600|(0)|602|603|(0)(0))|1338|1339|584|(0)|1326|591|(0)|593|594|(0)|600|(0)|602|603|(0)(0))|576|577|(16:579|581|(0)(0)|584|(0)|1326|591|(0)|593|594|(0)|600|(0)|602|603|(0)(0))|1328|581|(0)(0)|584|(0)|1326|591|(0)|593|594|(0)|600|(0)|602|603|(0)(0))(1:1710))(1:1713)|1711)(1:1714)|1712|434|(0)(0)|438|(74:440|442|(73:444|446|(0)|1695|450|(0)|453|(0)(0)|465|(0)|470|(0)|(0)|492|(0)|(0)|1642|1644|1646|(1:1647)|1668|1660|1661|(0)|1641|501|(0)|506|(0)|513|(0)(0)|516|(0)|519|(0)(0)|522|(0)(0)|525|(0)|528|(0)(0)|540|(0)(0)|559|(0)(0)|562|(0)|564|565|(0)(0)|569|(0)|574|(0)|576|577|(0)|1328|581|(0)(0)|584|(0)|1326|591|(0)|593|594|(0)|600|(0)|602|603|(0)(0))|1696|449|450|(0)|453|(0)(0)|465|(0)|470|(0)|(0)|492|(0)|(0)|1642|1644|1646|(1:1647)|1668|1660|1661|(0)|1641|501|(0)|506|(0)|513|(0)(0)|516|(0)|519|(0)(0)|522|(0)(0)|525|(0)|528|(0)(0)|540|(0)(0)|559|(0)(0)|562|(0)|564|565|(0)(0)|569|(0)|574|(0)|576|577|(0)|1328|581|(0)(0)|584|(0)|1326|591|(0)|593|594|(0)|600|(0)|602|603|(0)(0))|1697|1695|450|(0)|453|(0)(0)|465|(0)|470|(0)|(0)|492|(0)|(0)|1642|1644|1646|(1:1647)|1668|1660|1661|(0)|1641|501|(0)|506|(0)|513|(0)(0)|516|(0)|519|(0)(0)|522|(0)(0)|525|(0)|528|(0)(0)|540|(0)(0)|559|(0)(0)|562|(0)|564|565|(0)(0)|569|(0)|574|(0)|576|577|(0)|1328|581|(0)(0)|584|(0)|1326|591|(0)|593|594|(0)|600|(0)|602|603|(0)(0))(26:1715|(1:1717)(1:1881)|1718|(3:1867|(4:1870|(2:1872|(1:1874)(2:1875|1876))(2:1878|1879)|1877|1868)|1880)|1720|1721|(1:1866)|1725|(1:1727)|1728|(1:1730)(1:1863)|1731|(3:(1:1736)|1737|(1:1739)(1:1861))(1:1862)|1740|(1:1744)(1:1860)|1745|(1:1747)(1:1859)|1748|(4:1750|(3:1752|(3:1825|(1:1827)(1:1829)|1828)(2:1754|1755)|1756)(2:1830|(1:1834)(6:1835|(3:1837|(1:1839)(1:1845)|1840)(1:1846)|1841|(1:1843)|1844|1758))|1757|1758)(3:1847|(3:1853|(1:1855)(1:1857)|1856)|1858)|1759|(1:1763)|1764|(1:1766)(2:1782|(2:1784|(2:1786|(2:1788|(1:1790)(5:1791|(1:1793)(1:1799)|1794|(1:1796)(1:1798)|1797))(5:1800|(1:1802)(1:1808)|1803|(1:1805)(1:1807)|1806))(3:1809|(1:1811)(1:1813)|1812))(5:1814|(1:1816)|1817|(1:1819)(1:1821)|1820))|1767|(1:1769)(4:1771|(1:1777)(1:1781)|1778|(1:1780))|1770))(5:1882|(1:1884)(1:1895)|1885|(1:1887)(3:1890|(1:1892)(1:1894)|1893)|1888))(12:1896|(11:1900|(1:(1:1903))(1:2035)|1904|(2:1906|(5:1908|(3:1910|(1:1912)(1:1960)|1913)(3:1961|(1:1963)(1:1965)|1964)|1914|(1:1916)|1917)(7:1966|(3:1968|(1:1970)(1:1995)|1971)(3:1996|(1:1998)(1:2000)|1999)|1972|(1:1974)|1975|(1:1977)(6:1979|(1:1981)(1:1994)|(3:1983|(1:1985)(1:1989)|1986)|(1:1991)(1:1993)|1992|1988)|1978))(11:2001|(3:2003|(1:2005)(1:2029)|2006)(3:2030|(1:2032)(1:2034)|2033)|2007|(1:2009)|2010|(1:2012)(1:2028)|2013|(2:2015|(1:2017)(3:2023|(1:2025)|2026))(1:2027)|2018|(1:2020)(1:2022)|2021)|1918|(1:1920)(2:1949|(3:1951|(2:1953|(1:1955)(1:1957))(1:1958)|1956)(1:1959))|1921|(1:(4:1924|(1:1940)|1928|(1:1930))(2:1941|(3:1943|(1:1945)(1:1947)|1946)))(1:1948)|1931|(3:1935|(1:1937)|1938)|1939)|2036|1904|(0)(0)|1918|(0)(0)|1921|(0)(0)|1931|(4:1933|1935|(0)|1938)|1939)|624|(2:632|(1:634))(3:1138|(1:1147)|1140)|635|(1:643)|644|(1:646)|647|(5:651|(1:653)(1:1136)|654|(1:656)|657)(1:1137)|658|(1:660)(4:1129|(1:1131)|1132|(1:1134)(1:1135))|661|(2:663|(4:667|(7:669|(1:671)(1:681)|672|(1:674)(1:680)|675|(1:677)(1:679)|678)|682|(3:684|(1:686)(1:688)|687)))|689)(20:2037|(3:2039|(1:2041)(1:2193)|2042)(3:2194|(1:2196)(1:2198)|2197)|2043|(1:2045)|2046|(4:2050|2051|(1:2053)(1:2056)|2054)|2059|(1:2061)(4:2182|(3:2184|(2:2186|2187)(2:2189|2190)|2188)|2191|2192)|2062|(4:2064|(3:2066|(2:2068|2069)(2:2071|2072)|2070)|2073|2074)|2075|(4:2077|(3:2079|(1:2084)(2:2081|2082)|2083)|2085|2086)|2087|(2:2089|(1:2093))|(1:2097)|2098|(4:2100|(1:2180)|2103|(2:2107|(3:2111|(2:2113|(1:2115))(1:2117)|2116)))(1:2181)|2118|(11:2122|(1:2124)|2125|(1:2133)(2:2159|(1:2167)(2:2170|(1:2176)))|2134|(1:2138)|2139|(1:2153)|2154|(1:2156)|2157)(1:2177)|2158)|1889|624|(16:626|628|632|(0)|635|(4:637|639|641|643)|644|(0)|647|(11:649|651|(0)(0)|654|(0)|657|658|(0)(0)|661|(0)|689)|1137|658|(0)(0)|661|(0)|689)|1138|(2:1141|1147)|1140|635|(0)|644|(0)|647|(0)|1137|658|(0)(0)|661|(0)|689)(51:2217|(1:2219)|2220|(1:2222)(1:2519)|2223|(1:2225)(1:2518)|2226|(1:2228)|2229|(1:(2:2516|2517)(2:2231|(1:2233)(2:2234|2235)))|2236|(2:2238|(2:2240|(1:2242)(1:2510))(2:2511|(1:2513)(1:2514)))(1:2515)|2243|(1:(1:2248)(1:(1:2252)(1:2253)))|2254|(1:2256)(1:2509)|2257|(6:2259|(1:2263)(1:2286)|2264|(3:2266|(1:2268)(1:2280)|2269)(3:2281|(1:2283)(1:2285)|2284)|2270|(3:2274|(1:2276)(1:2278)|2277)(1:2279))|2287|(2:2293|2294)|2295|(1:2297)|2298|(2:2300|(2:2302|(2:2303|(1:2306)(1:2305)))(0))(2:2478|(2:2479|(1:2497)(3:2481|(4:2484|(1:2486)(1:2490)|2487|2488)(2:2491|(1:2494)(2:2495|2496))|2489)))|2307|(1:2313)|2314|(1:2320)(1:2477)|2321|(1:2323)(5:2457|(3:2459|(1:2465)(1:2467)|2466)|2468|(3:2472|(1:2474)|2475)|2476)|2324|(1:2326)(1:2456)|2327|(1:2329)(1:2455)|2330|(1:2332)(1:2454)|2333|(7:2335|(2:2337|(1:(1:2360)(2:2339|(1:2341)(5:2342|2343|(2:2347|2348)(1:2359)|(2:2350|(1:2354))(1:2356)|2355))))(0)|(2:2362|(1:(1:2369)(2:2364|(1:2366)(2:2367|2368))))(0)|(1:2375)(1:2383)|2376|(2:2378|2379)(2:2381|2382)|2380)|2384|(3:2387|(1:2389)|2390)|2391|(3:2393|(2:2395|2396)(2:2398|2399)|2397)|2400|2401|(1:2405)(2:2449|(1:2453))|2406|(1:2408)|2409|(7:2425|(2:(2:2428|(2:2430|2431)(2:2433|2434))(2:2435|2436)|2432)|2437|2438|(1:2440)(1:2448)|2441|(1:2447))|2413|(4:2417|(1:2419)(1:2423)|2420|(1:2422))))(13:2520|(1:2524)(11:2574|(1:2576)|2529|2530|(3:2532|(1:2534)(1:2567)|2535)(3:2568|(1:2570)(1:2572)|2571)|2536|(4:2542|(1:2544)|2545|(1:2547))|2548|(1:2550)|2551|(2:2553|(7:2555|(1:2557)|2558|(1:2560)|2561|(1:2565)|2566)))|2525|(9:2573|2530|(0)(0)|2536|(6:2538|2540|2542|(0)|2545|(0))|2548|(0)|2551|(0))|2529|2530|(0)(0)|2536|(0)|2548|(0)|2551|(0)))(10:2578|(1:2580)(1:2628)|2581|(1:2585)(1:2627)|2586|(3:2588|(1:2590)(1:2617)|2591)(3:2618|(1:2620)(1:2622)|2621)|2592|(1:2594)|2595|(4:2597|(1:2599)(1:2616)|2600|(9:2602|(1:2604)(1:2615)|2605|(1:2607)|2608|(1:2610)|2611|(1:2613)|2614))))(29:2629|(1:2633)(1:2728)|2634|(1:2636)(1:2723)|2637|(3:2639|(1:2641)(1:2717)|2642)(3:2718|(1:2720)(1:2722)|2721)|2643|(1:2645)(1:2716)|2646|(1:2648)|(2:2650|(16:2654|2655|(3:2657|(1:2659)(1:2711)|2660)(1:2712)|2661|(1:(1:2666)(2:2706|(1:2708)(1:2709)))(1:2710)|2667|(1:2671)|2672|(1:2680)(2:2701|(1:2705))|2681|(1:2683)|2684|(2:2686|(2:2688|(1:2690)))(1:2700)|2691|(3:2695|(1:2697)|2698)|2699)(1:2713))(1:2715)|2714|2655|(0)(0)|2661|(0)(0)|2667|(2:2669|2671)|2672|(10:2674|2676|2680|2681|(0)|2684|(0)(0)|2691|(4:2693|2695|(0)|2698)|2699)|2701|(2:2703|2705)|2681|(0)|2684|(0)(0)|2691|(0)|2699))(10:2729|(3:2731|(1:2733)(1:2770)|2734)(3:2771|(1:2773)(1:2775)|2774)|2735|(1:2737)|2738|(1:(2:2741|(2:2743|(1:2745)(1:2752))(2:2753|(1:2755)(1:2756)))(2:2757|(1:2759)(1:2760)))(1:(2:2762|(1:2764)(1:2765))(2:2766|(1:2768)(1:2769)))|2746|(1:2748)|2749|(1:2751))|2424)(63:2776|(1:2778)(1:4063)|2779|(5:2781|(1:2783)(1:4057)|2784|(1:2796)(1:4056)|2797)(3:4058|(1:4060)(1:4062)|4061)|2798|(3:2800|(1:2802)(1:2804)|2803)|2805|(1:2807)|2808|(1:2812)(1:4055)|2813|(1:2819)(1:4054)|2820|(1:2824)(1:4053)|2825|(1:2827)(1:4052)|2828|(1:2836)(1:4051)|2837|(1:2839)(1:4050)|2840|(1:(2:2843|(43:2855|(6:2858|(2:2860|(2:2866|2865)(1:2862))(1:2867)|2863|2864|2865|2856)|2868|2869|2870|(2:2876|(16:2878|(1:2881)(1:3923)|2882|(3:2884|(1:2886)(1:2888)|2887)|2889|(1:2893)(1:3922)|2894|(2:2896|(3:2898|(1:2900)|2901))|2902|(1:2904)|2905|(1:2909)|2910|2911|(1:2917)(20:2919|(1:(1:2922)(1:3918))(1:(1:3920)(1:3921))|2923|(1:2925)|2926|(2:2928|(3:2930|(1:2932)(1:3839)|2933)(3:3840|(1:3842)(1:3844)|3843))(19:3845|(17:3917|(15:3914|(10:3911|3855|(1:3857)(1:(1:3907)(1:3908))|3858|(1:3863)|3864|(1:3882)(1:3905)|(1:3896)(1:3904)|(1:3901)(1:3903)|3902)|3854|3855|(0)(0)|3858|(2:3861|3863)|3864|(14:3866|3868|3870|3872|3874|3876|3878|3880|3882|(5:3884|3896|(3:3899|3901|3902)|3903|3902)|3904|(0)|3903|3902)|3905|(0)|3904|(0)|3903|3902)|3851|(1:3853)(14:3909|3911|3855|(0)(0)|3858|(0)|3864|(0)|3905|(0)|3904|(0)|3903|3902)|3854|3855|(0)(0)|3858|(0)|3864|(0)|3905|(0)|3904|(0)|3903|3902)|3848|(1:3850)(16:3912|3914|(0)(0)|3854|3855|(0)(0)|3858|(0)|3864|(0)|3905|(0)|3904|(0)|3903|3902)|3851|(0)(0)|3854|3855|(0)(0)|3858|(0)|3864|(0)|3905|(0)|3904|(0)|3903|3902)|2934|(2:2936|(2:2938|(2:2940|(1:2942)(1:3835))(1:3836))(1:3837))(1:3838)|2943|(1:2945)(1:3834)|2946|(1:2949)|(1:2951)(18:3742|3743|3744|3745|3746|(3:3821|3822|3823)(2:3748|3749)|3750|3751|3752|3753|3754|(1:3756)(1:3814)|3757|3758|(11:3762|3763|3764|3765|(8:(8:(1:3794)(1:3796)|3795|3770|3771|3772|3773|3774|3775)(1:3768)|3769|3770|3771|3772|3773|3774|3775)(1:3798)|(3:(1:3782)(2:3783|(1:3785))|3779|3780)(1:3777)|3778|3779|3780|3759|3760)|3802|3803|3804)|(1:2953)(14:3662|3663|3664|(1:3666)(1:3740)|3667|(1:3669)(2:3738|3739)|3670|3671|3672|(12:3676|(1:3678)(1:3728)|3679|3680|(3:3682|3683|3684)(2:3726|3727)|(8:(8:(1:3718)(1:3720)|3719|3689|3690|3691|3692|3693|3694)(1:3687)|3688|3689|3690|3691|3692|3693|3694)(1:3722)|(3:(1:3701)(2:3702|(1:3704))|3698|3699)(1:3696)|3697|3698|3699|3673|3674)|3729|3730|(1:3712)|3713)|(17:2956|2957|(1:2959)(1:3658)|2960|2961|2962|2963|2964|2965|2966|(6:3652|2972|(1:2974)(2:3649|3650)|2975|2976|2977)|2971|2972|(0)(0)|2975|2976|2977)(1:3661)|(18:3555|3556|3557|(1:3559)(1:3643)|(13:3642|3563|(10:3635|(1:3637)(1:3639)|3638|3570|(5:3573|3574|(4:3579|(1:3581)(1:3584)|3582|3583)(2:3576|3577)|3578|3571)|3587|3588|(9:3591|(1:3628)|(1:(3:3596|3597|3598)(1:3623))(1:3624)|(4:(1:3616)(1:(1:3618)(2:3619|(1:3621)))|3602|(4:(1:3608)(1:3614)|(1:3610)(1:3613)|3611|3612)(2:3604|3605)|3606)(1:3600)|3601|3602|(0)(0)|3606|3589)|3629|3630)|3566|(1:3568)(1:3632)|3569|3570|(1:3571)|3587|3588|(1:3589)|3629|3630)|3562|3563|(1:3565)(11:3633|3635|(0)(0)|3638|3570|(1:3571)|3587|3588|(1:3589)|3629|3630)|3566|(0)(0)|3569|3570|(1:3571)|3587|3588|(1:3589)|3629|3630)|2979|(1:2985)(1:3554)|(1:2987)|(8:(1:(1:2991)(6:3316|(1:3318)(1:3320)|3319|2995|(8:3001|(1:3008)(26:(1:3039)(1:3314)|3040|(1:3042)|3043|(2:3045|(1:3049)(2:3286|(2:3292|(1:3294))(3:3295|(1:3297)(1:3299)|3298)))(1:3300)|3050|(1:3054)|3055|(1:3057)(1:3285)|3058|(1:(1:3061)(1:3281))(2:3282|(1:3284))|3062|(1:3064)|(2:3068|(9:3072|(2:3074|(1:3076)(1:3266))(1:3267)|3077|(2:3083|(1:3085))(2:3263|(5:3265|3087|(1:3089)|3090|(1:3092)))|3086|3087|(0)|3090|(0))(4:3268|(3:3272|(2:3274|(1:3276)(2:3277|3278))|3279)|3270|3271))(1:3280)|3093|(1:3095)(3:3259|(1:3261)|3262)|3096|(1:3100)(1:3258)|3101|(2:3103|(2:3105|(2:3107|(3:3109|(2:3111|(4:3115|(2:3154|(2:3156|(1:3160)(2:3162|3119))(1:3163))(1:3117)|3118|3119)(10:3164|(3:3166|(1:3168)(1:3204)|3169)(1:3205)|3170|(1:3174)(1:3203)|3175|(1:3178)(2:3180|(7:3187|(1:3189)(1:3197)|3190|(1:3192)|3193|(1:3195)|3196)(3:3198|(1:3200)(1:3202)|3201))|3179|3121|(1:3126)(2:3128|(7:3130|3131|(1:3133)|3134|(2:3146|(2:3148|(1:3139)))|3137|(0)))|3127))(3:3206|(1:3214)(2:3216|(3:3220|(1:3224)(1:3226)|3225)(1:3227))|3215)|3161)(5:3228|(1:3232)|3233|(4:3239|3240|(1:3244)(1:3246)|3245)(2:3235|3236)|3237))(2:3249|(1:3251)(1:3252)))(2:3253|(1:3255)(1:3256)))(1:3257)|3120|3121|(3:3123|3126|3127)|3128|(0)|3127)|3009|(4:3011|(2:3013|(1:3015)(1:3027))(1:3028)|3016|(5:3018|(1:3020)(1:3026)|3021|(1:3023)(1:3025)|3024))|3029|(1:3036)|3031|3032)(1:3315)|3033))(14:3321|(1:3323)(2:3345|(11:3347|3325|(1:3328)(1:3344)|(1:3330)(1:3343)|3331|(1:3333)(1:3342)|3334|(1:3336)(1:3341)|3337|(1:3339)|3340))|3324|3325|(9:3328|(0)(0)|3331|(0)(0)|3334|(0)(0)|3337|(0)|3340)|3344|(0)(0)|3331|(0)(0)|3334|(0)(0)|3337|(0)|3340)|2992|2993|2994|2995|(41:2997|2999|3001|(10:3004|3006|3008|3009|(0)|3029|(2:3034|3036)|3031|3032|3033)|(35:3039|3040|(0)|3043|(0)(0)|3050|(2:3052|3054)|3055|(0)(0)|3058|(0)(0)|3062|(0)|(27:3066|3068|(32:3070|3072|(0)(0)|3077|(28:3079|3083|(0)|3086|3087|(0)|3090|(0)|3093|(0)(0)|3096|(17:3098|3100|3101|(0)(0)|3120|3121|(0)|3128|(0)|3127|3009|(0)|3029|(0)|3031|3032|3033)|3258|3101|(0)(0)|3120|3121|(0)|3128|(0)|3127|3009|(0)|3029|(0)|3031|3032|3033)|3263|(0)|3086|3087|(0)|3090|(0)|3093|(0)(0)|3096|(0)|3258|3101|(0)(0)|3120|3121|(0)|3128|(0)|3127|3009|(0)|3029|(0)|3031|3032|3033)|3268|(0)|3270|3271|3093|(0)(0)|3096|(0)|3258|3101|(0)(0)|3120|3121|(0)|3128|(0)|3127|3009|(0)|3029|(0)|3031|3032|3033)|3280|3093|(0)(0)|3096|(0)|3258|3101|(0)(0)|3120|3121|(0)|3128|(0)|3127|3009|(0)|3029|(0)|3031|3032|3033)|3302|3039|3040|(0)|3043|(0)(0)|3050|(0)|3055|(0)(0)|3058|(0)(0)|3062|(0)|(0)|3280|3093|(0)(0)|3096|(0)|3258|3101|(0)(0)|3120|3121|(0)|3128|(0)|3127|3009|(0)|3029|(0)|3031|3032|3033)|3315|3033)(7:3348|(2:3350|(3:3352|(3:3354|(2:3358|(2:3360|(9:3362|(1:3364)|3365|(2:3367|(2:3369|(2:3371|(1:3375))(1:3377))(6:3378|(1:3382)|3383|(1:3387)|3388|3389))(3:3391|(3:3393|(1:3395)(1:3398)|3396)(3:3399|(1:3401)(1:3403)|3402)|3397)|3390|2995|(0)|3315|3033)(5:3404|(1:3406)(1:3428)|3407|(4:3413|(2:3414|(1:3426)(2:3416|(1:3418)(2:3419|3420)))|3421|(1:3425))|3427))(3:3429|(4:3435|(2:3436|(1:3448)(2:3438|(1:3440)(2:3441|3442)))|3443|(1:3447))|3449))(3:3450|(4:3456|(2:3457|(1:3469)(2:3459|(1:3461)(2:3462|3463)))|3464|(1:3468))|3470)|3376)(13:3471|(1:3473)(1:3513)|3474|(1:3476)|3477|(1:3479)(1:3512)|3480|(1:3482)|(1:3484)|3485|(4:3495|(2:3496|(1:3511)(2:3498|(1:3500)(3:3501|3502|(1:3504)(1:3510))))|3505|(1:3509))|3487|3488)|2993)(9:3514|(1:3552)(1:3516)|3517|(1:3519)(1:3549)|3520|(1:(1:3523))(1:3548)|3524|(5:3530|(3:3533|(1:3537)(1:3539)|3531)|3546|3540|(1:3544))|3547))(1:3553)|2994|2995|(0)|3315|3033))|2918))|3924|2882|(0)|2889|(33:2891|2893|2894|(0)|2902|(0)|2905|(2:2907|2909)|2910|2911|(4:2913|2915|2917|2918)|2919|(0)(0)|2923|(0)|2926|(0)(0)|2934|(0)(0)|2943|(0)(0)|2946|(1:2949)|(0)(0)|(0)(0)|(23:2956|2957|(0)(0)|2960|2961|2962|2963|2964|2965|2966|(1:2968)|3652|2972|(0)(0)|2975|2976|2977|(0)|2979|(5:2981|2983|2985|(0)|(0)(0))|3554|(0)|(0)(0))|3661|(0)|2979|(0)|3554|(0)|(0)(0))|3922|2894|(0)|2902|(0)|2905|(0)|2910|2911|(0)|2919|(0)(0)|2923|(0)|2926|(0)(0)|2934|(0)(0)|2943|(0)(0)|2946|(0)|(0)(0)|(0)(0)|(0)|3661|(0)|2979|(0)|3554|(0)|(0)(0))))(2:3927|(2:3929|(2:3931|(2:3933|(2:3935|(2:3937|(2:3939|(2:3941|(8:3943|3944|3945|(1:3947)(1:4021)|3948|(5:4006|(1:4020)|4009|4010|(4:4012|4013|4014|(2:3952|(7:3958|(1:3979)|3961|(1:3975)|3964|(1:3971)|3967))(9:3980|(1:4005)|3983|(1:4001)|3986|(1:3997)|3989|(1:3991)(1:3993)|3992)))|3950|(0)(0)))(42:4023|(1:(2:4042|4043)(4:4025|(1:(1:4041)(2:4027|(1:4029)(2:4030|4031)))|4032|(2:4034|(1:4036)(2:4037|4038))(2:4039|4040)))|3926|2870|(4:2872|2874|2876|(0))|3924|2882|(0)|2889|(0)|3922|2894|(0)|2902|(0)|2905|(0)|2910|2911|(0)|2919|(0)(0)|2923|(0)|2926|(0)(0)|2934|(0)(0)|2943|(0)(0)|2946|(0)|(0)(0)|(0)(0)|(0)|3661|(0)|2979|(0)|3554|(0)|(0)(0)))(1:4044))(1:4045))(1:4046))(1:4047))(1:4048))(1:4049))|3925|3926|2870|(0)|3924|2882|(0)|2889|(0)|3922|2894|(0)|2902|(0)|2905|(0)|2910|2911|(0)|2919|(0)(0)|2923|(0)|2926|(0)(0)|2934|(0)(0)|2943|(0)(0)|2946|(0)|(0)(0)|(0)(0)|(0)|3661|(0)|2979|(0)|3554|(0)|(0)(0))|690|(4:1016|(10:1024|(1:1026)(1:1062)|1027|(3:1035|(1:1037)|1038)|1039|1040|(3:1049|(3:1051|(1:1053)|1054)(3:1056|(1:1058)|1059)|1055)(1:1042)|1043|(1:1045)(1:1048)|1046)|1063|(8:1067|1068|(4:1115|(5:1118|1119|(1:1124)(2:1121|1122)|1123|1116)|1125|1126)|1071|(2:1111|(12:1079|(1:1081)(1:1107)|1082|(1:1106)|1085|(1:1103)|1088|(1:1090)(1:1100)|1091|(1:1093)(2:1096|(2:1098|1095))|1094|1095)(1:1078))|1074|(1:1076)(1:1108)|(0)(0)))|696|(1:1011)|700|701|(19:956|957|958|959|(1:961)(1:1005)|962|963|964|965|966|(1:968)(1:999)|969|(4:972|(2:974|975)(2:977|(2:979|980)(2:981|982))|976|970)|983|(1:985)(1:997)|986|(1:996)|991|(2:993|(1:995)))(1:703)|704|(5:706|(1:708)(1:717)|709|(1:715)|716)|718|(1:720)(1:951)|721|(11:846|(1:848)(1:950)|849|(1:851)(1:949)|852|(4:(1:855)(1:861)|856|(1:858)(1:860)|859)|862|(1:868)(3:945|(1:947)|948)|869|(1:871)(4:873|(3:875|(3:877|(14:880|(1:882)(1:939)|(1:884)(1:938)|885|(6:937|892|(1:894)|895|(6:899|900|(7:907|(3:930|920|(5:923|(1:925)(1:926)|913|904|905)(1:922))|910|(2:914|(4:917|(1:919)|920|(0)(0))(1:916))(1:912)|913|904|905)(1:902)|903|904|905)|906)|888|(1:890)(1:934)|891|892|(0)|895|(1:933)(7:897|899|900|(0)(0)|903|904|905)|906|878)|940)(1:942)|941)|943|944)|872)(2:723|724)|725|(3:727|(1:729)(1:731)|730)|732|(1:736)(1:(2:830|(1:838))(1:839))|737|(2:739|(1:743)(2:744|(1:746)))|747|(1:749)|750|(1:752)(2:822|(2:824|(1:826)(1:827))(1:828))|753|(23:755|(1:757)(1:820)|758|(1:760)|761|(1:819)|767|(1:773)(1:818)|774|(1:817)|778|(1:780)(1:816)|781|(8:785|(1:787)|788|(1:790)|791|(1:793)|794|(8:796|797|(2:799|(1:801)(1:802))|803|(2:805|(1:807)(1:808))|809|(1:814)|813))|815|797|(0)|803|(0)|809|(1:811)|814|813)|821)|(6:175|(1:177)|178|(3:180|(1:182)(1:184)|183)|185|(1:187))|188|(6:190|(1:196)(1:205)|(1:198)(1:204)|199|(1:201)(1:203)|202)|206|(1:210)(1:230)|211|(1:219)|220|(1:226)|227|228)|4279|37|(152:39|41|43|45|46|(0)(0)|(2:50|52)|53|(1:55)|4264|(2:75|77)|78|(150:80|82|(0)(0)|(148:86|88|90|(2:92|94)|95|(145:97|99|(0)(0)|102|103|(7:105|107|(2:109|111)|112|(2:116|117)|118|117)|(10:121|123|125|127|129|131|133|135|(2:(0)(0)|139)|(0))|(4:151|(0)(0)|154|(0)(0))|159|(16:167|169|171|173|(0)|188|(0)|206|(8:208|210|211|(4:213|215|217|219)|220|(2:222|226)|227|228)|230|211|(0)|220|(0)|227|228)|231|(134:4254|4256|(0)|235|(136:237|239|(134:241|245|246|(131:248|252|253|254|(130:256|258|260|262|264|265|(0)(0)|268|(123:270|272|274|275|(122:277|279|281|283|287|288|(118:290|292|294|296|297|(0)(0)|300|(116:4218|4222|(115:4224|4226|4230|4231|(4:4235|4237|4239|4241)|4243|4234|304|(0)|307|(3:4205|4207|(3:4208|(0)(0)|4214))(0)|309|310|(0)|4204|314|(3:4199|4201|4203)|316|317|(96:319|321|322|(0)|325|(0)|4195|4197|328|329|(1:331)|4154|(80:4156|4158|(0)|341|(76:343|345|346|(70:349|4064|(72:4066|4068|(0)|4071|(0)(0)|4132|4111|(0)|4113|4114|(0)|4117|355|(0)(0)|690|(1:692)|1012|1014|1016|(12:1018|1020|1024|(0)(0)|1027|(6:1029|1031|1033|1035|(0)|1038)|1039|1040|(0)(0)|1043|(0)(0)|1046)|1063|(1:1065)|1067|1068|(1:1070)(5:1112|1115|(1:1116)|1125|1126)|1071|(1:1073)(45:1109|1111|(0)(0)|696|(1:698)|1009|1011|700|701|(56:952|954|956|957|958|959|(0)(0)|962|963|964|965|966|(0)(0)|969|(1:970)|983|(0)(0)|986|(0)|996|991|(0)|704|(0)|718|(0)(0)|721|(43:840|842|844|846|(0)(0)|849|(0)(0)|852|(0)|862|(32:864|866|868|869|(0)(0)|872|725|(0)|732|(23:734|736|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|945|(0)|948|869|(0)(0)|872|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4138|(64:4148|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4159|(0)(0)|(6:4163|4165|4167|4169|(1:4170)|4185)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4244|4231|(0)|4243|4234|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4251|253|254|(0)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4252|246|(0)|4251|253|254|(0)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4253|254|(0)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|233|234|235|(0)|4253|254|(0)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4260|103|(0)|(0)|(0)|159|(0)|231|(0)|233|234|235|(0)|4253|254|(0)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4261|(0)|95|(0)|4260|103|(0)|(0)|(0)|159|(0)|231|(0)|233|234|235|(0)|4253|254|(0)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4263|(0)|159|(0)|231|(0)|233|234|235|(0)|4253|254|(0)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228)|4266|4268|45|46|(0)(0)|(0)|53|(0)|4264|(0)|78|(0)|4263|(0)|159|(0)|231|(0)|233|234|235|(0)|4253|254|(0)|4250|265|(0)(0)|268|(0)|4248|275|(0)|4247|288|(0)|4246|297|(0)(0)|300|(0)|302|303|304|(0)|307|(0)(0)|309|310|(0)|4204|314|(0)|316|317|(0)|4198|322|(0)|325|(0)|4195|4197|328|329|(0)|4154|(0)|4159|(0)(0)|(0)(0)|4186|(0)(0)|(0)|341|(0)|4153|346|(0)|4149|4151|349|4064|(0)|4138|(0)|4140|4141|4142|(0)(0)|4145|355|(0)(0)|690|(0)|1012|1014|1016|(0)|1063|(0)|1067|1068|(0)(0)|1071|(0)(0)|1074|(0)(0)|(0)(0)|696|(0)|1009|1011|700|701|(0)|703|704|(0)|718|(0)(0)|721|(0)|723|724|725|(0)|732|(0)|(0)(0)|737|(0)|747|(0)|750|(0)(0)|753|(0)|821|(0)|188|(0)|206|(0)|230|211|(0)|220|(0)|227|228|(1:(0))) */
    /* JADX WARN: Can't wrap try/catch for region: R(18:956|957|958|959|(1:961)(1:1005)|(2:962|963)|964|965|966|(1:968)(1:999)|969|(4:972|(2:974|975)(2:977|(2:979|980)(2:981|982))|976|970)|983|(1:985)(1:997)|986|(1:996)|991|(2:993|(1:995))) */
    /* JADX WARN: Can't wrap try/catch for region: R(6:(3:(8:(1:3718)(1:3720)|3719|3689|3690|3691|3692|3693|3694)(1:3687)|3693|3694)|3688|3689|3690|3691|3692) */
    /* JADX WARN: Can't wrap try/catch for region: R(6:(3:(8:(1:3794)(1:3796)|3795|3770|3771|3772|3773|3774|3775)(1:3768)|3774|3775)|3769|3770|3771|3772|3773) */
    /* JADX WARN: Code restructure failed: missing block: B:1000:0x56cf, code lost:
        r0 = move-exception;
     */
    /* JADX WARN: Code restructure failed: missing block: B:1001:0x56d0, code lost:
        org.telegram.messenger.FileLog.e(r0);
     */
    /* JADX WARN: Code restructure failed: missing block: B:1127:0x55a8, code lost:
        r0 = move-exception;
     */
    /* JADX WARN: Code restructure failed: missing block: B:1128:0x55a9, code lost:
        org.telegram.messenger.FileLog.e(r0);
     */
    /* JADX WARN: Code restructure failed: missing block: B:1443:0x0f67, code lost:
        r74.captionWidth = r2;
     */
    /* JADX WARN: Code restructure failed: missing block: B:1581:0x1867, code lost:
        if ((r10.flags & 2) == 0) goto L1538;
     */
    /* JADX WARN: Code restructure failed: missing block: B:1987:0x2163, code lost:
        if (r2 >= (r74.timeWidth + org.telegram.messenger.AndroidUtilities.dp(20 + (!r75.isOutOwner() ? 0 : 20)))) goto L1988;
     */
    /* JADX WARN: Code restructure failed: missing block: B:2577:0x30b0, code lost:
        if (r14.messageOwner.fwd_from.from_id != null) goto L2529;
     */
    /* JADX WARN: Code restructure failed: missing block: B:34:0x0091, code lost:
        if (r74.isPlayingRound == (org.telegram.messenger.MediaController.getInstance().isPlayingMessage(r74.currentMessageObject) && (r7 = r74.delegate) != null && !r7.keyboardIsOpened())) goto L36;
     */
    /* JADX WARN: Code restructure failed: missing block: B:3715:0x4257, code lost:
        r0 = e;
     */
    /* JADX WARN: Code restructure failed: missing block: B:3716:0x4258, code lost:
        r37 = r13;
     */
    /* JADX WARN: Code restructure failed: missing block: B:3721:0x4239, code lost:
        if (r74.isSmallImage != false) goto L3688;
     */
    /* JADX WARN: Code restructure failed: missing block: B:3791:0x40ed, code lost:
        r0 = e;
     */
    /* JADX WARN: Code restructure failed: missing block: B:3792:0x40ee, code lost:
        r59 = r3;
        r60 = r4;
     */
    /* JADX WARN: Code restructure failed: missing block: B:3797:0x40c9, code lost:
        if (r74.isSmallImage != false) goto L3769;
     */
    /* JADX WARN: Code restructure failed: missing block: B:552:0x0d65, code lost:
        if (r2.isSmall != false) goto L1458;
     */
    /* JADX WARN: Code restructure failed: missing block: B:927:0x5ca7, code lost:
        if (r4.button.url.startsWith("tg://resolve") != false) goto L913;
     */
    /* JADX WARN: Multi-variable search skipped. Vars limit reached: 7152 (expected less than 5000) */
    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:1005:0x5635  */
    /* JADX WARN: Removed duplicated region for block: B:1018:0x539b  */
    /* JADX WARN: Removed duplicated region for block: B:101:0x0194  */
    /* JADX WARN: Removed duplicated region for block: B:1026:0x53b4  */
    /* JADX WARN: Removed duplicated region for block: B:1037:0x53f7  */
    /* JADX WARN: Removed duplicated region for block: B:1042:0x5424  */
    /* JADX WARN: Removed duplicated region for block: B:1045:0x545d A[Catch: Exception -> 0x5499, TryCatch #20 {Exception -> 0x5499, blocks: (B:1040:0x541c, B:1043:0x5445, B:1045:0x545d, B:1046:0x5492, B:1048:0x5470, B:1049:0x5425, B:1051:0x542b, B:1054:0x5433, B:1055:0x5444, B:1056:0x5438, B:1059:0x5440), top: B:1039:0x541c }] */
    /* JADX WARN: Removed duplicated region for block: B:1048:0x5470 A[Catch: Exception -> 0x5499, TryCatch #20 {Exception -> 0x5499, blocks: (B:1040:0x541c, B:1043:0x5445, B:1045:0x545d, B:1046:0x5492, B:1048:0x5470, B:1049:0x5425, B:1051:0x542b, B:1054:0x5433, B:1055:0x5444, B:1056:0x5438, B:1059:0x5440), top: B:1039:0x541c }] */
    /* JADX WARN: Removed duplicated region for block: B:1049:0x5425 A[Catch: Exception -> 0x5499, TryCatch #20 {Exception -> 0x5499, blocks: (B:1040:0x541c, B:1043:0x5445, B:1045:0x545d, B:1046:0x5492, B:1048:0x5470, B:1049:0x5425, B:1051:0x542b, B:1054:0x5433, B:1055:0x5444, B:1056:0x5438, B:1059:0x5440), top: B:1039:0x541c }] */
    /* JADX WARN: Removed duplicated region for block: B:105:0x01a1  */
    /* JADX WARN: Removed duplicated region for block: B:1062:0x53b7  */
    /* JADX WARN: Removed duplicated region for block: B:1065:0x54a2  */
    /* JADX WARN: Removed duplicated region for block: B:1070:0x54b0 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:1073:0x54e7 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:1076:0x54f4  */
    /* JADX WARN: Removed duplicated region for block: B:1078:0x5520  */
    /* JADX WARN: Removed duplicated region for block: B:1079:0x5522 A[Catch: Exception -> 0x55a8, TryCatch #19 {Exception -> 0x55a8, blocks: (B:1068:0x54aa, B:1071:0x54dc, B:1074:0x54ee, B:1079:0x5522, B:1082:0x552f, B:1085:0x554a, B:1088:0x5556, B:1091:0x5566, B:1096:0x557d, B:1098:0x558c, B:1100:0x5560, B:1101:0x554f, B:1104:0x5544, B:1107:0x5527, B:1108:0x54f6, B:1109:0x54e8, B:1111:0x5502, B:1112:0x54b1, B:1115:0x54b6, B:1116:0x54cc, B:1126:0x54d4, B:1118:0x5598), top: B:1067:0x54aa }] */
    /* JADX WARN: Removed duplicated region for block: B:1108:0x54f6 A[Catch: Exception -> 0x55a8, TryCatch #19 {Exception -> 0x55a8, blocks: (B:1068:0x54aa, B:1071:0x54dc, B:1074:0x54ee, B:1079:0x5522, B:1082:0x552f, B:1085:0x554a, B:1088:0x5556, B:1091:0x5566, B:1096:0x557d, B:1098:0x558c, B:1100:0x5560, B:1101:0x554f, B:1104:0x5544, B:1107:0x5527, B:1108:0x54f6, B:1109:0x54e8, B:1111:0x5502, B:1112:0x54b1, B:1115:0x54b6, B:1116:0x54cc, B:1126:0x54d4, B:1118:0x5598), top: B:1067:0x54aa }] */
    /* JADX WARN: Removed duplicated region for block: B:1109:0x54e8 A[Catch: Exception -> 0x55a8, TryCatch #19 {Exception -> 0x55a8, blocks: (B:1068:0x54aa, B:1071:0x54dc, B:1074:0x54ee, B:1079:0x5522, B:1082:0x552f, B:1085:0x554a, B:1088:0x5556, B:1091:0x5566, B:1096:0x557d, B:1098:0x558c, B:1100:0x5560, B:1101:0x554f, B:1104:0x5544, B:1107:0x5527, B:1108:0x54f6, B:1109:0x54e8, B:1111:0x5502, B:1112:0x54b1, B:1115:0x54b6, B:1116:0x54cc, B:1126:0x54d4, B:1118:0x5598), top: B:1067:0x54aa }] */
    /* JADX WARN: Removed duplicated region for block: B:1112:0x54b1 A[Catch: Exception -> 0x55a8, TryCatch #19 {Exception -> 0x55a8, blocks: (B:1068:0x54aa, B:1071:0x54dc, B:1074:0x54ee, B:1079:0x5522, B:1082:0x552f, B:1085:0x554a, B:1088:0x5556, B:1091:0x5566, B:1096:0x557d, B:1098:0x558c, B:1100:0x5560, B:1101:0x554f, B:1104:0x5544, B:1107:0x5527, B:1108:0x54f6, B:1109:0x54e8, B:1111:0x5502, B:1112:0x54b1, B:1115:0x54b6, B:1116:0x54cc, B:1126:0x54d4, B:1118:0x5598), top: B:1067:0x54aa }] */
    /* JADX WARN: Removed duplicated region for block: B:1118:0x5598 A[Catch: Exception -> 0x55a8, TRY_LEAVE, TryCatch #19 {Exception -> 0x55a8, blocks: (B:1068:0x54aa, B:1071:0x54dc, B:1074:0x54ee, B:1079:0x5522, B:1082:0x552f, B:1085:0x554a, B:1088:0x5556, B:1091:0x5566, B:1096:0x557d, B:1098:0x558c, B:1100:0x5560, B:1101:0x554f, B:1104:0x5544, B:1107:0x5527, B:1108:0x54f6, B:1109:0x54e8, B:1111:0x5502, B:1112:0x54b1, B:1115:0x54b6, B:1116:0x54cc, B:1126:0x54d4, B:1118:0x5598), top: B:1067:0x54aa }] */
    /* JADX WARN: Removed duplicated region for block: B:1129:0x281c  */
    /* JADX WARN: Removed duplicated region for block: B:1136:0x27f6  */
    /* JADX WARN: Removed duplicated region for block: B:120:0x01c9 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:1290:0x174a  */
    /* JADX WARN: Removed duplicated region for block: B:1303:0x1292 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:1314:0x12bd  */
    /* JADX WARN: Removed duplicated region for block: B:1315:0x12c1  */
    /* JADX WARN: Removed duplicated region for block: B:1322:0x1270 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:1327:0x122f  */
    /* JADX WARN: Removed duplicated region for block: B:1334:0x1155 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:1346:0x11c5  */
    /* JADX WARN: Removed duplicated region for block: B:1347:0x1100  */
    /* JADX WARN: Removed duplicated region for block: B:1354:0x1119  */
    /* JADX WARN: Removed duplicated region for block: B:1356:0x100d  */
    /* JADX WARN: Removed duplicated region for block: B:137:0x020e  */
    /* JADX WARN: Removed duplicated region for block: B:1388:0x0ece A[EXC_TOP_SPLITTER, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:142:0x0223  */
    /* JADX WARN: Removed duplicated region for block: B:1460:0x0d8e  */
    /* JADX WARN: Removed duplicated region for block: B:147:0x020c A[SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:150:0x023c A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:153:0x0247  */
    /* JADX WARN: Removed duplicated region for block: B:156:0x0259  */
    /* JADX WARN: Removed duplicated region for block: B:157:0x025b  */
    /* JADX WARN: Removed duplicated region for block: B:158:0x0249  */
    /* JADX WARN: Removed duplicated region for block: B:161:0x0263 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:1629:0x0d19  */
    /* JADX WARN: Removed duplicated region for block: B:1630:0x0cd6  */
    /* JADX WARN: Removed duplicated region for block: B:1631:0x0ccc  */
    /* JADX WARN: Removed duplicated region for block: B:1632:0x0c6e  */
    /* JADX WARN: Removed duplicated region for block: B:1649:0x0bcf  */
    /* JADX WARN: Removed duplicated region for block: B:1690:0x0b39  */
    /* JADX WARN: Removed duplicated region for block: B:1698:0x0a52  */
    /* JADX WARN: Removed duplicated region for block: B:175:0x59df  */
    /* JADX WARN: Removed duplicated region for block: B:1906:0x1f4b  */
    /* JADX WARN: Removed duplicated region for block: B:190:0x5a2c  */
    /* JADX WARN: Removed duplicated region for block: B:1920:0x2389  */
    /* JADX WARN: Removed duplicated region for block: B:1923:0x23b5  */
    /* JADX WARN: Removed duplicated region for block: B:1937:0x2445  */
    /* JADX WARN: Removed duplicated region for block: B:1948:0x23ff  */
    /* JADX WARN: Removed duplicated region for block: B:1949:0x2396  */
    /* JADX WARN: Removed duplicated region for block: B:2001:0x2178  */
    /* JADX WARN: Removed duplicated region for block: B:208:0x5a5d  */
    /* JADX WARN: Removed duplicated region for block: B:213:0x5a70  */
    /* JADX WARN: Removed duplicated region for block: B:222:0x5aa7  */
    /* JADX WARN: Removed duplicated region for block: B:237:0x02d5  */
    /* JADX WARN: Removed duplicated region for block: B:248:0x02f2  */
    /* JADX WARN: Removed duplicated region for block: B:2532:0x30c9  */
    /* JADX WARN: Removed duplicated region for block: B:2538:0x311a  */
    /* JADX WARN: Removed duplicated region for block: B:2544:0x3132  */
    /* JADX WARN: Removed duplicated region for block: B:2547:0x3152  */
    /* JADX WARN: Removed duplicated region for block: B:2550:0x3162  */
    /* JADX WARN: Removed duplicated region for block: B:2553:0x3175  */
    /* JADX WARN: Removed duplicated region for block: B:2568:0x30e6  */
    /* JADX WARN: Removed duplicated region for block: B:256:0x0311  */
    /* JADX WARN: Removed duplicated region for block: B:2657:0x3402  */
    /* JADX WARN: Removed duplicated region for block: B:2663:0x341d  */
    /* JADX WARN: Removed duplicated region for block: B:267:0x0360  */
    /* JADX WARN: Removed duplicated region for block: B:2683:0x352a  */
    /* JADX WARN: Removed duplicated region for block: B:2686:0x3539  */
    /* JADX WARN: Removed duplicated region for block: B:2693:0x3577  */
    /* JADX WARN: Removed duplicated region for block: B:2697:0x35b3  */
    /* JADX WARN: Removed duplicated region for block: B:2700:0x356d  */
    /* JADX WARN: Removed duplicated region for block: B:270:0x0374  */
    /* JADX WARN: Removed duplicated region for block: B:2710:0x3464  */
    /* JADX WARN: Removed duplicated region for block: B:2712:0x3410  */
    /* JADX WARN: Removed duplicated region for block: B:2776:0x3767  */
    /* JADX WARN: Removed duplicated region for block: B:277:0x0387  */
    /* JADX WARN: Removed duplicated region for block: B:2872:0x3c8a  */
    /* JADX WARN: Removed duplicated region for block: B:2878:0x3c9a  */
    /* JADX WARN: Removed duplicated region for block: B:2884:0x3ce3  */
    /* JADX WARN: Removed duplicated region for block: B:2891:0x3d1f  */
    /* JADX WARN: Removed duplicated region for block: B:2896:0x3d41  */
    /* JADX WARN: Removed duplicated region for block: B:2904:0x3d6c  */
    /* JADX WARN: Removed duplicated region for block: B:2907:0x3d96  */
    /* JADX WARN: Removed duplicated region for block: B:290:0x03ad  */
    /* JADX WARN: Removed duplicated region for block: B:2913:0x3da9  */
    /* JADX WARN: Removed duplicated region for block: B:2921:0x3dce  */
    /* JADX WARN: Removed duplicated region for block: B:2925:0x3e03  */
    /* JADX WARN: Removed duplicated region for block: B:2928:0x3e18  */
    /* JADX WARN: Removed duplicated region for block: B:2936:0x3f9a  */
    /* JADX WARN: Removed duplicated region for block: B:2945:0x3fd3  */
    /* JADX WARN: Removed duplicated region for block: B:2948:0x3fe4 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:2951:0x3fed  */
    /* JADX WARN: Removed duplicated region for block: B:2953:0x4183  */
    /* JADX WARN: Removed duplicated region for block: B:2955:0x42b1 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:2959:0x42ba  */
    /* JADX WARN: Removed duplicated region for block: B:2968:0x42e7 A[Catch: Exception -> 0x4369, TRY_ENTER, TryCatch #3 {Exception -> 0x4369, blocks: (B:2957:0x42b6, B:2968:0x42e7, B:2971:0x4308, B:2972:0x431d, B:2974:0x4345, B:3649:0x4354, B:3652:0x42ee, B:3658:0x42bb), top: B:2956:0x42b6 }] */
    /* JADX WARN: Removed duplicated region for block: B:2974:0x4345 A[Catch: Exception -> 0x4369, TryCatch #3 {Exception -> 0x4369, blocks: (B:2957:0x42b6, B:2968:0x42e7, B:2971:0x4308, B:2972:0x431d, B:2974:0x4345, B:3649:0x4354, B:3652:0x42ee, B:3658:0x42bb), top: B:2956:0x42b6 }] */
    /* JADX WARN: Removed duplicated region for block: B:2981:0x44d5  */
    /* JADX WARN: Removed duplicated region for block: B:2987:0x44e7  */
    /* JADX WARN: Removed duplicated region for block: B:2989:0x44eb  */
    /* JADX WARN: Removed duplicated region for block: B:2997:0x4aa4  */
    /* JADX WARN: Removed duplicated region for block: B:299:0x03c6  */
    /* JADX WARN: Removed duplicated region for block: B:3011:0x5254  */
    /* JADX WARN: Removed duplicated region for block: B:3034:0x534b  */
    /* JADX WARN: Removed duplicated region for block: B:3042:0x4b30  */
    /* JADX WARN: Removed duplicated region for block: B:3045:0x4b44  */
    /* JADX WARN: Removed duplicated region for block: B:3052:0x4b8e  */
    /* JADX WARN: Removed duplicated region for block: B:3057:0x4b9f  */
    /* JADX WARN: Removed duplicated region for block: B:3060:0x4bb0  */
    /* JADX WARN: Removed duplicated region for block: B:3064:0x4bc7  */
    /* JADX WARN: Removed duplicated region for block: B:3066:0x4bd5  */
    /* JADX WARN: Removed duplicated region for block: B:306:0x047c  */
    /* JADX WARN: Removed duplicated region for block: B:3074:0x4be8  */
    /* JADX WARN: Removed duplicated region for block: B:3085:0x4c2a  */
    /* JADX WARN: Removed duplicated region for block: B:3089:0x4c40  */
    /* JADX WARN: Removed duplicated region for block: B:3092:0x4c59  */
    /* JADX WARN: Removed duplicated region for block: B:3095:0x4ca6  */
    /* JADX WARN: Removed duplicated region for block: B:3098:0x4cea  */
    /* JADX WARN: Removed duplicated region for block: B:3103:0x4d48  */
    /* JADX WARN: Removed duplicated region for block: B:3123:0x51a7  */
    /* JADX WARN: Removed duplicated region for block: B:312:0x04fc A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:3130:0x51ba A[EXC_TOP_SPLITTER, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:3139:0x51f4  */
    /* JADX WARN: Removed duplicated region for block: B:319:0x0566  */
    /* JADX WARN: Removed duplicated region for block: B:324:0x0576  */
    /* JADX WARN: Removed duplicated region for block: B:3257:0x517a  */
    /* JADX WARN: Removed duplicated region for block: B:3259:0x4cb8  */
    /* JADX WARN: Removed duplicated region for block: B:3265:0x4c38  */
    /* JADX WARN: Removed duplicated region for block: B:3267:0x4bfb  */
    /* JADX WARN: Removed duplicated region for block: B:3272:0x4c6a  */
    /* JADX WARN: Removed duplicated region for block: B:327:0x0582 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:3282:0x4bb8  */
    /* JADX WARN: Removed duplicated region for block: B:3285:0x4ba1  */
    /* JADX WARN: Removed duplicated region for block: B:3300:0x4b83  */
    /* JADX WARN: Removed duplicated region for block: B:331:0x05b9  */
    /* JADX WARN: Removed duplicated region for block: B:3330:0x454c  */
    /* JADX WARN: Removed duplicated region for block: B:3333:0x455b  */
    /* JADX WARN: Removed duplicated region for block: B:3336:0x4566  */
    /* JADX WARN: Removed duplicated region for block: B:3339:0x457a  */
    /* JADX WARN: Removed duplicated region for block: B:3341:0x4569  */
    /* JADX WARN: Removed duplicated region for block: B:3342:0x455d  */
    /* JADX WARN: Removed duplicated region for block: B:3343:0x454e  */
    /* JADX WARN: Removed duplicated region for block: B:3348:0x4583  */
    /* JADX WARN: Removed duplicated region for block: B:334:0x064b  */
    /* JADX WARN: Removed duplicated region for block: B:343:0x0668  */
    /* JADX WARN: Removed duplicated region for block: B:348:0x0691 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:3555:0x4374  */
    /* JADX WARN: Removed duplicated region for block: B:3568:0x43b6  */
    /* JADX WARN: Removed duplicated region for block: B:3573:0x44a1 A[EXC_TOP_SPLITTER, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:357:0x08d1  */
    /* JADX WARN: Removed duplicated region for block: B:3591:0x4436 A[Catch: Exception -> 0x44cc, TryCatch #28 {Exception -> 0x44cc, blocks: (B:3557:0x4375, B:3566:0x43ac, B:3569:0x43bd, B:3570:0x43f5, B:3571:0x441d, B:3588:0x4425, B:3589:0x442c, B:3591:0x4436, B:3596:0x4451, B:3625:0x4445, B:3628:0x444a, B:3633:0x43a8, B:3635:0x43ca, B:3638:0x43e6, B:3640:0x4394, B:3643:0x4381), top: B:3556:0x4375 }] */
    /* JADX WARN: Removed duplicated region for block: B:3604:0x4480  */
    /* JADX WARN: Removed duplicated region for block: B:3607:0x4481  */
    /* JADX WARN: Removed duplicated region for block: B:3632:0x43b9  */
    /* JADX WARN: Removed duplicated region for block: B:3637:0x43df  */
    /* JADX WARN: Removed duplicated region for block: B:3639:0x43e2  */
    /* JADX WARN: Removed duplicated region for block: B:3649:0x4354 A[Catch: Exception -> 0x4369, TRY_LEAVE, TryCatch #3 {Exception -> 0x4369, blocks: (B:2957:0x42b6, B:2968:0x42e7, B:2971:0x4308, B:2972:0x431d, B:2974:0x4345, B:3649:0x4354, B:3652:0x42ee, B:3658:0x42bb), top: B:2956:0x42b6 }] */
    /* JADX WARN: Removed duplicated region for block: B:3658:0x42bb A[Catch: Exception -> 0x4369, TRY_LEAVE, TryCatch #3 {Exception -> 0x4369, blocks: (B:2957:0x42b6, B:2968:0x42e7, B:2971:0x4308, B:2972:0x431d, B:2974:0x4345, B:3649:0x4354, B:3652:0x42ee, B:3658:0x42bb), top: B:2956:0x42b6 }] */
    /* JADX WARN: Removed duplicated region for block: B:3662:0x4186  */
    /* JADX WARN: Removed duplicated region for block: B:3710:0x429f  */
    /* JADX WARN: Removed duplicated region for block: B:3742:0x3ffd A[EXC_TOP_SPLITTER, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:3834:0x3fd8  */
    /* JADX WARN: Removed duplicated region for block: B:3838:0x3fc7  */
    /* JADX WARN: Removed duplicated region for block: B:3845:0x3e7d  */
    /* JADX WARN: Removed duplicated region for block: B:3853:0x3eae A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:3857:0x3ec2  */
    /* JADX WARN: Removed duplicated region for block: B:3860:0x3ed5 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:3866:0x3efe  */
    /* JADX WARN: Removed duplicated region for block: B:3884:0x3f4b  */
    /* JADX WARN: Removed duplicated region for block: B:3898:0x3f70 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:3906:0x3ec5  */
    /* JADX WARN: Removed duplicated region for block: B:3909:0x3eb0  */
    /* JADX WARN: Removed duplicated region for block: B:3919:0x3de6  */
    /* JADX WARN: Removed duplicated region for block: B:3952:0x3a71 A[Catch: Exception -> 0x3c80, TryCatch #36 {Exception -> 0x3c80, blocks: (B:3952:0x3a71, B:3955:0x3a79, B:3958:0x3a81, B:3961:0x3ab6, B:3964:0x3adf, B:3967:0x3b06, B:3968:0x3ae8, B:3971:0x3af5, B:3972:0x3abf, B:3975:0x3acc, B:3976:0x3a9a, B:3979:0x3aa5, B:3980:0x3b2e, B:3983:0x3b69, B:3986:0x3b92, B:3989:0x3bb9, B:3991:0x3bc0, B:3992:0x3bcc, B:3993:0x3bc7, B:3994:0x3b9b, B:3997:0x3ba8, B:3998:0x3b72, B:4001:0x3b7f, B:4002:0x3b47, B:4005:0x3b52, B:4014:0x3a6d), top: B:4013:0x3a6d }] */
    /* JADX WARN: Removed duplicated region for block: B:3980:0x3b2e A[Catch: Exception -> 0x3c80, TryCatch #36 {Exception -> 0x3c80, blocks: (B:3952:0x3a71, B:3955:0x3a79, B:3958:0x3a81, B:3961:0x3ab6, B:3964:0x3adf, B:3967:0x3b06, B:3968:0x3ae8, B:3971:0x3af5, B:3972:0x3abf, B:3975:0x3acc, B:3976:0x3a9a, B:3979:0x3aa5, B:3980:0x3b2e, B:3983:0x3b69, B:3986:0x3b92, B:3989:0x3bb9, B:3991:0x3bc0, B:3992:0x3bcc, B:3993:0x3bc7, B:3994:0x3b9b, B:3997:0x3ba8, B:3998:0x3b72, B:4001:0x3b7f, B:4002:0x3b47, B:4005:0x3b52, B:4014:0x3a6d), top: B:4013:0x3a6d }] */
    /* JADX WARN: Removed duplicated region for block: B:4066:0x06c0  */
    /* JADX WARN: Removed duplicated region for block: B:4070:0x0719  */
    /* JADX WARN: Removed duplicated region for block: B:4073:0x072a  */
    /* JADX WARN: Removed duplicated region for block: B:4098:0x07f1  */
    /* JADX WARN: Removed duplicated region for block: B:4102:0x082b  */
    /* JADX WARN: Removed duplicated region for block: B:4105:0x082e  */
    /* JADX WARN: Removed duplicated region for block: B:4107:0x0812  */
    /* JADX WARN: Removed duplicated region for block: B:4116:0x087f  */
    /* JADX WARN: Removed duplicated region for block: B:4118:0x0873  */
    /* JADX WARN: Removed duplicated region for block: B:4122:0x088b  */
    /* JADX WARN: Removed duplicated region for block: B:4124:0x0892  */
    /* JADX WARN: Removed duplicated region for block: B:4137:0x0839  */
    /* JADX WARN: Removed duplicated region for block: B:4144:0x070b  */
    /* JADX WARN: Removed duplicated region for block: B:4146:0x070d  */
    /* JADX WARN: Removed duplicated region for block: B:4147:0x06cc A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:4156:0x05c7  */
    /* JADX WARN: Removed duplicated region for block: B:4161:0x05de  */
    /* JADX WARN: Removed duplicated region for block: B:4163:0x05e4  */
    /* JADX WARN: Removed duplicated region for block: B:4172:0x0603  */
    /* JADX WARN: Removed duplicated region for block: B:4188:0x062c  */
    /* JADX WARN: Removed duplicated region for block: B:4189:0x0634  */
    /* JADX WARN: Removed duplicated region for block: B:4194:0x05e0  */
    /* JADX WARN: Removed duplicated region for block: B:4199:0x0511  */
    /* JADX WARN: Removed duplicated region for block: B:4205:0x04a7  */
    /* JADX WARN: Removed duplicated region for block: B:4210:0x5cc2  */
    /* JADX WARN: Removed duplicated region for block: B:4217:0x04a5 A[EDGE_INSN: B:4217:0x04a5->B:309:0x04a5 ?: BREAK  , SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:4218:0x03ee  */
    /* JADX WARN: Removed duplicated region for block: B:4233:0x0416 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:4245:0x03ca  */
    /* JADX WARN: Removed duplicated region for block: B:4249:0x0362  */
    /* JADX WARN: Removed duplicated region for block: B:4254:0x02ae  */
    /* JADX WARN: Removed duplicated region for block: B:4258:0x02ce  */
    /* JADX WARN: Removed duplicated region for block: B:4259:0x0196  */
    /* JADX WARN: Removed duplicated region for block: B:4262:0x015a  */
    /* JADX WARN: Removed duplicated region for block: B:4265:0x00e3  */
    /* JADX WARN: Removed duplicated region for block: B:436:0x0a47  */
    /* JADX WARN: Removed duplicated region for block: B:448:0x0a92  */
    /* JADX WARN: Removed duplicated region for block: B:452:0x0ac5  */
    /* JADX WARN: Removed duplicated region for block: B:455:0x0acf  */
    /* JADX WARN: Removed duplicated region for block: B:467:0x0b48  */
    /* JADX WARN: Removed duplicated region for block: B:472:0x0b5b  */
    /* JADX WARN: Removed duplicated region for block: B:481:0x0b76  */
    /* JADX WARN: Removed duplicated region for block: B:48:0x00e1  */
    /* JADX WARN: Removed duplicated region for block: B:494:0x0ba7  */
    /* JADX WARN: Removed duplicated region for block: B:498:0x0bb2 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:500:0x0c1f A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:503:0x0c2f  */
    /* JADX WARN: Removed duplicated region for block: B:508:0x0c4a  */
    /* JADX WARN: Removed duplicated region for block: B:50:0x00e7  */
    /* JADX WARN: Removed duplicated region for block: B:515:0x0c66  */
    /* JADX WARN: Removed duplicated region for block: B:518:0x0c9c  */
    /* JADX WARN: Removed duplicated region for block: B:521:0x0cc9  */
    /* JADX WARN: Removed duplicated region for block: B:524:0x0cd4  */
    /* JADX WARN: Removed duplicated region for block: B:527:0x0ce3  */
    /* JADX WARN: Removed duplicated region for block: B:530:0x0cea  */
    /* JADX WARN: Removed duplicated region for block: B:542:0x0d2e  */
    /* JADX WARN: Removed duplicated region for block: B:557:0x0d7f  */
    /* JADX WARN: Removed duplicated region for block: B:55:0x00f9  */
    /* JADX WARN: Removed duplicated region for block: B:561:0x0ec7  */
    /* JADX WARN: Removed duplicated region for block: B:567:0x10fe A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:571:0x1132  */
    /* JADX WARN: Removed duplicated region for block: B:579:0x11fd  */
    /* JADX WARN: Removed duplicated region for block: B:583:0x1219  */
    /* JADX WARN: Removed duplicated region for block: B:586:0x125f  */
    /* JADX WARN: Removed duplicated region for block: B:596:0x1280 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:605:0x12d7  */
    /* JADX WARN: Removed duplicated region for block: B:634:0x2777  */
    /* JADX WARN: Removed duplicated region for block: B:637:0x2792  */
    /* JADX WARN: Removed duplicated region for block: B:646:0x27c0  */
    /* JADX WARN: Removed duplicated region for block: B:649:0x27d8  */
    /* JADX WARN: Removed duplicated region for block: B:653:0x27f4  */
    /* JADX WARN: Removed duplicated region for block: B:656:0x280b  */
    /* JADX WARN: Removed duplicated region for block: B:660:0x281a  */
    /* JADX WARN: Removed duplicated region for block: B:663:0x2853  */
    /* JADX WARN: Removed duplicated region for block: B:692:0x5374  */
    /* JADX WARN: Removed duplicated region for block: B:698:0x55b1  */
    /* JADX WARN: Removed duplicated region for block: B:706:0x5714  */
    /* JADX WARN: Removed duplicated region for block: B:720:0x5755  */
    /* JADX WARN: Removed duplicated region for block: B:727:0x5841  */
    /* JADX WARN: Removed duplicated region for block: B:734:0x585f  */
    /* JADX WARN: Removed duplicated region for block: B:739:0x589d  */
    /* JADX WARN: Removed duplicated region for block: B:749:0x58dc  */
    /* JADX WARN: Removed duplicated region for block: B:752:0x58e6  */
    /* JADX WARN: Removed duplicated region for block: B:755:0x5923  */
    /* JADX WARN: Removed duplicated region for block: B:75:0x0133  */
    /* JADX WARN: Removed duplicated region for block: B:799:0x59ab  */
    /* JADX WARN: Removed duplicated region for block: B:805:0x59bb  */
    /* JADX WARN: Removed duplicated region for block: B:80:0x0143  */
    /* JADX WARN: Removed duplicated region for block: B:822:0x58ec  */
    /* JADX WARN: Removed duplicated region for block: B:830:0x5865  */
    /* JADX WARN: Removed duplicated region for block: B:839:0x5883  */
    /* JADX WARN: Removed duplicated region for block: B:840:0x576a  */
    /* JADX WARN: Removed duplicated region for block: B:848:0x578d  */
    /* JADX WARN: Removed duplicated region for block: B:84:0x0156  */
    /* JADX WARN: Removed duplicated region for block: B:851:0x57ad  */
    /* JADX WARN: Removed duplicated region for block: B:854:0x57bd  */
    /* JADX WARN: Removed duplicated region for block: B:871:0x5833  */
    /* JADX WARN: Removed duplicated region for block: B:873:0x5835  */
    /* JADX WARN: Removed duplicated region for block: B:894:0x5c10  */
    /* JADX WARN: Removed duplicated region for block: B:902:0x5c49  */
    /* JADX WARN: Removed duplicated region for block: B:907:0x5c4a A[Catch: Exception -> 0x5caf, TryCatch #11 {Exception -> 0x5caf, blocks: (B:900:0x5c2f, B:904:0x5cac, B:907:0x5c4a, B:910:0x5c64, B:914:0x5c6d, B:917:0x5c76, B:920:0x5c7f, B:923:0x5c8c, B:926:0x5c9b, B:928:0x5c57), top: B:899:0x5c2f }] */
    /* JADX WARN: Removed duplicated region for block: B:922:0x5c8b  */
    /* JADX WARN: Removed duplicated region for block: B:923:0x5c8c A[Catch: Exception -> 0x5caf, TryCatch #11 {Exception -> 0x5caf, blocks: (B:900:0x5c2f, B:904:0x5cac, B:907:0x5c4a, B:910:0x5c64, B:914:0x5c6d, B:917:0x5c76, B:920:0x5c7f, B:923:0x5c8c, B:926:0x5c9b, B:928:0x5c57), top: B:899:0x5c2f }] */
    /* JADX WARN: Removed duplicated region for block: B:92:0x017c  */
    /* JADX WARN: Removed duplicated region for block: B:947:0x5816  */
    /* JADX WARN: Removed duplicated region for block: B:949:0x57b0  */
    /* JADX WARN: Removed duplicated region for block: B:950:0x578f  */
    /* JADX WARN: Removed duplicated region for block: B:951:0x5757  */
    /* JADX WARN: Removed duplicated region for block: B:952:0x55ce  */
    /* JADX WARN: Removed duplicated region for block: B:961:0x5633  */
    /* JADX WARN: Removed duplicated region for block: B:968:0x565d  */
    /* JADX WARN: Removed duplicated region for block: B:972:0x56ad A[Catch: Exception -> 0x56cf, TryCatch #31 {Exception -> 0x56cf, blocks: (B:966:0x5657, B:969:0x5667, B:970:0x569e, B:997:0x56a9, B:972:0x56ad, B:977:0x56bd, B:979:0x56c1, B:981:0x56c9, B:999:0x565e), top: B:965:0x5657 }] */
    /* JADX WARN: Removed duplicated region for block: B:97:0x0187  */
    /* JADX WARN: Removed duplicated region for block: B:985:0x56a8  */
    /* JADX WARN: Removed duplicated region for block: B:988:0x56d9 A[ADDED_TO_REGION] */
    /* JADX WARN: Removed duplicated region for block: B:993:0x56fa  */
    /* JADX WARN: Removed duplicated region for block: B:997:0x56a9 A[Catch: Exception -> 0x56cf, TryCatch #31 {Exception -> 0x56cf, blocks: (B:966:0x5657, B:969:0x5667, B:970:0x569e, B:997:0x56a9, B:972:0x56ad, B:977:0x56bd, B:979:0x56c1, B:981:0x56c9, B:999:0x565e), top: B:965:0x5657 }] */
    /* JADX WARN: Removed duplicated region for block: B:999:0x565e A[Catch: Exception -> 0x56cf, TryCatch #31 {Exception -> 0x56cf, blocks: (B:966:0x5657, B:969:0x5667, B:970:0x569e, B:997:0x56a9, B:972:0x56ad, B:977:0x56bd, B:979:0x56c1, B:981:0x56c9, B:999:0x565e), top: B:965:0x5657 }] */
    /* JADX WARN: Type inference failed for: r0v390, types: [java.lang.CharSequence] */
    /* JADX WARN: Type inference failed for: r0v648, types: [org.telegram.ui.Components.RadialProgress2] */
    /* JADX WARN: Type inference failed for: r0v656, types: [org.telegram.ui.Components.RadialProgress2] */
    /* JADX WARN: Type inference failed for: r0v657, types: [org.telegram.messenger.ImageReceiver] */
    /* JADX WARN: Type inference failed for: r13v0 */
    /* JADX WARN: Type inference failed for: r13v1 */
    /* JADX WARN: Type inference failed for: r13v2 */
    /* JADX WARN: Type inference failed for: r13v267 */
    /* JADX WARN: Type inference failed for: r13v268 */
    /* JADX WARN: Type inference failed for: r13v3, types: [boolean] */
    /* JADX WARN: Type inference failed for: r21v33 */
    /* JADX WARN: Type inference failed for: r2v1252 */
    /* JADX WARN: Type inference failed for: r2v1253 */
    /* JADX WARN: Type inference failed for: r2v30 */
    /* JADX WARN: Type inference failed for: r2v31, types: [boolean, int] */
    /* JADX WARN: Type inference failed for: r2v39 */
    /* JADX WARN: Type inference failed for: r2v52, types: [boolean, int] */
    /* JADX WARN: Type inference failed for: r4v584, types: [org.telegram.tgnet.TLRPC$InputStickerSet] */
    /* JADX WARN: Type inference failed for: r6v473, types: [org.telegram.ui.Cells.ChatMessageCell$1] */
    /* JADX WARN: Type inference failed for: r6v489 */
    /* JADX WARN: Type inference failed for: r6v499, types: [org.telegram.tgnet.TLRPC$Document, java.lang.Object, org.telegram.tgnet.TLRPC$PhotoSize, android.graphics.drawable.Drawable] */
    /* JADX WARN: Type inference failed for: r6v774, types: [org.telegram.messenger.WebFile, android.text.StaticLayout, java.lang.String] */
    /* JADX WARN: Type inference failed for: r6v775 */
    /* JADX WARN: Type inference failed for: r6v794 */
    /* JADX WARN: Type inference failed for: r6v795 */
    /* JADX WARN: Type inference failed for: r6v796 */
    /* JADX WARN: Type inference failed for: r6v800 */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void setMessageContent(MessageObject messageObject, MessageObject.GroupedMessages groupedMessages, boolean z, boolean z2) {
        boolean z3;
        boolean z4;
        boolean z5;
        boolean z6;
        int i;
        float f;
        int i2;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        MessageObject.GroupedMessages groupedMessages2;
        boolean z7;
        ?? r2;
        boolean z8;
        TLRPC$Message tLRPC$Message;
        ?? r22;
        MessageObject.GroupedMessagePosition groupedMessagePosition2;
        int i3;
        Drawable[] drawableArr;
        boolean z9;
        MessageObject.GroupedMessagePosition groupedMessagePosition3;
        boolean z10;
        TLRPC$Message tLRPC$Message2;
        TLRPC$TL_messageReactions tLRPC$TL_messageReactions;
        int i4;
        MessageObject.GroupedMessages groupedMessages3;
        boolean isLinkedToChat;
        int i5;
        int minTabletSide;
        int dp;
        int i6;
        TLRPC$Document tLRPC$Document;
        TLRPC$ThemeSettings tLRPC$ThemeSettings;
        boolean z11;
        ReactionsLayoutInBubble reactionsLayoutInBubble;
        int max;
        int i7;
        int minTabletSide2;
        int dp2;
        int dp3;
        int dp4;
        String str;
        int i8;
        String str2;
        int i9;
        String str3;
        int i10;
        String str4;
        TLRPC$Document themeDocument;
        TLRPC$Document tLRPC$Document2;
        String str5;
        WebFile webFile;
        int i11;
        String str6;
        String str7;
        TLRPC$Photo tLRPC$Photo;
        int i12;
        String str8;
        boolean z12;
        int i13;
        int i14;
        String string;
        int dp5;
        int i15;
        MessageObject messageObject2;
        String str9;
        String str10;
        TLRPC$Document tLRPC$Document3;
        WebFile webFile2;
        TLRPC$Photo tLRPC$Photo2;
        boolean z13;
        int i16;
        int i17;
        int i18;
        int i19;
        StaticLayout staticLayout;
        int width;
        int i20;
        boolean z14;
        boolean z15;
        int i21;
        boolean z16;
        int i22;
        int i23;
        int width2;
        int i24;
        boolean z17;
        String str11;
        boolean z18;
        int i25;
        int i26;
        int i27;
        int i28;
        boolean z19;
        MessageObject messageObject3;
        String str12;
        WebFile webFile3;
        int i29;
        int i30;
        TLRPC$Photo tLRPC$Photo3;
        TLRPC$Document tLRPC$Document4;
        float f2;
        TLRPC$PhotoSize tLRPC$PhotoSize;
        int dp6;
        int i31;
        int i32;
        int i33;
        int i34;
        float f3;
        boolean z20;
        int i35;
        int i36;
        int max2;
        TLRPC$PhotoSize tLRPC$PhotoSize2;
        int i37;
        String str13;
        int i38;
        boolean z21;
        boolean z22;
        long j;
        TLRPC$User user;
        String str14;
        boolean canDownloadMedia;
        boolean z23;
        int i39;
        int i40;
        int i41;
        int i42;
        int i43;
        int i44;
        int i45;
        int i46;
        int minTabletSide3;
        int i47;
        int i48;
        String upperCase;
        int max3;
        boolean z24;
        BitmapDrawable bitmapDrawable;
        boolean z25;
        WebFile webFile4;
        int i49;
        String str15;
        String str16;
        int max4;
        int width3;
        boolean z26;
        int i50;
        int i51;
        int size;
        int minTabletSide4;
        int dp7;
        int i52;
        StaticLayout staticLayout2;
        Float valueOf;
        int i53;
        CharSequence voiceTranscription;
        int minTabletSide5;
        int dp8;
        String str17;
        MessageObject.GroupedMessagePosition groupedMessagePosition4;
        int i54;
        MessageObject messageObject4;
        float f4;
        int i55;
        int i56;
        boolean z27;
        HashMap hashMap;
        int dp9;
        StringBuilder sb;
        StringBuilder sb2;
        HashMap hashMap2;
        int i57;
        BotButton botButton;
        CharSequence string2;
        Uri parse;
        boolean z28;
        HashMap hashMap3;
        String str18;
        int minTabletSide6;
        ?? r6;
        boolean z29;
        MessageObject.GroupedMessagePosition groupedMessagePosition5;
        int i58;
        int dp10;
        int i59;
        int i60;
        TLRPC$User user2;
        MessageObject messageObject5;
        String string3;
        boolean z30;
        CharSequence charSequence;
        String replace;
        ReactionsLayoutInBubble reactionsLayoutInBubble2;
        int dp11;
        ReactionsLayoutInBubble reactionsLayoutInBubble3;
        MessageObject.GroupedMessagePosition groupedMessagePosition6;
        int min;
        boolean z31;
        int min2;
        ReactionsLayoutInBubble reactionsLayoutInBubble4;
        MessageObject.GroupedMessages groupedMessages4;
        boolean z32;
        String string4;
        boolean z33;
        float f5;
        ArrayList arrayList;
        byte[] isSendingVote;
        String string5;
        PollButton pollButton;
        int i61;
        int i62;
        CharSequence ellipsize;
        MessageObject messageObject6;
        float f6;
        int i63;
        int dp12;
        int dp13;
        int i64;
        int i65;
        int i66;
        int i67;
        int i68;
        StaticLayout staticLayout3;
        MessageObject messageObject7;
        MessageObject.GroupedMessages groupedMessages5;
        StaticLayout staticLayout4;
        int dp14;
        MessageObject.GroupedMessagePosition groupedMessagePosition7;
        int i69;
        int i70;
        int dp15;
        MessageObject.GroupedMessagePosition groupedMessagePosition8;
        int i71;
        int dp16;
        TLRPC$Message tLRPC$Message3;
        int i72;
        int i73;
        int i74;
        int i75;
        ReactionsLayoutInBubble reactionsLayoutInBubble5;
        int i76;
        float minTabletSide7;
        float f7;
        int dp17;
        int i77;
        int i78;
        int i79;
        float minTabletSide8;
        float f8;
        int i80;
        int i81;
        String str19;
        SvgHelper.SvgDrawable svgDrawable;
        MessageObject messageObject8;
        int i82;
        int i83;
        boolean z34;
        SvgHelper.SvgDrawable svgDrawable2;
        String format;
        int i84;
        boolean z35;
        int i85;
        boolean z36;
        BitmapDrawable bitmapDrawable2;
        int i86;
        int i87;
        TLRPC$PhotoSize tLRPC$PhotoSize3;
        TLRPC$PhotoSize tLRPC$PhotoSize4;
        TLRPC$Document document;
        int i88;
        MessageObject.GroupedMessagePosition groupedMessagePosition9;
        int dp18;
        MessageObject.GroupedMessagePosition groupedMessagePosition10;
        MessageObject.GroupedMessagePosition groupedMessagePosition11;
        float[] fArr;
        int round;
        int dp19;
        int i89;
        boolean z37;
        int i90;
        int i91;
        int i92;
        int i93;
        double ceil;
        int i94;
        double ceil2;
        int dp20;
        int i95;
        int i96;
        boolean z38;
        boolean z39;
        int i97;
        int i98;
        int i99;
        int i100;
        int i101;
        int lineCount;
        int max5;
        float lineLeft;
        ReactionsLayoutInBubble reactionsLayoutInBubble6;
        int dp21;
        int measureText;
        int i102;
        ImageLocation forObject;
        StringBuilder sb3;
        Object obj;
        TLRPC$PhotoSize tLRPC$PhotoSize5;
        int i103;
        TLRPC$PhotoSize tLRPC$PhotoSize6;
        MessageObject.GroupedMessagePosition groupedMessagePosition12;
        Object obj2;
        int i104;
        boolean z40;
        char c;
        Object obj3;
        ArrayList<TLRPC$PhotoSize> arrayList2;
        int i105;
        int minTabletSide9;
        boolean z41;
        int minTabletSide10;
        TLRPC$PhotoSize tLRPC$PhotoSize7;
        TLRPC$PhotoSize tLRPC$PhotoSize8;
        int i106;
        int i107;
        int i108;
        int i109;
        int minTabletSide11;
        int i110;
        MessageObject.GroupedMessagePosition groupedMessagePosition13;
        MessageObject.GroupedMessagePosition groupedMessagePosition14;
        int repliesCount;
        String string6;
        int i111;
        AnimatedNumberLayout animatedNumberLayout;
        boolean z42;
        AnimatedNumberLayout animatedNumberLayout2;
        TLRPC$User user3;
        TLRPC$Chat tLRPC$Chat;
        ArrayList<MessageObject.TextLayoutBlock> arrayList3;
        MessageObject.GroupedMessagePosition groupedMessagePosition15;
        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader;
        ChatMessageCellDelegate chatMessageCellDelegate;
        MessageObject.GroupedMessagePosition groupedMessagePosition16;
        MessageObject.GroupedMessagePosition groupedMessagePosition17;
        ?? r62;
        TranscribeButton transcribeButton;
        ChatMessageCellDelegate chatMessageCellDelegate2;
        ArrayList<TLRPC$TL_pollAnswerVoters> arrayList4;
        TLRPC$Poll tLRPC$Poll;
        int i112;
        boolean z43;
        TLRPC$Poll tLRPC$Poll2;
        boolean z44;
        TLRPC$TL_messageMediaPoll tLRPC$TL_messageMediaPoll;
        TLRPC$PollResults tLRPC$PollResults;
        int size2;
        int i113;
        TLRPC$TL_pollAnswerVoters tLRPC$TL_pollAnswerVoters;
        int i114;
        String str20;
        MessageObject.GroupedMessagePosition groupedMessagePosition18;
        float[] fArr2;
        MessageObject messageObject9;
        MessageObject messageObject10 = messageObject;
        if (messageObject.checkLayout() || (this.currentPosition != null && this.lastHeight != AndroidUtilities.displaySize.y)) {
            this.currentMessageObject = null;
        }
        ?? r13 = 1;
        r13 = 1;
        r13 = 1;
        boolean z45 = this.lastWidth != getParentWidth();
        this.lastHeight = AndroidUtilities.displaySize.y;
        this.lastWidth = getParentWidth();
        this.isRoundVideo = messageObject.isRoundVideo();
        TLRPC$Message tLRPC$Message4 = !messageObject.hasValidReplyMessageObject() ? null : messageObject10.replyMessageObject.messageOwner;
        MessageObject messageObject11 = this.currentMessageObject;
        boolean z46 = messageObject11 == null || messageObject11.getId() != messageObject.getId();
        if (this.currentMessageObject == messageObject10 && !messageObject10.forceUpdate) {
            if (this.isRoundVideo) {
            }
            z3 = false;
            MessageObject messageObject12 = this.currentMessageObject;
            z4 = (messageObject12 != null && messageObject12.getId() == messageObject.getId() && this.lastSendState == 3 && messageObject.isSent()) || !((this.currentMessageObject != messageObject10 || (!isUserDataChanged() && !this.photoNotSet)) && this.lastPostAuthor == messageObject10.messageOwner.post_author && this.wasPinned == this.isPinned && tLRPC$Message4 == this.lastReplyMessage);
            z5 = groupedMessages != this.currentMessagesGroup;
            if (!z46 && (messageObject9 = this.currentMessageObject) != null) {
                messageObject10.copyStableParams(messageObject9);
            }
            this.accessibilityText = null;
            if (!this.drawCommentButton || this.useTranscribeButton || (this.drawSideButton == 3 && (((!this.hasDiscussion || !messageObject10.isLinkedToChat(this.linkedChatId)) && !this.isRepliesChat) || ((groupedMessagePosition18 = this.currentPosition) != null && (((fArr2 = groupedMessagePosition18.siblingHeights) != null || (groupedMessagePosition18.flags & 8) == 0) && (fArr2 == null || (groupedMessagePosition18.flags & 4) != 0)))))) {
                z4 = true;
            }
            if (!z3 && messageObject.isDice()) {
                setCurrentDiceValue(this.isUpdating);
            }
            if (!z3 && messageObject.isPoll()) {
                if (MessageObject.getMedia(messageObject10.messageOwner) instanceof TLRPC$TL_messageMediaPoll) {
                    tLRPC$Poll = null;
                    arrayList4 = null;
                    i112 = 0;
                } else {
                    TLRPC$TL_messageMediaPoll tLRPC$TL_messageMediaPoll2 = (TLRPC$TL_messageMediaPoll) MessageObject.getMedia(messageObject10.messageOwner);
                    TLRPC$PollResults tLRPC$PollResults2 = tLRPC$TL_messageMediaPoll2.results;
                    arrayList4 = tLRPC$PollResults2.results;
                    tLRPC$Poll = tLRPC$TL_messageMediaPoll2.poll;
                    i112 = tLRPC$PollResults2.total_voters;
                }
                z43 = (arrayList4 == null || this.lastPollResults == null || i112 == this.lastPollResultsVoters) ? false : true;
                if (!z43 && arrayList4 != this.lastPollResults) {
                    z43 = true;
                }
                tLRPC$Poll2 = this.lastPoll;
                if (tLRPC$Poll2 == tLRPC$Poll || tLRPC$Poll2.closed == tLRPC$Poll.closed) {
                    z6 = z43;
                    z44 = false;
                } else {
                    if (!this.pollVoted) {
                        z44 = false;
                    } else {
                        this.pollVoteInProgress = true;
                        z44 = false;
                        this.vibrateOnPollVote = false;
                    }
                    z6 = true;
                }
                this.animatePollAvatars = z44;
                if (z6 && this.attachedToWindow) {
                    this.pollAnimationProgressTime = 0.0f;
                    if (this.pollVoted && !messageObject.isVoted()) {
                        this.pollUnvoteInProgress = true;
                    }
                    int i115 = this.lastPollResultsVoters;
                    this.animatePollAvatars = i115 == 0 || (i115 != 0 && i112 == 0);
                }
                if (!z46 && tLRPC$Poll != null && this.lastPoll.quiz && tLRPC$Poll.quiz && this.currentMessageObject != null && !this.pollVoted && messageObject.isVoted() && (tLRPC$PollResults = (tLRPC$TL_messageMediaPoll = (TLRPC$TL_messageMediaPoll) MessageObject.getMedia(messageObject10.messageOwner)).results) != null && !tLRPC$PollResults.results.isEmpty()) {
                    size2 = tLRPC$TL_messageMediaPoll.results.results.size();
                    i113 = 0;
                    while (true) {
                        if (i113 < size2) {
                            tLRPC$TL_pollAnswerVoters = null;
                            break;
                        }
                        tLRPC$TL_pollAnswerVoters = tLRPC$TL_messageMediaPoll.results.results.get(i113);
                        if (tLRPC$TL_pollAnswerVoters.chosen) {
                            break;
                        }
                        i113++;
                    }
                    if (tLRPC$TL_pollAnswerVoters != null) {
                        int i116 = i113 + 500;
                        if (!tLRPC$TL_pollAnswerVoters.correct) {
                            i114 = R.string.AccDescrQuizIncorrectAnswer;
                            str20 = "AccDescrQuizIncorrectAnswer";
                        } else {
                            i114 = R.string.AccDescrQuizCorrectAnswer;
                            str20 = "AccDescrQuizCorrectAnswer";
                        }
                        sendAccessibilityEventForVirtualView(i116, 4, LocaleController.getString(str20, i114));
                    }
                }
            } else {
                z6 = false;
            }
            if (!z5 && groupedMessages != null) {
                z5 = (groupedMessages.messages.size() > 1 ? null : this.currentMessagesGroup.positions.get(this.currentMessageObject)) == this.currentPosition;
            }
            i = -1;
            f = 1.0f;
            i2 = 2;
            if (!z3 && !z4 && !z5 && !z6 && ((!z45 || !messageObject.isPoll()) && !isPhotoDataChanged(messageObject) && this.pinnedBottom == z && this.pinnedTop == z2)) {
                i54 = -1;
                f4 = 0.0f;
                r62 = 0;
                i58 = 5;
                i33 = 3;
                i34 = 2;
            } else {
                this.wasPinned = this.isPinned;
                this.pinnedBottom = z;
                this.pinnedTop = z2;
                this.currentMessageObject = messageObject10;
                this.currentMessagesGroup = groupedMessages;
                this.lastTime = -2;
                this.lastPostAuthor = messageObject10.messageOwner.post_author;
                this.isHighlightedAnimated = false;
                this.widthBeforeNewTimeLine = -1;
                if (groupedMessages != null && groupedMessages.posArray.size() > 1) {
                    groupedMessagePosition = this.currentMessagesGroup.positions.get(this.currentMessageObject);
                    this.currentPosition = groupedMessagePosition;
                    if (groupedMessagePosition == null) {
                        this.currentMessagesGroup = null;
                    }
                } else {
                    this.currentMessagesGroup = null;
                    this.currentPosition = null;
                }
                groupedMessages2 = this.currentMessagesGroup;
                if (groupedMessages2 == null || groupedMessages2.isDocuments) {
                    this.drawPinnedTop = this.pinnedTop;
                    this.drawPinnedBottom = this.pinnedBottom;
                } else {
                    this.drawPinnedTop = this.pinnedTop && ((groupedMessagePosition17 = this.currentPosition) == null || (groupedMessagePosition17.flags & 4) != 0);
                    this.drawPinnedBottom = this.pinnedBottom && ((groupedMessagePosition16 = this.currentPosition) == null || (groupedMessagePosition16.flags & 8) != 0);
                }
                this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                this.photoImage.setCrossfadeWithOldImage(false);
                this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                this.photoImage.setGradientBitmap(null);
                TLRPC$Message tLRPC$Message5 = messageObject10.messageOwner;
                this.lastSendState = tLRPC$Message5.send_state;
                this.lastDeleteDate = tLRPC$Message5.destroyTime;
                this.lastViewsCount = tLRPC$Message5.views;
                this.lastRepliesCount = getRepliesCount();
                if (!z46) {
                    z7 = false;
                } else {
                    z7 = false;
                    this.isPressed = false;
                    this.isCheckPressed = true;
                }
                this.gamePreviewPressed = z7;
                this.sideButtonPressed = z7;
                this.hasNewLineForTime = z7;
                this.flipImage = z7;
                boolean z47 = (!this.isThreadChat || (tLRPC$MessageFwdHeader = messageObject10.messageOwner.fwd_from) == null || tLRPC$MessageFwdHeader.channel_post == 0) ? false : true;
                this.isThreadPost = z47;
                this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                boolean z48 = this.isChat && !this.isThreadPost && !messageObject.isOutOwner() && messageObject.needDrawAvatar();
                if (messageObject10.customAvatarDrawable != null) {
                    z8 = z48;
                    r2 = 0;
                } else {
                    this.isAvatarVisible = true;
                    r2 = 0;
                    z8 = true;
                }
                this.wasLayout = r2;
                this.groupPhotoInvisible = r2;
                int i117 = r2 == true ? 1 : 0;
                int i118 = r2 == true ? 1 : 0;
                this.animatingDrawVideoImageButton = i117;
                this.drawVideoSize = r2;
                this.canStreamVideo = r2;
                this.animatingNoSound = r2;
                if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId()) || ((tLRPC$Message = messageObject10.messageOwner) != null && tLRPC$Message.noforwards)) {
                    r22 = 0;
                    this.drawSideButton = 0;
                } else {
                    int i119 = (!this.isRepliesChat && checkNeedDrawShareButton(messageObject) && ((groupedMessagePosition2 = this.currentPosition) == null || groupedMessagePosition2.last)) ? 1 : 0;
                    this.drawSideButton = i119;
                    if (!this.isPinnedChat || (i119 == 1 && messageObject10.messageOwner.fwd_from != null && !messageObject.isOutOwner() && messageObject10.messageOwner.fwd_from.saved_from_peer != null && messageObject.getDialogId() == UserConfig.getInstance(this.currentAccount).getClientUserId())) {
                        this.drawSideButton = 2;
                    }
                    r22 = 0;
                }
                this.replyNameLayout = null;
                this.adminLayout = null;
                this.checkOnlyButtonPressed = r22;
                this.replyTextLayout = null;
                AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                this.lastReplyMessage = null;
                this.hasEmbed = r22;
                this.autoPlayingMedia = r22;
                int i120 = r22 == true ? 1 : 0;
                int i121 = r22 == true ? 1 : 0;
                this.replyNameWidth = i120;
                this.replyTextWidth = r22;
                this.viaWidth = r22;
                this.viaNameWidth = r22;
                this.addedCaptionHeight = r22;
                this.currentReplyPhoto = null;
                this.currentUser = null;
                this.currentChat = null;
                this.currentViaBotUser = null;
                this.instantViewLayout = null;
                this.drawNameLayout = r22;
                this.lastLoadingSizeTotal = 0L;
                if (this.scheduledInvalidate) {
                    AndroidUtilities.cancelRunOnUIThread(this.invalidateRunnable);
                    this.scheduledInvalidate = r22;
                }
                this.links.clear();
                this.pressedLink = null;
                this.pressedEmoji = null;
                this.pressedLinkType = -1;
                messageObject10.forceUpdate = r22;
                this.drawPhotoImage = r22;
                this.drawMediaCheckBox = r22;
                this.hasLinkPreview = r22;
                this.hasOldCaptionPreview = r22;
                this.hasGamePreview = r22;
                this.hasInvoicePreview = r22;
                this.commentButtonPressed = r22;
                this.instantButtonPressed = r22;
                this.instantPressed = r22;
                if (!z6 && Build.VERSION.SDK_INT >= 21) {
                    i3 = 0;
                    while (true) {
                        drawableArr = this.selectorDrawable;
                        if (i3 < drawableArr.length) {
                            break;
                        }
                        boolean z49 = z4;
                        if (drawableArr[i3] != null) {
                            drawableArr[i3].setVisible(false, false);
                            this.selectorDrawable[i3].setState(StateSet.NOTHING);
                        }
                        i3++;
                        z4 = z49;
                        f = 1.0f;
                        i2 = 2;
                        r13 = 1;
                        i = -1;
                    }
                }
                this.spoilerPressed = null;
                this.isCaptionSpoilerPressed = false;
                this.isSpoilerRevealing = false;
                this.linkPreviewPressed = false;
                this.buttonPressed = 0;
                this.additionalTimeOffsetY = 0;
                this.miniButtonPressed = 0;
                this.pressedBotButton = i;
                this.pressedVoteButton = i;
                this.pollHintPressed = false;
                this.psaHintPressed = false;
                this.linkPreviewHeight = 0;
                this.mediaOffsetY = 0;
                this.documentAttachType = 0;
                this.documentAttach = null;
                this.descriptionLayout = null;
                this.titleLayout = null;
                this.videoInfoLayout = null;
                this.photosCountLayout = null;
                this.siteNameLayout = null;
                this.authorLayout = null;
                this.captionLayout = null;
                this.captionWidth = 0;
                this.captionHeight = 0;
                this.captionOffsetX = 0;
                this.currentCaption = null;
                this.docTitleLayout = null;
                this.drawImageButton = false;
                this.drawVideoImageButton = false;
                this.currentPhotoObject = null;
                this.photoParentObject = null;
                this.currentPhotoObjectThumb = null;
                this.currentPhotoObjectThumbStripped = null;
                if (!z3 || z46 || z4) {
                    this.currentPhotoFilter = null;
                }
                this.buttonState = i;
                this.miniButtonState = i;
                this.hasMiniProgress = 0;
                if (this.addedForTest && this.currentUrl != null && this.currentWebFile != null) {
                    ImageLoader.getInstance().removeTestWebFile(this.currentUrl);
                }
                this.addedForTest = false;
                this.photoNotSet = false;
                this.drawBackground = r13;
                this.drawName = false;
                this.useSeekBarWaveform = false;
                this.useTranscribeButton = false;
                this.drawInstantView = false;
                this.drawInstantViewType = 0;
                this.drawForwardedName = false;
                this.drawCommentButton = false;
                this.photoImage.setSideClip(0.0f);
                this.photoImage.setAspectFit(false);
                this.gradientShader = null;
                this.motionBackgroundDrawable = null;
                this.imageBackgroundColor = 0;
                this.imageBackgroundGradientColor1 = 0;
                this.imageBackgroundGradientColor2 = 0;
                this.imageBackgroundIntensity = 0.0f;
                this.imageBackgroundGradientColor3 = 0;
                this.imageBackgroundGradientRotation = 45;
                this.imageBackgroundSideColor = 0;
                this.mediaBackground = false;
                this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader2 = messageObject10.messageOwner.fwd_from;
                z9 = tLRPC$MessageFwdHeader2 != null && !TextUtils.isEmpty(tLRPC$MessageFwdHeader2.psa_type);
                this.hasPsaHint = z9;
                if (z9) {
                    createSelectorDrawable(0);
                }
                this.photoImage.setAlpha(f);
                if ((!z3 || z4) && !this.pollUnvoteInProgress) {
                    this.pollButtons.clear();
                }
                this.availableTimeWidth = 0;
                this.photoImage.setForceLoading(false);
                this.photoImage.setNeedsQualityThumb(false);
                this.photoImage.setShouldGenerateQualityThumb(false);
                this.photoImage.setAllowDecodeSingleFrame(false);
                this.photoImage.setColorFilter(null);
                this.photoImage.setMediaStartEndTime(-1L, -1L);
                if (!z46 || messageObject10.reactionsChanged) {
                    messageObject10.reactionsChanged = false;
                    groupedMessagePosition3 = this.currentPosition;
                    if (groupedMessagePosition3 == null || (groupedMessagePosition3.flags & 8) != 0) {
                        z10 = !messageObject.shouldDrawReactionsInLayout();
                        if (z10 && (tLRPC$Message2 = messageObject10.messageOwner) != null && (tLRPC$TL_messageReactions = tLRPC$Message2.reactions) != null && tLRPC$TL_messageReactions.results != null) {
                            int i122 = 0;
                            int i123 = 0;
                            for (i4 = 0; i4 < messageObject10.messageOwner.reactions.results.size(); i4++) {
                                TLRPC$ReactionCount tLRPC$ReactionCount = messageObject10.messageOwner.reactions.results.get(i4);
                                if (tLRPC$ReactionCount.count == i2) {
                                    i122++;
                                } else if (tLRPC$ReactionCount.chosen) {
                                    i122++;
                                    if (i123 >= i2 || i122 >= i2) {
                                        z10 = false;
                                        break;
                                    }
                                }
                                i123++;
                                if (i123 >= i2) {
                                }
                                z10 = false;
                            }
                        }
                        if (this.currentPosition != null) {
                            this.reactionsLayoutInBubble.setMessage(groupedMessages.findPrimaryMessageObject(), !messageObject.shouldDrawReactionsInLayout(), this.resourcesProvider);
                        } else {
                            this.reactionsLayoutInBubble.setMessage(messageObject10, z10, this.resourcesProvider);
                        }
                    } else {
                        this.reactionsLayoutInBubble.setMessage(null, false, this.resourcesProvider);
                    }
                }
                if (z3) {
                    this.firstVisibleBlockNum = 0;
                    this.lastVisibleBlockNum = 0;
                    MessageObject messageObject13 = this.currentMessageObject;
                    if (messageObject13 != null && (arrayList3 = messageObject13.textLayoutBlocks) != null && arrayList3.size() > r13) {
                        this.needNewVisiblePart = r13;
                    }
                }
                groupedMessages3 = this.currentMessagesGroup;
                if (groupedMessages3 != null && groupedMessages3.messages.size() > 0) {
                    isLinkedToChat = this.currentMessagesGroup.messages.get(0).isLinkedToChat(this.linkedChatId);
                } else {
                    isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                }
                if (((this.hasDiscussion && isLinkedToChat) || (this.isRepliesChat && !messageObject.isOutOwner())) && ((groupedMessagePosition14 = this.currentPosition) == null || (groupedMessagePosition14.flags & 8) != 0)) {
                    repliesCount = getRepliesCount();
                    if (!messageObject.shouldDrawWithoutBackground() && !messageObject.isAnimatedEmoji()) {
                        this.drawCommentButton = r13;
                        if (this.commentProgress == null) {
                            this.commentProgress = new InfiniteProgress(AndroidUtilities.dp(7.0f));
                        }
                        if (!this.isRepliesChat) {
                            string6 = LocaleController.getString("ViewInChat", R.string.ViewInChat);
                        } else {
                            if (LocaleController.isRTL) {
                                string6 = repliesCount != 0 ? LocaleController.formatPluralString("CommentsCount", repliesCount, new Object[0]) : LocaleController.getString("LeaveAComment", R.string.LeaveAComment);
                            } else {
                                string6 = repliesCount != 0 ? LocaleController.getPluralString("CommentsNoNumber", repliesCount) : LocaleController.getString("LeaveAComment", R.string.LeaveAComment);
                            }
                            ArrayList<TLRPC$Peer> recentRepliers = getRecentRepliers();
                            if (repliesCount != 0 && recentRepliers != null && !recentRepliers.isEmpty()) {
                                createCommentUI();
                                int size3 = recentRepliers.size();
                                int i124 = 0;
                                i111 = 0;
                                while (true) {
                                    ImageReceiver[] imageReceiverArr = this.commentAvatarImages;
                                    if (i124 >= imageReceiverArr.length) {
                                        break;
                                    }
                                    if (i124 < size3) {
                                        imageReceiverArr[i124].setImageCoords(0.0f, 0.0f, AndroidUtilities.dp(24.0f), AndroidUtilities.dp(24.0f));
                                        long peerId = MessageObject.getPeerId(recentRepliers.get(i124));
                                        if (DialogObject.isUserDialog(peerId)) {
                                            user3 = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(peerId));
                                        } else if (!DialogObject.isChatDialog(peerId)) {
                                            user3 = null;
                                        } else {
                                            tLRPC$Chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-peerId));
                                            user3 = null;
                                            if (user3 == null) {
                                                this.commentAvatarDrawables[i124].setInfo(user3);
                                                this.commentAvatarImages[i124].setForUserOrChat(user3, this.commentAvatarDrawables[i124]);
                                            } else if (tLRPC$Chat != null) {
                                                this.commentAvatarDrawables[i124].setInfo(tLRPC$Chat);
                                                this.commentAvatarImages[i124].setForUserOrChat(tLRPC$Chat, this.commentAvatarDrawables[i124]);
                                            } else {
                                                this.commentAvatarDrawables[i124].setInfo(peerId, "", "");
                                            }
                                            this.commentAvatarImagesVisible[i124] = true;
                                            i111 += i124 == 0 ? 17 : 2;
                                        }
                                        tLRPC$Chat = null;
                                        if (user3 == null) {
                                        }
                                        this.commentAvatarImagesVisible[i124] = true;
                                        i111 += i124 == 0 ? 17 : 2;
                                    } else if (size3 != 0) {
                                        imageReceiverArr[i124].setImageBitmap((Drawable) null);
                                        this.commentAvatarImagesVisible[i124] = false;
                                    }
                                    i124++;
                                }
                                int ceil3 = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(string6));
                                this.totalCommentWidth = ceil3;
                                this.commentWidth = ceil3;
                                this.commentLayout = new StaticLayout(string6, Theme.chat_replyNamePaint, this.commentWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                if (repliesCount != 0 && !LocaleController.isRTL) {
                                    this.drawCommentNumber = true;
                                    animatedNumberLayout = this.commentNumberLayout;
                                    if (animatedNumberLayout != null) {
                                        AnimatedNumberLayout animatedNumberLayout3 = new AnimatedNumberLayout(this, Theme.chat_replyNamePaint);
                                        this.commentNumberLayout = animatedNumberLayout3;
                                        z42 = false;
                                        animatedNumberLayout3.setNumber(repliesCount, false);
                                    } else {
                                        animatedNumberLayout.setNumber(repliesCount, messageObject10.animateComments);
                                        z42 = false;
                                    }
                                    messageObject10.animateComments = z42;
                                    int width4 = this.commentNumberLayout.getWidth();
                                    this.commentNumberWidth = width4;
                                    this.totalCommentWidth += width4 + AndroidUtilities.dp(4.0f);
                                } else {
                                    this.drawCommentNumber = false;
                                    animatedNumberLayout2 = this.commentNumberLayout;
                                    if (animatedNumberLayout2 != null) {
                                        animatedNumberLayout2.setNumber(1, false);
                                    }
                                }
                                this.totalCommentWidth += AndroidUtilities.dp(i111 + 70);
                            } else if (this.commentAvatarImages != null) {
                                int i125 = 0;
                                while (true) {
                                    ImageReceiver[] imageReceiverArr2 = this.commentAvatarImages;
                                    if (i125 >= imageReceiverArr2.length) {
                                        break;
                                    }
                                    imageReceiverArr2[i125].setImageBitmap((Drawable) null);
                                    this.commentAvatarImagesVisible[i125] = false;
                                    i125++;
                                }
                            }
                        }
                        i111 = 0;
                        int ceil32 = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(string6));
                        this.totalCommentWidth = ceil32;
                        this.commentWidth = ceil32;
                        this.commentLayout = new StaticLayout(string6, Theme.chat_replyNamePaint, this.commentWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        if (repliesCount != 0) {
                            this.drawCommentNumber = true;
                            animatedNumberLayout = this.commentNumberLayout;
                            if (animatedNumberLayout != null) {
                            }
                            messageObject10.animateComments = z42;
                            int width42 = this.commentNumberLayout.getWidth();
                            this.commentNumberWidth = width42;
                            this.totalCommentWidth += width42 + AndroidUtilities.dp(4.0f);
                            this.totalCommentWidth += AndroidUtilities.dp(i111 + 70);
                        }
                        this.drawCommentNumber = false;
                        animatedNumberLayout2 = this.commentNumberLayout;
                        if (animatedNumberLayout2 != null) {
                        }
                        this.totalCommentWidth += AndroidUtilities.dp(i111 + 70);
                    } else {
                        if (!this.isRepliesChat && repliesCount > 0) {
                            String formatShortNumber = LocaleController.formatShortNumber(repliesCount, null);
                            int ceil4 = (int) Math.ceil(Theme.chat_stickerCommentCountPaint.measureText(formatShortNumber));
                            this.totalCommentWidth = ceil4;
                            this.commentWidth = ceil4;
                            this.commentLayout = new StaticLayout(formatShortNumber, Theme.chat_stickerCommentCountPaint, this.commentWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        } else {
                            this.commentLayout = null;
                        }
                        this.drawCommentNumber = false;
                        this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                    }
                } else {
                    this.commentLayout = null;
                    this.drawCommentNumber = false;
                }
                i5 = messageObject10.type;
                float f9 = 102.0f;
                if (i5 == 0) {
                    if (i5 == 16) {
                        messageObject5 = messageObject10;
                        createSelectorDrawable(0);
                        this.drawName = false;
                        this.drawForwardedName = false;
                        this.drawPhotoImage = false;
                        if (!AndroidUtilities.isTablet()) {
                            this.backgroundWidth = Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(270.0f));
                        } else {
                            this.backgroundWidth = Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(270.0f));
                        }
                        this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                        int maxNameWidth = getMaxNameWidth() - AndroidUtilities.dp(50.0f);
                        if (maxNameWidth < 0) {
                            maxNameWidth = AndroidUtilities.dp(10.0f);
                        }
                        String format2 = LocaleController.getInstance().formatterDay.format(messageObject5.messageOwner.date * 1000);
                        TLRPC$TL_messageActionPhoneCall tLRPC$TL_messageActionPhoneCall = (TLRPC$TL_messageActionPhoneCall) messageObject5.messageOwner.action;
                        boolean z50 = tLRPC$TL_messageActionPhoneCall.reason instanceof TLRPC$TL_phoneCallDiscardReasonMissed;
                        if (!messageObject.isOutOwner()) {
                            if (z50) {
                                if (tLRPC$TL_messageActionPhoneCall.video) {
                                    string3 = LocaleController.getString("CallMessageVideoIncomingMissed", R.string.CallMessageVideoIncomingMissed);
                                } else {
                                    string3 = LocaleController.getString("CallMessageIncomingMissed", R.string.CallMessageIncomingMissed);
                                }
                            } else if (tLRPC$TL_messageActionPhoneCall.reason instanceof TLRPC$TL_phoneCallDiscardReasonBusy) {
                                if (tLRPC$TL_messageActionPhoneCall.video) {
                                    string3 = LocaleController.getString("CallMessageVideoIncomingDeclined", R.string.CallMessageVideoIncomingDeclined);
                                } else {
                                    string3 = LocaleController.getString("CallMessageIncomingDeclined", R.string.CallMessageIncomingDeclined);
                                }
                            } else if (tLRPC$TL_messageActionPhoneCall.video) {
                                string3 = LocaleController.getString("CallMessageVideoIncoming", R.string.CallMessageVideoIncoming);
                            } else {
                                string3 = LocaleController.getString("CallMessageIncoming", R.string.CallMessageIncoming);
                            }
                        } else if (z50) {
                            if (tLRPC$TL_messageActionPhoneCall.video) {
                                string3 = LocaleController.getString("CallMessageVideoOutgoingMissed", R.string.CallMessageVideoOutgoingMissed);
                            } else {
                                string3 = LocaleController.getString("CallMessageOutgoingMissed", R.string.CallMessageOutgoingMissed);
                            }
                        } else if (tLRPC$TL_messageActionPhoneCall.video) {
                            string3 = LocaleController.getString("CallMessageVideoOutgoing", R.string.CallMessageVideoOutgoing);
                        } else {
                            string3 = LocaleController.getString("CallMessageOutgoing", R.string.CallMessageOutgoing);
                        }
                        if (tLRPC$TL_messageActionPhoneCall.duration > 0) {
                            format2 = format2 + ", " + LocaleController.formatCallDuration(tLRPC$TL_messageActionPhoneCall.duration);
                        }
                        float f10 = maxNameWidth;
                        this.titleLayout = new StaticLayout(TextUtils.ellipsize(string3, Theme.chat_audioTitlePaint, f10, TextUtils.TruncateAt.END), Theme.chat_audioTitlePaint, maxNameWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        this.docTitleLayout = new StaticLayout(TextUtils.ellipsize(format2, Theme.chat_contactPhonePaint, f10, TextUtils.TruncateAt.END), Theme.chat_contactPhonePaint, maxNameWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        setMessageObjectInternal(messageObject);
                        int dp22 = AndroidUtilities.dp(65.0f);
                        int i126 = this.namesOffset;
                        this.totalHeight = dp22 + i126;
                        if (this.drawPinnedTop) {
                            this.namesOffset = i126 - AndroidUtilities.dp(1.0f);
                        }
                    } else if (i5 == 12) {
                        this.drawName = (messageObject.isFromGroup() && messageObject.isSupergroup()) || (messageObject.isImportedForward() && messageObject10.messageOwner.fwd_from.from_id == null);
                        this.drawForwardedName = !this.isRepliesChat;
                        this.drawPhotoImage = true;
                        this.photoImage.setRoundRadius(AndroidUtilities.dp(22.0f));
                        if (!AndroidUtilities.isTablet()) {
                            this.backgroundWidth = Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(270.0f));
                        } else {
                            this.backgroundWidth = Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(270.0f));
                        }
                        this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                        long j2 = MessageObject.getMedia(messageObject10.messageOwner).user_id;
                        TLRPC$User user4 = j2 == 0 ? null : MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(j2));
                        int maxNameWidth2 = getMaxNameWidth() - AndroidUtilities.dp(80.0f);
                        if (maxNameWidth2 < 0) {
                            maxNameWidth2 = AndroidUtilities.dp(10.0f);
                        }
                        if (user4 != null) {
                            this.contactAvatarDrawable.setInfo(user4);
                        } else if (!TextUtils.isEmpty(MessageObject.getMedia(messageObject10.messageOwner).first_name) || !TextUtils.isEmpty(MessageObject.getMedia(messageObject10.messageOwner).last_name)) {
                            this.contactAvatarDrawable.setInfo(0L, MessageObject.getMedia(messageObject10.messageOwner).first_name, MessageObject.getMedia(messageObject10.messageOwner).last_name);
                        } else {
                            z30 = false;
                            this.photoImage.setForUserOrChat(user4, z30 ? Theme.chat_contactDrawable[!messageObject.isOutOwner() ? (char) 0 : (char) 1] : this.contactAvatarDrawable, messageObject10);
                            if (TextUtils.isEmpty(messageObject10.vCardData)) {
                                charSequence = messageObject10.vCardData;
                                this.drawInstantView = true;
                                this.drawInstantViewType = 5;
                            } else if (user4 != null && !TextUtils.isEmpty(user4.phone)) {
                                charSequence = PhoneFormat.getInstance().format("+" + user4.phone);
                            } else {
                                String str21 = MessageObject.getMedia(messageObject10.messageOwner).phone_number;
                                if (!TextUtils.isEmpty(str21)) {
                                    charSequence = PhoneFormat.getInstance().format(str21);
                                } else {
                                    charSequence = LocaleController.getString("NumberUnknown", R.string.NumberUnknown);
                                }
                            }
                            CharSequence charSequence2 = charSequence;
                            replace = ContactsController.formatName(MessageObject.getMedia(messageObject10.messageOwner).first_name, MessageObject.getMedia(messageObject10.messageOwner).last_name).replace('\n', ' ');
                            if (replace.length() == 0 && (replace = MessageObject.getMedia(messageObject10.messageOwner).phone_number) == null) {
                                replace = "";
                            }
                            this.titleLayout = new StaticLayout(TextUtils.ellipsize(replace, Theme.chat_contactNamePaint, maxNameWidth2, TextUtils.TruncateAt.END), Theme.chat_contactNamePaint, maxNameWidth2 + AndroidUtilities.dp(4.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                            this.docTitleLayout = new StaticLayout(charSequence2, Theme.chat_contactPhonePaint, maxNameWidth2 + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(1.0f), false);
                            setMessageObjectInternal(messageObject);
                            if (this.drawForwardedName && messageObject.needDrawForwarded() && ((groupedMessagePosition6 = this.currentPosition) == null || groupedMessagePosition6.minY == 0)) {
                                this.namesOffset += AndroidUtilities.dp(5.0f);
                            } else if (this.drawNameLayout && messageObject.getReplyMsgId() == 0) {
                                this.namesOffset += AndroidUtilities.dp(7.0f);
                            }
                            this.totalHeight = AndroidUtilities.dp(55.0f) + this.namesOffset + this.docTitleLayout.getHeight();
                            if (this.drawPinnedTop) {
                                this.namesOffset -= AndroidUtilities.dp(1.0f);
                            }
                            if (this.drawInstantView) {
                                createInstantViewButton();
                            } else if (this.docTitleLayout.getLineCount() > 0) {
                                int dp23 = this.backgroundWidth - AndroidUtilities.dp(110.0f);
                                StaticLayout staticLayout5 = this.docTitleLayout;
                                if (dp23 - ((int) Math.ceil(staticLayout5.getLineWidth(staticLayout5.getLineCount() - 1))) < this.timeWidth) {
                                    this.totalHeight += AndroidUtilities.dp(8.0f);
                                }
                            }
                            reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
                            if (!reactionsLayoutInBubble2.isSmall && !reactionsLayoutInBubble2.isEmpty) {
                                reactionsLayoutInBubble2.measure(this.backgroundWidth - AndroidUtilities.dp(32.0f), 3);
                                ReactionsLayoutInBubble reactionsLayoutInBubble7 = this.reactionsLayoutInBubble;
                                reactionsLayoutInBubble7.totalHeight = reactionsLayoutInBubble7.height + AndroidUtilities.dp(12.0f);
                                this.reactionsLayoutInBubble.positionOffsetY += -AndroidUtilities.dp(4.0f);
                                dp11 = this.backgroundWidth - AndroidUtilities.dp(32.0f);
                                reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
                                if (dp11 - reactionsLayoutInBubble3.lastLineX < this.timeWidth) {
                                    reactionsLayoutInBubble3.totalHeight += AndroidUtilities.dp(12.0f);
                                    this.reactionsLayoutInBubble.positionOffsetY += -AndroidUtilities.dp(12.0f);
                                }
                                this.totalHeight += this.reactionsLayoutInBubble.totalHeight;
                            }
                            messageObject10 = messageObject10;
                            i50 = 0;
                            i33 = 3;
                            i34 = 2;
                            f3 = 1.0f;
                            z26 = false;
                        }
                        z30 = true;
                        if (z30) {
                        }
                        this.photoImage.setForUserOrChat(user4, z30 ? Theme.chat_contactDrawable[!messageObject.isOutOwner() ? (char) 0 : (char) 1] : this.contactAvatarDrawable, messageObject10);
                        if (TextUtils.isEmpty(messageObject10.vCardData)) {
                        }
                        CharSequence charSequence22 = charSequence;
                        replace = ContactsController.formatName(MessageObject.getMedia(messageObject10.messageOwner).first_name, MessageObject.getMedia(messageObject10.messageOwner).last_name).replace('\n', ' ');
                        if (replace.length() == 0) {
                            replace = "";
                        }
                        this.titleLayout = new StaticLayout(TextUtils.ellipsize(replace, Theme.chat_contactNamePaint, maxNameWidth2, TextUtils.TruncateAt.END), Theme.chat_contactNamePaint, maxNameWidth2 + AndroidUtilities.dp(4.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        this.docTitleLayout = new StaticLayout(charSequence22, Theme.chat_contactPhonePaint, maxNameWidth2 + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(1.0f), false);
                        setMessageObjectInternal(messageObject);
                        if (this.drawForwardedName) {
                            this.namesOffset += AndroidUtilities.dp(5.0f);
                            this.totalHeight = AndroidUtilities.dp(55.0f) + this.namesOffset + this.docTitleLayout.getHeight();
                            if (this.drawPinnedTop) {
                            }
                            if (this.drawInstantView) {
                            }
                            reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
                            if (!reactionsLayoutInBubble2.isSmall) {
                                reactionsLayoutInBubble2.measure(this.backgroundWidth - AndroidUtilities.dp(32.0f), 3);
                                ReactionsLayoutInBubble reactionsLayoutInBubble72 = this.reactionsLayoutInBubble;
                                reactionsLayoutInBubble72.totalHeight = reactionsLayoutInBubble72.height + AndroidUtilities.dp(12.0f);
                                this.reactionsLayoutInBubble.positionOffsetY += -AndroidUtilities.dp(4.0f);
                                dp11 = this.backgroundWidth - AndroidUtilities.dp(32.0f);
                                reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
                                if (dp11 - reactionsLayoutInBubble3.lastLineX < this.timeWidth) {
                                }
                                this.totalHeight += this.reactionsLayoutInBubble.totalHeight;
                            }
                            messageObject10 = messageObject10;
                            i50 = 0;
                            i33 = 3;
                            i34 = 2;
                            f3 = 1.0f;
                            z26 = false;
                        }
                        if (this.drawNameLayout) {
                            this.namesOffset += AndroidUtilities.dp(7.0f);
                        }
                        this.totalHeight = AndroidUtilities.dp(55.0f) + this.namesOffset + this.docTitleLayout.getHeight();
                        if (this.drawPinnedTop) {
                        }
                        if (this.drawInstantView) {
                        }
                        reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
                        if (!reactionsLayoutInBubble2.isSmall) {
                        }
                        messageObject10 = messageObject10;
                        i50 = 0;
                        i33 = 3;
                        i34 = 2;
                        f3 = 1.0f;
                        z26 = false;
                    } else if (i5 == i2) {
                        messageObject5 = messageObject10;
                        this.drawForwardedName = !this.isRepliesChat;
                        this.drawName = (messageObject.isFromGroup() && messageObject.isSupergroup()) || (messageObject.isImportedForward() && messageObject5.messageOwner.fwd_from.from_id == null);
                        if (!AndroidUtilities.isTablet()) {
                            min = Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(270.0f));
                            this.backgroundWidth = min;
                        } else {
                            min = Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(270.0f));
                            this.backgroundWidth = min;
                        }
                        createDocumentLayout(this.backgroundWidth, messageObject5);
                        setMessageObjectInternal(messageObject);
                        int dp24 = AndroidUtilities.dp(70.0f);
                        int i127 = this.namesOffset;
                        this.totalHeight = dp24 + i127;
                        if (this.drawPinnedTop) {
                            this.namesOffset = i127 - AndroidUtilities.dp(1.0f);
                        }
                        ReactionsLayoutInBubble reactionsLayoutInBubble8 = this.reactionsLayoutInBubble;
                        if (!reactionsLayoutInBubble8.isSmall) {
                            reactionsLayoutInBubble8.measure(min - AndroidUtilities.dp(!messageObject.isOutOwner() ? 24.0f : 32.0f), 3);
                            ReactionsLayoutInBubble reactionsLayoutInBubble9 = this.reactionsLayoutInBubble;
                            if (!reactionsLayoutInBubble9.isEmpty) {
                                reactionsLayoutInBubble9.totalHeight = reactionsLayoutInBubble9.height;
                                if (TextUtils.isEmpty(messageObject5.caption)) {
                                    this.reactionsLayoutInBubble.totalHeight += AndroidUtilities.dp(12.0f);
                                } else {
                                    this.reactionsLayoutInBubble.totalHeight += AndroidUtilities.dp(8.0f);
                                }
                                int i128 = this.reactionsLayoutInBubble.width;
                                if (i128 > this.backgroundWidth) {
                                    this.backgroundWidth = i128;
                                }
                                int dp25 = this.timeWidth + AndroidUtilities.dp(6.0f);
                                if (messageObject.isOutOwner()) {
                                    dp25 += AndroidUtilities.dp(20.5f);
                                }
                                int extraTimeX = dp25 + getExtraTimeX();
                                ReactionsLayoutInBubble reactionsLayoutInBubble10 = this.reactionsLayoutInBubble;
                                if (reactionsLayoutInBubble10.lastLineX + extraTimeX >= this.backgroundWidth) {
                                    reactionsLayoutInBubble10.totalHeight += AndroidUtilities.dp(12.0f);
                                    this.reactionsLayoutInBubble.positionOffsetY -= AndroidUtilities.dp(12.0f);
                                }
                                this.totalHeight += this.reactionsLayoutInBubble.totalHeight;
                            }
                        }
                    } else if (i5 == 14) {
                        if (messageObject.isFromGroup() && messageObject.isSupergroup()) {
                            messageObject5 = messageObject;
                        } else {
                            messageObject5 = messageObject;
                            if (messageObject.isImportedForward()) {
                            }
                            z31 = false;
                            this.drawName = z31;
                            if (!AndroidUtilities.isTablet()) {
                                min2 = Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(270.0f));
                                this.backgroundWidth = min2;
                            } else {
                                min2 = Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(270.0f));
                                this.backgroundWidth = min2;
                            }
                            createDocumentLayout(this.backgroundWidth, messageObject5);
                            setMessageObjectInternal(messageObject);
                            this.totalHeight = AndroidUtilities.dp(82.0f) + this.namesOffset;
                            if (this.currentPosition != null && (groupedMessages4 = this.currentMessagesGroup) != null && groupedMessages4.messages.size() > 1) {
                                if ((this.currentPosition.flags & 4) == 0) {
                                    this.totalHeight -= AndroidUtilities.dp(6.0f);
                                    this.mediaOffsetY -= AndroidUtilities.dp(6.0f);
                                }
                                if ((this.currentPosition.flags & 8) == 0) {
                                    this.totalHeight -= AndroidUtilities.dp(6.0f);
                                }
                            }
                            if (this.drawPinnedTop) {
                                this.namesOffset -= AndroidUtilities.dp(1.0f);
                            }
                            reactionsLayoutInBubble4 = this.reactionsLayoutInBubble;
                            if (!reactionsLayoutInBubble4.isSmall) {
                                reactionsLayoutInBubble4.measure(min2 - AndroidUtilities.dp(24.0f), 3);
                                ReactionsLayoutInBubble reactionsLayoutInBubble11 = this.reactionsLayoutInBubble;
                                if (!reactionsLayoutInBubble11.isEmpty) {
                                    reactionsLayoutInBubble11.totalHeight = reactionsLayoutInBubble11.height + AndroidUtilities.dp(12.0f);
                                    measureTime(messageObject);
                                    ReactionsLayoutInBubble reactionsLayoutInBubble12 = this.reactionsLayoutInBubble;
                                    int i129 = reactionsLayoutInBubble12.width;
                                    if (i129 > this.backgroundWidth) {
                                        this.backgroundWidth = i129;
                                    }
                                    if (reactionsLayoutInBubble12.lastLineX + this.timeWidth + AndroidUtilities.dp(24.0f) > this.backgroundWidth) {
                                        this.reactionsLayoutInBubble.totalHeight += AndroidUtilities.dp(12.0f);
                                        this.reactionsLayoutInBubble.positionOffsetY -= AndroidUtilities.dp(12.0f);
                                    }
                                    if (!messageObject5.isRestrictedMessage && messageObject5.caption != null) {
                                        this.reactionsLayoutInBubble.positionOffsetY += AndroidUtilities.dp(14.0f);
                                    }
                                    this.totalHeight += this.reactionsLayoutInBubble.totalHeight;
                                }
                            }
                        }
                        MessageObject.GroupedMessagePosition groupedMessagePosition19 = this.currentPosition;
                        if (groupedMessagePosition19 == null || (groupedMessagePosition19.flags & 4) != 0) {
                            z31 = true;
                            this.drawName = z31;
                            if (!AndroidUtilities.isTablet()) {
                            }
                            createDocumentLayout(this.backgroundWidth, messageObject5);
                            setMessageObjectInternal(messageObject);
                            this.totalHeight = AndroidUtilities.dp(82.0f) + this.namesOffset;
                            if (this.currentPosition != null) {
                                if ((this.currentPosition.flags & 4) == 0) {
                                }
                                if ((this.currentPosition.flags & 8) == 0) {
                                }
                            }
                            if (this.drawPinnedTop) {
                            }
                            reactionsLayoutInBubble4 = this.reactionsLayoutInBubble;
                            if (!reactionsLayoutInBubble4.isSmall) {
                            }
                        }
                        z31 = false;
                        this.drawName = z31;
                        if (!AndroidUtilities.isTablet()) {
                        }
                        createDocumentLayout(this.backgroundWidth, messageObject5);
                        setMessageObjectInternal(messageObject);
                        this.totalHeight = AndroidUtilities.dp(82.0f) + this.namesOffset;
                        if (this.currentPosition != null) {
                        }
                        if (this.drawPinnedTop) {
                        }
                        reactionsLayoutInBubble4 = this.reactionsLayoutInBubble;
                        if (!reactionsLayoutInBubble4.isSmall) {
                        }
                    } else if (i5 == 17) {
                        messageObject5 = messageObject10;
                        int i130 = -1;
                        boolean z51 = false;
                        if (this.timerParticles == null) {
                            this.timerParticles = new TimerParticles();
                        }
                        createSelectorDrawable(0);
                        this.drawName = true;
                        this.drawForwardedName = !this.isRepliesChat;
                        this.drawPhotoImage = false;
                        int min3 = Math.min(AndroidUtilities.dp(500.0f), messageObject.getMaxMessageTextWidth());
                        this.backgroundWidth = AndroidUtilities.dp(31.0f) + min3;
                        TLRPC$TL_messageMediaPoll tLRPC$TL_messageMediaPoll3 = (TLRPC$TL_messageMediaPoll) MessageObject.getMedia(messageObject5.messageOwner);
                        this.timerTransitionProgress = tLRPC$TL_messageMediaPoll3.poll.close_date - ConnectionsManager.getInstance(this.currentAccount).getCurrentTime() >= 60 ? 1.0f : 0.0f;
                        this.pollClosed = tLRPC$TL_messageMediaPoll3.poll.closed;
                        boolean isVoted = messageObject.isVoted();
                        this.pollVoted = isVoted;
                        if (isVoted) {
                            messageObject5.checkedVotes.clear();
                        }
                        StaticLayout staticLayout6 = new StaticLayout(Emoji.replaceEmoji(tLRPC$TL_messageMediaPoll3.poll.question, Theme.chat_audioTitlePaint.getFontMetricsInt(), AndroidUtilities.dp(16.0f), false), Theme.chat_audioTitlePaint, (AndroidUtilities.dp(2.0f) + min3) - (getExtraTextX() * 2), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        this.titleLayout = staticLayout6;
                        int lineCount2 = staticLayout6.getLineCount();
                        int i131 = 0;
                        while (true) {
                            if (i131 >= lineCount2) {
                                z32 = false;
                                break;
                            }
                            if (this.titleLayout.getLineLeft(i131) > 0.0f) {
                                z32 = true;
                                break;
                            }
                            i131++;
                        }
                        if (this.pollClosed) {
                            string4 = LocaleController.getString("FinalResults", R.string.FinalResults);
                        } else {
                            TLRPC$Poll tLRPC$Poll3 = tLRPC$TL_messageMediaPoll3.poll;
                            if (tLRPC$Poll3.quiz) {
                                if (tLRPC$Poll3.public_voters) {
                                    string4 = LocaleController.getString("QuizPoll", R.string.QuizPoll);
                                } else {
                                    string4 = LocaleController.getString("AnonymousQuizPoll", R.string.AnonymousQuizPoll);
                                }
                            } else if (tLRPC$Poll3.public_voters) {
                                string4 = LocaleController.getString("PublicPoll", R.string.PublicPoll);
                            } else {
                                string4 = LocaleController.getString("AnonymousPoll", R.string.AnonymousPoll);
                            }
                        }
                        float f11 = min3;
                        StaticLayout staticLayout7 = new StaticLayout(TextUtils.ellipsize(string4, Theme.chat_timePaint, f11, TextUtils.TruncateAt.END), Theme.chat_timePaint, (AndroidUtilities.dp(2.0f) + min3) - (getExtraTextX() * 2), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        this.docTitleLayout = staticLayout7;
                        if (staticLayout7.getLineCount() > 0) {
                            if (z32 && !LocaleController.isRTL) {
                                this.docTitleOffsetX = (int) Math.ceil(f11 - this.docTitleLayout.getLineWidth(0));
                            } else if (!z32 && LocaleController.isRTL) {
                                this.docTitleOffsetX = -((int) Math.ceil(this.docTitleLayout.getLineLeft(0)));
                            } else {
                                this.docTitleOffsetX = 0;
                            }
                        }
                        int dp26 = min3 - AndroidUtilities.dp(!messageObject.isOutOwner() ? 8.0f : 28.0f);
                        if (!this.isBot) {
                            TLRPC$Poll tLRPC$Poll4 = tLRPC$TL_messageMediaPoll3.poll;
                            TextPaint textPaint = (!tLRPC$Poll4.public_voters && !tLRPC$Poll4.multiple_choice) ? Theme.chat_livePaint : Theme.chat_locationAddressPaint;
                            if (tLRPC$Poll4.quiz) {
                                int i132 = tLRPC$TL_messageMediaPoll3.results.total_voters;
                                ellipsize = TextUtils.ellipsize(i132 != 0 ? LocaleController.formatPluralString("Answer", i132, new Object[0]) : LocaleController.getString("NoVotesQuiz", R.string.NoVotesQuiz), textPaint, dp26, TextUtils.TruncateAt.END);
                            } else {
                                int i133 = tLRPC$TL_messageMediaPoll3.results.total_voters;
                                ellipsize = TextUtils.ellipsize(i133 != 0 ? LocaleController.formatPluralString("Vote", i133, new Object[0]) : LocaleController.getString("NoVotes", R.string.NoVotes), textPaint, dp26, TextUtils.TruncateAt.END);
                            }
                            StaticLayout staticLayout8 = new StaticLayout(ellipsize, textPaint, dp26, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                            this.infoLayout = staticLayout8;
                            TLRPC$Poll tLRPC$Poll5 = tLRPC$TL_messageMediaPoll3.poll;
                            if (!tLRPC$Poll5.public_voters && !tLRPC$Poll5.multiple_choice) {
                                this.infoX = (int) Math.ceil(staticLayout8.getLineCount() <= 0 ? 0.0d : -this.infoLayout.getLineLeft(0));
                                this.availableTimeWidth = (int) ((f11 - this.infoLayout.getLineWidth(0)) - AndroidUtilities.dp(16.0f));
                            } else {
                                double dp27 = this.backgroundWidth - AndroidUtilities.dp(28.0f);
                                double ceil5 = Math.ceil(this.infoLayout.getLineWidth(0));
                                Double.isNaN(dp27);
                                double lineLeft2 = this.infoLayout.getLineLeft(0);
                                Double.isNaN(lineLeft2);
                                this.infoX = (int) (((dp27 - ceil5) / 2.0d) - lineLeft2);
                                this.availableTimeWidth = min3;
                            }
                        }
                        measureTime(messageObject);
                        TLRPC$Poll tLRPC$Poll6 = tLRPC$TL_messageMediaPoll3.poll;
                        this.lastPoll = tLRPC$Poll6;
                        TLRPC$PollResults tLRPC$PollResults3 = tLRPC$TL_messageMediaPoll3.results;
                        this.lastPollResults = tLRPC$PollResults3.results;
                        int i134 = tLRPC$PollResults3.total_voters;
                        this.lastPollResultsVoters = i134;
                        if ((tLRPC$Poll6.multiple_choice && !this.pollVoted && !this.pollClosed) || (!this.isBot && (((z33 = tLRPC$Poll6.public_voters) && this.pollVoted) || (this.pollClosed && tLRPC$PollResults3 != null && i134 != 0 && z33)))) {
                            this.drawInstantView = true;
                            this.drawInstantViewType = 8;
                            createInstantViewButton();
                        }
                        if (tLRPC$TL_messageMediaPoll3.poll.multiple_choice) {
                            createPollUI();
                        }
                        if (tLRPC$TL_messageMediaPoll3.results != null) {
                            createPollUI();
                            int size4 = tLRPC$TL_messageMediaPoll3.results.recent_voters.size();
                            int i135 = 0;
                            while (true) {
                                ImageReceiver[] imageReceiverArr3 = this.pollAvatarImages;
                                if (i135 >= imageReceiverArr3.length) {
                                    break;
                                }
                                if (!this.isBot && i135 < size4) {
                                    imageReceiverArr3[i135].setImageCoords(0.0f, 0.0f, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f));
                                    Long l = tLRPC$TL_messageMediaPoll3.results.recent_voters.get(i135);
                                    TLRPC$User user5 = MessagesController.getInstance(this.currentAccount).getUser(l);
                                    if (user5 != null) {
                                        this.pollAvatarDrawables[i135].setInfo(user5);
                                        this.pollAvatarImages[i135].setForUserOrChat(user5, this.pollAvatarDrawables[i135]);
                                    } else {
                                        this.pollAvatarDrawables[i135].setInfo(l.longValue(), "", "");
                                    }
                                    this.pollAvatarImagesVisible[i135] = true;
                                } else if (!this.pollUnvoteInProgress || size4 != 0) {
                                    imageReceiverArr3[i135].setImageBitmap((Drawable) null);
                                    this.pollAvatarImagesVisible[i135] = false;
                                }
                                i135++;
                                messageObject5 = messageObject;
                                i130 = -1;
                                z51 = false;
                            }
                        } else if (this.pollAvatarImages != null) {
                            int i136 = 0;
                            while (true) {
                                ImageReceiver[] imageReceiverArr4 = this.pollAvatarImages;
                                if (i136 >= imageReceiverArr4.length) {
                                    break;
                                }
                                imageReceiverArr4[i136].setImageBitmap((Drawable) null);
                                this.pollAvatarImagesVisible[i136] = false;
                                i136++;
                            }
                        }
                        if (!this.animatePollAnswer && this.pollVoteInProgress && this.vibrateOnPollVote) {
                            performHapticFeedback(3, 2);
                        }
                        boolean z52 = this.attachedToWindow && (this.pollVoteInProgress || this.pollUnvoteInProgress);
                        this.animatePollAnswer = z52;
                        this.animatePollAnswerAlpha = z52;
                        ArrayList arrayList5 = new ArrayList();
                        if (this.pollButtons.isEmpty()) {
                            arrayList = null;
                            f5 = 1.0f;
                        } else {
                            ArrayList arrayList6 = new ArrayList(this.pollButtons);
                            this.pollButtons.clear();
                            if (!this.animatePollAnswer) {
                                this.animatePollAnswer = this.attachedToWindow && (this.pollVoted || this.pollClosed);
                            }
                            float f12 = this.pollAnimationProgress;
                            f5 = 1.0f;
                            if (f12 > 0.0f && f12 < 1.0f) {
                                int size5 = arrayList6.size();
                                int i137 = 0;
                                while (i137 < size5) {
                                    PollButton pollButton2 = (PollButton) arrayList6.get(i137);
                                    pollButton2.percent = (int) Math.ceil(pollButton2.prevPercent + ((pollButton2.percent - pollButton2.prevPercent) * this.pollAnimationProgress));
                                    pollButton2.percentProgress = pollButton2.prevPercentProgress + ((pollButton2.percentProgress - pollButton2.prevPercentProgress) * this.pollAnimationProgress);
                                    i137++;
                                    messageObject5 = messageObject;
                                    f5 = 1.0f;
                                    i130 = -1;
                                    z51 = false;
                                }
                            }
                            arrayList = arrayList6;
                        }
                        this.pollAnimationProgress = !this.animatePollAnswer ? 1.0f : 0.0f;
                        if (this.animatePollAnswerAlpha) {
                            isSendingVote = null;
                        } else {
                            this.pollVoteInProgress = z51;
                            this.pollVoteInProgressNum = i130;
                            isSendingVote = SendMessagesHelper.getInstance(this.currentAccount).isSendingVote(this.currentMessageObject);
                        }
                        StaticLayout staticLayout9 = this.titleLayout;
                        int height = staticLayout9 == null ? 0 : staticLayout9.getHeight();
                        int i138 = 100;
                        int size6 = tLRPC$TL_messageMediaPoll3.poll.answers.size();
                        byte[] bArr = isSendingVote;
                        int i139 = height;
                        int i140 = 0;
                        int i141 = 0;
                        int i142 = 0;
                        boolean z53 = false;
                        while (i142 < size6) {
                            PollButton pollButton3 = new PollButton();
                            pollButton3.answer = tLRPC$TL_messageMediaPoll3.poll.answers.get(i142);
                            int i143 = size6;
                            int i144 = i142;
                            pollButton3.title = new StaticLayout(Emoji.replaceEmoji(pollButton3.answer.text, Theme.chat_audioPerformerPaint.getFontMetricsInt(), AndroidUtilities.dp(15.0f), false), Theme.chat_audioPerformerPaint, min3 - AndroidUtilities.dp(33.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                            pollButton3.y = AndroidUtilities.dp(52.0f) + i139;
                            pollButton3.height = pollButton3.title.getHeight();
                            this.pollButtons.add(pollButton3);
                            arrayList5.add(pollButton3);
                            i139 += pollButton3.height + AndroidUtilities.dp(26.0f);
                            if (!tLRPC$TL_messageMediaPoll3.results.results.isEmpty()) {
                                int size7 = tLRPC$TL_messageMediaPoll3.results.results.size();
                                int i145 = 0;
                                while (true) {
                                    if (i145 >= size7) {
                                        break;
                                    }
                                    TLRPC$TL_pollAnswerVoters tLRPC$TL_pollAnswerVoters2 = tLRPC$TL_messageMediaPoll3.results.results.get(i145);
                                    if (!Arrays.equals(pollButton3.answer.option, tLRPC$TL_pollAnswerVoters2.option)) {
                                        i145++;
                                    } else {
                                        pollButton3.chosen = tLRPC$TL_pollAnswerVoters2.chosen;
                                        pollButton3.count = tLRPC$TL_pollAnswerVoters2.voters;
                                        pollButton3.correct = tLRPC$TL_pollAnswerVoters2.correct;
                                        if ((!this.pollVoted && !this.pollClosed) || (i62 = tLRPC$TL_messageMediaPoll3.results.total_voters) <= 0) {
                                            pollButton3.percent = 0;
                                            pollButton3.decimal = 0.0f;
                                        } else {
                                            pollButton3.decimal = (tLRPC$TL_pollAnswerVoters2.voters / i62) * 100.0f;
                                            pollButton3.percent = (int) pollButton3.decimal;
                                            PollButton.access$2424(pollButton3, pollButton3.percent);
                                        }
                                        if (i141 != 0) {
                                            if (pollButton3.percent != 0 && i141 != pollButton3.percent) {
                                                z53 = true;
                                            }
                                        } else {
                                            i141 = pollButton3.percent;
                                        }
                                        i138 -= pollButton3.percent;
                                        i140 = Math.max(pollButton3.percent, i140);
                                    }
                                }
                            }
                            if (arrayList != null) {
                                int size8 = arrayList.size();
                                int i146 = 0;
                                while (true) {
                                    if (i146 >= size8) {
                                        break;
                                    }
                                    PollButton pollButton4 = (PollButton) arrayList.get(i146);
                                    if (Arrays.equals(pollButton3.answer.option, pollButton4.answer.option)) {
                                        pollButton3.prevPercent = pollButton4.percent;
                                        pollButton3.prevPercentProgress = pollButton4.percentProgress;
                                        pollButton3.prevChosen = pollButton4.chosen;
                                        break;
                                    }
                                    i146++;
                                }
                            }
                            if (bArr != null && pollButton3.answer.option.length > 0 && Arrays.binarySearch(bArr, pollButton3.answer.option[0]) >= 0) {
                                i61 = i144;
                                this.pollVoteInProgressNum = i61;
                                this.pollVoteInProgress = true;
                                this.vibrateOnPollVote = true;
                                bArr = null;
                            } else {
                                i61 = i144;
                            }
                            if (this.currentMessageObject.checkedVotes.contains(pollButton3.answer)) {
                                this.pollCheckBox[i61].setChecked(true, false);
                            } else {
                                this.pollCheckBox[i61].setChecked(false, false);
                            }
                            i142 = i61 + 1;
                            messageObject5 = messageObject;
                            size6 = i143;
                            f5 = 1.0f;
                            z51 = false;
                        }
                        if (z53 && i138 != 0) {
                            Collections.sort(arrayList5, ChatMessageCell$$ExternalSyntheticLambda6.INSTANCE);
                            int min4 = Math.min(i138, arrayList5.size());
                            for (int i147 = 0; i147 < min4; i147++) {
                                PollButton.access$1712((PollButton) arrayList5.get(i147), 1);
                            }
                        }
                        int dp28 = this.backgroundWidth - AndroidUtilities.dp(76.0f);
                        int size9 = this.pollButtons.size();
                        for (int i148 = 0; i148 < size9; i148++) {
                            this.pollButtons.get(i148).percentProgress = Math.max(AndroidUtilities.dp(5.0f) / dp28, i140 == 0 ? 0.0f : pollButton.percent / i140);
                        }
                        setMessageObjectInternal(messageObject);
                        if (this.isBot && !this.drawInstantView) {
                            i139 -= AndroidUtilities.dp(10.0f);
                        } else {
                            TLRPC$Poll tLRPC$Poll7 = tLRPC$TL_messageMediaPoll3.poll;
                            if (tLRPC$Poll7.public_voters || tLRPC$Poll7.multiple_choice) {
                                i139 += AndroidUtilities.dp(13.0f);
                            }
                        }
                        int dp29 = AndroidUtilities.dp(73.0f);
                        int i149 = this.namesOffset;
                        this.totalHeight = dp29 + i149 + i139;
                        if (this.drawPinnedTop) {
                            this.namesOffset = i149 - AndroidUtilities.dp(f5);
                        }
                        this.instantTextNewLine = z51;
                        TLRPC$Poll tLRPC$Poll8 = tLRPC$TL_messageMediaPoll3.poll;
                        if (tLRPC$Poll8.public_voters || tLRPC$Poll8.multiple_choice) {
                            int i150 = 0;
                            int i151 = 0;
                            for (int i152 = 3; i151 < i152; i152 = 3) {
                                if (i151 == 0) {
                                    string5 = LocaleController.getString("PollViewResults", R.string.PollViewResults);
                                } else if (i151 == 1) {
                                    string5 = LocaleController.getString("PollSubmitVotes", R.string.PollSubmitVotes);
                                } else {
                                    string5 = LocaleController.getString("NoVotes", R.string.NoVotes);
                                }
                                i150 = Math.max(i150, (int) Math.ceil(Theme.chat_instantViewPaint.measureText(string5)));
                                i151++;
                            }
                            int dp30 = this.timeWidth + (!messageObject.isOutOwner() ? 0 : AndroidUtilities.dp(20.0f)) + getExtraTimeX();
                            ReactionsLayoutInBubble reactionsLayoutInBubble13 = this.reactionsLayoutInBubble;
                            if (!reactionsLayoutInBubble13.isSmall && reactionsLayoutInBubble13.isEmpty && dp30 >= ((this.backgroundWidth - AndroidUtilities.dp(76.0f)) - i150) / 2) {
                                this.totalHeight += AndroidUtilities.dp(18.0f);
                                this.instantTextNewLine = true;
                            }
                        }
                        ReactionsLayoutInBubble reactionsLayoutInBubble14 = this.reactionsLayoutInBubble;
                        if (!reactionsLayoutInBubble14.isSmall && !reactionsLayoutInBubble14.isEmpty) {
                            reactionsLayoutInBubble14.measure(min3, 3);
                            this.totalHeight += this.reactionsLayoutInBubble.height + AndroidUtilities.dp(12.0f);
                            if (this.timeWidth + (!messageObject.isOutOwner() ? 0 : AndroidUtilities.dp(20.0f)) + getExtraTimeX() >= (this.backgroundWidth - AndroidUtilities.dp(24.0f)) - this.reactionsLayoutInBubble.lastLineX) {
                                this.totalHeight += AndroidUtilities.dp(16.0f);
                                this.reactionsLayoutInBubble.positionOffsetY -= AndroidUtilities.dp(16.0f);
                            }
                        }
                    } else {
                        this.drawForwardedName = messageObject10.messageOwner.fwd_from != null && (!messageObject.isAnyKindOfSticker() || !messageObject.isDice());
                        if (!messageObject.isAnyKindOfSticker() && messageObject10.type != 5) {
                            this.drawName = ((messageObject.isFromGroup() && messageObject.isSupergroup()) || (messageObject.isImportedForward() && messageObject10.messageOwner.fwd_from.from_id == null)) && ((groupedMessagePosition13 = this.currentPosition) == null || (groupedMessagePosition13.flags & 4) != 0);
                        }
                        int i153 = messageObject10.type;
                        this.mediaBackground = i153 != 9;
                        this.drawImageButton = true;
                        this.drawPhotoImage = true;
                        if (messageObject10.gifState != 2.0f && !SharedConfig.autoplayGifs && (i153 == 8 || i153 == 5)) {
                            messageObject10.gifState = 1.0f;
                        }
                        this.photoImage.setAllowDecodeSingleFrame(true);
                        if (messageObject.isVideo()) {
                            this.photoImage.setAllowStartAnimation(true);
                        } else if (messageObject.isRoundVideo()) {
                            MessageObject playingMessageObject = MediaController.getInstance().getPlayingMessageObject();
                            this.photoImage.setAllowStartAnimation(playingMessageObject == null || !playingMessageObject.isRoundVideo());
                        } else {
                            this.photoImage.setAllowStartAnimation(messageObject10.gifState == 0.0f);
                        }
                        this.photoImage.setForcePreview(messageObject.needDrawBluredPreview());
                        int i154 = messageObject10.type;
                        if (i154 == 9) {
                            messageObject6 = messageObject10;
                            f6 = 1.0f;
                            if (!AndroidUtilities.isTablet()) {
                                this.backgroundWidth = Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(300.0f));
                            } else {
                                this.backgroundWidth = Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(300.0f));
                            }
                            if (checkNeedDrawShareButton(messageObject)) {
                                this.backgroundWidth -= AndroidUtilities.dp(20.0f);
                            }
                            int dp31 = this.backgroundWidth - AndroidUtilities.dp(138.0f);
                            createDocumentLayout(dp31, messageObject6);
                            int dp32 = ((this.backgroundWidth - AndroidUtilities.dp(31.0f)) - AndroidUtilities.dp(10.0f)) - (getExtraTextX() * 2);
                            if (!messageObject6.isRestrictedMessage && !TextUtils.isEmpty(messageObject6.caption)) {
                                try {
                                    CharSequence charSequence3 = messageObject6.caption;
                                    this.currentCaption = charSequence3;
                                    if (Build.VERSION.SDK_INT >= 24) {
                                        this.captionLayout = StaticLayout.Builder.obtain(charSequence3, 0, charSequence3.length(), Theme.chat_msgTextPaint, dp32).setBreakStrategy(1).setHyphenationFrequency(0).setAlignment(Layout.Alignment.ALIGN_NORMAL).build();
                                    } else {
                                        this.captionLayout = new StaticLayout(messageObject6.caption, Theme.chat_msgTextPaint, dp32, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                    }
                                    updateCaptionSpoilers();
                                } catch (Exception e) {
                                    FileLog.e(e);
                                }
                            }
                            StaticLayout staticLayout10 = this.docTitleLayout;
                            if (staticLayout10 == null) {
                                i63 = 0;
                            } else {
                                int lineCount3 = staticLayout10.getLineCount();
                                int i155 = 0;
                                for (int i156 = 0; i156 < lineCount3; i156++) {
                                    i155 = Math.max(i155, ((int) Math.ceil(this.docTitleLayout.getLineWidth(i156) + this.docTitleLayout.getLineLeft(i156))) + AndroidUtilities.dp(86 + (!this.drawPhotoImage ? 22 : 52)));
                                }
                                i63 = i155;
                            }
                            StaticLayout staticLayout11 = this.infoLayout;
                            if (staticLayout11 != null) {
                                int lineCount4 = staticLayout11.getLineCount();
                                int i157 = i63;
                                for (int i158 = 0; i158 < lineCount4; i158++) {
                                    i157 = Math.max(i157, this.infoWidth + AndroidUtilities.dp(86 + (!this.drawPhotoImage ? 22 : 52)));
                                }
                                i63 = i157;
                            }
                            StaticLayout staticLayout12 = this.captionLayout;
                            if (staticLayout12 != null) {
                                int lineCount5 = staticLayout12.getLineCount();
                                int i159 = i63;
                                for (int i160 = 0; i160 < lineCount5; i160++) {
                                    int ceil6 = ((int) Math.ceil(Math.min(dp32, this.captionLayout.getLineWidth(i160) + this.captionLayout.getLineLeft(i160)))) + AndroidUtilities.dp(31.0f);
                                    if (ceil6 > i159) {
                                        i159 = ceil6;
                                    }
                                }
                                i63 = i159;
                            }
                            ReactionsLayoutInBubble reactionsLayoutInBubble15 = this.reactionsLayoutInBubble;
                            if (!reactionsLayoutInBubble15.isSmall) {
                                reactionsLayoutInBubble15.measure(dp32, 3);
                                ReactionsLayoutInBubble reactionsLayoutInBubble16 = this.reactionsLayoutInBubble;
                                if (!reactionsLayoutInBubble16.isEmpty && reactionsLayoutInBubble16.width + AndroidUtilities.dp(31.0f) > i63) {
                                    i63 = this.reactionsLayoutInBubble.width + AndroidUtilities.dp(31.0f);
                                }
                            }
                            if (i63 > 0 && this.currentPosition == null) {
                                this.backgroundWidth = i63;
                                dp31 = i63 - AndroidUtilities.dp(31.0f);
                            }
                            this.availableTimeWidth = dp31;
                            if (this.drawPhotoImage) {
                                dp12 = AndroidUtilities.dp(86.0f);
                                dp13 = AndroidUtilities.dp(86.0f);
                                this.availableTimeWidth -= dp12;
                            } else {
                                dp12 = AndroidUtilities.dp(56.0f);
                                dp13 = AndroidUtilities.dp(56.0f);
                                StaticLayout staticLayout13 = this.docTitleLayout;
                                if (staticLayout13 != null && staticLayout13.getLineCount() > 1) {
                                    dp13 += (this.docTitleLayout.getLineCount() - 1) * AndroidUtilities.dp(16.0f);
                                }
                                if (TextUtils.isEmpty(messageObject6.caption) && (staticLayout4 = this.infoLayout) != null) {
                                    int lineCount6 = staticLayout4.getLineCount();
                                    measureTime(messageObject);
                                    int dp33 = (this.backgroundWidth - AndroidUtilities.dp(122.0f)) - this.infoWidth;
                                    ReactionsLayoutInBubble reactionsLayoutInBubble17 = this.reactionsLayoutInBubble;
                                    if (reactionsLayoutInBubble17.isSmall || reactionsLayoutInBubble17.isEmpty) {
                                        if (dp33 < this.timeWidth) {
                                            dp14 = AndroidUtilities.dp(12.0f);
                                        } else if (lineCount6 == 1) {
                                            dp14 = AndroidUtilities.dp(4.0f);
                                        }
                                        dp13 += dp14;
                                    }
                                }
                            }
                            i64 = dp12;
                            i65 = dp13;
                            ReactionsLayoutInBubble reactionsLayoutInBubble18 = this.reactionsLayoutInBubble;
                            if (!reactionsLayoutInBubble18.isSmall && !reactionsLayoutInBubble18.isEmpty) {
                                if (!this.drawPhotoImage) {
                                    reactionsLayoutInBubble18.positionOffsetY += AndroidUtilities.dp(2.0f);
                                }
                                if (this.captionLayout != null && this.currentPosition != null && (groupedMessages5 = this.currentMessagesGroup) != null && groupedMessages5.isDocuments) {
                                    this.reactionsLayoutInBubble.positionOffsetY += AndroidUtilities.dp(10.0f);
                                } else if (!this.drawPhotoImage && !TextUtils.isEmpty(messageObject6.caption) && (((staticLayout3 = this.docTitleLayout) != null && staticLayout3.getLineCount() > 1) || this.currentMessageObject.hasValidReplyMessageObject())) {
                                    this.reactionsLayoutInBubble.positionOffsetY += AndroidUtilities.dp(10.0f);
                                } else if (!this.drawPhotoImage && !TextUtils.isEmpty(messageObject6.caption) && !this.currentMessageObject.isOutOwner()) {
                                    this.reactionsLayoutInBubble.positionOffsetY += AndroidUtilities.dp(10.0f);
                                }
                                ReactionsLayoutInBubble reactionsLayoutInBubble19 = this.reactionsLayoutInBubble;
                                reactionsLayoutInBubble19.totalHeight = reactionsLayoutInBubble19.height + AndroidUtilities.dp(8.0f);
                                measureTime(messageObject);
                                if (this.drawPhotoImage && this.captionLayout == null) {
                                    this.reactionsLayoutInBubble.totalHeight += AndroidUtilities.dp(8.0f);
                                }
                                if (this.captionLayout != null && (messageObject7 = this.currentMessageObject) != null && messageObject7.isOutOwner() && this.currentMessageObject.isDocument() && this.currentMessagesGroup == null && !this.currentMessageObject.isForwarded() && !this.currentMessageObject.isReply()) {
                                    this.reactionsLayoutInBubble.positionOffsetY += AndroidUtilities.dp(10.0f);
                                }
                                if ((this.backgroundWidth - this.reactionsLayoutInBubble.lastLineX) - AndroidUtilities.dp(31.0f) < this.timeWidth) {
                                    this.reactionsLayoutInBubble.totalHeight += AndroidUtilities.dp(12.0f);
                                    this.reactionsLayoutInBubble.positionOffsetY -= AndroidUtilities.dp(12.0f);
                                }
                                i66 = this.reactionsLayoutInBubble.totalHeight + 0;
                            } else {
                                i66 = 0;
                            }
                            i67 = i66;
                            i68 = 0;
                        } else {
                            if (i154 == 4) {
                                messageObject6 = messageObject10;
                                f6 = 1.0f;
                                TLRPC$GeoPoint tLRPC$GeoPoint = MessageObject.getMedia(messageObject6.messageOwner).geo;
                                double d = tLRPC$GeoPoint.lat;
                                double d2 = tLRPC$GeoPoint._long;
                                if (((int) messageObject.getDialogId()) == 0 && (i76 = SharedConfig.mapPreviewType) != 0) {
                                    if (i76 == 1) {
                                        i71 = 4;
                                    } else if (i76 == 3) {
                                        i71 = 1;
                                    }
                                    if (!(MessageObject.getMedia(messageObject6.messageOwner) instanceof TLRPC$TL_messageMediaGeoLive)) {
                                        if (!AndroidUtilities.isTablet()) {
                                            this.backgroundWidth = Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(289.0f));
                                        } else {
                                            this.backgroundWidth = Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(289.0f));
                                        }
                                        this.backgroundWidth -= AndroidUtilities.dp(4.0f);
                                        if (checkNeedDrawShareButton(messageObject)) {
                                            this.backgroundWidth -= AndroidUtilities.dp(20.0f);
                                        }
                                        int dp34 = this.backgroundWidth - AndroidUtilities.dp(37.0f);
                                        this.availableTimeWidth = dp34;
                                        int dp35 = dp34 - AndroidUtilities.dp(54.0f);
                                        int dp36 = this.backgroundWidth - AndroidUtilities.dp(17.0f);
                                        int dp37 = AndroidUtilities.dp(195.0f);
                                        double d3 = 268435456;
                                        Double.isNaN(d3);
                                        double d4 = d3 / 3.141592653589793d;
                                        double d5 = (d * 3.141592653589793d) / 180.0d;
                                        Double.isNaN(d3);
                                        double round2 = Math.round(d3 - ((Math.log((Math.sin(d5) + 1.0d) / (1.0d - Math.sin(d5))) * d4) / 2.0d)) - (AndroidUtilities.dp(10.3f) << 6);
                                        Double.isNaN(round2);
                                        Double.isNaN(d3);
                                        double atan = ((1.5707963267948966d - (Math.atan(Math.exp((round2 - d3) / d4)) * 2.0d)) * 180.0d) / 3.141592653589793d;
                                        int i161 = this.currentAccount;
                                        float f13 = dp36;
                                        float f14 = AndroidUtilities.density;
                                        float f15 = dp37;
                                        this.currentUrl = AndroidUtilities.formapMapUrl(i161, atan, d2, (int) (f13 / f14), (int) (f15 / f14), false, 15, i71);
                                        this.lastWebFile = this.currentWebFile;
                                        long j3 = tLRPC$GeoPoint.access_hash;
                                        float f16 = AndroidUtilities.density;
                                        this.currentWebFile = WebFile.createWithGeoPoint(atan, d2, j3, (int) (f13 / f16), (int) (f15 / f16), 15, Math.min(2, (int) Math.ceil(f16)));
                                        boolean isCurrentLocationTimeExpired = isCurrentLocationTimeExpired(messageObject);
                                        this.locationExpired = isCurrentLocationTimeExpired;
                                        if (!isCurrentLocationTimeExpired) {
                                            this.photoImage.setCrossfadeWithOldImage(true);
                                            this.mediaBackground = false;
                                            dp16 = AndroidUtilities.dp(56.0f);
                                            AndroidUtilities.runOnUIThread(this.invalidateRunnable, 1000L);
                                            this.scheduledInvalidate = true;
                                        } else {
                                            this.backgroundWidth -= AndroidUtilities.dp(9.0f);
                                            dp16 = 0;
                                        }
                                        this.docTitleLayout = new StaticLayout(TextUtils.ellipsize(LocaleController.getString("AttachLiveLocation", R.string.AttachLiveLocation), Theme.chat_locationTitlePaint, dp35, TextUtils.TruncateAt.END), Theme.chat_locationTitlePaint, dp35 + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                        updateCurrentUserAndChat();
                                        TLRPC$User tLRPC$User = this.currentUser;
                                        if (tLRPC$User != null) {
                                            this.contactAvatarDrawable.setInfo(tLRPC$User);
                                            this.locationImageReceiver.setForUserOrChat(this.currentUser, this.contactAvatarDrawable);
                                        } else {
                                            TLRPC$Chat tLRPC$Chat2 = this.currentChat;
                                            if (tLRPC$Chat2 != null) {
                                                TLRPC$ChatPhoto tLRPC$ChatPhoto = tLRPC$Chat2.photo;
                                                if (tLRPC$ChatPhoto != null) {
                                                    this.currentPhoto = tLRPC$ChatPhoto.photo_small;
                                                }
                                                this.contactAvatarDrawable.setInfo(tLRPC$Chat2);
                                                this.locationImageReceiver.setForUserOrChat(this.currentChat, this.contactAvatarDrawable);
                                            } else {
                                                this.locationImageReceiver.setImage(null, null, this.contactAvatarDrawable, null, null, 0);
                                            }
                                        }
                                        messageObject6 = messageObject;
                                        int i162 = messageObject6.messageOwner.edit_date;
                                        this.infoLayout = new StaticLayout(TextUtils.ellipsize(LocaleController.formatLocationUpdateDate(i162 == 0 ? tLRPC$Message3.date : i162), Theme.chat_locationAddressPaint, AndroidUtilities.dp(2.0f) + dp35, TextUtils.TruncateAt.END), Theme.chat_locationAddressPaint, dp35, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                        i64 = dp36;
                                        i72 = dp37;
                                    } else if (!TextUtils.isEmpty(MessageObject.getMedia(messageObject6.messageOwner).title)) {
                                        if (!AndroidUtilities.isTablet()) {
                                            this.backgroundWidth = Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(289.0f));
                                        } else {
                                            this.backgroundWidth = Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(289.0f));
                                        }
                                        this.backgroundWidth -= AndroidUtilities.dp(4.0f);
                                        if (checkNeedDrawShareButton(messageObject)) {
                                            this.backgroundWidth -= AndroidUtilities.dp(20.0f);
                                        }
                                        int dp38 = this.backgroundWidth - AndroidUtilities.dp(34.0f);
                                        this.availableTimeWidth = dp38;
                                        int dp39 = this.backgroundWidth - AndroidUtilities.dp(17.0f);
                                        int dp40 = AndroidUtilities.dp(195.0f);
                                        this.mediaBackground = false;
                                        int i163 = this.currentAccount;
                                        float f17 = dp39;
                                        float f18 = AndroidUtilities.density;
                                        float f19 = dp40;
                                        this.currentUrl = AndroidUtilities.formapMapUrl(i163, d, d2, (int) (f17 / f18), (int) (f19 / f18), true, 15, i71);
                                        float f20 = AndroidUtilities.density;
                                        this.currentWebFile = WebFile.createWithGeoPoint(tLRPC$GeoPoint, (int) (f17 / f20), (int) (f19 / f20), 15, Math.min(2, (int) Math.ceil(f20)));
                                        this.docTitleLayout = StaticLayoutEx.createStaticLayout(MessageObject.getMedia(messageObject6.messageOwner).title, Theme.chat_locationTitlePaint, dp38 + AndroidUtilities.dp(4.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false, TextUtils.TruncateAt.END, dp38, 1);
                                        int dp41 = AndroidUtilities.dp(50.0f) + 0;
                                        this.docTitleLayout.getLineCount();
                                        if (!TextUtils.isEmpty(MessageObject.getMedia(messageObject6.messageOwner).address)) {
                                            this.infoLayout = StaticLayoutEx.createStaticLayout(MessageObject.getMedia(messageObject6.messageOwner).address, Theme.chat_locationAddressPaint, dp38, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false, TextUtils.TruncateAt.END, dp38, 1);
                                            measureTime(messageObject);
                                            int ceil7 = (this.backgroundWidth - ((int) Math.ceil(this.infoLayout.getLineWidth(0)))) - AndroidUtilities.dp(24.0f);
                                            boolean z54 = this.infoLayout.getLineLeft(0) > 0.0f;
                                            if (!z54) {
                                            }
                                            dp41 += AndroidUtilities.dp(!z54 ? 8.0f : 10.0f);
                                            dp16 = dp41;
                                        } else {
                                            this.infoLayout = null;
                                            dp16 = dp41;
                                        }
                                        i64 = dp39;
                                        i72 = dp40;
                                    } else {
                                        if (!AndroidUtilities.isTablet()) {
                                            this.backgroundWidth = Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(289.0f));
                                        } else {
                                            this.backgroundWidth = Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 50.0f : 102.0f), AndroidUtilities.dp(289.0f));
                                        }
                                        this.backgroundWidth -= AndroidUtilities.dp(4.0f);
                                        if (checkNeedDrawShareButton(messageObject)) {
                                            this.backgroundWidth -= AndroidUtilities.dp(20.0f);
                                        }
                                        this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(34.0f);
                                        int dp42 = this.backgroundWidth - AndroidUtilities.dp(8.0f);
                                        int dp43 = AndroidUtilities.dp(195.0f);
                                        int i164 = this.currentAccount;
                                        float f21 = dp42;
                                        float f22 = AndroidUtilities.density;
                                        float f23 = dp43;
                                        this.currentUrl = AndroidUtilities.formapMapUrl(i164, d, d2, (int) (f21 / f22), (int) (f23 / f22), true, 15, i71);
                                        float f24 = AndroidUtilities.density;
                                        this.currentWebFile = WebFile.createWithGeoPoint(tLRPC$GeoPoint, (int) (f21 / f24), (int) (f23 / f24), 15, Math.min(2, (int) Math.ceil(f24)));
                                        i64 = dp42;
                                        i72 = dp43;
                                        dp16 = 0;
                                    }
                                    if (((int) messageObject.getDialogId()) != 0) {
                                        int i165 = SharedConfig.mapPreviewType;
                                        if (i165 != 0) {
                                            if (i165 == 1) {
                                                i74 = -1;
                                                this.currentMapProvider = 1;
                                            } else if (i165 == 3) {
                                                i74 = -1;
                                                this.currentMapProvider = 1;
                                            } else {
                                                i74 = -1;
                                                this.currentMapProvider = -1;
                                            }
                                            i73 = 2;
                                        } else {
                                            i73 = 2;
                                            i74 = -1;
                                            this.currentMapProvider = 2;
                                        }
                                    } else {
                                        this.currentMapProvider = MessagesController.getInstance(messageObject6.currentAccount).mapProvider;
                                        i73 = 2;
                                        i74 = -1;
                                    }
                                    i75 = this.currentMapProvider;
                                    if (i75 != i74) {
                                        this.photoImage.setImage(null, null, null, null, messageObject, 0);
                                    } else if (i75 == i73) {
                                        if (this.currentWebFile != null) {
                                            WebFile webFile5 = this.lastWebFile;
                                            this.photoImage.setImage(ImageLocation.getForWebFile(this.currentWebFile), (String) null, webFile5 != null ? ImageLocation.getForWebFile(webFile5) : null, (String) null, (Drawable) null, messageObject, 0);
                                        }
                                    } else {
                                        if (i75 == 3 || i75 == 4) {
                                            ImageLoader.getInstance().addTestWebFile(this.currentUrl, this.currentWebFile);
                                            this.addedForTest = true;
                                        }
                                        String str22 = this.currentUrl;
                                        if (str22 != null) {
                                            this.photoImage.setImage(str22, null, null, null, 0L);
                                        }
                                    }
                                    reactionsLayoutInBubble5 = this.reactionsLayoutInBubble;
                                    if (!reactionsLayoutInBubble5.isSmall && !reactionsLayoutInBubble5.isEmpty) {
                                        reactionsLayoutInBubble5.measure(this.backgroundWidth - AndroidUtilities.dp(16.0f), 3);
                                        ReactionsLayoutInBubble reactionsLayoutInBubble20 = this.reactionsLayoutInBubble;
                                        reactionsLayoutInBubble20.totalHeight = reactionsLayoutInBubble20.height + AndroidUtilities.dp(14.0f);
                                        measureTime(messageObject);
                                        if (this.reactionsLayoutInBubble.lastLineX + this.timeWidth + AndroidUtilities.dp(24.0f) > this.backgroundWidth) {
                                            this.reactionsLayoutInBubble.totalHeight += AndroidUtilities.dp(12.0f);
                                            this.reactionsLayoutInBubble.positionOffsetY -= AndroidUtilities.dp(12.0f);
                                        }
                                        dp16 += this.reactionsLayoutInBubble.totalHeight;
                                    }
                                    i67 = dp16;
                                    z26 = true;
                                    i65 = i72;
                                    i68 = 0;
                                }
                                i71 = -1;
                                if (!(MessageObject.getMedia(messageObject6.messageOwner) instanceof TLRPC$TL_messageMediaGeoLive)) {
                                }
                                if (((int) messageObject.getDialogId()) != 0) {
                                }
                                i75 = this.currentMapProvider;
                                if (i75 != i74) {
                                }
                                reactionsLayoutInBubble5 = this.reactionsLayoutInBubble;
                                if (!reactionsLayoutInBubble5.isSmall) {
                                    reactionsLayoutInBubble5.measure(this.backgroundWidth - AndroidUtilities.dp(16.0f), 3);
                                    ReactionsLayoutInBubble reactionsLayoutInBubble202 = this.reactionsLayoutInBubble;
                                    reactionsLayoutInBubble202.totalHeight = reactionsLayoutInBubble202.height + AndroidUtilities.dp(14.0f);
                                    measureTime(messageObject);
                                    if (this.reactionsLayoutInBubble.lastLineX + this.timeWidth + AndroidUtilities.dp(24.0f) > this.backgroundWidth) {
                                    }
                                    dp16 += this.reactionsLayoutInBubble.totalHeight;
                                }
                                i67 = dp16;
                                z26 = true;
                                i65 = i72;
                                i68 = 0;
                            } else if (i154 == 19) {
                                messageObject6 = messageObject10;
                                f6 = 1.0f;
                                this.drawBackground = false;
                                int i166 = messageObject6.textWidth;
                                int dp44 = messageObject6.textHeight + AndroidUtilities.dp(32.0f);
                                this.backgroundWidth = AndroidUtilities.dp(14.0f) + i166;
                                this.availableTimeWidth = i166 - AndroidUtilities.dp(12.0f);
                                if (AndroidUtilities.isTablet()) {
                                    minTabletSide7 = AndroidUtilities.getMinTabletSide();
                                    f7 = 0.4f;
                                } else {
                                    minTabletSide7 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                                    f7 = 0.5f;
                                }
                                int max6 = Math.max(this.backgroundWidth, (int) (minTabletSide7 * f7));
                                ReactionsLayoutInBubble reactionsLayoutInBubble21 = this.reactionsLayoutInBubble;
                                if (reactionsLayoutInBubble21.isSmall) {
                                    dp17 = 0;
                                } else {
                                    reactionsLayoutInBubble21.measure(max6, !this.currentMessageObject.isOutOwner() ? 3 : 5);
                                    ReactionsLayoutInBubble reactionsLayoutInBubble22 = this.reactionsLayoutInBubble;
                                    reactionsLayoutInBubble22.drawServiceShaderBackground = true;
                                    int i167 = reactionsLayoutInBubble22.height;
                                    reactionsLayoutInBubble22.totalHeight = i167;
                                    dp17 = 0 + i167 + AndroidUtilities.dp(8.0f);
                                    this.reactionsLayoutInBubble.positionOffsetY += AndroidUtilities.dp(8.0f);
                                }
                                i64 = i166;
                                i65 = dp44;
                                i67 = dp17 - AndroidUtilities.dp(17.0f);
                                i68 = 0;
                            } else if (messageObject.isAnyKindOfSticker()) {
                                f6 = 1.0f;
                                this.drawBackground = false;
                                messageObject6 = messageObject;
                                boolean z55 = messageObject6.type == 13;
                                TLRPC$Document document2 = messageObject.getDocument();
                                if (document2 != null) {
                                    for (int i168 = 0; i168 < document2.attributes.size(); i168++) {
                                        TLRPC$DocumentAttribute tLRPC$DocumentAttribute = document2.attributes.get(i168);
                                        if (tLRPC$DocumentAttribute instanceof TLRPC$TL_documentAttributeImageSize) {
                                            i77 = tLRPC$DocumentAttribute.w;
                                            i78 = tLRPC$DocumentAttribute.h;
                                        } else if (tLRPC$DocumentAttribute instanceof TLRPC$TL_documentAttributeVideo) {
                                            i77 = tLRPC$DocumentAttribute.w;
                                            i78 = tLRPC$DocumentAttribute.h;
                                        }
                                        i79 = i77;
                                    }
                                }
                                i78 = 0;
                                i79 = 0;
                                if ((messageObject.isAnimatedSticker() || messageObject.isVideoSticker()) && i79 == 0 && i78 == 0) {
                                    i79 = 512;
                                    i78 = 512;
                                }
                                if (messageObject.isAnimatedAnimatedEmoji()) {
                                    i79 = Math.max(512, i79);
                                    i78 = Math.max(512, i78);
                                }
                                if (AndroidUtilities.isTablet()) {
                                    minTabletSide8 = AndroidUtilities.getMinTabletSide();
                                    f8 = 0.4f;
                                } else {
                                    minTabletSide8 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                                    f8 = 0.5f;
                                }
                                int i169 = (int) (minTabletSide8 * f8);
                                float f25 = i169;
                                if (!messageObject.isAnimatedEmoji() && !messageObject.isDice()) {
                                    if (i79 == 0) {
                                        i78 = (int) f25;
                                        i79 = i78 + AndroidUtilities.dp(100.0f);
                                    }
                                    float f26 = i78;
                                    float f27 = i169;
                                    int i170 = (int) (f26 * (f27 / i79));
                                    float f28 = i170;
                                    if (f28 <= f25) {
                                        i80 = i170;
                                        i81 = i169;
                                    } else {
                                        i81 = (int) (f27 * (f25 / f28));
                                        i80 = (int) f25;
                                    }
                                } else {
                                    float f29 = MessagesController.getInstance(this.currentAccount).animatedEmojisZoom;
                                    i80 = (int) ((i78 / 512.0f) * f25 * f29);
                                    i81 = (int) ((i79 / 512.0f) * i169 * f29);
                                }
                                float f30 = AndroidUtilities.density;
                                int i171 = (int) (i81 / f30);
                                int i172 = (int) (i80 / f30);
                                ChatMessageCellDelegate chatMessageCellDelegate3 = this.delegate;
                                boolean z56 = chatMessageCellDelegate3 != null && chatMessageCellDelegate3.shouldRepeatSticker(messageObject6);
                                BitmapDrawable bitmapDrawable3 = this.currentMessageObject.strippedThumb;
                                if (bitmapDrawable3 == null) {
                                    this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject6.photoThumbs, 40);
                                } else {
                                    this.currentPhotoObjectThumbStripped = bitmapDrawable3;
                                }
                                this.photoParentObject = messageObject6.photoThumbsObject;
                                if (messageObject.isDice()) {
                                    String format3 = String.format(Locale.US, "%d_%d_dice_%s_%s", Integer.valueOf(i171), Integer.valueOf(i172), messageObject.getDiceEmoji(), messageObject.toString());
                                    this.photoImage.setAutoRepeat(2);
                                    String diceEmoji = this.currentMessageObject.getDiceEmoji();
                                    TLRPC$TL_messages_stickerSet stickerSetByEmojiOrName = MediaDataController.getInstance(this.currentAccount).getStickerSetByEmojiOrName(diceEmoji);
                                    if (stickerSetByEmojiOrName != null && stickerSetByEmojiOrName.documents.size() > 0 && this.currentMessageObject.getDiceValue() <= 0) {
                                        TLRPC$Document tLRPC$Document5 = stickerSetByEmojiOrName.documents.get(0);
                                        if ("🎰".equals(diceEmoji)) {
                                            this.currentPhotoObjectThumb = null;
                                        } else {
                                            this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document5.thumbs, 40);
                                        }
                                        this.photoParentObject = tLRPC$Document5;
                                    }
                                    str19 = format3;
                                    svgDrawable = null;
                                    messageObject8 = messageObject6;
                                } else {
                                    if (messageObject.isAnimatedEmoji()) {
                                        if (messageObject6.emojiAnimatedSticker == null && messageObject6.emojiAnimatedStickerId != null) {
                                            String format4 = String.format(Locale.US, "%d_%d_nr_messageId=%d", Integer.valueOf(i171), Integer.valueOf(i172), Integer.valueOf(messageObject6.stableId));
                                            SvgHelper.SvgDrawable circleThumb = DocumentObject.getCircleThumb(0.4f, "chat_serviceBackground", this.resourcesProvider, 0.65f);
                                            this.photoImage.setAutoRepeat(1);
                                            messageObject.loadAnimatedEmojiDocument();
                                            str19 = format4;
                                            svgDrawable2 = circleThumb;
                                        } else {
                                            String format5 = String.format(Locale.US, "%d_%d_nr_messageId=%d" + messageObject6.emojiAnimatedStickerColor, Integer.valueOf(i171), Integer.valueOf(i172), Integer.valueOf(messageObject6.stableId));
                                            if (MessageObject.isAnimatedEmoji(messageObject6.emojiAnimatedSticker)) {
                                                z34 = true;
                                                this.photoImage.setAutoRepeat(1);
                                            } else {
                                                this.photoImage.setAutoRepeat(!z56 ? 3 : 2);
                                                z34 = true;
                                            }
                                            ?? inputStickerSet = MessageObject.getInputStickerSet(messageObject6.emojiAnimatedSticker);
                                            if (messageObject6.emojiAnimatedStickerId != null) {
                                                this.photoImage.setCrossfadeWithOldImage(z34);
                                            }
                                            str19 = format5;
                                            messageObject8 = inputStickerSet;
                                            svgDrawable = null;
                                        }
                                    } else {
                                        if (SharedConfig.loopStickers || (z55 && !messageObject.isVideoSticker())) {
                                            format = String.format(Locale.US, "%d_%d", Integer.valueOf(i171), Integer.valueOf(i172));
                                            this.photoImage.setAutoRepeat(1);
                                        } else {
                                            format = String.format(Locale.US, "%d_%d_nr_messageId=%d", Integer.valueOf(i171), Integer.valueOf(i172), Integer.valueOf(messageObject6.stableId));
                                            this.photoImage.setAutoRepeat(!z56 ? 3 : 2);
                                        }
                                        str19 = format;
                                        svgDrawable2 = null;
                                    }
                                    messageObject8 = messageObject6;
                                    svgDrawable = svgDrawable2;
                                }
                                this.documentAttachType = 6;
                                this.availableTimeWidth = i81 - AndroidUtilities.dp(14.0f);
                                this.backgroundWidth = AndroidUtilities.dp(12.0f) + i81;
                                this.photoImage.setRoundRadius(0);
                                if (!messageObject.isOutOwner() && MessageObject.isPremiumSticker(messageObject.getDocument())) {
                                    this.flipImage = true;
                                }
                                if (messageObject.getDocument() != null) {
                                    i82 = i80;
                                    if (messageObject.isVideoSticker()) {
                                        if (!SharedConfig.loopStickers) {
                                            this.photoImage.animatedFileDrawableRepeatMaxCount = 1;
                                        }
                                        this.photoImage.setImage(ImageLocation.getForDocument(messageObject.getDocument()), ImageLoader.AUTOPLAY_FILTER, null, null, messageObject6.pathThumb, messageObject.getDocument().size, !z55 ? null : "webp", messageObject8, 1);
                                    } else if (messageObject6.pathThumb != null) {
                                        this.photoImage.setImage(ImageLocation.getForDocument(messageObject.getDocument()), str19, messageObject6.pathThumb, messageObject.getDocument().size, !z55 ? null : "webp", messageObject8, 1);
                                    } else if (messageObject6.attachPathExists) {
                                        this.photoImage.setImage(ImageLocation.getForPath(messageObject6.messageOwner.attachPath), str19, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), "b1", svgDrawable == null ? this.currentPhotoObjectThumbStripped : svgDrawable, messageObject.getDocument().size, !z55 ? null : "webp", messageObject8, 1);
                                    } else if (messageObject.getDocument().id != 0) {
                                        this.photoImage.setImage(ImageLocation.getForDocument(messageObject.getDocument()), str19, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), "b1", svgDrawable == null ? this.currentPhotoObjectThumbStripped : svgDrawable, messageObject.getDocument().size, !z55 ? null : "webp", messageObject8, 1);
                                    } else {
                                        this.photoImage.setImage(null, null, svgDrawable, null, messageObject, 0);
                                    }
                                } else {
                                    i82 = i80;
                                    this.photoImage.setImage(null, null, svgDrawable, null, messageObject, 0);
                                }
                                ReactionsLayoutInBubble reactionsLayoutInBubble23 = this.reactionsLayoutInBubble;
                                if (reactionsLayoutInBubble23.isSmall) {
                                    i83 = 0;
                                } else {
                                    reactionsLayoutInBubble23.measure(i169, (this.currentMessageObject.isOutOwner() && (this.currentMessageObject.isAnimatedEmoji() || this.currentMessageObject.isAnyKindOfSticker())) ? 5 : 3);
                                    ReactionsLayoutInBubble reactionsLayoutInBubble24 = this.reactionsLayoutInBubble;
                                    reactionsLayoutInBubble24.drawServiceShaderBackground = true;
                                    reactionsLayoutInBubble24.totalHeight = reactionsLayoutInBubble24.height + AndroidUtilities.dp(8.0f);
                                    i83 = this.reactionsLayoutInBubble.totalHeight + 0;
                                    if (!this.currentMessageObject.isAnimatedEmoji()) {
                                        this.reactionsLayoutInBubble.positionOffsetY += AndroidUtilities.dp(4.0f);
                                    }
                                }
                                i67 = i83;
                                i64 = i81;
                                i65 = i82;
                                i68 = 0;
                                z26 = false;
                            } else {
                                this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(messageObject10.photoThumbs, AndroidUtilities.getPhotoSize());
                                this.photoParentObject = messageObject10.photoThumbsObject;
                                if (messageObject10.type == 5) {
                                    this.documentAttach = messageObject.getDocument();
                                    this.documentAttachType = 7;
                                    i84 = 0;
                                } else {
                                    if (AndroidUtilities.isTablet()) {
                                        minTabletSide11 = AndroidUtilities.getMinTabletSide();
                                    } else {
                                        TLRPC$PhotoSize tLRPC$PhotoSize9 = this.currentPhotoObject;
                                        if (tLRPC$PhotoSize9 != null && (((i110 = messageObject10.type) == 1 || i110 == 20 || i110 == 3 || i110 == 8) && tLRPC$PhotoSize9.w >= tLRPC$PhotoSize9.h)) {
                                            i84 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y) - AndroidUtilities.dp(64 + (!checkNeedDrawShareButton(messageObject) ? 0 : 10));
                                            z35 = true;
                                            int dp45 = AndroidUtilities.dp(100.0f) + i84;
                                            if (z35) {
                                                if (messageObject10.type != 5 && checkNeedDrawShareButton(messageObject)) {
                                                    i84 -= AndroidUtilities.dp(20.0f);
                                                }
                                                if (i84 > AndroidUtilities.getPhotoSize()) {
                                                    i84 = AndroidUtilities.getPhotoSize();
                                                }
                                                if (dp45 > AndroidUtilities.getPhotoSize()) {
                                                    dp45 = AndroidUtilities.getPhotoSize();
                                                }
                                            } else if (z8) {
                                                i84 -= AndroidUtilities.dp(52.0f);
                                            }
                                            i85 = messageObject10.type;
                                            if (i85 == 1 || i85 == 20) {
                                                updateSecretTimeText(messageObject);
                                                this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject10.photoThumbs, 40);
                                            } else {
                                                if (i85 == 3 || i85 == 8) {
                                                    createDocumentLayout(0, messageObject10);
                                                    this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject10.photoThumbs, 40);
                                                    updateSecretTimeText(messageObject);
                                                } else if (i85 == 5) {
                                                    this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject10.photoThumbs, 40);
                                                }
                                                z36 = true;
                                                bitmapDrawable2 = this.currentMessageObject.strippedThumb;
                                                if (bitmapDrawable2 != null) {
                                                    this.currentPhotoObjectThumb = null;
                                                    this.currentPhotoObjectThumbStripped = bitmapDrawable2;
                                                }
                                                if (messageObject10.type == 5) {
                                                    if (this.isPlayingRound) {
                                                        i86 = AndroidUtilities.roundPlayingMessageSize;
                                                    } else {
                                                        i86 = AndroidUtilities.roundMessageSize;
                                                    }
                                                    i87 = i86;
                                                } else {
                                                    TLRPC$PhotoSize tLRPC$PhotoSize10 = this.currentPhotoObject;
                                                    if (tLRPC$PhotoSize10 == null) {
                                                        tLRPC$PhotoSize10 = this.currentPhotoObjectThumb;
                                                    }
                                                    if (messageObject.hasExtendedMediaPreview()) {
                                                        TLRPC$TL_messageExtendedMediaPreview tLRPC$TL_messageExtendedMediaPreview = (TLRPC$TL_messageExtendedMediaPreview) messageObject10.messageOwner.media.extended_media;
                                                        i107 = tLRPC$TL_messageExtendedMediaPreview.w;
                                                        if (i107 == 0 || (i109 = tLRPC$TL_messageExtendedMediaPreview.h) == 0) {
                                                            TLRPC$PhotoSize tLRPC$PhotoSize11 = tLRPC$TL_messageExtendedMediaPreview.thumb;
                                                            if (tLRPC$PhotoSize11 != null) {
                                                                i107 = tLRPC$PhotoSize11.w;
                                                                i108 = tLRPC$PhotoSize11.h;
                                                            }
                                                            i108 = 0;
                                                            i107 = 0;
                                                        } else {
                                                            i108 = i109;
                                                        }
                                                        Point messageSize = getMessageSize(i107, i108, i84, dp45);
                                                        i86 = (int) messageSize.x;
                                                        i87 = (int) messageSize.y;
                                                    } else {
                                                        if (tLRPC$PhotoSize10 != null && !(tLRPC$PhotoSize10 instanceof TLRPC$TL_photoStrippedSize)) {
                                                            i107 = tLRPC$PhotoSize10.w;
                                                            i108 = tLRPC$PhotoSize10.h;
                                                        } else {
                                                            TLRPC$Document tLRPC$Document6 = this.documentAttach;
                                                            if (tLRPC$Document6 != null) {
                                                                int size10 = tLRPC$Document6.attributes.size();
                                                                int i173 = 0;
                                                                int i174 = 0;
                                                                for (int i175 = 0; i175 < size10; i175++) {
                                                                    TLRPC$DocumentAttribute tLRPC$DocumentAttribute2 = this.documentAttach.attributes.get(i175);
                                                                    if (tLRPC$DocumentAttribute2 instanceof TLRPC$TL_documentAttributeVideo) {
                                                                        i173 = tLRPC$DocumentAttribute2.w;
                                                                        i174 = tLRPC$DocumentAttribute2.h;
                                                                    }
                                                                }
                                                                i107 = i173;
                                                                i108 = i174;
                                                            }
                                                            i108 = 0;
                                                            i107 = 0;
                                                        }
                                                        Point messageSize2 = getMessageSize(i107, i108, i84, dp45);
                                                        i86 = (int) messageSize2.x;
                                                        i87 = (int) messageSize2.y;
                                                    }
                                                }
                                                tLRPC$PhotoSize3 = this.currentPhotoObject;
                                                if (tLRPC$PhotoSize3 != null && "s".equals(tLRPC$PhotoSize3.type)) {
                                                    this.currentPhotoObject = null;
                                                }
                                                tLRPC$PhotoSize4 = this.currentPhotoObject;
                                                if (tLRPC$PhotoSize4 != null && tLRPC$PhotoSize4 == this.currentPhotoObjectThumb) {
                                                    i106 = messageObject10.type;
                                                    if (i106 == 1 || i106 == 20) {
                                                        this.currentPhotoObjectThumb = null;
                                                        this.currentPhotoObjectThumbStripped = null;
                                                    } else {
                                                        this.currentPhotoObject = null;
                                                    }
                                                }
                                                if (z36 && !messageObject.needDrawBluredPreview() && (((tLRPC$PhotoSize7 = this.currentPhotoObject) == null || tLRPC$PhotoSize7 == this.currentPhotoObjectThumb) && ((tLRPC$PhotoSize8 = this.currentPhotoObjectThumb) == null || !"m".equals(tLRPC$PhotoSize8.type)))) {
                                                    this.photoImage.setNeedsQualityThumb(true);
                                                    this.photoImage.setShouldGenerateQualityThumb(true);
                                                }
                                                if (this.currentMessagesGroup == null && messageObject10.caption != null) {
                                                    this.mediaBackground = false;
                                                }
                                                if ((i86 != 0 || i87 == 0) && messageObject10.type == 8 && (document = messageObject.getDocument()) != null) {
                                                    for (i88 = 0; i88 < document.attributes.size(); i88++) {
                                                        TLRPC$DocumentAttribute tLRPC$DocumentAttribute3 = document.attributes.get(i88);
                                                        if ((tLRPC$DocumentAttribute3 instanceof TLRPC$TL_documentAttributeImageSize) || (tLRPC$DocumentAttribute3 instanceof TLRPC$TL_documentAttributeVideo)) {
                                                            int i176 = tLRPC$DocumentAttribute3.w;
                                                            float f31 = i84;
                                                            float f32 = i176 / f31;
                                                            int i177 = (int) (i176 / f32);
                                                            i87 = (int) (tLRPC$DocumentAttribute3.h / f32);
                                                            if (i87 > dp45) {
                                                                i86 = (int) (i177 / (i87 / dp45));
                                                            } else if (i87 >= AndroidUtilities.dp(120.0f)) {
                                                                i86 = i177;
                                                                dp45 = i87;
                                                            } else {
                                                                dp45 = AndroidUtilities.dp(120.0f);
                                                                float f33 = tLRPC$DocumentAttribute3.h / dp45;
                                                                int i178 = tLRPC$DocumentAttribute3.w;
                                                                if (i178 / f33 < f31) {
                                                                    i177 = (int) (i178 / f33);
                                                                }
                                                                i86 = i177;
                                                            }
                                                            i87 = dp45;
                                                        }
                                                    }
                                                    dp45 = i87;
                                                    i87 = dp45;
                                                }
                                                if (i86 != 0 || i87 == 0) {
                                                    i87 = AndroidUtilities.dp(150.0f);
                                                    i86 = i87;
                                                }
                                                if (messageObject10.type == 3 && i86 < this.infoWidth + AndroidUtilities.dp(40.0f)) {
                                                    i86 = this.infoWidth + AndroidUtilities.dp(40.0f);
                                                }
                                                if (this.commentLayout != null && this.drawSideButton != 3 && i86 < this.totalCommentWidth + AndroidUtilities.dp(10.0f)) {
                                                    i86 = this.totalCommentWidth + AndroidUtilities.dp(10.0f);
                                                }
                                                if (this.currentMessagesGroup != null) {
                                                    int groupPhotosWidth = getGroupPhotosWidth();
                                                    int i179 = 0;
                                                    int i180 = 0;
                                                    while (i179 < this.currentMessagesGroup.posArray.size()) {
                                                        if (this.currentMessagesGroup.posArray.get(i179).minY != 0) {
                                                            break;
                                                        }
                                                        double d6 = i180;
                                                        double ceil8 = Math.ceil(((groupedMessagePosition9.pw + groupedMessagePosition9.leftSpanOffset) / 1000.0f) * groupPhotosWidth);
                                                        Double.isNaN(d6);
                                                        i180 = (int) (d6 + ceil8);
                                                        i179++;
                                                        messageObject10 = messageObject;
                                                        z4 = z4;
                                                        i2 = 2;
                                                    }
                                                    this.availableTimeWidth = i180 - AndroidUtilities.dp(35.0f);
                                                } else {
                                                    this.availableTimeWidth = i84 - AndroidUtilities.dp(14.0f);
                                                }
                                                if (messageObject10.type == 5) {
                                                    double d7 = AndroidUtilities.roundMessageSize;
                                                    double ceil9 = Math.ceil(Theme.chat_audioTimePaint.measureText("00:00"));
                                                    Double.isNaN(d7);
                                                    double d8 = d7 - ceil9;
                                                    double dp46 = AndroidUtilities.dp(46.0f);
                                                    Double.isNaN(dp46);
                                                    this.availableTimeWidth = (int) (d8 - dp46);
                                                }
                                                measureTime(messageObject);
                                                dp18 = this.timeWidth + AndroidUtilities.dp((SharedConfig.bubbleRadius < 10 ? 18 : 22) + (!messageObject.isOutOwner() ? 0 : 20));
                                                if (i86 < dp18) {
                                                    i86 = dp18;
                                                }
                                                if (messageObject.isRoundVideo()) {
                                                    i87 = Math.min(i86, i87);
                                                    this.drawBackground = false;
                                                    this.photoImage.setRoundRadius(i87 / 2);
                                                    i86 = i87;
                                                    z26 = false;
                                                } else {
                                                    if (messageObject.needDrawBluredPreview() && !messageObject.hasExtendedMediaPreview()) {
                                                        if (AndroidUtilities.isTablet()) {
                                                            minTabletSide10 = AndroidUtilities.getMinTabletSide();
                                                        } else {
                                                            minTabletSide10 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                                                        }
                                                        i87 = (int) (minTabletSide10 * 0.5f);
                                                        i86 = i87;
                                                    }
                                                    z26 = true;
                                                }
                                                if (this.currentMessagesGroup != null) {
                                                    float max7 = Math.max(getParentWidth(), AndroidUtilities.displaySize.y) * 0.5f;
                                                    float groupPhotosWidth2 = getGroupPhotosWidth();
                                                    int ceil10 = (int) Math.ceil((this.currentPosition.pw / 1000.0f) * groupPhotosWidth2);
                                                    if (this.currentPosition.minY != 0 && ((messageObject.isOutOwner() && (this.currentPosition.flags & 1) != 0) || (!messageObject.isOutOwner() && (this.currentPosition.flags & i2) != 0))) {
                                                        int i181 = 0;
                                                        int i182 = 0;
                                                        int i183 = 0;
                                                        while (i181 < this.currentMessagesGroup.posArray.size()) {
                                                            MessageObject.GroupedMessagePosition groupedMessagePosition20 = this.currentMessagesGroup.posArray.get(i181);
                                                            byte b = groupedMessagePosition20.minY;
                                                            if (b == 0) {
                                                                z39 = z4;
                                                                i97 = dp18;
                                                                double d9 = i182;
                                                                double ceil11 = Math.ceil((groupedMessagePosition20.pw / 1000.0f) * groupPhotosWidth2);
                                                                double ceil12 = groupedMessagePosition20.leftSpanOffset == 0 ? 0.0d : Math.ceil((i98 / 1000.0f) * groupPhotosWidth2);
                                                                Double.isNaN(d9);
                                                                i182 = (int) (d9 + ceil11 + ceil12);
                                                            } else {
                                                                byte b2 = this.currentPosition.minY;
                                                                if (b == b2) {
                                                                    z39 = z4;
                                                                    i97 = dp18;
                                                                    double d10 = i183;
                                                                    double ceil13 = Math.ceil((groupedMessagePosition20.pw / 1000.0f) * groupPhotosWidth2);
                                                                    double ceil14 = groupedMessagePosition20.leftSpanOffset == 0 ? 0.0d : Math.ceil((i99 / 1000.0f) * groupPhotosWidth2);
                                                                    Double.isNaN(d10);
                                                                    i183 = (int) (d10 + ceil13 + ceil14);
                                                                } else if (b > b2) {
                                                                    break;
                                                                } else {
                                                                    z39 = z4;
                                                                    i97 = dp18;
                                                                }
                                                            }
                                                            i181++;
                                                            messageObject10 = messageObject;
                                                            dp18 = i97;
                                                            z4 = z39;
                                                            i2 = 2;
                                                        }
                                                        ceil10 += i182 - i183;
                                                    }
                                                    int dp47 = ceil10 - AndroidUtilities.dp(9.0f);
                                                    if (this.isAvatarVisible) {
                                                        dp47 -= AndroidUtilities.dp(48.0f);
                                                    }
                                                    int i184 = dp47;
                                                    if (this.currentPosition.siblingHeights != null) {
                                                        int i185 = 0;
                                                        int i186 = 0;
                                                        while (true) {
                                                            groupedMessagePosition11 = this.currentPosition;
                                                            if (i185 >= groupedMessagePosition11.siblingHeights.length) {
                                                                break;
                                                            }
                                                            i186 += (int) Math.ceil(fArr[i185] * max7);
                                                            i185++;
                                                            messageObject10 = messageObject;
                                                            i2 = 2;
                                                        }
                                                        round = i186 + ((groupedMessagePosition11.maxY - groupedMessagePosition11.minY) * Math.round(AndroidUtilities.density * 7.0f));
                                                    } else {
                                                        round = (int) Math.ceil(max7 * groupedMessagePosition10.ph);
                                                    }
                                                    this.backgroundWidth = i184;
                                                    int i187 = this.currentPosition.flags;
                                                    if ((i187 & 2) != 0 && (i187 & 1) != 0) {
                                                        dp19 = AndroidUtilities.dp(8.0f);
                                                    } else if ((i187 & 2) == 0 && (i187 & 1) == 0) {
                                                        dp19 = AndroidUtilities.dp(11.0f);
                                                    } else if ((i187 & i2) != 0) {
                                                        dp19 = AndroidUtilities.dp(10.0f);
                                                    } else {
                                                        dp19 = AndroidUtilities.dp(9.0f);
                                                    }
                                                    i89 = i184 - dp19;
                                                    i86 = this.currentPosition.edge ? i89 : AndroidUtilities.dp(10.0f) + i89;
                                                    int dp48 = (i86 - AndroidUtilities.dp(10.0f)) + 0;
                                                    MessageObject.GroupedMessagePosition groupedMessagePosition21 = this.currentPosition;
                                                    int i188 = groupedMessagePosition21.flags;
                                                    if ((i188 & 8) != 0 || (this.currentMessagesGroup.hasSibling && (i188 & 4) == 0)) {
                                                        int additionalWidthForPosition = dp48 + getAdditionalWidthForPosition(groupedMessagePosition21);
                                                        int size11 = this.currentMessagesGroup.messages.size();
                                                        int i189 = additionalWidthForPosition;
                                                        int i190 = 0;
                                                        boolean z57 = true;
                                                        while (i190 < size11) {
                                                            int i191 = dp18;
                                                            MessageObject messageObject14 = this.currentMessagesGroup.messages.get(i190);
                                                            MessageObject.GroupedMessagePosition groupedMessagePosition22 = this.currentMessagesGroup.posArray.get(i190);
                                                            if (groupedMessagePosition22 != this.currentPosition && (groupedMessagePosition22.flags & 8) != 0) {
                                                                int ceil15 = (int) Math.ceil((groupedMessagePosition22.pw / 1000.0f) * groupPhotosWidth2);
                                                                if (groupedMessagePosition22.minY != 0) {
                                                                    if (messageObject.isOutOwner() && (groupedMessagePosition22.flags & 1) != 0) {
                                                                        int i192 = 0;
                                                                        int i193 = 0;
                                                                        int i194 = 0;
                                                                        while (i192 < this.currentMessagesGroup.posArray.size()) {
                                                                            MessageObject.GroupedMessagePosition groupedMessagePosition23 = this.currentMessagesGroup.posArray.get(i192);
                                                                            byte b3 = groupedMessagePosition23.minY;
                                                                            if (b3 == 0) {
                                                                                z37 = z4;
                                                                                i90 = i86;
                                                                                i91 = size11;
                                                                                double d11 = i193;
                                                                                double ceil16 = Math.ceil((groupedMessagePosition23.pw / 1000.0f) * groupPhotosWidth2);
                                                                                if (groupedMessagePosition23.leftSpanOffset == 0) {
                                                                                    ceil = 0.0d;
                                                                                    i93 = i194;
                                                                                } else {
                                                                                    i93 = i194;
                                                                                    ceil = Math.ceil((i92 / 1000.0f) * groupPhotosWidth2);
                                                                                }
                                                                                Double.isNaN(d11);
                                                                                i193 = (int) (d11 + ceil16 + ceil);
                                                                                i194 = i93;
                                                                            } else {
                                                                                byte b4 = groupedMessagePosition22.minY;
                                                                                if (b3 == b4) {
                                                                                    double d12 = i194;
                                                                                    z37 = z4;
                                                                                    i90 = i86;
                                                                                    double ceil17 = Math.ceil((groupedMessagePosition23.pw / 1000.0f) * groupPhotosWidth2);
                                                                                    if (groupedMessagePosition23.leftSpanOffset == 0) {
                                                                                        i91 = size11;
                                                                                        ceil2 = 0.0d;
                                                                                    } else {
                                                                                        i91 = size11;
                                                                                        ceil2 = Math.ceil((i94 / 1000.0f) * groupPhotosWidth2);
                                                                                    }
                                                                                    Double.isNaN(d12);
                                                                                    i194 = (int) (d12 + ceil17 + ceil2);
                                                                                } else if (b3 > b4) {
                                                                                    break;
                                                                                } else {
                                                                                    z37 = z4;
                                                                                    i90 = i86;
                                                                                    i91 = size11;
                                                                                }
                                                                            }
                                                                            i192++;
                                                                            i86 = i90;
                                                                            z4 = z37;
                                                                            size11 = i91;
                                                                        }
                                                                        ceil15 += i193 - i194;
                                                                    }
                                                                    if (!messageObject.isOutOwner()) {
                                                                    }
                                                                }
                                                                int dp49 = ceil15 - AndroidUtilities.dp(9.0f);
                                                                int i195 = groupedMessagePosition22.flags;
                                                                if ((i195 & 2) != 0 && (i195 & 1) != 0) {
                                                                    dp20 = AndroidUtilities.dp(8.0f);
                                                                } else if ((i195 & 2) == 0 && (i195 & 1) == 0) {
                                                                    dp20 = AndroidUtilities.dp(11.0f);
                                                                } else if ((i195 & 2) != 0) {
                                                                    dp20 = AndroidUtilities.dp(10.0f);
                                                                } else {
                                                                    dp20 = AndroidUtilities.dp(9.0f);
                                                                }
                                                                int i196 = dp49 - dp20;
                                                                if (this.isChat && !this.isThreadPost && !messageObject14.isOutOwner() && messageObject14.needDrawAvatar() && groupedMessagePosition22.edge) {
                                                                    i196 -= AndroidUtilities.dp(48.0f);
                                                                }
                                                                int additionalWidthForPosition2 = i196 + getAdditionalWidthForPosition(groupedMessagePosition22);
                                                                if (!groupedMessagePosition22.edge) {
                                                                    additionalWidthForPosition2 += AndroidUtilities.dp(10.0f);
                                                                }
                                                                i189 += additionalWidthForPosition2;
                                                                if (groupedMessagePosition22.minX < this.currentPosition.minX || (this.currentMessagesGroup.hasSibling && groupedMessagePosition22.minY != groupedMessagePosition22.maxY)) {
                                                                    this.captionOffsetX -= additionalWidthForPosition2;
                                                                }
                                                                i89 = additionalWidthForPosition2;
                                                            }
                                                            CharSequence charSequence4 = messageObject14.caption;
                                                            if (charSequence4 != null) {
                                                                if (this.currentCaption != null) {
                                                                    this.currentCaption = null;
                                                                    z57 = false;
                                                                    i190++;
                                                                    messageObject10 = messageObject;
                                                                    dp18 = i191;
                                                                } else {
                                                                    this.currentCaption = charSequence4;
                                                                }
                                                            }
                                                            i190++;
                                                            messageObject10 = messageObject;
                                                            dp18 = i191;
                                                        }
                                                        dp48 = i189;
                                                    }
                                                    i95 = dp48;
                                                    i96 = round;
                                                    z38 = false;
                                                } else {
                                                    this.currentCaption = messageObject10.caption;
                                                    if (AndroidUtilities.isTablet()) {
                                                        minTabletSide9 = AndroidUtilities.getMinTabletSide();
                                                    } else {
                                                        minTabletSide9 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                                                    }
                                                    int i197 = (int) (minTabletSide9 * 0.65f);
                                                    if (!messageObject.needDrawBluredPreview()) {
                                                        if (this.currentCaption == null) {
                                                            ReactionsLayoutInBubble reactionsLayoutInBubble25 = this.reactionsLayoutInBubble;
                                                            if (!reactionsLayoutInBubble25.isEmpty) {
                                                            }
                                                        }
                                                        if (i86 < i197) {
                                                            z41 = true;
                                                            int dp50 = AndroidUtilities.dp(8.0f) + i86;
                                                            this.backgroundWidth = dp50;
                                                            if (!this.mediaBackground) {
                                                                this.backgroundWidth = dp50 + AndroidUtilities.dp(9.0f);
                                                            }
                                                            z38 = z41;
                                                            i96 = i87;
                                                            i89 = i86;
                                                            i95 = i197;
                                                        }
                                                    }
                                                    i197 = i86 - AndroidUtilities.dp(10.0f);
                                                    z41 = false;
                                                    int dp502 = AndroidUtilities.dp(8.0f) + i86;
                                                    this.backgroundWidth = dp502;
                                                    if (!this.mediaBackground) {
                                                    }
                                                    z38 = z41;
                                                    i96 = i87;
                                                    i89 = i86;
                                                    i95 = i197;
                                                }
                                                if (this.currentCaption == null) {
                                                    i100 = dp18;
                                                    i68 = 0;
                                                    i101 = 0;
                                                } else {
                                                    try {
                                                        i95 -= getExtraTextX() * 2;
                                                        if (Build.VERSION.SDK_INT >= 24) {
                                                            CharSequence charSequence5 = this.currentCaption;
                                                            this.captionLayout = StaticLayout.Builder.obtain(charSequence5, 0, charSequence5.length(), Theme.chat_msgTextPaint, i95).setBreakStrategy(1).setHyphenationFrequency(0).setAlignment(Layout.Alignment.ALIGN_NORMAL).build();
                                                        } else {
                                                            try {
                                                                this.captionLayout = new StaticLayout(this.currentCaption, Theme.chat_msgTextPaint, i95, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                            } catch (Exception e2) {
                                                                e = e2;
                                                                i100 = dp18;
                                                                i101 = 0;
                                                                FileLog.e(e);
                                                                i68 = 0;
                                                                if (!this.reactionsLayoutInBubble.isSmall) {
                                                                }
                                                                int i198 = i101;
                                                                measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                                                if (this.currentMessagesGroup != null) {
                                                                }
                                                                if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                                                }
                                                                i64 = i86;
                                                                if (z3) {
                                                                }
                                                                obj = null;
                                                                String format6 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                                                this.currentPhotoFilterThumb = format6;
                                                                this.currentPhotoFilter = format6;
                                                                arrayList2 = messageObject10.photoThumbs;
                                                                if (arrayList2 != null) {
                                                                }
                                                                if (!messageObject.needDrawBluredPreview()) {
                                                                }
                                                                int i199 = messageObject10.type;
                                                                if (i199 == 3) {
                                                                }
                                                                tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                                if (tLRPC$PhotoSize5 != null) {
                                                                }
                                                                i103 = -1;
                                                                tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                                if (tLRPC$PhotoSize6 != null) {
                                                                }
                                                                if (SharedConfig.autoplayVideo) {
                                                                }
                                                                if (this.autoPlayingMedia) {
                                                                }
                                                                if (this.currentPosition != null) {
                                                                }
                                                                if (!messageObject10.isRestrictedMessage) {
                                                                }
                                                                if (this.captionLayout == null) {
                                                                }
                                                                if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                }
                                                                int dp51 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                staticLayout2 = this.captionLayout;
                                                                if (staticLayout2 == null) {
                                                                }
                                                                if (this.currentMessageObject.type != i34) {
                                                                }
                                                                if (valueOf != null) {
                                                                }
                                                                groupedMessagePosition4 = this.currentPosition;
                                                                if (groupedMessagePosition4 != null) {
                                                                }
                                                                int i200 = this.widthBeforeNewTimeLine;
                                                                i54 = -1;
                                                                messageObject4 = this.currentMessageObject;
                                                                if (messageObject4.eventId == 0) {
                                                                }
                                                                f4 = 0.0f;
                                                                if (messageObject.isSponsored()) {
                                                                }
                                                                this.botButtons.clear();
                                                                if (z46) {
                                                                }
                                                                if (!messageObject10.isRestrictedMessage) {
                                                                }
                                                                this.substractBackgroundHeight = 0;
                                                                this.keyboardHeight = 0;
                                                                r6 = hashMap;
                                                                if (this.drawCommentButton) {
                                                                }
                                                                z29 = this.drawPinnedBottom;
                                                                if (z29) {
                                                                }
                                                                if (!z29) {
                                                                }
                                                                if (messageObject10.type != 19) {
                                                                }
                                                                if (!this.drawPhotoImage) {
                                                                }
                                                                i58 = 5;
                                                                if (this.documentAttachType == 5) {
                                                                }
                                                                calculateUnlockXY();
                                                                if (z26) {
                                                                }
                                                                updateAnimatedEmojis();
                                                                r62 = r6;
                                                                if (z46) {
                                                                }
                                                                transcribeButton = this.transcribeButton;
                                                                if (transcribeButton != null) {
                                                                }
                                                                updateWaveform();
                                                                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                if (!this.currentMessageObject.loadingCancelled) {
                                                                }
                                                                chatMessageCellDelegate2 = this.delegate;
                                                                if (chatMessageCellDelegate2 != null) {
                                                                }
                                                                this.accessibilityVirtualViewBounds.clear();
                                                                this.transitionParams.updatePhotoImageX = true;
                                                                updateFlagSecure();
                                                            }
                                                        }
                                                        updateCaptionSpoilers();
                                                        lineCount = this.captionLayout.getLineCount();
                                                    } catch (Exception e3) {
                                                        e = e3;
                                                        i100 = dp18;
                                                    }
                                                    if (lineCount <= 0) {
                                                        i100 = dp18;
                                                    } else {
                                                        if (z38) {
                                                            this.captionWidth = 0;
                                                            int i201 = 0;
                                                            while (true) {
                                                                if (i201 >= lineCount) {
                                                                    i100 = dp18;
                                                                    break;
                                                                }
                                                                i100 = dp18;
                                                                try {
                                                                    this.captionWidth = (int) Math.max(this.captionWidth, Math.ceil(this.captionLayout.getLineWidth(i201)));
                                                                    if (this.captionLayout.getLineLeft(i201) != 0.0f) {
                                                                        try {
                                                                            break;
                                                                        } catch (Exception e4) {
                                                                            e = e4;
                                                                            i101 = 0;
                                                                            FileLog.e(e);
                                                                            i68 = 0;
                                                                            if (!this.reactionsLayoutInBubble.isSmall) {
                                                                            }
                                                                            int i1982 = i101;
                                                                            measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                                                            if (this.currentMessagesGroup != null) {
                                                                            }
                                                                            if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                                                            }
                                                                            i64 = i86;
                                                                            if (z3) {
                                                                            }
                                                                            obj = null;
                                                                            String format62 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                                                            this.currentPhotoFilterThumb = format62;
                                                                            this.currentPhotoFilter = format62;
                                                                            arrayList2 = messageObject10.photoThumbs;
                                                                            if (arrayList2 != null) {
                                                                            }
                                                                            if (!messageObject.needDrawBluredPreview()) {
                                                                            }
                                                                            int i1992 = messageObject10.type;
                                                                            if (i1992 == 3) {
                                                                            }
                                                                            tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                                            if (tLRPC$PhotoSize5 != null) {
                                                                            }
                                                                            i103 = -1;
                                                                            tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                                            if (tLRPC$PhotoSize6 != null) {
                                                                            }
                                                                            if (SharedConfig.autoplayVideo) {
                                                                            }
                                                                            if (this.autoPlayingMedia) {
                                                                            }
                                                                            if (this.currentPosition != null) {
                                                                            }
                                                                            if (!messageObject10.isRestrictedMessage) {
                                                                            }
                                                                            if (this.captionLayout == null) {
                                                                            }
                                                                            if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                            }
                                                                            int dp512 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                            staticLayout2 = this.captionLayout;
                                                                            if (staticLayout2 == null) {
                                                                            }
                                                                            if (this.currentMessageObject.type != i34) {
                                                                            }
                                                                            if (valueOf != null) {
                                                                            }
                                                                            groupedMessagePosition4 = this.currentPosition;
                                                                            if (groupedMessagePosition4 != null) {
                                                                            }
                                                                            int i2002 = this.widthBeforeNewTimeLine;
                                                                            i54 = -1;
                                                                            messageObject4 = this.currentMessageObject;
                                                                            if (messageObject4.eventId == 0) {
                                                                            }
                                                                            f4 = 0.0f;
                                                                            if (messageObject.isSponsored()) {
                                                                            }
                                                                            this.botButtons.clear();
                                                                            if (z46) {
                                                                            }
                                                                            if (!messageObject10.isRestrictedMessage) {
                                                                            }
                                                                            this.substractBackgroundHeight = 0;
                                                                            this.keyboardHeight = 0;
                                                                            r6 = hashMap;
                                                                            if (this.drawCommentButton) {
                                                                            }
                                                                            z29 = this.drawPinnedBottom;
                                                                            if (z29) {
                                                                            }
                                                                            if (!z29) {
                                                                            }
                                                                            if (messageObject10.type != 19) {
                                                                            }
                                                                            if (!this.drawPhotoImage) {
                                                                            }
                                                                            i58 = 5;
                                                                            if (this.documentAttachType == 5) {
                                                                            }
                                                                            calculateUnlockXY();
                                                                            if (z26) {
                                                                            }
                                                                            updateAnimatedEmojis();
                                                                            r62 = r6;
                                                                            if (z46) {
                                                                            }
                                                                            transcribeButton = this.transcribeButton;
                                                                            if (transcribeButton != null) {
                                                                            }
                                                                            updateWaveform();
                                                                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                            if (!this.currentMessageObject.loadingCancelled) {
                                                                            }
                                                                            chatMessageCellDelegate2 = this.delegate;
                                                                            if (chatMessageCellDelegate2 != null) {
                                                                            }
                                                                            this.accessibilityVirtualViewBounds.clear();
                                                                            this.transitionParams.updatePhotoImageX = true;
                                                                            updateFlagSecure();
                                                                        }
                                                                    }
                                                                    i201++;
                                                                    dp18 = i100;
                                                                } catch (Exception e5) {
                                                                    e = e5;
                                                                    i101 = 0;
                                                                    FileLog.e(e);
                                                                    i68 = 0;
                                                                    if (!this.reactionsLayoutInBubble.isSmall) {
                                                                    }
                                                                    int i19822 = i101;
                                                                    measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                                                    if (this.currentMessagesGroup != null) {
                                                                    }
                                                                    if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                                                    }
                                                                    i64 = i86;
                                                                    if (z3) {
                                                                    }
                                                                    obj = null;
                                                                    String format622 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                                                    this.currentPhotoFilterThumb = format622;
                                                                    this.currentPhotoFilter = format622;
                                                                    arrayList2 = messageObject10.photoThumbs;
                                                                    if (arrayList2 != null) {
                                                                    }
                                                                    if (!messageObject.needDrawBluredPreview()) {
                                                                    }
                                                                    int i19922 = messageObject10.type;
                                                                    if (i19922 == 3) {
                                                                    }
                                                                    tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                                    if (tLRPC$PhotoSize5 != null) {
                                                                    }
                                                                    i103 = -1;
                                                                    tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                                    if (tLRPC$PhotoSize6 != null) {
                                                                    }
                                                                    if (SharedConfig.autoplayVideo) {
                                                                    }
                                                                    if (this.autoPlayingMedia) {
                                                                    }
                                                                    if (this.currentPosition != null) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    if (this.captionLayout == null) {
                                                                    }
                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                    }
                                                                    int dp5122 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                    staticLayout2 = this.captionLayout;
                                                                    if (staticLayout2 == null) {
                                                                    }
                                                                    if (this.currentMessageObject.type != i34) {
                                                                    }
                                                                    if (valueOf != null) {
                                                                    }
                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                    if (groupedMessagePosition4 != null) {
                                                                    }
                                                                    int i20022 = this.widthBeforeNewTimeLine;
                                                                    i54 = -1;
                                                                    messageObject4 = this.currentMessageObject;
                                                                    if (messageObject4.eventId == 0) {
                                                                    }
                                                                    f4 = 0.0f;
                                                                    if (messageObject.isSponsored()) {
                                                                    }
                                                                    this.botButtons.clear();
                                                                    if (z46) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    this.substractBackgroundHeight = 0;
                                                                    this.keyboardHeight = 0;
                                                                    r6 = hashMap;
                                                                    if (this.drawCommentButton) {
                                                                    }
                                                                    z29 = this.drawPinnedBottom;
                                                                    if (z29) {
                                                                    }
                                                                    if (!z29) {
                                                                    }
                                                                    if (messageObject10.type != 19) {
                                                                    }
                                                                    if (!this.drawPhotoImage) {
                                                                    }
                                                                    i58 = 5;
                                                                    if (this.documentAttachType == 5) {
                                                                    }
                                                                    calculateUnlockXY();
                                                                    if (z26) {
                                                                    }
                                                                    updateAnimatedEmojis();
                                                                    r62 = r6;
                                                                    if (z46) {
                                                                    }
                                                                    transcribeButton = this.transcribeButton;
                                                                    if (transcribeButton != null) {
                                                                    }
                                                                    updateWaveform();
                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                    }
                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                    if (chatMessageCellDelegate2 != null) {
                                                                    }
                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                    updateFlagSecure();
                                                                }
                                                            }
                                                            if (this.captionWidth > i95) {
                                                                this.captionWidth = i95;
                                                            }
                                                        } else {
                                                            this.captionWidth = i95;
                                                            i100 = dp18;
                                                        }
                                                        int height2 = this.captionLayout.getHeight();
                                                        this.captionHeight = height2;
                                                        int dp52 = height2 + AndroidUtilities.dp(9.0f);
                                                        this.addedCaptionHeight = dp52;
                                                        MessageObject.GroupedMessagePosition groupedMessagePosition24 = this.currentPosition;
                                                        if (groupedMessagePosition24 != null && (groupedMessagePosition24.flags & 8) == 0) {
                                                            this.captionLayout = null;
                                                            updateCaptionSpoilers();
                                                        }
                                                        i101 = 0 + dp52;
                                                        try {
                                                            max5 = Math.max(this.captionWidth, i86 - AndroidUtilities.dp(10.0f));
                                                            StaticLayout staticLayout14 = this.captionLayout;
                                                            float lineWidth = staticLayout14.getLineWidth(staticLayout14.getLineCount() - 1);
                                                            StaticLayout staticLayout15 = this.captionLayout;
                                                            lineLeft = lineWidth + staticLayout15.getLineLeft(staticLayout15.getLineCount() - 1);
                                                            reactionsLayoutInBubble6 = this.reactionsLayoutInBubble;
                                                        } catch (Exception e6) {
                                                            e = e6;
                                                            FileLog.e(e);
                                                            i68 = 0;
                                                            if (!this.reactionsLayoutInBubble.isSmall) {
                                                            }
                                                            int i198222 = i101;
                                                            measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                                            if (this.currentMessagesGroup != null) {
                                                            }
                                                            if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                                            }
                                                            i64 = i86;
                                                            if (z3) {
                                                            }
                                                            obj = null;
                                                            String format6222 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                                            this.currentPhotoFilterThumb = format6222;
                                                            this.currentPhotoFilter = format6222;
                                                            arrayList2 = messageObject10.photoThumbs;
                                                            if (arrayList2 != null) {
                                                            }
                                                            if (!messageObject.needDrawBluredPreview()) {
                                                            }
                                                            int i199222 = messageObject10.type;
                                                            if (i199222 == 3) {
                                                            }
                                                            tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                            if (tLRPC$PhotoSize5 != null) {
                                                            }
                                                            i103 = -1;
                                                            tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                            if (tLRPC$PhotoSize6 != null) {
                                                            }
                                                            if (SharedConfig.autoplayVideo) {
                                                            }
                                                            if (this.autoPlayingMedia) {
                                                            }
                                                            if (this.currentPosition != null) {
                                                            }
                                                            if (!messageObject10.isRestrictedMessage) {
                                                            }
                                                            if (this.captionLayout == null) {
                                                            }
                                                            if (!messageObject.isVoiceTranscriptionOpen()) {
                                                            }
                                                            int dp51222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                            staticLayout2 = this.captionLayout;
                                                            if (staticLayout2 == null) {
                                                            }
                                                            if (this.currentMessageObject.type != i34) {
                                                            }
                                                            if (valueOf != null) {
                                                            }
                                                            groupedMessagePosition4 = this.currentPosition;
                                                            if (groupedMessagePosition4 != null) {
                                                            }
                                                            int i200222 = this.widthBeforeNewTimeLine;
                                                            i54 = -1;
                                                            messageObject4 = this.currentMessageObject;
                                                            if (messageObject4.eventId == 0) {
                                                            }
                                                            f4 = 0.0f;
                                                            if (messageObject.isSponsored()) {
                                                            }
                                                            this.botButtons.clear();
                                                            if (z46) {
                                                            }
                                                            if (!messageObject10.isRestrictedMessage) {
                                                            }
                                                            this.substractBackgroundHeight = 0;
                                                            this.keyboardHeight = 0;
                                                            r6 = hashMap;
                                                            if (this.drawCommentButton) {
                                                            }
                                                            z29 = this.drawPinnedBottom;
                                                            if (z29) {
                                                            }
                                                            if (!z29) {
                                                            }
                                                            if (messageObject10.type != 19) {
                                                            }
                                                            if (!this.drawPhotoImage) {
                                                            }
                                                            i58 = 5;
                                                            if (this.documentAttachType == 5) {
                                                            }
                                                            calculateUnlockXY();
                                                            if (z26) {
                                                            }
                                                            updateAnimatedEmojis();
                                                            r62 = r6;
                                                            if (z46) {
                                                            }
                                                            transcribeButton = this.transcribeButton;
                                                            if (transcribeButton != null) {
                                                            }
                                                            updateWaveform();
                                                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                            if (!this.currentMessageObject.loadingCancelled) {
                                                            }
                                                            chatMessageCellDelegate2 = this.delegate;
                                                            if (chatMessageCellDelegate2 != null) {
                                                            }
                                                            this.accessibilityVirtualViewBounds.clear();
                                                            this.transitionParams.updatePhotoImageX = true;
                                                            updateFlagSecure();
                                                        }
                                                        if (!reactionsLayoutInBubble6.isEmpty && !reactionsLayoutInBubble6.isSmall) {
                                                            i68 = 0;
                                                        }
                                                        if (!shouldDrawTimeOnMedia() && (max5 + AndroidUtilities.dp(2.0f)) - lineLeft < i100 + getExtraTimeX()) {
                                                            i101 += AndroidUtilities.dp(14.0f);
                                                            this.addedCaptionHeight += AndroidUtilities.dp(14.0f);
                                                            i68 = 1;
                                                        }
                                                        i68 = 0;
                                                    }
                                                    i68 = 0;
                                                    i101 = 0;
                                                }
                                                if (!this.reactionsLayoutInBubble.isSmall) {
                                                    boolean z58 = this.backgroundWidth - AndroidUtilities.dp(24.0f) > i95;
                                                    int max8 = Math.max(this.backgroundWidth - AndroidUtilities.dp(36.0f), i95);
                                                    this.reactionsLayoutInBubble.measure(max8, 3);
                                                    if (!this.reactionsLayoutInBubble.isEmpty) {
                                                        if (shouldDrawTimeOnMedia()) {
                                                            this.reactionsLayoutInBubble.drawServiceShaderBackground = true;
                                                        }
                                                        int i202 = this.reactionsLayoutInBubble.height;
                                                        if (this.captionLayout == null) {
                                                            dp21 = i202 + AndroidUtilities.dp(12.0f) + AndroidUtilities.dp(4.0f);
                                                        } else {
                                                            dp21 = i202 + AndroidUtilities.dp(12.0f);
                                                            this.reactionsLayoutInBubble.positionOffsetY += AndroidUtilities.dp(12.0f);
                                                        }
                                                        this.reactionsLayoutInBubble.totalHeight = dp21;
                                                        i101 += dp21;
                                                        if (!shouldDrawTimeOnMedia()) {
                                                            int min5 = Math.min(max8, this.reactionsLayoutInBubble.width + i100 + getExtraTimeX() + AndroidUtilities.dp(2.0f));
                                                            float f34 = this.reactionsLayoutInBubble.lastLineX;
                                                            if (!shouldDrawTimeOnMedia() && min5 - f34 < i100 + getExtraTimeX()) {
                                                                i101 += AndroidUtilities.dp(14.0f);
                                                                this.reactionsLayoutInBubble.totalHeight += AndroidUtilities.dp(14.0f);
                                                                this.reactionsLayoutInBubble.positionOffsetY -= AndroidUtilities.dp(14.0f);
                                                                if (!z58) {
                                                                    int i203 = this.captionWidth;
                                                                    int i204 = this.reactionsLayoutInBubble.width;
                                                                    if (i203 < i204) {
                                                                        this.captionWidth = i204;
                                                                    }
                                                                }
                                                                i68 = 1;
                                                            } else if (!z58) {
                                                                ReactionsLayoutInBubble reactionsLayoutInBubble26 = this.reactionsLayoutInBubble;
                                                                int i205 = reactionsLayoutInBubble26.lastLineX;
                                                                if (i205 + i100 > this.captionWidth) {
                                                                    this.captionWidth = i205 + i100;
                                                                }
                                                                int i206 = reactionsLayoutInBubble26.width;
                                                                if (i206 > this.captionWidth) {
                                                                    this.captionWidth = i206;
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                                int i1982222 = i101;
                                                measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                                if (this.currentMessagesGroup != null && (((i102 = this.documentAttachType) == 4 || i102 == 2) && i86 < measureText)) {
                                                    int dp53 = AndroidUtilities.dp(8.0f) + measureText;
                                                    this.backgroundWidth = dp53;
                                                    if (!this.mediaBackground) {
                                                        this.backgroundWidth = dp53 + AndroidUtilities.dp(9.0f);
                                                    }
                                                    i86 = measureText;
                                                }
                                                if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                                    i86 = this.captionWidth + AndroidUtilities.dp(10.0f);
                                                    int dp54 = AndroidUtilities.dp(8.0f) + i86;
                                                    this.backgroundWidth = dp54;
                                                    if (!this.mediaBackground) {
                                                        this.backgroundWidth = dp54 + AndroidUtilities.dp(9.0f);
                                                    }
                                                }
                                                i64 = i86;
                                                if (z3 || z46 || z4) {
                                                    obj = null;
                                                    String format62222 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                                    this.currentPhotoFilterThumb = format62222;
                                                    this.currentPhotoFilter = format62222;
                                                    arrayList2 = messageObject10.photoThumbs;
                                                    if ((arrayList2 != null && arrayList2.size() > 1) || (i105 = messageObject10.type) == 3 || i105 == 8 || i105 == 5) {
                                                        if (!messageObject.needDrawBluredPreview()) {
                                                            this.currentPhotoFilter += "_b2";
                                                            this.currentPhotoFilterThumb += "_b2";
                                                        } else {
                                                            this.currentPhotoFilterThumb += "_b";
                                                        }
                                                    }
                                                } else {
                                                    String format7 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                                    if (!messageObject.needDrawBluredPreview() && !format7.equals(this.currentPhotoFilter) && (forObject = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject)) != null) {
                                                        sb3 = new StringBuilder();
                                                        obj = null;
                                                        sb3.append(forObject.getKey(this.photoParentObject, null, false));
                                                        sb3.append("@");
                                                        sb3.append(this.currentPhotoFilter);
                                                        if (ImageLoader.getInstance().isInMemCache(sb3.toString(), false)) {
                                                            this.currentPhotoObjectThumb = this.currentPhotoObject;
                                                            this.currentPhotoFilterThumb = this.currentPhotoFilter;
                                                            this.currentPhotoFilter = format7;
                                                        }
                                                    } else {
                                                        obj = null;
                                                    }
                                                }
                                                int i1992222 = messageObject10.type;
                                                boolean z59 = i1992222 == 3 || i1992222 == 8 || i1992222 == 5;
                                                tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                if (tLRPC$PhotoSize5 != null && !z59 && tLRPC$PhotoSize5.size == 0) {
                                                    i103 = -1;
                                                    tLRPC$PhotoSize5.size = -1;
                                                } else {
                                                    i103 = -1;
                                                }
                                                tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                if (tLRPC$PhotoSize6 != null && !z59 && tLRPC$PhotoSize6.size == 0) {
                                                    tLRPC$PhotoSize6.size = i103;
                                                }
                                                if (SharedConfig.autoplayVideo && i1992222 == 3 && !messageObject.needDrawBluredPreview() && (this.currentMessageObject.mediaExists || (messageObject.canStreamVideo() && DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject)))) {
                                                    groupedMessagePosition12 = this.currentPosition;
                                                    if (groupedMessagePosition12 == null) {
                                                        int i207 = groupedMessagePosition12.flags;
                                                        this.autoPlayingMedia = ((i207 & 1) == 0 || (i207 & 2) == 0) ? false : true;
                                                        if (this.autoPlayingMedia) {
                                                            obj2 = obj;
                                                            i104 = i96;
                                                            f6 = 1.0f;
                                                            this.photoImage.setAllowStartAnimation(true);
                                                            this.photoImage.startAnimation();
                                                            TLRPC$Document document3 = messageObject.getDocument();
                                                            VideoEditedInfo videoEditedInfo = this.currentMessageObject.videoEditedInfo;
                                                            if (videoEditedInfo != null && videoEditedInfo.canAutoPlaySourceVideo() && messageObject.getDocument() != null) {
                                                                this.photoImage.setImage(ImageLocation.getForPath(this.currentMessageObject.videoEditedInfo.originalPath), ImageLoader.AUTOPLAY_FILTER, ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForDocument(this.currentPhotoObjectThumb, document3), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, messageObject.getDocument().size, null, messageObject, 0);
                                                                ImageReceiver imageReceiver = this.photoImage;
                                                                VideoEditedInfo videoEditedInfo2 = this.currentMessageObject.videoEditedInfo;
                                                                imageReceiver.setMediaStartEndTime(videoEditedInfo2.startTime / 1000, videoEditedInfo2.endTime / 1000);
                                                            } else if (messageObject.getDocument() != null) {
                                                                if (!z46 && !z4) {
                                                                    this.photoImage.setCrossfadeWithOldImage(true);
                                                                }
                                                                this.photoImage.setImage(ImageLocation.getForDocument(document3), ImageLoader.AUTOPLAY_FILTER, ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForDocument(this.currentPhotoObjectThumb, document3), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, messageObject.getDocument().size, null, messageObject, 0);
                                                            }
                                                            messageObject6 = messageObject;
                                                            i65 = i104;
                                                            i67 = i1982222;
                                                        } else {
                                                            int i208 = messageObject10.type;
                                                            if (i208 == 20) {
                                                                obj2 = obj;
                                                                i104 = i96;
                                                                f6 = 1.0f;
                                                                ImageReceiver imageReceiver2 = this.photoImage;
                                                                ImageLocation forObject2 = ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject);
                                                                String str23 = this.currentPhotoFilterThumb;
                                                                BitmapDrawable bitmapDrawable4 = this.currentPhotoObjectThumbStripped;
                                                                MessageObject messageObject15 = this.currentMessageObject;
                                                                imageReceiver2.setImage(null, null, forObject2, str23, bitmapDrawable4, 0L, null, messageObject15, !messageObject15.shouldEncryptPhotoOrVideo() ? 0 : 2);
                                                            } else if (i208 != 1) {
                                                                if (i208 == 8 || i208 == 5) {
                                                                    i104 = i96;
                                                                    f6 = 1.0f;
                                                                    String attachFileName = FileLoader.getAttachFileName(messageObject.getDocument());
                                                                    if (messageObject10.attachPathExists) {
                                                                        DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                                                                        c = 1;
                                                                    } else {
                                                                        c = !messageObject10.mediaExists ? (char) 0 : (char) 2;
                                                                    }
                                                                    TLRPC$Document document4 = messageObject.getDocument();
                                                                    boolean canDownloadMedia2 = (!MessageObject.isGifDocument(document4, messageObject.hasValidGroupId()) && messageObject10.type != 5) ? false : DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject);
                                                                    TLRPC$VideoSize documentVideoThumb = MessageObject.getDocumentVideoThumb(document4);
                                                                    if (((MessageObject.isGifDocument(document4, messageObject.hasValidGroupId()) && messageObject10.videoEditedInfo == null) || (!messageObject.isSending() && !messageObject.isEditing())) && (c != 0 || FileLoader.getInstance(this.currentAccount).isLoadingFile(attachFileName) || canDownloadMedia2)) {
                                                                        if (c != 1 && !messageObject.needDrawBluredPreview() && (c != 0 || (messageObject.canStreamVideo() && canDownloadMedia2))) {
                                                                            this.autoPlayingMedia = true;
                                                                            if (!z46) {
                                                                                this.photoImage.setCrossfadeWithOldImage(true);
                                                                                this.photoImage.setCrossfadeDuration(250);
                                                                            }
                                                                            if (c == 0 && documentVideoThumb != null && (this.currentPhotoObject == null || this.currentPhotoObjectThumb == null)) {
                                                                                ImageReceiver imageReceiver3 = this.photoImage;
                                                                                ImageLocation forDocument = ImageLocation.getForDocument(document4);
                                                                                ImageLocation forDocument2 = ImageLocation.getForDocument(documentVideoThumb, this.documentAttach);
                                                                                TLRPC$PhotoSize tLRPC$PhotoSize12 = this.currentPhotoObject;
                                                                                if (tLRPC$PhotoSize12 == null) {
                                                                                    tLRPC$PhotoSize12 = this.currentPhotoObjectThumb;
                                                                                }
                                                                                imageReceiver3.setImage(forDocument, ImageLoader.AUTOPLAY_FILTER, forDocument2, null, ImageLocation.getForDocument(tLRPC$PhotoSize12, this.documentAttach), this.currentPhotoObject == null ? this.currentPhotoFilterThumb : this.currentPhotoFilter, this.currentPhotoObjectThumbStripped, document4.size, null, messageObject, 0);
                                                                            } else if (this.isRoundVideo && !z46 && this.photoImage.hasStaticThumb()) {
                                                                                this.photoImage.setImage(ImageLocation.getForDocument(document4), ImageLoader.AUTOPLAY_FILTER, ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, null, null, this.photoImage.getStaticThumb(), document4.size, null, messageObject, 0);
                                                                            } else {
                                                                                this.photoImage.setImage(ImageLocation.getForDocument(document4), ImageLoader.AUTOPLAY_FILTER, ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, document4.size, null, messageObject, 0);
                                                                            }
                                                                        } else if (c == 1) {
                                                                            this.photoImage.setImage(ImageLocation.getForPath(!messageObject.isSendError() ? messageObject10.messageOwner.attachPath : null), null, ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 0);
                                                                        } else if (documentVideoThumb != null && (this.currentPhotoObject == null || this.currentPhotoObjectThumb == null)) {
                                                                            ImageReceiver imageReceiver4 = this.photoImage;
                                                                            ImageLocation forDocument3 = ImageLocation.getForDocument(document4);
                                                                            ImageLocation forDocument4 = ImageLocation.getForDocument(documentVideoThumb, this.documentAttach);
                                                                            TLRPC$PhotoSize tLRPC$PhotoSize13 = this.currentPhotoObject;
                                                                            if (tLRPC$PhotoSize13 == null) {
                                                                                tLRPC$PhotoSize13 = this.currentPhotoObjectThumb;
                                                                            }
                                                                            imageReceiver4.setImage(forDocument3, null, forDocument4, null, ImageLocation.getForDocument(tLRPC$PhotoSize13, this.documentAttach), this.currentPhotoObject == null ? this.currentPhotoFilterThumb : this.currentPhotoFilter, this.currentPhotoObjectThumbStripped, document4.size, null, messageObject, 0);
                                                                        } else {
                                                                            this.photoImage.setImage(ImageLocation.getForDocument(document4), null, ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, document4.size, null, messageObject, 0);
                                                                        }
                                                                    } else if (messageObject10.videoEditedInfo != null && messageObject10.type == 5 && !this.currentMessageObject.needDrawBluredPreview()) {
                                                                        this.photoImage.setImage(ImageLocation.getForPath(messageObject10.videoEditedInfo.originalPath), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 0);
                                                                        ImageReceiver imageReceiver5 = this.photoImage;
                                                                        VideoEditedInfo videoEditedInfo3 = this.currentMessageObject.videoEditedInfo;
                                                                        imageReceiver5.setMediaStartEndTime(videoEditedInfo3.startTime / 1000, videoEditedInfo3.endTime / 1000);
                                                                    } else {
                                                                        if (!z46 && !this.currentMessageObject.needDrawBluredPreview()) {
                                                                            this.photoImage.setCrossfadeWithOldImage(true);
                                                                            this.photoImage.setCrossfadeDuration(250);
                                                                        }
                                                                        this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 0);
                                                                    }
                                                                } else if (messageObject10.videoEditedInfo != null && i208 == 5 && !this.currentMessageObject.needDrawBluredPreview()) {
                                                                    obj3 = obj;
                                                                    i104 = i96;
                                                                    f6 = 1.0f;
                                                                    this.photoImage.setImage(ImageLocation.getForPath(messageObject10.videoEditedInfo.originalPath), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, !this.currentMessageObject.shouldEncryptPhotoOrVideo() ? 0 : 2);
                                                                    ImageReceiver imageReceiver6 = this.photoImage;
                                                                    VideoEditedInfo videoEditedInfo4 = this.currentMessageObject.videoEditedInfo;
                                                                    imageReceiver6.setMediaStartEndTime(videoEditedInfo4.startTime / 1000, videoEditedInfo4.endTime / 1000);
                                                                } else {
                                                                    if (!z46 && !this.currentMessageObject.needDrawBluredPreview()) {
                                                                        this.photoImage.setCrossfadeWithOldImage(true);
                                                                        this.photoImage.setCrossfadeDuration(250);
                                                                    }
                                                                    f6 = 1.0f;
                                                                    obj3 = obj;
                                                                    i104 = i96;
                                                                    this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, !this.currentMessageObject.shouldEncryptPhotoOrVideo() ? 0 : 2);
                                                                }
                                                                messageObject6 = messageObject;
                                                                i65 = i104;
                                                                i67 = i1982222;
                                                            } else {
                                                                i104 = i96;
                                                                f6 = 1.0f;
                                                                if (messageObject10.useCustomPhoto) {
                                                                    obj2 = null;
                                                                    this.photoImage.setImageBitmap(getResources().getDrawable(R.drawable.theme_preview_image));
                                                                } else {
                                                                    TLRPC$PhotoSize tLRPC$PhotoSize14 = this.currentPhotoObject;
                                                                    if (tLRPC$PhotoSize14 != null) {
                                                                        obj2 = null;
                                                                        String attachFileName2 = FileLoader.getAttachFileName(tLRPC$PhotoSize14);
                                                                        if (!messageObject10.mediaExists) {
                                                                            z40 = false;
                                                                        } else {
                                                                            DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                                                                            z40 = true;
                                                                        }
                                                                        if (z40 || ((!this.currentMessageObject.loadingCancelled && DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject)) || FileLoader.getInstance(this.currentAccount).isLoadingFile(attachFileName2))) {
                                                                            ImageReceiver imageReceiver7 = this.photoImage;
                                                                            ImageLocation forObject3 = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                                                                            String str24 = this.currentPhotoFilter;
                                                                            ImageLocation forObject4 = ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject);
                                                                            String str25 = this.currentPhotoFilterThumb;
                                                                            BitmapDrawable bitmapDrawable5 = this.currentPhotoObjectThumbStripped;
                                                                            long j4 = this.currentPhotoObject.size;
                                                                            MessageObject messageObject16 = this.currentMessageObject;
                                                                            imageReceiver7.setImage(forObject3, str24, forObject4, str25, bitmapDrawable5, j4, null, messageObject16, !messageObject16.shouldEncryptPhotoOrVideo() ? 0 : 2);
                                                                        } else {
                                                                            this.photoNotSet = true;
                                                                            TLRPC$PhotoSize tLRPC$PhotoSize15 = this.currentPhotoObjectThumb;
                                                                            if (tLRPC$PhotoSize15 != null || this.currentPhotoObjectThumbStripped != null) {
                                                                                ImageReceiver imageReceiver8 = this.photoImage;
                                                                                ImageLocation forObject5 = ImageLocation.getForObject(tLRPC$PhotoSize15, this.photoParentObject);
                                                                                String str26 = this.currentPhotoFilterThumb;
                                                                                BitmapDrawable bitmapDrawable6 = this.currentPhotoObjectThumbStripped;
                                                                                MessageObject messageObject17 = this.currentMessageObject;
                                                                                imageReceiver8.setImage(null, null, forObject5, str26, bitmapDrawable6, 0L, null, messageObject17, !messageObject17.shouldEncryptPhotoOrVideo() ? 0 : 2);
                                                                            } else {
                                                                                this.photoImage.setImageBitmap((Drawable) null);
                                                                            }
                                                                        }
                                                                    } else {
                                                                        obj2 = null;
                                                                        this.photoImage.setImageBitmap((Drawable) null);
                                                                    }
                                                                }
                                                            }
                                                            messageObject6 = messageObject;
                                                            i65 = i104;
                                                            i67 = i1982222;
                                                        }
                                                    } else {
                                                        this.autoPlayingMedia = true;
                                                    }
                                                }
                                                if (this.autoPlayingMedia) {
                                                }
                                            }
                                            z36 = false;
                                            bitmapDrawable2 = this.currentMessageObject.strippedThumb;
                                            if (bitmapDrawable2 != null) {
                                            }
                                            if (messageObject10.type == 5) {
                                            }
                                            tLRPC$PhotoSize3 = this.currentPhotoObject;
                                            if (tLRPC$PhotoSize3 != null) {
                                                this.currentPhotoObject = null;
                                            }
                                            tLRPC$PhotoSize4 = this.currentPhotoObject;
                                            if (tLRPC$PhotoSize4 != null) {
                                                i106 = messageObject10.type;
                                                if (i106 == 1) {
                                                    this.currentPhotoObject = null;
                                                }
                                                this.currentPhotoObjectThumb = null;
                                                this.currentPhotoObjectThumbStripped = null;
                                            }
                                            if (z36) {
                                                this.photoImage.setNeedsQualityThumb(true);
                                                this.photoImage.setShouldGenerateQualityThumb(true);
                                            }
                                            if (this.currentMessagesGroup == null) {
                                                this.mediaBackground = false;
                                            }
                                            if (i86 != 0) {
                                            }
                                            while (i88 < document.attributes.size()) {
                                            }
                                            dp45 = i87;
                                            i87 = dp45;
                                            if (i86 != 0) {
                                            }
                                            i87 = AndroidUtilities.dp(150.0f);
                                            i86 = i87;
                                            if (messageObject10.type == 3) {
                                                i86 = this.infoWidth + AndroidUtilities.dp(40.0f);
                                            }
                                            if (this.commentLayout != null) {
                                                i86 = this.totalCommentWidth + AndroidUtilities.dp(10.0f);
                                            }
                                            if (this.currentMessagesGroup != null) {
                                            }
                                            if (messageObject10.type == 5) {
                                            }
                                            measureTime(messageObject);
                                            dp18 = this.timeWidth + AndroidUtilities.dp((SharedConfig.bubbleRadius < 10 ? 18 : 22) + (!messageObject.isOutOwner() ? 0 : 20));
                                            if (i86 < dp18) {
                                            }
                                            if (messageObject.isRoundVideo()) {
                                            }
                                            if (this.currentMessagesGroup != null) {
                                            }
                                            if (this.currentCaption == null) {
                                            }
                                            if (!this.reactionsLayoutInBubble.isSmall) {
                                            }
                                            int i19822222 = i101;
                                            measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                            if (this.currentMessagesGroup != null) {
                                                int dp532 = AndroidUtilities.dp(8.0f) + measureText;
                                                this.backgroundWidth = dp532;
                                                if (!this.mediaBackground) {
                                                }
                                                i86 = measureText;
                                            }
                                            if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                            }
                                            i64 = i86;
                                            if (z3) {
                                                String format72 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                                if (!messageObject.needDrawBluredPreview()) {
                                                    sb3 = new StringBuilder();
                                                    obj = null;
                                                    sb3.append(forObject.getKey(this.photoParentObject, null, false));
                                                    sb3.append("@");
                                                    sb3.append(this.currentPhotoFilter);
                                                    if (ImageLoader.getInstance().isInMemCache(sb3.toString(), false)) {
                                                    }
                                                    int i19922222 = messageObject10.type;
                                                    if (i19922222 == 3) {
                                                        tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                        if (tLRPC$PhotoSize5 != null) {
                                                            i103 = -1;
                                                            tLRPC$PhotoSize5.size = -1;
                                                            tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                            if (tLRPC$PhotoSize6 != null) {
                                                                tLRPC$PhotoSize6.size = i103;
                                                            }
                                                            if (SharedConfig.autoplayVideo) {
                                                                groupedMessagePosition12 = this.currentPosition;
                                                                if (groupedMessagePosition12 == null) {
                                                                }
                                                            }
                                                            if (this.autoPlayingMedia) {
                                                            }
                                                        }
                                                        i103 = -1;
                                                        tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                        if (tLRPC$PhotoSize6 != null) {
                                                        }
                                                        if (SharedConfig.autoplayVideo) {
                                                        }
                                                        if (this.autoPlayingMedia) {
                                                        }
                                                    }
                                                    tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                    if (tLRPC$PhotoSize5 != null) {
                                                    }
                                                    i103 = -1;
                                                    tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                    if (tLRPC$PhotoSize6 != null) {
                                                    }
                                                    if (SharedConfig.autoplayVideo) {
                                                    }
                                                    if (this.autoPlayingMedia) {
                                                    }
                                                }
                                                obj = null;
                                                int i199222222 = messageObject10.type;
                                                if (i199222222 == 3) {
                                                }
                                                tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                if (tLRPC$PhotoSize5 != null) {
                                                }
                                                i103 = -1;
                                                tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                if (tLRPC$PhotoSize6 != null) {
                                                }
                                                if (SharedConfig.autoplayVideo) {
                                                }
                                                if (this.autoPlayingMedia) {
                                                }
                                            }
                                            obj = null;
                                            String format622222 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                            this.currentPhotoFilterThumb = format622222;
                                            this.currentPhotoFilter = format622222;
                                            arrayList2 = messageObject10.photoThumbs;
                                            if (arrayList2 != null) {
                                                if (!messageObject.needDrawBluredPreview()) {
                                                }
                                                int i1992222222 = messageObject10.type;
                                                if (i1992222222 == 3) {
                                                }
                                                tLRPC$PhotoSize5 = this.currentPhotoObject;
                                                if (tLRPC$PhotoSize5 != null) {
                                                }
                                                i103 = -1;
                                                tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                                if (tLRPC$PhotoSize6 != null) {
                                                }
                                                if (SharedConfig.autoplayVideo) {
                                                }
                                                if (this.autoPlayingMedia) {
                                                }
                                            }
                                            if (!messageObject.needDrawBluredPreview()) {
                                            }
                                            int i19922222222 = messageObject10.type;
                                            if (i19922222222 == 3) {
                                            }
                                            tLRPC$PhotoSize5 = this.currentPhotoObject;
                                            if (tLRPC$PhotoSize5 != null) {
                                            }
                                            i103 = -1;
                                            tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                            if (tLRPC$PhotoSize6 != null) {
                                            }
                                            if (SharedConfig.autoplayVideo) {
                                            }
                                            if (this.autoPlayingMedia) {
                                            }
                                        } else {
                                            minTabletSide11 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                                        }
                                    }
                                    i84 = (int) (minTabletSide11 * 0.7f);
                                }
                                z35 = false;
                                int dp452 = AndroidUtilities.dp(100.0f) + i84;
                                if (z35) {
                                }
                                i85 = messageObject10.type;
                                if (i85 == 1) {
                                    if (i85 == 3) {
                                        if (i85 == 5) {
                                        }
                                        z36 = false;
                                        bitmapDrawable2 = this.currentMessageObject.strippedThumb;
                                        if (bitmapDrawable2 != null) {
                                        }
                                        if (messageObject10.type == 5) {
                                        }
                                        tLRPC$PhotoSize3 = this.currentPhotoObject;
                                        if (tLRPC$PhotoSize3 != null) {
                                        }
                                        tLRPC$PhotoSize4 = this.currentPhotoObject;
                                        if (tLRPC$PhotoSize4 != null) {
                                        }
                                        if (z36) {
                                        }
                                        if (this.currentMessagesGroup == null) {
                                        }
                                        if (i86 != 0) {
                                        }
                                        while (i88 < document.attributes.size()) {
                                        }
                                        dp452 = i87;
                                        i87 = dp452;
                                        if (i86 != 0) {
                                        }
                                        i87 = AndroidUtilities.dp(150.0f);
                                        i86 = i87;
                                        if (messageObject10.type == 3) {
                                        }
                                        if (this.commentLayout != null) {
                                        }
                                        if (this.currentMessagesGroup != null) {
                                        }
                                        if (messageObject10.type == 5) {
                                        }
                                        measureTime(messageObject);
                                        dp18 = this.timeWidth + AndroidUtilities.dp((SharedConfig.bubbleRadius < 10 ? 18 : 22) + (!messageObject.isOutOwner() ? 0 : 20));
                                        if (i86 < dp18) {
                                        }
                                        if (messageObject.isRoundVideo()) {
                                        }
                                        if (this.currentMessagesGroup != null) {
                                        }
                                        if (this.currentCaption == null) {
                                        }
                                        if (!this.reactionsLayoutInBubble.isSmall) {
                                        }
                                        int i198222222 = i101;
                                        measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                        if (this.currentMessagesGroup != null) {
                                        }
                                        if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                        }
                                        i64 = i86;
                                        if (z3) {
                                        }
                                        obj = null;
                                        String format6222222 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                        this.currentPhotoFilterThumb = format6222222;
                                        this.currentPhotoFilter = format6222222;
                                        arrayList2 = messageObject10.photoThumbs;
                                        if (arrayList2 != null) {
                                        }
                                        if (!messageObject.needDrawBluredPreview()) {
                                        }
                                        int i199222222222 = messageObject10.type;
                                        if (i199222222222 == 3) {
                                        }
                                        tLRPC$PhotoSize5 = this.currentPhotoObject;
                                        if (tLRPC$PhotoSize5 != null) {
                                        }
                                        i103 = -1;
                                        tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                        if (tLRPC$PhotoSize6 != null) {
                                        }
                                        if (SharedConfig.autoplayVideo) {
                                        }
                                        if (this.autoPlayingMedia) {
                                        }
                                    }
                                    createDocumentLayout(0, messageObject10);
                                    this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject10.photoThumbs, 40);
                                    updateSecretTimeText(messageObject);
                                    z36 = true;
                                    bitmapDrawable2 = this.currentMessageObject.strippedThumb;
                                    if (bitmapDrawable2 != null) {
                                    }
                                    if (messageObject10.type == 5) {
                                    }
                                    tLRPC$PhotoSize3 = this.currentPhotoObject;
                                    if (tLRPC$PhotoSize3 != null) {
                                    }
                                    tLRPC$PhotoSize4 = this.currentPhotoObject;
                                    if (tLRPC$PhotoSize4 != null) {
                                    }
                                    if (z36) {
                                    }
                                    if (this.currentMessagesGroup == null) {
                                    }
                                    if (i86 != 0) {
                                    }
                                    while (i88 < document.attributes.size()) {
                                    }
                                    dp452 = i87;
                                    i87 = dp452;
                                    if (i86 != 0) {
                                    }
                                    i87 = AndroidUtilities.dp(150.0f);
                                    i86 = i87;
                                    if (messageObject10.type == 3) {
                                    }
                                    if (this.commentLayout != null) {
                                    }
                                    if (this.currentMessagesGroup != null) {
                                    }
                                    if (messageObject10.type == 5) {
                                    }
                                    measureTime(messageObject);
                                    dp18 = this.timeWidth + AndroidUtilities.dp((SharedConfig.bubbleRadius < 10 ? 18 : 22) + (!messageObject.isOutOwner() ? 0 : 20));
                                    if (i86 < dp18) {
                                    }
                                    if (messageObject.isRoundVideo()) {
                                    }
                                    if (this.currentMessagesGroup != null) {
                                    }
                                    if (this.currentCaption == null) {
                                    }
                                    if (!this.reactionsLayoutInBubble.isSmall) {
                                    }
                                    int i1982222222 = i101;
                                    measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                    if (this.currentMessagesGroup != null) {
                                    }
                                    if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                    }
                                    i64 = i86;
                                    if (z3) {
                                    }
                                    obj = null;
                                    String format62222222 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                    this.currentPhotoFilterThumb = format62222222;
                                    this.currentPhotoFilter = format62222222;
                                    arrayList2 = messageObject10.photoThumbs;
                                    if (arrayList2 != null) {
                                    }
                                    if (!messageObject.needDrawBluredPreview()) {
                                    }
                                    int i1992222222222 = messageObject10.type;
                                    if (i1992222222222 == 3) {
                                    }
                                    tLRPC$PhotoSize5 = this.currentPhotoObject;
                                    if (tLRPC$PhotoSize5 != null) {
                                    }
                                    i103 = -1;
                                    tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                    if (tLRPC$PhotoSize6 != null) {
                                    }
                                    if (SharedConfig.autoplayVideo) {
                                    }
                                    if (this.autoPlayingMedia) {
                                    }
                                }
                                updateSecretTimeText(messageObject);
                                this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject10.photoThumbs, 40);
                                z36 = false;
                                bitmapDrawable2 = this.currentMessageObject.strippedThumb;
                                if (bitmapDrawable2 != null) {
                                }
                                if (messageObject10.type == 5) {
                                }
                                tLRPC$PhotoSize3 = this.currentPhotoObject;
                                if (tLRPC$PhotoSize3 != null) {
                                }
                                tLRPC$PhotoSize4 = this.currentPhotoObject;
                                if (tLRPC$PhotoSize4 != null) {
                                }
                                if (z36) {
                                }
                                if (this.currentMessagesGroup == null) {
                                }
                                if (i86 != 0) {
                                }
                                while (i88 < document.attributes.size()) {
                                }
                                dp452 = i87;
                                i87 = dp452;
                                if (i86 != 0) {
                                }
                                i87 = AndroidUtilities.dp(150.0f);
                                i86 = i87;
                                if (messageObject10.type == 3) {
                                }
                                if (this.commentLayout != null) {
                                }
                                if (this.currentMessagesGroup != null) {
                                }
                                if (messageObject10.type == 5) {
                                }
                                measureTime(messageObject);
                                dp18 = this.timeWidth + AndroidUtilities.dp((SharedConfig.bubbleRadius < 10 ? 18 : 22) + (!messageObject.isOutOwner() ? 0 : 20));
                                if (i86 < dp18) {
                                }
                                if (messageObject.isRoundVideo()) {
                                }
                                if (this.currentMessagesGroup != null) {
                                }
                                if (this.currentCaption == null) {
                                }
                                if (!this.reactionsLayoutInBubble.isSmall) {
                                }
                                int i19822222222 = i101;
                                measureText = (int) (Theme.chat_infoPaint.measureText("100%") + AndroidUtilities.dp(100.0f));
                                if (this.currentMessagesGroup != null) {
                                }
                                if (i86 < this.captionWidth + AndroidUtilities.dp(10.0f)) {
                                }
                                i64 = i86;
                                if (z3) {
                                }
                                obj = null;
                                String format622222222 = String.format(Locale.US, "%d_%d", Integer.valueOf((int) (i89 / AndroidUtilities.density)), Integer.valueOf((int) (i96 / AndroidUtilities.density)));
                                this.currentPhotoFilterThumb = format622222222;
                                this.currentPhotoFilter = format622222222;
                                arrayList2 = messageObject10.photoThumbs;
                                if (arrayList2 != null) {
                                }
                                if (!messageObject.needDrawBluredPreview()) {
                                }
                                int i19922222222222 = messageObject10.type;
                                if (i19922222222222 == 3) {
                                }
                                tLRPC$PhotoSize5 = this.currentPhotoObject;
                                if (tLRPC$PhotoSize5 != null) {
                                }
                                i103 = -1;
                                tLRPC$PhotoSize6 = this.currentPhotoObjectThumb;
                                if (tLRPC$PhotoSize6 != null) {
                                }
                                if (SharedConfig.autoplayVideo) {
                                }
                                if (this.autoPlayingMedia) {
                                }
                            }
                            setMessageObjectInternal(messageObject);
                            if (this.drawForwardedName && messageObject.needDrawForwarded() && ((groupedMessagePosition8 = this.currentPosition) == null || groupedMessagePosition8.minY == 0)) {
                                if (messageObject6.type != 5) {
                                    this.namesOffset += AndroidUtilities.dp(5.0f);
                                }
                            } else if (this.drawNameLayout && (messageObject.getReplyMsgId() == 0 || (this.isThreadChat && messageObject.getReplyTopMsgId() == 0))) {
                                this.namesOffset += AndroidUtilities.dp(7.0f);
                            }
                            this.totalHeight = AndroidUtilities.dp(14.0f) + i65 + this.namesOffset + i67;
                            groupedMessagePosition7 = this.currentPosition;
                            if (groupedMessagePosition7 != null && (groupedMessagePosition7.flags & 8) == 0 && !this.currentMessageObject.isDocument() && this.currentMessageObject.type != 19) {
                                this.totalHeight -= AndroidUtilities.dp(3.0f);
                            }
                            if (this.currentMessageObject.isDice()) {
                                this.totalHeight += AndroidUtilities.dp(21.0f);
                                this.additionalTimeOffsetY = AndroidUtilities.dp(21.0f);
                            }
                            if (this.currentPosition != null && !this.currentMessageObject.isDocument()) {
                                int additionalWidthForPosition3 = i64 + getAdditionalWidthForPosition(this.currentPosition);
                                if ((this.currentPosition.flags & 4) == 0) {
                                    i70 = 0;
                                } else {
                                    i65 += AndroidUtilities.dp(4.0f);
                                    i70 = 0 - AndroidUtilities.dp(4.0f);
                                }
                                if ((this.currentPosition.flags & 8) == 0) {
                                    i65 += AndroidUtilities.dp(f6);
                                }
                                i69 = additionalWidthForPosition3;
                            } else {
                                i69 = i64;
                                i70 = 0;
                            }
                            if (this.currentMessageObject.type != 19) {
                                dp15 = 0;
                            } else {
                                if (this.drawPinnedTop) {
                                    this.namesOffset -= AndroidUtilities.dp(f6);
                                }
                                if (this.namesOffset > 0) {
                                    dp15 = AndroidUtilities.dp(7.0f);
                                    this.totalHeight -= AndroidUtilities.dp(2.0f);
                                } else {
                                    dp15 = AndroidUtilities.dp(5.0f);
                                    this.totalHeight -= AndroidUtilities.dp(4.0f);
                                }
                            }
                            if (this.currentPosition != null) {
                                MessageObject.GroupedMessages groupedMessages6 = this.currentMessagesGroup;
                                if (groupedMessages6.isDocuments && groupedMessages6.messages.size() > 1) {
                                    if ((this.currentPosition.flags & 4) == 0) {
                                        this.totalHeight -= AndroidUtilities.dp(!this.drawPhotoImage ? 6.0f : 3.0f);
                                        this.mediaOffsetY -= AndroidUtilities.dp(!this.drawPhotoImage ? 6.0f : 3.0f);
                                        dp15 -= AndroidUtilities.dp(!this.drawPhotoImage ? 6.0f : 3.0f);
                                    }
                                    if ((this.currentPosition.flags & 8) == 0) {
                                        this.totalHeight -= AndroidUtilities.dp(!this.drawPhotoImage ? 6.0f : 3.0f);
                                    }
                                }
                            }
                            this.photoImage.setImageCoords(0.0f, dp15 + this.namesOffset + i70, i69, i65);
                            invalidate();
                            i50 = i68;
                            messageObject10 = messageObject6;
                            i33 = 3;
                            i34 = 2;
                            f3 = 1.0f;
                        }
                        z26 = true;
                        setMessageObjectInternal(messageObject);
                        if (this.drawForwardedName) {
                            if (messageObject6.type != 5) {
                            }
                            this.totalHeight = AndroidUtilities.dp(14.0f) + i65 + this.namesOffset + i67;
                            groupedMessagePosition7 = this.currentPosition;
                            if (groupedMessagePosition7 != null) {
                                this.totalHeight -= AndroidUtilities.dp(3.0f);
                            }
                            if (this.currentMessageObject.isDice()) {
                            }
                            if (this.currentPosition != null) {
                                int additionalWidthForPosition32 = i64 + getAdditionalWidthForPosition(this.currentPosition);
                                if ((this.currentPosition.flags & 4) == 0) {
                                }
                                if ((this.currentPosition.flags & 8) == 0) {
                                }
                                i69 = additionalWidthForPosition32;
                                if (this.currentMessageObject.type != 19) {
                                }
                                if (this.currentPosition != null) {
                                }
                                this.photoImage.setImageCoords(0.0f, dp15 + this.namesOffset + i70, i69, i65);
                                invalidate();
                                i50 = i68;
                                messageObject10 = messageObject6;
                                i33 = 3;
                                i34 = 2;
                                f3 = 1.0f;
                            }
                            i69 = i64;
                            i70 = 0;
                            if (this.currentMessageObject.type != 19) {
                            }
                            if (this.currentPosition != null) {
                            }
                            this.photoImage.setImageCoords(0.0f, dp15 + this.namesOffset + i70, i69, i65);
                            invalidate();
                            i50 = i68;
                            messageObject10 = messageObject6;
                            i33 = 3;
                            i34 = 2;
                            f3 = 1.0f;
                        }
                        if (this.drawNameLayout) {
                            this.namesOffset += AndroidUtilities.dp(7.0f);
                        }
                        this.totalHeight = AndroidUtilities.dp(14.0f) + i65 + this.namesOffset + i67;
                        groupedMessagePosition7 = this.currentPosition;
                        if (groupedMessagePosition7 != null) {
                        }
                        if (this.currentMessageObject.isDice()) {
                        }
                        if (this.currentPosition != null) {
                        }
                        i69 = i64;
                        i70 = 0;
                        if (this.currentMessageObject.type != 19) {
                        }
                        if (this.currentPosition != null) {
                        }
                        this.photoImage.setImageCoords(0.0f, dp15 + this.namesOffset + i70, i69, i65);
                        invalidate();
                        i50 = i68;
                        messageObject10 = messageObject6;
                        i33 = 3;
                        i34 = 2;
                        f3 = 1.0f;
                    }
                    messageObject10 = messageObject5;
                    i50 = 0;
                    i33 = 3;
                    i34 = 2;
                    f3 = 1.0f;
                    z26 = true;
                } else {
                    this.drawForwardedName = !this.isRepliesChat;
                    if (z8) {
                        if (AndroidUtilities.isTablet()) {
                            minTabletSide = AndroidUtilities.getMinTabletSide();
                            dp = AndroidUtilities.dp(122.0f);
                        } else {
                            minTabletSide = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                            dp = AndroidUtilities.dp(122.0f);
                        }
                        i6 = minTabletSide - dp;
                        this.drawName = true;
                    } else {
                        if (AndroidUtilities.isTablet()) {
                            minTabletSide4 = AndroidUtilities.getMinTabletSide();
                            dp7 = AndroidUtilities.dp(80.0f);
                        } else {
                            minTabletSide4 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                            dp7 = AndroidUtilities.dp(80.0f);
                        }
                        i6 = minTabletSide4 - dp7;
                        this.drawName = this.isPinnedChat || (messageObject10.messageOwner.peer_id.channel_id != 0 && (!messageObject.isOutOwner() || messageObject.isSupergroup())) || (messageObject.isImportedForward() && messageObject10.messageOwner.fwd_from.from_id == null);
                    }
                    int i209 = i6;
                    this.availableTimeWidth = i209;
                    if (messageObject.isRoundVideo()) {
                        double d13 = this.availableTimeWidth;
                        double ceil18 = Math.ceil(Theme.chat_audioTimePaint.measureText("00:00"));
                        double dp55 = !messageObject.isOutOwner() ? AndroidUtilities.dp(64.0f) : 0;
                        Double.isNaN(dp55);
                        Double.isNaN(d13);
                        this.availableTimeWidth = (int) (d13 - (ceil18 + dp55));
                    }
                    measureTime(messageObject);
                    int dp56 = this.timeWidth + AndroidUtilities.dp(6.0f);
                    if (messageObject.isOutOwner()) {
                        dp56 += AndroidUtilities.dp(20.5f);
                    }
                    int extraTimeX2 = dp56 + getExtraTimeX();
                    this.hasGamePreview = (MessageObject.getMedia(messageObject10.messageOwner) instanceof TLRPC$TL_messageMediaGame) && (MessageObject.getMedia(messageObject10.messageOwner).game instanceof TLRPC$TL_game);
                    this.hasInvoicePreview = MessageObject.getMedia(messageObject10.messageOwner) instanceof TLRPC$TL_messageMediaInvoice;
                    boolean z60 = !messageObject10.isRestrictedMessage && (MessageObject.getMedia(messageObject10.messageOwner) instanceof TLRPC$TL_messageMediaWebPage) && (MessageObject.getMedia(messageObject10.messageOwner).webpage instanceof TLRPC$TL_webPage);
                    this.hasLinkPreview = z60;
                    this.drawInstantView = z60 && MessageObject.getMedia(messageObject10.messageOwner).webpage.cached_page != null;
                    String str27 = !this.hasLinkPreview ? null : MessageObject.getMedia(messageObject10.messageOwner).webpage.site_name;
                    this.hasEmbed = this.hasLinkPreview && !TextUtils.isEmpty(MessageObject.getMedia(messageObject10.messageOwner).webpage.embed_url) && !messageObject.isGif() && !"instangram".equalsIgnoreCase(str27);
                    String str28 = !this.hasLinkPreview ? null : MessageObject.getMedia(messageObject10.messageOwner).webpage.type;
                    if (this.drawInstantView) {
                        if (str27 != null) {
                            String lowerCase = str27.toLowerCase();
                            if ((lowerCase.equals("instagram") || lowerCase.equals("twitter") || "telegram_album".equals(str28)) && (MessageObject.getMedia(messageObject10.messageOwner).webpage.cached_page instanceof TLRPC$TL_page) && ((MessageObject.getMedia(messageObject10.messageOwner).webpage.photo instanceof TLRPC$TL_photo) || MessageObject.isVideoDocument(MessageObject.getMedia(messageObject10.messageOwner).webpage.document))) {
                                this.drawInstantView = false;
                                ArrayList<TLRPC$PageBlock> arrayList7 = MessageObject.getMedia(messageObject10.messageOwner).webpage.cached_page.blocks;
                                int i210 = 1;
                                for (int i211 = 0; i211 < arrayList7.size(); i211++) {
                                    TLRPC$PageBlock tLRPC$PageBlock = arrayList7.get(i211);
                                    if (tLRPC$PageBlock instanceof TLRPC$TL_pageBlockSlideshow) {
                                        size = ((TLRPC$TL_pageBlockSlideshow) tLRPC$PageBlock).items.size();
                                    } else if (tLRPC$PageBlock instanceof TLRPC$TL_pageBlockCollage) {
                                        size = ((TLRPC$TL_pageBlockCollage) tLRPC$PageBlock).items.size();
                                    }
                                    i210 = size;
                                }
                                String formatString = LocaleController.formatString("Of", R.string.Of, 1, Integer.valueOf(i210));
                                this.photosCountWidth = (int) Math.ceil(Theme.chat_durationPaint.measureText(formatString));
                                this.photosCountLayout = new StaticLayout(formatString, Theme.chat_durationPaint, this.photosCountWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                tLRPC$ThemeSettings = null;
                                tLRPC$Document = null;
                                z11 = true;
                                this.backgroundWidth = i209;
                                if (!this.hasLinkPreview && !this.hasGamePreview && !this.hasInvoicePreview) {
                                    i51 = messageObject10.lastLineWidth;
                                    if (i209 - i51 >= extraTimeX2) {
                                        int i212 = i209 - i51;
                                        if (i212 >= 0 && i212 <= extraTimeX2) {
                                            this.backgroundWidth = ((i209 + extraTimeX2) - i212) + AndroidUtilities.dp(31.0f);
                                        } else {
                                            this.backgroundWidth = Math.max(i209, i51 + extraTimeX2) + AndroidUtilities.dp(31.0f);
                                        }
                                        this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                        if (messageObject.isRoundVideo()) {
                                            double d14 = this.availableTimeWidth;
                                            double ceil19 = Math.ceil(Theme.chat_audioTimePaint.measureText("00:00"));
                                            double dp57 = !messageObject.isOutOwner() ? AndroidUtilities.dp(64.0f) : 0;
                                            Double.isNaN(dp57);
                                            Double.isNaN(d14);
                                            this.availableTimeWidth = (int) (d14 - (ceil19 + dp57));
                                        }
                                        setMessageObjectInternal(messageObject);
                                        this.backgroundWidth = messageObject10.textWidth + (getExtraTextX() * 2) + ((!this.hasGamePreview && !this.hasInvoicePreview) ? 0 : AndroidUtilities.dp(10.0f));
                                        this.totalHeight = messageObject10.textHeight + AndroidUtilities.dp(19.5f) + this.namesOffset;
                                        reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                                        if (!reactionsLayoutInBubble.isSmall) {
                                            reactionsLayoutInBubble.measure(i209, 3);
                                            ReactionsLayoutInBubble reactionsLayoutInBubble27 = this.reactionsLayoutInBubble;
                                            if (!reactionsLayoutInBubble27.isEmpty) {
                                                reactionsLayoutInBubble27.totalHeight = reactionsLayoutInBubble27.height + AndroidUtilities.dp(8.0f);
                                                ReactionsLayoutInBubble reactionsLayoutInBubble28 = this.reactionsLayoutInBubble;
                                                int i213 = reactionsLayoutInBubble28.width;
                                                if (i213 > this.backgroundWidth) {
                                                    this.backgroundWidth = i213;
                                                }
                                                this.totalHeight += reactionsLayoutInBubble28.totalHeight;
                                            }
                                        }
                                        if (this.drawPinnedTop) {
                                            this.namesOffset -= AndroidUtilities.dp(1.0f);
                                        }
                                        max = Math.max(Math.max(Math.max(Math.max(this.backgroundWidth, this.nameWidth), this.forwardedNameWidth), this.replyNameWidth), this.replyTextWidth);
                                        if (this.commentLayout != null && this.drawSideButton != 3) {
                                            max = Math.max(max, this.totalCommentWidth);
                                        }
                                        i7 = max;
                                        if (this.hasLinkPreview || this.hasGamePreview || this.hasInvoicePreview) {
                                            if (!AndroidUtilities.isTablet()) {
                                                if (z8) {
                                                    minTabletSide2 = getParentWidth();
                                                    dp2 = AndroidUtilities.dp(132.0f);
                                                } else {
                                                    minTabletSide2 = getParentWidth();
                                                    dp2 = AndroidUtilities.dp(80.0f);
                                                }
                                            } else if (z8) {
                                                minTabletSide2 = AndroidUtilities.getMinTabletSide();
                                                dp2 = AndroidUtilities.dp(132.0f);
                                            } else {
                                                minTabletSide2 = AndroidUtilities.getMinTabletSide();
                                                dp2 = AndroidUtilities.dp(80.0f);
                                            }
                                            int i214 = minTabletSide2 - dp2;
                                            if (this.drawSideButton != 0) {
                                                i214 -= AndroidUtilities.dp(20.0f);
                                            }
                                            dp3 = AndroidUtilities.dp(48.0f);
                                            dp4 = AndroidUtilities.dp(10.0f);
                                            if (this.hasLinkPreview) {
                                                TLRPC$TL_webPage tLRPC$TL_webPage = (TLRPC$TL_webPage) MessageObject.getMedia(messageObject10.messageOwner).webpage;
                                                String str29 = tLRPC$TL_webPage.site_name;
                                                int i215 = this.drawInstantViewType;
                                                if (i215 != 6 && i215 != 7) {
                                                    str = tLRPC$TL_webPage.title;
                                                    i8 = 6;
                                                    if (i215 != i8 && i215 != 7) {
                                                        str2 = tLRPC$TL_webPage.author;
                                                        i9 = 6;
                                                        if (i215 != i9 && i215 != 7) {
                                                            str3 = tLRPC$TL_webPage.description;
                                                            i10 = i214;
                                                            TLRPC$Photo tLRPC$Photo4 = tLRPC$TL_webPage.photo;
                                                            str4 = str3;
                                                            if (i215 != 7) {
                                                                themeDocument = tLRPC$ThemeSettings == null ? tLRPC$Document : new DocumentObject.ThemeDocument(tLRPC$ThemeSettings);
                                                            } else {
                                                                themeDocument = tLRPC$TL_webPage.document;
                                                            }
                                                            String str30 = tLRPC$TL_webPage.type;
                                                            int i216 = tLRPC$TL_webPage.duration;
                                                            if (str29 != null && tLRPC$Photo4 != null && str29.toLowerCase().equals("instagram")) {
                                                                i10 = Math.max(AndroidUtilities.displaySize.y / 3, this.currentMessageObject.textWidth);
                                                            }
                                                            boolean z61 = !z11 && (!this.drawInstantView || (i13 = this.drawInstantViewType) == 1 || i13 == 9 || i13 == 11 || i13 == 13) && themeDocument == null && ("app".equals(str30) || "profile".equals(str30) || "article".equals(str30) || "telegram_bot".equals(str30) || "telegram_user".equals(str30) || "telegram_channel".equals(str30) || "telegram_megagroup".equals(str30) || "telegram_voicechat".equals(str30) || "telegram_livestream".equals(str30));
                                                            this.isSmallImage = (!z61 || str30 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                            tLRPC$Document2 = themeDocument;
                                                            str5 = str;
                                                            webFile = null;
                                                            i11 = i216;
                                                            str6 = str2;
                                                            str7 = str29;
                                                            tLRPC$Photo = tLRPC$Photo4;
                                                            i214 = i10;
                                                            i12 = i209;
                                                            boolean z62 = z61;
                                                            str8 = str30;
                                                            z12 = z62;
                                                        }
                                                        i10 = i214;
                                                        str3 = null;
                                                        TLRPC$Photo tLRPC$Photo42 = tLRPC$TL_webPage.photo;
                                                        str4 = str3;
                                                        if (i215 != 7) {
                                                        }
                                                        String str302 = tLRPC$TL_webPage.type;
                                                        int i2162 = tLRPC$TL_webPage.duration;
                                                        if (str29 != null) {
                                                            i10 = Math.max(AndroidUtilities.displaySize.y / 3, this.currentMessageObject.textWidth);
                                                        }
                                                        if ("app".equals(str302)) {
                                                            if (!z11) {
                                                                if (!z61) {
                                                                    this.isSmallImage = (!z61 || str302 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                                    tLRPC$Document2 = themeDocument;
                                                                    str5 = str;
                                                                    webFile = null;
                                                                    i11 = i2162;
                                                                    str6 = str2;
                                                                    str7 = str29;
                                                                    tLRPC$Photo = tLRPC$Photo42;
                                                                    i214 = i10;
                                                                    i12 = i209;
                                                                    boolean z622 = z61;
                                                                    str8 = str302;
                                                                    z12 = z622;
                                                                }
                                                                this.isSmallImage = (!z61 || str302 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                                tLRPC$Document2 = themeDocument;
                                                                str5 = str;
                                                                webFile = null;
                                                                i11 = i2162;
                                                                str6 = str2;
                                                                str7 = str29;
                                                                tLRPC$Photo = tLRPC$Photo42;
                                                                i214 = i10;
                                                                i12 = i209;
                                                                boolean z6222 = z61;
                                                                str8 = str302;
                                                                z12 = z6222;
                                                            }
                                                            this.isSmallImage = (!z61 || str302 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                            tLRPC$Document2 = themeDocument;
                                                            str5 = str;
                                                            webFile = null;
                                                            i11 = i2162;
                                                            str6 = str2;
                                                            str7 = str29;
                                                            tLRPC$Photo = tLRPC$Photo42;
                                                            i214 = i10;
                                                            i12 = i209;
                                                            boolean z62222 = z61;
                                                            str8 = str302;
                                                            z12 = z62222;
                                                        }
                                                        if (!z11) {
                                                        }
                                                        this.isSmallImage = (!z61 || str302 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                        tLRPC$Document2 = themeDocument;
                                                        str5 = str;
                                                        webFile = null;
                                                        i11 = i2162;
                                                        str6 = str2;
                                                        str7 = str29;
                                                        tLRPC$Photo = tLRPC$Photo42;
                                                        i214 = i10;
                                                        i12 = i209;
                                                        boolean z622222 = z61;
                                                        str8 = str302;
                                                        z12 = z622222;
                                                    }
                                                    i9 = 6;
                                                    str2 = null;
                                                    if (i215 != i9) {
                                                        str3 = tLRPC$TL_webPage.description;
                                                        i10 = i214;
                                                        TLRPC$Photo tLRPC$Photo422 = tLRPC$TL_webPage.photo;
                                                        str4 = str3;
                                                        if (i215 != 7) {
                                                        }
                                                        String str3022 = tLRPC$TL_webPage.type;
                                                        int i21622 = tLRPC$TL_webPage.duration;
                                                        if (str29 != null) {
                                                        }
                                                        if (!z11) {
                                                        }
                                                        this.isSmallImage = (!z61 || str3022 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                        tLRPC$Document2 = themeDocument;
                                                        str5 = str;
                                                        webFile = null;
                                                        i11 = i21622;
                                                        str6 = str2;
                                                        str7 = str29;
                                                        tLRPC$Photo = tLRPC$Photo422;
                                                        i214 = i10;
                                                        i12 = i209;
                                                        boolean z6222222 = z61;
                                                        str8 = str3022;
                                                        z12 = z6222222;
                                                    }
                                                    i10 = i214;
                                                    str3 = null;
                                                    TLRPC$Photo tLRPC$Photo4222 = tLRPC$TL_webPage.photo;
                                                    str4 = str3;
                                                    if (i215 != 7) {
                                                    }
                                                    String str30222 = tLRPC$TL_webPage.type;
                                                    int i216222 = tLRPC$TL_webPage.duration;
                                                    if (str29 != null) {
                                                    }
                                                    if (!z11) {
                                                    }
                                                    this.isSmallImage = (!z61 || str30222 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                    tLRPC$Document2 = themeDocument;
                                                    str5 = str;
                                                    webFile = null;
                                                    i11 = i216222;
                                                    str6 = str2;
                                                    str7 = str29;
                                                    tLRPC$Photo = tLRPC$Photo4222;
                                                    i214 = i10;
                                                    i12 = i209;
                                                    boolean z62222222 = z61;
                                                    str8 = str30222;
                                                    z12 = z62222222;
                                                }
                                                i8 = 6;
                                                str = null;
                                                if (i215 != i8) {
                                                    str2 = tLRPC$TL_webPage.author;
                                                    i9 = 6;
                                                    if (i215 != i9) {
                                                    }
                                                    i10 = i214;
                                                    str3 = null;
                                                    TLRPC$Photo tLRPC$Photo42222 = tLRPC$TL_webPage.photo;
                                                    str4 = str3;
                                                    if (i215 != 7) {
                                                    }
                                                    String str302222 = tLRPC$TL_webPage.type;
                                                    int i2162222 = tLRPC$TL_webPage.duration;
                                                    if (str29 != null) {
                                                    }
                                                    if (!z11) {
                                                    }
                                                    this.isSmallImage = (!z61 || str302222 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                    tLRPC$Document2 = themeDocument;
                                                    str5 = str;
                                                    webFile = null;
                                                    i11 = i2162222;
                                                    str6 = str2;
                                                    str7 = str29;
                                                    tLRPC$Photo = tLRPC$Photo42222;
                                                    i214 = i10;
                                                    i12 = i209;
                                                    boolean z622222222 = z61;
                                                    str8 = str302222;
                                                    z12 = z622222222;
                                                }
                                                i9 = 6;
                                                str2 = null;
                                                if (i215 != i9) {
                                                }
                                                i10 = i214;
                                                str3 = null;
                                                TLRPC$Photo tLRPC$Photo422222 = tLRPC$TL_webPage.photo;
                                                str4 = str3;
                                                if (i215 != 7) {
                                                }
                                                String str3022222 = tLRPC$TL_webPage.type;
                                                int i21622222 = tLRPC$TL_webPage.duration;
                                                if (str29 != null) {
                                                }
                                                if (!z11) {
                                                }
                                                this.isSmallImage = (!z61 || str3022222 == null || this.currentMessageObject.photoThumbs == null) ? false : true;
                                                tLRPC$Document2 = themeDocument;
                                                str5 = str;
                                                webFile = null;
                                                i11 = i21622222;
                                                str6 = str2;
                                                str7 = str29;
                                                tLRPC$Photo = tLRPC$Photo422222;
                                                i214 = i10;
                                                i12 = i209;
                                                boolean z6222222222 = z61;
                                                str8 = str3022222;
                                                z12 = z6222222222;
                                            } else if (this.hasInvoicePreview) {
                                                String str31 = MessageObject.getMedia(messageObject10.messageOwner).title;
                                                TLRPC$WebDocument tLRPC$WebDocument = ((TLRPC$TL_messageMediaInvoice) MessageObject.getMedia(messageObject10.messageOwner)).photo;
                                                WebFile createWithWebDocument = !(tLRPC$WebDocument instanceof TLRPC$TL_webDocument) ? null : WebFile.createWithWebDocument(tLRPC$WebDocument);
                                                this.isSmallImage = false;
                                                webFile = createWithWebDocument;
                                                i12 = i209;
                                                str7 = str31;
                                                str8 = "invoice";
                                                str5 = null;
                                                str6 = null;
                                                tLRPC$Document2 = null;
                                                tLRPC$Photo = null;
                                                z12 = false;
                                                i11 = 0;
                                                str4 = 0;
                                            } else {
                                                TLRPC$TL_game tLRPC$TL_game = MessageObject.getMedia(messageObject10.messageOwner).game;
                                                String str32 = tLRPC$TL_game.title;
                                                String str33 = !TextUtils.isEmpty(messageObject10.messageText) ? null : tLRPC$TL_game.description;
                                                tLRPC$Photo = tLRPC$TL_game.photo;
                                                TLRPC$Document tLRPC$Document7 = tLRPC$TL_game.document;
                                                this.isSmallImage = false;
                                                i12 = i209;
                                                str7 = str32;
                                                str4 = str33;
                                                str8 = "game";
                                                str5 = null;
                                                webFile = null;
                                                z12 = false;
                                                i11 = 0;
                                                tLRPC$Document2 = tLRPC$Document7;
                                                str6 = null;
                                            }
                                            i14 = this.drawInstantViewType;
                                            if (i14 == 11) {
                                                string = LocaleController.getString("VoipChannelVoiceChat", R.string.VoipChannelVoiceChat);
                                            } else if (i14 == 9) {
                                                string = LocaleController.getString("VoipGroupVoiceChat", R.string.VoipGroupVoiceChat);
                                            } else if (i14 == 6) {
                                                string = LocaleController.getString("ChatBackground", R.string.ChatBackground);
                                            } else {
                                                string = !"telegram_theme".equals(str28) ? str7 : LocaleController.getString("ColorTheme", R.string.ColorTheme);
                                            }
                                            dp5 = !this.hasInvoicePreview ? AndroidUtilities.dp(10.0f) : 0;
                                            i15 = i214 - dp5;
                                            messageObject2 = this.currentMessageObject;
                                            String str34 = str8;
                                            if (messageObject2.photoThumbs == null && tLRPC$Photo != null) {
                                                messageObject2.generateThumbs(true);
                                            }
                                            if (string == null) {
                                                str9 = str6;
                                                str10 = string;
                                                tLRPC$Document3 = tLRPC$Document2;
                                                webFile2 = webFile;
                                                tLRPC$Photo2 = tLRPC$Photo;
                                                z13 = z12;
                                                i18 = 0;
                                                i17 = 3;
                                            } else {
                                                try {
                                                    webFile2 = webFile;
                                                    TLRPC$Photo tLRPC$Photo5 = tLRPC$Photo;
                                                    try {
                                                        int ceil20 = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(string) + 1.0f);
                                                        if (!this.isSmallImage) {
                                                            this.siteNameLayout = new StaticLayout(string, Theme.chat_replyNamePaint, Math.min(ceil20, i15), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                            i19 = 0;
                                                            i16 = 3;
                                                        } else {
                                                            try {
                                                                StaticLayout generateStaticLayout = generateStaticLayout(string, Theme.chat_replyNamePaint, i15, (i15 - dp3) - dp4, 3, 1);
                                                                this.siteNameLayout = generateStaticLayout;
                                                                i16 = 3 - generateStaticLayout.getLineCount();
                                                                i19 = 3;
                                                            } catch (Exception e7) {
                                                                e = e7;
                                                                str9 = str6;
                                                                str10 = string;
                                                                tLRPC$Document3 = tLRPC$Document2;
                                                                z13 = z12;
                                                                tLRPC$Photo2 = tLRPC$Photo5;
                                                                i16 = 3;
                                                                FileLog.e(e);
                                                                i17 = i16;
                                                                i18 = 0;
                                                                if (str5 != null) {
                                                                }
                                                                if (str9 != null) {
                                                                }
                                                                z17 = false;
                                                                if (str4 != null) {
                                                                }
                                                                str11 = i15;
                                                                if (z13) {
                                                                }
                                                                z19 = z13;
                                                                if (!z19) {
                                                                }
                                                                if (tLRPC$Document3 == null) {
                                                                }
                                                                if (this.currentPosition != null) {
                                                                }
                                                                if (!messageObject10.isRestrictedMessage) {
                                                                }
                                                                if (this.captionLayout == null) {
                                                                }
                                                                if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                }
                                                                int dp512222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                staticLayout2 = this.captionLayout;
                                                                if (staticLayout2 == null) {
                                                                }
                                                                if (this.currentMessageObject.type != i34) {
                                                                }
                                                                if (valueOf != null) {
                                                                }
                                                                groupedMessagePosition4 = this.currentPosition;
                                                                if (groupedMessagePosition4 != null) {
                                                                }
                                                                int i2002222 = this.widthBeforeNewTimeLine;
                                                                i54 = -1;
                                                                messageObject4 = this.currentMessageObject;
                                                                if (messageObject4.eventId == 0) {
                                                                }
                                                                f4 = 0.0f;
                                                                if (messageObject.isSponsored()) {
                                                                }
                                                                this.botButtons.clear();
                                                                if (z46) {
                                                                }
                                                                if (!messageObject10.isRestrictedMessage) {
                                                                }
                                                                this.substractBackgroundHeight = 0;
                                                                this.keyboardHeight = 0;
                                                                r6 = hashMap;
                                                                if (this.drawCommentButton) {
                                                                }
                                                                z29 = this.drawPinnedBottom;
                                                                if (z29) {
                                                                }
                                                                if (!z29) {
                                                                }
                                                                if (messageObject10.type != 19) {
                                                                }
                                                                if (!this.drawPhotoImage) {
                                                                }
                                                                i58 = 5;
                                                                if (this.documentAttachType == 5) {
                                                                }
                                                                calculateUnlockXY();
                                                                if (z26) {
                                                                }
                                                                updateAnimatedEmojis();
                                                                r62 = r6;
                                                                if (z46) {
                                                                }
                                                                transcribeButton = this.transcribeButton;
                                                                if (transcribeButton != null) {
                                                                }
                                                                updateWaveform();
                                                                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                if (!this.currentMessageObject.loadingCancelled) {
                                                                }
                                                                chatMessageCellDelegate2 = this.delegate;
                                                                if (chatMessageCellDelegate2 != null) {
                                                                }
                                                                this.accessibilityVirtualViewBounds.clear();
                                                                this.transitionParams.updatePhotoImageX = true;
                                                                updateFlagSecure();
                                                            }
                                                        }
                                                        try {
                                                            int i217 = i16;
                                                            try {
                                                                this.siteNameRtl = Math.max(this.siteNameLayout.getLineLeft(0), 0.0f) != 0.0f;
                                                                int lineBottom = this.siteNameLayout.getLineBottom(staticLayout.getLineCount() - 1);
                                                                this.linkPreviewHeight += lineBottom;
                                                                this.totalHeight += lineBottom;
                                                                tLRPC$Photo2 = tLRPC$Photo5;
                                                                int i218 = 0;
                                                                int i219 = 0;
                                                                while (i218 < this.siteNameLayout.getLineCount()) {
                                                                    try {
                                                                        int i220 = i7;
                                                                        try {
                                                                            int max9 = (int) Math.max(0.0f, this.siteNameLayout.getLineLeft(i218));
                                                                            if (max9 != 0) {
                                                                                str9 = str6;
                                                                                str10 = string;
                                                                                tLRPC$Document3 = tLRPC$Document2;
                                                                                z13 = z12;
                                                                                width = this.siteNameLayout.getWidth() - max9;
                                                                            } else {
                                                                                try {
                                                                                    if (i218 >= i19) {
                                                                                        if (max9 == 0) {
                                                                                        }
                                                                                        z13 = z12;
                                                                                        i20 = i15;
                                                                                        tLRPC$Document3 = tLRPC$Document2;
                                                                                        str9 = str6;
                                                                                        str10 = string;
                                                                                        width = (int) Math.min(i20, Math.ceil(this.siteNameLayout.getLineWidth(i218)));
                                                                                    }
                                                                                    width = (int) Math.min(i20, Math.ceil(this.siteNameLayout.getLineWidth(i218)));
                                                                                } catch (Exception e8) {
                                                                                    e = e8;
                                                                                    i16 = i217;
                                                                                    i7 = i220;
                                                                                    FileLog.e(e);
                                                                                    i17 = i16;
                                                                                    i18 = 0;
                                                                                    if (str5 != null) {
                                                                                    }
                                                                                    if (str9 != null) {
                                                                                    }
                                                                                    z17 = false;
                                                                                    if (str4 != null) {
                                                                                    }
                                                                                    str11 = i15;
                                                                                    if (z13) {
                                                                                    }
                                                                                    z19 = z13;
                                                                                    if (!z19) {
                                                                                    }
                                                                                    if (tLRPC$Document3 == null) {
                                                                                    }
                                                                                    if (this.currentPosition != null) {
                                                                                    }
                                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                                    }
                                                                                    if (this.captionLayout == null) {
                                                                                    }
                                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                                    }
                                                                                    int dp5122222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                                    staticLayout2 = this.captionLayout;
                                                                                    if (staticLayout2 == null) {
                                                                                    }
                                                                                    if (this.currentMessageObject.type != i34) {
                                                                                    }
                                                                                    if (valueOf != null) {
                                                                                    }
                                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                                    if (groupedMessagePosition4 != null) {
                                                                                    }
                                                                                    int i20022222 = this.widthBeforeNewTimeLine;
                                                                                    i54 = -1;
                                                                                    messageObject4 = this.currentMessageObject;
                                                                                    if (messageObject4.eventId == 0) {
                                                                                    }
                                                                                    f4 = 0.0f;
                                                                                    if (messageObject.isSponsored()) {
                                                                                    }
                                                                                    this.botButtons.clear();
                                                                                    if (z46) {
                                                                                    }
                                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                                    }
                                                                                    this.substractBackgroundHeight = 0;
                                                                                    this.keyboardHeight = 0;
                                                                                    r6 = hashMap;
                                                                                    if (this.drawCommentButton) {
                                                                                    }
                                                                                    z29 = this.drawPinnedBottom;
                                                                                    if (z29) {
                                                                                    }
                                                                                    if (!z29) {
                                                                                    }
                                                                                    if (messageObject10.type != 19) {
                                                                                    }
                                                                                    if (!this.drawPhotoImage) {
                                                                                    }
                                                                                    i58 = 5;
                                                                                    if (this.documentAttachType == 5) {
                                                                                    }
                                                                                    calculateUnlockXY();
                                                                                    if (z26) {
                                                                                    }
                                                                                    updateAnimatedEmojis();
                                                                                    r62 = r6;
                                                                                    if (z46) {
                                                                                    }
                                                                                    transcribeButton = this.transcribeButton;
                                                                                    if (transcribeButton != null) {
                                                                                    }
                                                                                    updateWaveform();
                                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                                    }
                                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                                    if (chatMessageCellDelegate2 != null) {
                                                                                    }
                                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                                    updateFlagSecure();
                                                                                }
                                                                                i20 = i15 - (dp3 + dp4);
                                                                                z13 = z12;
                                                                                tLRPC$Document3 = tLRPC$Document2;
                                                                                str9 = str6;
                                                                                str10 = string;
                                                                            }
                                                                            if (i218 >= i19) {
                                                                                if (max9 != 0) {
                                                                                    if (!this.isSmallImage) {
                                                                                    }
                                                                                }
                                                                                i219 = Math.max(i219, width);
                                                                                i218++;
                                                                                i7 = i220;
                                                                                z12 = z13;
                                                                                tLRPC$Document2 = tLRPC$Document3;
                                                                                str6 = str9;
                                                                                string = str10;
                                                                            }
                                                                            width += dp3 + dp4;
                                                                            i219 = Math.max(i219, width);
                                                                            i218++;
                                                                            i7 = i220;
                                                                            z12 = z13;
                                                                            tLRPC$Document2 = tLRPC$Document3;
                                                                            str6 = str9;
                                                                            string = str10;
                                                                        } catch (Exception e9) {
                                                                            e = e9;
                                                                            str9 = str6;
                                                                            str10 = string;
                                                                            tLRPC$Document3 = tLRPC$Document2;
                                                                            z13 = z12;
                                                                        }
                                                                    } catch (Exception e10) {
                                                                        e = e10;
                                                                        str9 = str6;
                                                                        str10 = string;
                                                                        tLRPC$Document3 = tLRPC$Document2;
                                                                    }
                                                                }
                                                                try {
                                                                    this.siteNameWidth = i219;
                                                                    int i221 = i219 + dp5;
                                                                    i7 = Math.max(i7, i221);
                                                                    str9 = str6;
                                                                    str10 = string;
                                                                    tLRPC$Document3 = tLRPC$Document2;
                                                                    z13 = z12;
                                                                    i17 = i217;
                                                                    i18 = Math.max(0, i221);
                                                                } catch (Exception e11) {
                                                                    e = e11;
                                                                    str9 = str6;
                                                                    str10 = string;
                                                                    tLRPC$Document3 = tLRPC$Document2;
                                                                    z13 = z12;
                                                                    i16 = i217;
                                                                    FileLog.e(e);
                                                                    i17 = i16;
                                                                    i18 = 0;
                                                                    if (str5 != null) {
                                                                    }
                                                                    if (str9 != null) {
                                                                    }
                                                                    z17 = false;
                                                                    if (str4 != null) {
                                                                    }
                                                                    str11 = i15;
                                                                    if (z13) {
                                                                    }
                                                                    z19 = z13;
                                                                    if (!z19) {
                                                                    }
                                                                    if (tLRPC$Document3 == null) {
                                                                    }
                                                                    if (this.currentPosition != null) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    if (this.captionLayout == null) {
                                                                    }
                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                    }
                                                                    int dp51222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                    staticLayout2 = this.captionLayout;
                                                                    if (staticLayout2 == null) {
                                                                    }
                                                                    if (this.currentMessageObject.type != i34) {
                                                                    }
                                                                    if (valueOf != null) {
                                                                    }
                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                    if (groupedMessagePosition4 != null) {
                                                                    }
                                                                    int i200222222 = this.widthBeforeNewTimeLine;
                                                                    i54 = -1;
                                                                    messageObject4 = this.currentMessageObject;
                                                                    if (messageObject4.eventId == 0) {
                                                                    }
                                                                    f4 = 0.0f;
                                                                    if (messageObject.isSponsored()) {
                                                                    }
                                                                    this.botButtons.clear();
                                                                    if (z46) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    this.substractBackgroundHeight = 0;
                                                                    this.keyboardHeight = 0;
                                                                    r6 = hashMap;
                                                                    if (this.drawCommentButton) {
                                                                    }
                                                                    z29 = this.drawPinnedBottom;
                                                                    if (z29) {
                                                                    }
                                                                    if (!z29) {
                                                                    }
                                                                    if (messageObject10.type != 19) {
                                                                    }
                                                                    if (!this.drawPhotoImage) {
                                                                    }
                                                                    i58 = 5;
                                                                    if (this.documentAttachType == 5) {
                                                                    }
                                                                    calculateUnlockXY();
                                                                    if (z26) {
                                                                    }
                                                                    updateAnimatedEmojis();
                                                                    r62 = r6;
                                                                    if (z46) {
                                                                    }
                                                                    transcribeButton = this.transcribeButton;
                                                                    if (transcribeButton != null) {
                                                                    }
                                                                    updateWaveform();
                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                    }
                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                    if (chatMessageCellDelegate2 != null) {
                                                                    }
                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                    updateFlagSecure();
                                                                }
                                                            } catch (Exception e12) {
                                                                e = e12;
                                                                str9 = str6;
                                                                str10 = string;
                                                                tLRPC$Document3 = tLRPC$Document2;
                                                                z13 = z12;
                                                                tLRPC$Photo2 = tLRPC$Photo5;
                                                            }
                                                        } catch (Exception e13) {
                                                            e = e13;
                                                            str9 = str6;
                                                            str10 = string;
                                                            tLRPC$Document3 = tLRPC$Document2;
                                                            z13 = z12;
                                                            tLRPC$Photo2 = tLRPC$Photo5;
                                                        }
                                                    } catch (Exception e14) {
                                                        e = e14;
                                                        str9 = str6;
                                                        str10 = string;
                                                        tLRPC$Document3 = tLRPC$Document2;
                                                    }
                                                } catch (Exception e15) {
                                                    e = e15;
                                                    str9 = str6;
                                                    str10 = string;
                                                    tLRPC$Document3 = tLRPC$Document2;
                                                    webFile2 = webFile;
                                                    tLRPC$Photo2 = tLRPC$Photo;
                                                    z13 = z12;
                                                }
                                            }
                                            if (str5 != null) {
                                                z16 = false;
                                            } else {
                                                try {
                                                    this.titleX = ConnectionsManager.DEFAULT_DATACENTER_ID;
                                                    int i222 = this.linkPreviewHeight;
                                                    if (i222 != 0) {
                                                        this.linkPreviewHeight = i222 + AndroidUtilities.dp(2.0f);
                                                        this.totalHeight += AndroidUtilities.dp(2.0f);
                                                    }
                                                    if (!this.isSmallImage) {
                                                        this.titleLayout = StaticLayoutEx.createStaticLayout(str5, Theme.chat_replyNamePaint, i15, Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(1.0f), false, TextUtils.TruncateAt.END, i15, 4);
                                                        i22 = 0;
                                                    } else {
                                                        StaticLayout generateStaticLayout2 = generateStaticLayout(str5, Theme.chat_replyNamePaint, i15, (i15 - dp3) - dp4, i17, 4);
                                                        this.titleLayout = generateStaticLayout2;
                                                        int i223 = i17;
                                                        i17 -= generateStaticLayout2.getLineCount();
                                                        i22 = i223;
                                                    }
                                                } catch (Exception e16) {
                                                    e = e16;
                                                }
                                                try {
                                                    StaticLayout staticLayout16 = this.titleLayout;
                                                    int lineBottom2 = staticLayout16.getLineBottom(staticLayout16.getLineCount() - 1);
                                                    this.linkPreviewHeight += lineBottom2;
                                                    this.totalHeight += lineBottom2;
                                                    int i224 = 0;
                                                    boolean z63 = false;
                                                    while (i224 < this.titleLayout.getLineCount()) {
                                                        try {
                                                            int max10 = (int) Math.max(0.0f, this.titleLayout.getLineLeft(i224));
                                                            if (max10 != 0) {
                                                                z63 = true;
                                                            }
                                                            int i225 = this.titleX;
                                                            if (i225 == Integer.MAX_VALUE) {
                                                                this.titleX = -max10;
                                                            } else {
                                                                try {
                                                                    this.titleX = Math.max(i225, -max10);
                                                                } catch (Exception e17) {
                                                                    e = e17;
                                                                    z14 = z63;
                                                                    FileLog.e(e);
                                                                    i21 = i17;
                                                                    z15 = z14;
                                                                    if (z15) {
                                                                        i15 -= AndroidUtilities.dp(48.0f);
                                                                    }
                                                                    z16 = z15;
                                                                    i17 = i21;
                                                                    if (str9 != null) {
                                                                    }
                                                                    z17 = false;
                                                                    if (str4 != null) {
                                                                    }
                                                                    str11 = i15;
                                                                    if (z13) {
                                                                    }
                                                                    z19 = z13;
                                                                    if (!z19) {
                                                                    }
                                                                    if (tLRPC$Document3 == null) {
                                                                    }
                                                                    if (this.currentPosition != null) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    if (this.captionLayout == null) {
                                                                    }
                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                    }
                                                                    int dp512222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                    staticLayout2 = this.captionLayout;
                                                                    if (staticLayout2 == null) {
                                                                    }
                                                                    if (this.currentMessageObject.type != i34) {
                                                                    }
                                                                    if (valueOf != null) {
                                                                    }
                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                    if (groupedMessagePosition4 != null) {
                                                                    }
                                                                    int i2002222222 = this.widthBeforeNewTimeLine;
                                                                    i54 = -1;
                                                                    messageObject4 = this.currentMessageObject;
                                                                    if (messageObject4.eventId == 0) {
                                                                    }
                                                                    f4 = 0.0f;
                                                                    if (messageObject.isSponsored()) {
                                                                    }
                                                                    this.botButtons.clear();
                                                                    if (z46) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    this.substractBackgroundHeight = 0;
                                                                    this.keyboardHeight = 0;
                                                                    r6 = hashMap;
                                                                    if (this.drawCommentButton) {
                                                                    }
                                                                    z29 = this.drawPinnedBottom;
                                                                    if (z29) {
                                                                    }
                                                                    if (!z29) {
                                                                    }
                                                                    if (messageObject10.type != 19) {
                                                                    }
                                                                    if (!this.drawPhotoImage) {
                                                                    }
                                                                    i58 = 5;
                                                                    if (this.documentAttachType == 5) {
                                                                    }
                                                                    calculateUnlockXY();
                                                                    if (z26) {
                                                                    }
                                                                    updateAnimatedEmojis();
                                                                    r62 = r6;
                                                                    if (z46) {
                                                                    }
                                                                    transcribeButton = this.transcribeButton;
                                                                    if (transcribeButton != null) {
                                                                    }
                                                                    updateWaveform();
                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                    }
                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                    if (chatMessageCellDelegate2 != null) {
                                                                    }
                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                    updateFlagSecure();
                                                                }
                                                            }
                                                            if (max10 != 0) {
                                                                i23 = i17;
                                                                z14 = z63;
                                                                width2 = this.titleLayout.getWidth() - max10;
                                                            } else {
                                                                try {
                                                                    if (i224 >= i22) {
                                                                        if (max10 == 0) {
                                                                        }
                                                                        i24 = i15;
                                                                        i23 = i17;
                                                                        z14 = z63;
                                                                        width2 = (int) Math.min(i24, Math.ceil(this.titleLayout.getLineWidth(i224)));
                                                                    }
                                                                    width2 = (int) Math.min(i24, Math.ceil(this.titleLayout.getLineWidth(i224)));
                                                                } catch (Exception e18) {
                                                                    e = e18;
                                                                    i17 = i23;
                                                                    FileLog.e(e);
                                                                    i21 = i17;
                                                                    z15 = z14;
                                                                    if (z15) {
                                                                    }
                                                                    z16 = z15;
                                                                    i17 = i21;
                                                                    if (str9 != null) {
                                                                    }
                                                                    z17 = false;
                                                                    if (str4 != null) {
                                                                    }
                                                                    str11 = i15;
                                                                    if (z13) {
                                                                    }
                                                                    z19 = z13;
                                                                    if (!z19) {
                                                                    }
                                                                    if (tLRPC$Document3 == null) {
                                                                    }
                                                                    if (this.currentPosition != null) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    if (this.captionLayout == null) {
                                                                    }
                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                    }
                                                                    int dp5122222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                    staticLayout2 = this.captionLayout;
                                                                    if (staticLayout2 == null) {
                                                                    }
                                                                    if (this.currentMessageObject.type != i34) {
                                                                    }
                                                                    if (valueOf != null) {
                                                                    }
                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                    if (groupedMessagePosition4 != null) {
                                                                    }
                                                                    int i20022222222 = this.widthBeforeNewTimeLine;
                                                                    i54 = -1;
                                                                    messageObject4 = this.currentMessageObject;
                                                                    if (messageObject4.eventId == 0) {
                                                                    }
                                                                    f4 = 0.0f;
                                                                    if (messageObject.isSponsored()) {
                                                                    }
                                                                    this.botButtons.clear();
                                                                    if (z46) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    this.substractBackgroundHeight = 0;
                                                                    this.keyboardHeight = 0;
                                                                    r6 = hashMap;
                                                                    if (this.drawCommentButton) {
                                                                    }
                                                                    z29 = this.drawPinnedBottom;
                                                                    if (z29) {
                                                                    }
                                                                    if (!z29) {
                                                                    }
                                                                    if (messageObject10.type != 19) {
                                                                    }
                                                                    if (!this.drawPhotoImage) {
                                                                    }
                                                                    i58 = 5;
                                                                    if (this.documentAttachType == 5) {
                                                                    }
                                                                    calculateUnlockXY();
                                                                    if (z26) {
                                                                    }
                                                                    updateAnimatedEmojis();
                                                                    r62 = r6;
                                                                    if (z46) {
                                                                    }
                                                                    transcribeButton = this.transcribeButton;
                                                                    if (transcribeButton != null) {
                                                                    }
                                                                    updateWaveform();
                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                    }
                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                    if (chatMessageCellDelegate2 != null) {
                                                                    }
                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                    updateFlagSecure();
                                                                }
                                                                i24 = i15 - (dp3 + dp4);
                                                                i23 = i17;
                                                                z14 = z63;
                                                            }
                                                            if (i224 >= i22) {
                                                                if (max10 != 0) {
                                                                    if (!this.isSmallImage) {
                                                                    }
                                                                }
                                                                int i226 = width2 + dp5;
                                                                i7 = Math.max(i7, i226);
                                                                i18 = Math.max(i18, i226);
                                                                i224++;
                                                                i17 = i23;
                                                                z63 = z14;
                                                            }
                                                            width2 += dp3 + dp4;
                                                            int i2262 = width2 + dp5;
                                                            i7 = Math.max(i7, i2262);
                                                            i18 = Math.max(i18, i2262);
                                                            i224++;
                                                            i17 = i23;
                                                            z63 = z14;
                                                        } catch (Exception e19) {
                                                            e = e19;
                                                        }
                                                    }
                                                    i21 = i17;
                                                    z15 = z63;
                                                } catch (Exception e20) {
                                                    e = e20;
                                                    z14 = false;
                                                    FileLog.e(e);
                                                    i21 = i17;
                                                    z15 = z14;
                                                    if (z15) {
                                                    }
                                                    z16 = z15;
                                                    i17 = i21;
                                                    if (str9 != null) {
                                                    }
                                                    z17 = false;
                                                    if (str4 != null) {
                                                    }
                                                    str11 = i15;
                                                    if (z13) {
                                                    }
                                                    z19 = z13;
                                                    if (!z19) {
                                                    }
                                                    if (tLRPC$Document3 == null) {
                                                    }
                                                    if (this.currentPosition != null) {
                                                    }
                                                    if (!messageObject10.isRestrictedMessage) {
                                                    }
                                                    if (this.captionLayout == null) {
                                                    }
                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                    }
                                                    int dp51222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                    staticLayout2 = this.captionLayout;
                                                    if (staticLayout2 == null) {
                                                    }
                                                    if (this.currentMessageObject.type != i34) {
                                                    }
                                                    if (valueOf != null) {
                                                    }
                                                    groupedMessagePosition4 = this.currentPosition;
                                                    if (groupedMessagePosition4 != null) {
                                                    }
                                                    int i200222222222 = this.widthBeforeNewTimeLine;
                                                    i54 = -1;
                                                    messageObject4 = this.currentMessageObject;
                                                    if (messageObject4.eventId == 0) {
                                                    }
                                                    f4 = 0.0f;
                                                    if (messageObject.isSponsored()) {
                                                    }
                                                    this.botButtons.clear();
                                                    if (z46) {
                                                    }
                                                    if (!messageObject10.isRestrictedMessage) {
                                                    }
                                                    this.substractBackgroundHeight = 0;
                                                    this.keyboardHeight = 0;
                                                    r6 = hashMap;
                                                    if (this.drawCommentButton) {
                                                    }
                                                    z29 = this.drawPinnedBottom;
                                                    if (z29) {
                                                    }
                                                    if (!z29) {
                                                    }
                                                    if (messageObject10.type != 19) {
                                                    }
                                                    if (!this.drawPhotoImage) {
                                                    }
                                                    i58 = 5;
                                                    if (this.documentAttachType == 5) {
                                                    }
                                                    calculateUnlockXY();
                                                    if (z26) {
                                                    }
                                                    updateAnimatedEmojis();
                                                    r62 = r6;
                                                    if (z46) {
                                                    }
                                                    transcribeButton = this.transcribeButton;
                                                    if (transcribeButton != null) {
                                                    }
                                                    updateWaveform();
                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                    }
                                                    chatMessageCellDelegate2 = this.delegate;
                                                    if (chatMessageCellDelegate2 != null) {
                                                    }
                                                    this.accessibilityVirtualViewBounds.clear();
                                                    this.transitionParams.updatePhotoImageX = true;
                                                    updateFlagSecure();
                                                }
                                                if (z15 && this.isSmallImage) {
                                                    i15 -= AndroidUtilities.dp(48.0f);
                                                }
                                                z16 = z15;
                                                i17 = i21;
                                            }
                                            if (str9 != null && str5 == null) {
                                                try {
                                                    i49 = this.linkPreviewHeight;
                                                    if (i49 == 0) {
                                                        this.linkPreviewHeight = i49 + AndroidUtilities.dp(2.0f);
                                                        this.totalHeight += AndroidUtilities.dp(2.0f);
                                                    }
                                                    try {
                                                        str15 = str9;
                                                        try {
                                                            str16 = Emoji.replaceEmoji(str15, Theme.chat_replyNamePaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
                                                        } catch (Exception unused) {
                                                            str16 = str15;
                                                            if (i17 == 3) {
                                                            }
                                                            StaticLayout generateStaticLayout3 = generateStaticLayout(str16, Theme.chat_replyNamePaint, i15, (i15 - dp3) - dp4, i17, 1);
                                                            this.authorLayout = generateStaticLayout3;
                                                            i17 -= generateStaticLayout3.getLineCount();
                                                            StaticLayout staticLayout17 = this.authorLayout;
                                                            int lineBottom3 = staticLayout17.getLineBottom(staticLayout17.getLineCount() - 1);
                                                            this.linkPreviewHeight += lineBottom3;
                                                            this.totalHeight += lineBottom3;
                                                            max4 = (int) Math.max(this.authorLayout.getLineLeft(0), 0.0f);
                                                            this.authorX = -max4;
                                                            if (max4 == 0) {
                                                            }
                                                            int i227 = width3 + dp5;
                                                            i7 = Math.max(i7, i227);
                                                            i18 = Math.max(i18, i227);
                                                            if (str4 != null) {
                                                            }
                                                            str11 = i15;
                                                            if (z13) {
                                                            }
                                                            z19 = z13;
                                                            if (!z19) {
                                                            }
                                                            if (tLRPC$Document3 == null) {
                                                            }
                                                            if (this.currentPosition != null) {
                                                            }
                                                            if (!messageObject10.isRestrictedMessage) {
                                                            }
                                                            if (this.captionLayout == null) {
                                                            }
                                                            if (!messageObject.isVoiceTranscriptionOpen()) {
                                                            }
                                                            int dp512222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                            staticLayout2 = this.captionLayout;
                                                            if (staticLayout2 == null) {
                                                            }
                                                            if (this.currentMessageObject.type != i34) {
                                                            }
                                                            if (valueOf != null) {
                                                            }
                                                            groupedMessagePosition4 = this.currentPosition;
                                                            if (groupedMessagePosition4 != null) {
                                                            }
                                                            int i2002222222222 = this.widthBeforeNewTimeLine;
                                                            i54 = -1;
                                                            messageObject4 = this.currentMessageObject;
                                                            if (messageObject4.eventId == 0) {
                                                            }
                                                            f4 = 0.0f;
                                                            if (messageObject.isSponsored()) {
                                                            }
                                                            this.botButtons.clear();
                                                            if (z46) {
                                                            }
                                                            if (!messageObject10.isRestrictedMessage) {
                                                            }
                                                            this.substractBackgroundHeight = 0;
                                                            this.keyboardHeight = 0;
                                                            r6 = hashMap;
                                                            if (this.drawCommentButton) {
                                                            }
                                                            z29 = this.drawPinnedBottom;
                                                            if (z29) {
                                                            }
                                                            if (!z29) {
                                                            }
                                                            if (messageObject10.type != 19) {
                                                            }
                                                            if (!this.drawPhotoImage) {
                                                            }
                                                            i58 = 5;
                                                            if (this.documentAttachType == 5) {
                                                            }
                                                            calculateUnlockXY();
                                                            if (z26) {
                                                            }
                                                            updateAnimatedEmojis();
                                                            r62 = r6;
                                                            if (z46) {
                                                            }
                                                            transcribeButton = this.transcribeButton;
                                                            if (transcribeButton != null) {
                                                            }
                                                            updateWaveform();
                                                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                            if (!this.currentMessageObject.loadingCancelled) {
                                                            }
                                                            chatMessageCellDelegate2 = this.delegate;
                                                            if (chatMessageCellDelegate2 != null) {
                                                            }
                                                            this.accessibilityVirtualViewBounds.clear();
                                                            this.transitionParams.updatePhotoImageX = true;
                                                            updateFlagSecure();
                                                        }
                                                    } catch (Exception unused2) {
                                                        str15 = str9;
                                                    }
                                                } catch (Exception e21) {
                                                    e = e21;
                                                    z17 = false;
                                                }
                                                try {
                                                    if (i17 == 3 || (this.isSmallImage && str4 != null)) {
                                                        StaticLayout generateStaticLayout32 = generateStaticLayout(str16, Theme.chat_replyNamePaint, i15, (i15 - dp3) - dp4, i17, 1);
                                                        this.authorLayout = generateStaticLayout32;
                                                        i17 -= generateStaticLayout32.getLineCount();
                                                        StaticLayout staticLayout172 = this.authorLayout;
                                                        int lineBottom32 = staticLayout172.getLineBottom(staticLayout172.getLineCount() - 1);
                                                        this.linkPreviewHeight += lineBottom32;
                                                        this.totalHeight += lineBottom32;
                                                        max4 = (int) Math.max(this.authorLayout.getLineLeft(0), 0.0f);
                                                        this.authorX = -max4;
                                                        if (max4 == 0) {
                                                            width3 = this.authorLayout.getWidth() - max4;
                                                            z17 = true;
                                                        } else {
                                                            width3 = (int) Math.ceil(this.authorLayout.getLineWidth(0));
                                                            z17 = false;
                                                        }
                                                        int i2272 = width3 + dp5;
                                                        i7 = Math.max(i7, i2272);
                                                        i18 = Math.max(i18, i2272);
                                                    }
                                                    i7 = Math.max(i7, i2272);
                                                    i18 = Math.max(i18, i2272);
                                                } catch (Exception e22) {
                                                    e = e22;
                                                    FileLog.e(e);
                                                    if (str4 != null) {
                                                    }
                                                    str11 = i15;
                                                    if (z13) {
                                                    }
                                                    z19 = z13;
                                                    if (!z19) {
                                                    }
                                                    if (tLRPC$Document3 == null) {
                                                    }
                                                    if (this.currentPosition != null) {
                                                    }
                                                    if (!messageObject10.isRestrictedMessage) {
                                                    }
                                                    if (this.captionLayout == null) {
                                                    }
                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                    }
                                                    int dp5122222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                    staticLayout2 = this.captionLayout;
                                                    if (staticLayout2 == null) {
                                                    }
                                                    if (this.currentMessageObject.type != i34) {
                                                    }
                                                    if (valueOf != null) {
                                                    }
                                                    groupedMessagePosition4 = this.currentPosition;
                                                    if (groupedMessagePosition4 != null) {
                                                    }
                                                    int i20022222222222 = this.widthBeforeNewTimeLine;
                                                    i54 = -1;
                                                    messageObject4 = this.currentMessageObject;
                                                    if (messageObject4.eventId == 0) {
                                                    }
                                                    f4 = 0.0f;
                                                    if (messageObject.isSponsored()) {
                                                    }
                                                    this.botButtons.clear();
                                                    if (z46) {
                                                    }
                                                    if (!messageObject10.isRestrictedMessage) {
                                                    }
                                                    this.substractBackgroundHeight = 0;
                                                    this.keyboardHeight = 0;
                                                    r6 = hashMap;
                                                    if (this.drawCommentButton) {
                                                    }
                                                    z29 = this.drawPinnedBottom;
                                                    if (z29) {
                                                    }
                                                    if (!z29) {
                                                    }
                                                    if (messageObject10.type != 19) {
                                                    }
                                                    if (!this.drawPhotoImage) {
                                                    }
                                                    i58 = 5;
                                                    if (this.documentAttachType == 5) {
                                                    }
                                                    calculateUnlockXY();
                                                    if (z26) {
                                                    }
                                                    updateAnimatedEmojis();
                                                    r62 = r6;
                                                    if (z46) {
                                                    }
                                                    transcribeButton = this.transcribeButton;
                                                    if (transcribeButton != null) {
                                                    }
                                                    updateWaveform();
                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                    }
                                                    chatMessageCellDelegate2 = this.delegate;
                                                    if (chatMessageCellDelegate2 != null) {
                                                    }
                                                    this.accessibilityVirtualViewBounds.clear();
                                                    this.transitionParams.updatePhotoImageX = true;
                                                    updateFlagSecure();
                                                }
                                                this.authorLayout = new StaticLayout(str16, Theme.chat_replyNamePaint, i15, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                StaticLayout staticLayout1722 = this.authorLayout;
                                                int lineBottom322 = staticLayout1722.getLineBottom(staticLayout1722.getLineCount() - 1);
                                                this.linkPreviewHeight += lineBottom322;
                                                this.totalHeight += lineBottom322;
                                                max4 = (int) Math.max(this.authorLayout.getLineLeft(0), 0.0f);
                                                this.authorX = -max4;
                                                if (max4 == 0) {
                                                }
                                                int i22722 = width3 + dp5;
                                            } else {
                                                z17 = false;
                                            }
                                            if (str4 != null) {
                                                try {
                                                    this.descriptionX = 0;
                                                    this.currentMessageObject.generateLinkDescription();
                                                    int i228 = this.linkPreviewHeight;
                                                    if (i228 != 0) {
                                                        this.linkPreviewHeight = i228 + AndroidUtilities.dp(2.0f);
                                                        this.totalHeight += AndroidUtilities.dp(2.0f);
                                                    }
                                                    if (str10 != null && str10.toLowerCase().equals("twitter")) {
                                                        z18 = true;
                                                        if (i17 == 3 && !this.isSmallImage) {
                                                            this.descriptionLayout = StaticLayoutEx.createStaticLayout(messageObject10.linkDescription, Theme.chat_replyTextPaint, i15, Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(1.0f), false, TextUtils.TruncateAt.END, i15, z18 ? 6 : 100);
                                                            i17 = 0;
                                                            this.animatedEmojiDescriptionStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiDescriptionStack, this.descriptionLayout);
                                                            StaticLayout staticLayout18 = this.descriptionLayout;
                                                            int lineBottom4 = staticLayout18.getLineBottom(staticLayout18.getLineCount() - 1);
                                                            this.linkPreviewHeight += lineBottom4;
                                                            this.totalHeight += lineBottom4;
                                                            i25 = 0;
                                                            boolean z64 = false;
                                                            str11 = str4;
                                                            while (i25 < this.descriptionLayout.getLineCount()) {
                                                                try {
                                                                    int i229 = i15;
                                                                    int ceil21 = (int) Math.ceil(this.descriptionLayout.getLineLeft(i25));
                                                                    if (ceil21 > 0) {
                                                                        int i230 = this.descriptionX;
                                                                        if (i230 == 0) {
                                                                            this.descriptionX = -ceil21;
                                                                        } else {
                                                                            this.descriptionX = Math.max(i230, -ceil21);
                                                                        }
                                                                        z64 = true;
                                                                    }
                                                                    i25++;
                                                                    i15 = i229;
                                                                    str11 = i229;
                                                                } catch (Exception e23) {
                                                                    e = e23;
                                                                    FileLog.e(e);
                                                                    if (z13) {
                                                                    }
                                                                    z19 = z13;
                                                                    if (!z19) {
                                                                    }
                                                                    if (tLRPC$Document3 == null) {
                                                                    }
                                                                    if (this.currentPosition != null) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    if (this.captionLayout == null) {
                                                                    }
                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                    }
                                                                    int dp51222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                    staticLayout2 = this.captionLayout;
                                                                    if (staticLayout2 == null) {
                                                                    }
                                                                    if (this.currentMessageObject.type != i34) {
                                                                    }
                                                                    if (valueOf != null) {
                                                                    }
                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                    if (groupedMessagePosition4 != null) {
                                                                    }
                                                                    int i200222222222222 = this.widthBeforeNewTimeLine;
                                                                    i54 = -1;
                                                                    messageObject4 = this.currentMessageObject;
                                                                    if (messageObject4.eventId == 0) {
                                                                    }
                                                                    f4 = 0.0f;
                                                                    if (messageObject.isSponsored()) {
                                                                    }
                                                                    this.botButtons.clear();
                                                                    if (z46) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    this.substractBackgroundHeight = 0;
                                                                    this.keyboardHeight = 0;
                                                                    r6 = hashMap;
                                                                    if (this.drawCommentButton) {
                                                                    }
                                                                    z29 = this.drawPinnedBottom;
                                                                    if (z29) {
                                                                    }
                                                                    if (!z29) {
                                                                    }
                                                                    if (messageObject10.type != 19) {
                                                                    }
                                                                    if (!this.drawPhotoImage) {
                                                                    }
                                                                    i58 = 5;
                                                                    if (this.documentAttachType == 5) {
                                                                    }
                                                                    calculateUnlockXY();
                                                                    if (z26) {
                                                                    }
                                                                    updateAnimatedEmojis();
                                                                    r62 = r6;
                                                                    if (z46) {
                                                                    }
                                                                    transcribeButton = this.transcribeButton;
                                                                    if (transcribeButton != null) {
                                                                    }
                                                                    updateWaveform();
                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                    }
                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                    if (chatMessageCellDelegate2 != null) {
                                                                    }
                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                    updateFlagSecure();
                                                                }
                                                            }
                                                            int width5 = this.descriptionLayout.getWidth();
                                                            i26 = 0;
                                                            while (i26 < this.descriptionLayout.getLineCount()) {
                                                                int ceil22 = (int) Math.ceil(this.descriptionLayout.getLineLeft(i26));
                                                                if (ceil22 == 0 && this.descriptionX != 0) {
                                                                    this.descriptionX = 0;
                                                                }
                                                                if (ceil22 > 0) {
                                                                    str11 = i15;
                                                                    i27 = width5 - ceil22;
                                                                } else if (!z64) {
                                                                    str11 = i15;
                                                                    i27 = Math.min((int) Math.ceil(this.descriptionLayout.getLineWidth(i26)), width5);
                                                                } else {
                                                                    str11 = i15;
                                                                    i27 = width5;
                                                                }
                                                                if (i26 >= i17) {
                                                                    if (i17 != 0) {
                                                                        if (ceil22 != 0) {
                                                                            if (!this.isSmallImage) {
                                                                            }
                                                                        }
                                                                    }
                                                                    i28 = i27 + dp5;
                                                                    if (i18 < i28) {
                                                                        if (z16) {
                                                                            this.titleX += i28 - i18;
                                                                        }
                                                                        if (z17) {
                                                                            this.authorX += i28 - i18;
                                                                        }
                                                                        i18 = i28;
                                                                    }
                                                                    i7 = Math.max(i7, i28);
                                                                    i26++;
                                                                    i15 = str11;
                                                                }
                                                                i27 += dp3 + dp4;
                                                                i28 = i27 + dp5;
                                                                if (i18 < i28) {
                                                                }
                                                                i7 = Math.max(i7, i28);
                                                                i26++;
                                                                i15 = str11;
                                                            }
                                                        }
                                                        this.descriptionLayout = generateStaticLayout(messageObject10.linkDescription, Theme.chat_replyTextPaint, i15, (i15 - dp3) - dp4, i17, z18 ? 6 : 100);
                                                        this.animatedEmojiDescriptionStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiDescriptionStack, this.descriptionLayout);
                                                        StaticLayout staticLayout182 = this.descriptionLayout;
                                                        int lineBottom42 = staticLayout182.getLineBottom(staticLayout182.getLineCount() - 1);
                                                        this.linkPreviewHeight += lineBottom42;
                                                        this.totalHeight += lineBottom42;
                                                        i25 = 0;
                                                        boolean z642 = false;
                                                        str11 = str4;
                                                        while (i25 < this.descriptionLayout.getLineCount()) {
                                                        }
                                                        int width52 = this.descriptionLayout.getWidth();
                                                        i26 = 0;
                                                        while (i26 < this.descriptionLayout.getLineCount()) {
                                                        }
                                                    }
                                                    z18 = false;
                                                    if (i17 == 3) {
                                                        this.descriptionLayout = StaticLayoutEx.createStaticLayout(messageObject10.linkDescription, Theme.chat_replyTextPaint, i15, Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(1.0f), false, TextUtils.TruncateAt.END, i15, z18 ? 6 : 100);
                                                        i17 = 0;
                                                        this.animatedEmojiDescriptionStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiDescriptionStack, this.descriptionLayout);
                                                        StaticLayout staticLayout1822 = this.descriptionLayout;
                                                        int lineBottom422 = staticLayout1822.getLineBottom(staticLayout1822.getLineCount() - 1);
                                                        this.linkPreviewHeight += lineBottom422;
                                                        this.totalHeight += lineBottom422;
                                                        i25 = 0;
                                                        boolean z6422 = false;
                                                        str11 = str4;
                                                        while (i25 < this.descriptionLayout.getLineCount()) {
                                                        }
                                                        int width522 = this.descriptionLayout.getWidth();
                                                        i26 = 0;
                                                        while (i26 < this.descriptionLayout.getLineCount()) {
                                                        }
                                                    }
                                                    this.descriptionLayout = generateStaticLayout(messageObject10.linkDescription, Theme.chat_replyTextPaint, i15, (i15 - dp3) - dp4, i17, z18 ? 6 : 100);
                                                    this.animatedEmojiDescriptionStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiDescriptionStack, this.descriptionLayout);
                                                    StaticLayout staticLayout18222 = this.descriptionLayout;
                                                    int lineBottom4222 = staticLayout18222.getLineBottom(staticLayout18222.getLineCount() - 1);
                                                    this.linkPreviewHeight += lineBottom4222;
                                                    this.totalHeight += lineBottom4222;
                                                    i25 = 0;
                                                    boolean z64222 = false;
                                                    str11 = str4;
                                                    while (i25 < this.descriptionLayout.getLineCount()) {
                                                    }
                                                    int width5222 = this.descriptionLayout.getWidth();
                                                    i26 = 0;
                                                    while (i26 < this.descriptionLayout.getLineCount()) {
                                                    }
                                                } catch (Exception e24) {
                                                    e = e24;
                                                    str11 = i15;
                                                }
                                            }
                                            str11 = i15;
                                            if (z13 && this.descriptionLayout == null && this.titleLayout == null) {
                                                this.isSmallImage = false;
                                                z19 = false;
                                            } else {
                                                z19 = z13;
                                            }
                                            if (!z19) {
                                                dp3 = str11;
                                            }
                                            if (tLRPC$Document3 == null) {
                                                messageObject3 = messageObject;
                                                str12 = str34;
                                                webFile3 = webFile2;
                                                if (MessageObject.isRoundVideoDocument(tLRPC$Document3)) {
                                                    i29 = i12;
                                                    i30 = extraTimeX2;
                                                    tLRPC$Photo3 = tLRPC$Photo2;
                                                    tLRPC$Document4 = tLRPC$Document3;
                                                    this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document4.thumbs, 90);
                                                    this.photoParentObject = tLRPC$Document4;
                                                    this.documentAttach = tLRPC$Document4;
                                                    this.documentAttachType = 7;
                                                } else {
                                                    tLRPC$Document4 = tLRPC$Document3;
                                                    if (MessageObject.isGifDocument(tLRPC$Document4, messageObject.hasValidGroupId())) {
                                                        i29 = i12;
                                                        i30 = extraTimeX2;
                                                        tLRPC$Photo3 = tLRPC$Photo2;
                                                        if (!messageObject.isGame() && !SharedConfig.autoplayGifs) {
                                                            f2 = 1.0f;
                                                            messageObject3.gifState = 1.0f;
                                                        } else {
                                                            f2 = 1.0f;
                                                        }
                                                        this.photoImage.setAllowStartAnimation(messageObject3.gifState != f2);
                                                        TLRPC$PhotoSize closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document4.thumbs, 90);
                                                        this.currentPhotoObject = closestPhotoSizeWithSize;
                                                        if (closestPhotoSizeWithSize != null) {
                                                            this.photoParentObject = tLRPC$Document4;
                                                        } else if (tLRPC$Photo3 != null) {
                                                            this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Photo3.sizes, 90);
                                                            this.photoParentObject = tLRPC$Photo3;
                                                        }
                                                        TLRPC$PhotoSize tLRPC$PhotoSize16 = this.currentPhotoObject;
                                                        if (tLRPC$PhotoSize16 != null && (tLRPC$PhotoSize16.w == 0 || tLRPC$PhotoSize16.h == 0)) {
                                                            for (int i231 = 0; i231 < tLRPC$Document4.attributes.size(); i231++) {
                                                                TLRPC$DocumentAttribute tLRPC$DocumentAttribute4 = tLRPC$Document4.attributes.get(i231);
                                                                if ((tLRPC$DocumentAttribute4 instanceof TLRPC$TL_documentAttributeImageSize) || (tLRPC$DocumentAttribute4 instanceof TLRPC$TL_documentAttributeVideo)) {
                                                                    TLRPC$PhotoSize tLRPC$PhotoSize17 = this.currentPhotoObject;
                                                                    tLRPC$PhotoSize17.w = tLRPC$DocumentAttribute4.w;
                                                                    tLRPC$PhotoSize17.h = tLRPC$DocumentAttribute4.h;
                                                                    break;
                                                                }
                                                            }
                                                            TLRPC$PhotoSize tLRPC$PhotoSize18 = this.currentPhotoObject;
                                                            if (tLRPC$PhotoSize18.w == 0 || tLRPC$PhotoSize18.h == 0) {
                                                                int dp58 = AndroidUtilities.dp(150.0f);
                                                                tLRPC$PhotoSize18.h = dp58;
                                                                tLRPC$PhotoSize18.w = dp58;
                                                            }
                                                        }
                                                        this.documentAttach = tLRPC$Document4;
                                                        this.documentAttachType = 2;
                                                    } else if (MessageObject.isVideoDocument(tLRPC$Document4)) {
                                                        i29 = i12;
                                                        i30 = extraTimeX2;
                                                        if (tLRPC$Photo2 == null) {
                                                            tLRPC$Photo3 = tLRPC$Photo2;
                                                        } else {
                                                            tLRPC$Photo3 = tLRPC$Photo2;
                                                            this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Photo3.sizes, AndroidUtilities.getPhotoSize(), true);
                                                            this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Photo3.sizes, 40);
                                                            this.photoParentObject = tLRPC$Photo3;
                                                        }
                                                        if (this.currentPhotoObject == null) {
                                                            this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document4.thumbs, 320);
                                                            this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document4.thumbs, 40);
                                                            this.photoParentObject = tLRPC$Document4;
                                                        }
                                                        TLRPC$PhotoSize tLRPC$PhotoSize19 = this.currentPhotoObject;
                                                        if (tLRPC$PhotoSize19 != this.currentPhotoObjectThumb) {
                                                            tLRPC$PhotoSize = null;
                                                        } else {
                                                            tLRPC$PhotoSize = null;
                                                            this.currentPhotoObjectThumb = null;
                                                        }
                                                        BitmapDrawable bitmapDrawable7 = this.currentMessageObject.strippedThumb;
                                                        if (bitmapDrawable7 != null) {
                                                            this.currentPhotoObjectThumb = tLRPC$PhotoSize;
                                                            this.currentPhotoObjectThumbStripped = bitmapDrawable7;
                                                        }
                                                        if (tLRPC$PhotoSize19 == null) {
                                                            TLRPC$TL_photoSize tLRPC$TL_photoSize = new TLRPC$TL_photoSize();
                                                            this.currentPhotoObject = tLRPC$TL_photoSize;
                                                            tLRPC$TL_photoSize.type = "s";
                                                            tLRPC$TL_photoSize.location = new TLRPC$TL_fileLocationUnavailable();
                                                        }
                                                        TLRPC$PhotoSize tLRPC$PhotoSize20 = this.currentPhotoObject;
                                                        if (tLRPC$PhotoSize20 != null && (tLRPC$PhotoSize20.w == 0 || tLRPC$PhotoSize20.h == 0 || (tLRPC$PhotoSize20 instanceof TLRPC$TL_photoStrippedSize))) {
                                                            int i232 = 0;
                                                            while (true) {
                                                                if (i232 >= tLRPC$Document4.attributes.size()) {
                                                                    break;
                                                                }
                                                                TLRPC$DocumentAttribute tLRPC$DocumentAttribute5 = tLRPC$Document4.attributes.get(i232);
                                                                if (!(tLRPC$DocumentAttribute5 instanceof TLRPC$TL_documentAttributeVideo)) {
                                                                    i232++;
                                                                } else {
                                                                    TLRPC$PhotoSize tLRPC$PhotoSize21 = this.currentPhotoObject;
                                                                    if (tLRPC$PhotoSize21 instanceof TLRPC$TL_photoStrippedSize) {
                                                                        int i233 = tLRPC$DocumentAttribute5.w;
                                                                        float max11 = Math.max(i233, i233) / 50.0f;
                                                                        TLRPC$PhotoSize tLRPC$PhotoSize22 = this.currentPhotoObject;
                                                                        tLRPC$PhotoSize22.w = (int) (tLRPC$DocumentAttribute5.w / max11);
                                                                        tLRPC$PhotoSize22.h = (int) (tLRPC$DocumentAttribute5.h / max11);
                                                                    } else {
                                                                        tLRPC$PhotoSize21.w = tLRPC$DocumentAttribute5.w;
                                                                        tLRPC$PhotoSize21.h = tLRPC$DocumentAttribute5.h;
                                                                    }
                                                                }
                                                            }
                                                            TLRPC$PhotoSize tLRPC$PhotoSize23 = this.currentPhotoObject;
                                                            if (tLRPC$PhotoSize23.w == 0 || tLRPC$PhotoSize23.h == 0) {
                                                                int dp59 = AndroidUtilities.dp(150.0f);
                                                                tLRPC$PhotoSize23.h = dp59;
                                                                tLRPC$PhotoSize23.w = dp59;
                                                            }
                                                        }
                                                        createDocumentLayout(0, messageObject3);
                                                    } else {
                                                        if (MessageObject.isStickerDocument(tLRPC$Document4) || MessageObject.isAnimatedStickerDocument(tLRPC$Document4, true)) {
                                                            i29 = i12;
                                                            i30 = extraTimeX2;
                                                            TLRPC$PhotoSize closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document4.thumbs, 90);
                                                            this.currentPhotoObject = closestPhotoSizeWithSize2;
                                                            this.photoParentObject = tLRPC$Document4;
                                                            if (closestPhotoSizeWithSize2 != null && (closestPhotoSizeWithSize2.w == 0 || closestPhotoSizeWithSize2.h == 0)) {
                                                                int i234 = 0;
                                                                while (true) {
                                                                    if (i234 >= tLRPC$Document4.attributes.size()) {
                                                                        break;
                                                                    }
                                                                    TLRPC$DocumentAttribute tLRPC$DocumentAttribute6 = tLRPC$Document4.attributes.get(i234);
                                                                    if (tLRPC$DocumentAttribute6 instanceof TLRPC$TL_documentAttributeImageSize) {
                                                                        TLRPC$PhotoSize tLRPC$PhotoSize24 = this.currentPhotoObject;
                                                                        tLRPC$PhotoSize24.w = tLRPC$DocumentAttribute6.w;
                                                                        tLRPC$PhotoSize24.h = tLRPC$DocumentAttribute6.h;
                                                                        break;
                                                                    }
                                                                    i234++;
                                                                }
                                                                TLRPC$PhotoSize tLRPC$PhotoSize25 = this.currentPhotoObject;
                                                                if (tLRPC$PhotoSize25.w == 0 || tLRPC$PhotoSize25.h == 0) {
                                                                    int dp60 = AndroidUtilities.dp(150.0f);
                                                                    tLRPC$PhotoSize25.h = dp60;
                                                                    tLRPC$PhotoSize25.w = dp60;
                                                                }
                                                            }
                                                            this.documentAttach = tLRPC$Document4;
                                                            this.documentAttachType = 6;
                                                        } else {
                                                            int i235 = this.drawInstantViewType;
                                                            if (i235 == 6) {
                                                                i29 = i12;
                                                                i30 = extraTimeX2;
                                                                TLRPC$PhotoSize closestPhotoSizeWithSize3 = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document4.thumbs, 320);
                                                                this.currentPhotoObject = closestPhotoSizeWithSize3;
                                                                this.photoParentObject = tLRPC$Document4;
                                                                if (closestPhotoSizeWithSize3 != null && (closestPhotoSizeWithSize3.w == 0 || closestPhotoSizeWithSize3.h == 0)) {
                                                                    int i236 = 0;
                                                                    while (true) {
                                                                        if (i236 >= tLRPC$Document4.attributes.size()) {
                                                                            break;
                                                                        }
                                                                        TLRPC$DocumentAttribute tLRPC$DocumentAttribute7 = tLRPC$Document4.attributes.get(i236);
                                                                        if (tLRPC$DocumentAttribute7 instanceof TLRPC$TL_documentAttributeImageSize) {
                                                                            TLRPC$PhotoSize tLRPC$PhotoSize26 = this.currentPhotoObject;
                                                                            tLRPC$PhotoSize26.w = tLRPC$DocumentAttribute7.w;
                                                                            tLRPC$PhotoSize26.h = tLRPC$DocumentAttribute7.h;
                                                                            break;
                                                                        }
                                                                        i236++;
                                                                    }
                                                                    TLRPC$PhotoSize tLRPC$PhotoSize27 = this.currentPhotoObject;
                                                                    if (tLRPC$PhotoSize27.w == 0 || tLRPC$PhotoSize27.h == 0) {
                                                                        int dp61 = AndroidUtilities.dp(150.0f);
                                                                        tLRPC$PhotoSize27.h = dp61;
                                                                        tLRPC$PhotoSize27.w = dp61;
                                                                    }
                                                                }
                                                                this.documentAttach = tLRPC$Document4;
                                                                this.documentAttachType = 8;
                                                                String formatFileSize = AndroidUtilities.formatFileSize(tLRPC$Document4.size);
                                                                this.durationWidth = (int) Math.ceil(Theme.chat_durationPaint.measureText(formatFileSize));
                                                                this.videoInfoLayout = new StaticLayout(formatFileSize, Theme.chat_durationPaint, this.durationWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                            } else if (i235 == 7) {
                                                                i29 = i12;
                                                                i30 = extraTimeX2;
                                                                this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document4.thumbs, 700);
                                                                BitmapDrawable bitmapDrawable8 = this.currentMessageObject.strippedThumb;
                                                                if (bitmapDrawable8 == null) {
                                                                    this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(tLRPC$Document4.thumbs, 40);
                                                                } else {
                                                                    this.currentPhotoObjectThumbStripped = bitmapDrawable8;
                                                                }
                                                                this.photoParentObject = tLRPC$Document4;
                                                                TLRPC$PhotoSize tLRPC$PhotoSize28 = this.currentPhotoObject;
                                                                if (tLRPC$PhotoSize28 != null && (tLRPC$PhotoSize28.w == 0 || tLRPC$PhotoSize28.h == 0)) {
                                                                    int i237 = 0;
                                                                    while (true) {
                                                                        if (i237 >= tLRPC$Document4.attributes.size()) {
                                                                            break;
                                                                        }
                                                                        TLRPC$DocumentAttribute tLRPC$DocumentAttribute8 = tLRPC$Document4.attributes.get(i237);
                                                                        if (tLRPC$DocumentAttribute8 instanceof TLRPC$TL_documentAttributeImageSize) {
                                                                            TLRPC$PhotoSize tLRPC$PhotoSize29 = this.currentPhotoObject;
                                                                            tLRPC$PhotoSize29.w = tLRPC$DocumentAttribute8.w;
                                                                            tLRPC$PhotoSize29.h = tLRPC$DocumentAttribute8.h;
                                                                            break;
                                                                        }
                                                                        i237++;
                                                                    }
                                                                    TLRPC$PhotoSize tLRPC$PhotoSize30 = this.currentPhotoObject;
                                                                    if (tLRPC$PhotoSize30.w == 0 || tLRPC$PhotoSize30.h == 0) {
                                                                        int dp62 = AndroidUtilities.dp(150.0f);
                                                                        tLRPC$PhotoSize30.h = dp62;
                                                                        tLRPC$PhotoSize30.w = dp62;
                                                                    }
                                                                }
                                                                this.documentAttach = tLRPC$Document4;
                                                                this.documentAttachType = 9;
                                                            } else {
                                                                i29 = i12;
                                                                i30 = extraTimeX2;
                                                                calcBackgroundWidth(i29, i30, i7);
                                                                if (this.backgroundWidth < AndroidUtilities.dp(20.0f) + i29) {
                                                                    this.backgroundWidth = AndroidUtilities.dp(20.0f) + i29;
                                                                }
                                                                if (MessageObject.isVoiceDocument(tLRPC$Document4)) {
                                                                    createDocumentLayout(this.backgroundWidth - AndroidUtilities.dp(10.0f), messageObject3);
                                                                    this.mediaOffsetY = this.currentMessageObject.textHeight + AndroidUtilities.dp(8.0f) + this.linkPreviewHeight;
                                                                    this.totalHeight += AndroidUtilities.dp(44.0f);
                                                                    this.linkPreviewHeight += AndroidUtilities.dp(44.0f);
                                                                    dp6 = i29 - AndroidUtilities.dp(86.0f);
                                                                    i7 = !AndroidUtilities.isTablet() ? Math.max(i7, (Math.min(getParentWidth() - AndroidUtilities.dp(!z8 ? 0.0f : 52.0f), AndroidUtilities.dp(220.0f)) - AndroidUtilities.dp(30.0f)) + dp5) : Math.max(i7, (Math.min(AndroidUtilities.getMinTabletSide() - AndroidUtilities.dp(!z8 ? 0.0f : 52.0f), AndroidUtilities.dp(220.0f)) - AndroidUtilities.dp(30.0f)) + dp5);
                                                                    calcBackgroundWidth(dp6, i30, i7);
                                                                } else if (MessageObject.isMusicDocument(tLRPC$Document4)) {
                                                                    int createDocumentLayout = createDocumentLayout(this.backgroundWidth - AndroidUtilities.dp(10.0f), messageObject3);
                                                                    this.mediaOffsetY = this.currentMessageObject.textHeight + AndroidUtilities.dp(8.0f) + this.linkPreviewHeight;
                                                                    this.totalHeight += AndroidUtilities.dp(56.0f);
                                                                    this.linkPreviewHeight += AndroidUtilities.dp(56.0f);
                                                                    dp6 = i29 - AndroidUtilities.dp(86.0f);
                                                                    int max12 = Math.max(i7, createDocumentLayout + dp5 + AndroidUtilities.dp(94.0f));
                                                                    StaticLayout staticLayout19 = this.songLayout;
                                                                    if (staticLayout19 != null && staticLayout19.getLineCount() > 0) {
                                                                        max12 = (int) Math.max(max12, this.songLayout.getLineWidth(0) + dp5 + AndroidUtilities.dp(86.0f));
                                                                    }
                                                                    StaticLayout staticLayout20 = this.performerLayout;
                                                                    if (staticLayout20 != null && staticLayout20.getLineCount() > 0) {
                                                                        max12 = (int) Math.max(max12, this.performerLayout.getLineWidth(0) + dp5 + AndroidUtilities.dp(86.0f));
                                                                    }
                                                                    i7 = max12;
                                                                    calcBackgroundWidth(dp6, i30, i7);
                                                                } else {
                                                                    createDocumentLayout(this.backgroundWidth - AndroidUtilities.dp(168.0f), messageObject3);
                                                                    this.drawImageButton = true;
                                                                    if (this.drawPhotoImage) {
                                                                        this.totalHeight += AndroidUtilities.dp(100.0f);
                                                                        this.linkPreviewHeight += AndroidUtilities.dp(86.0f);
                                                                        this.photoImage.setImageCoords(0.0f, this.totalHeight + this.namesOffset, AndroidUtilities.dp(86.0f), AndroidUtilities.dp(86.0f));
                                                                    } else {
                                                                        this.mediaOffsetY = this.currentMessageObject.textHeight + AndroidUtilities.dp(8.0f) + this.linkPreviewHeight;
                                                                        this.photoImage.setImageCoords(0.0f, (this.totalHeight + this.namesOffset) - AndroidUtilities.dp(14.0f), AndroidUtilities.dp(56.0f), AndroidUtilities.dp(56.0f));
                                                                        this.totalHeight += AndroidUtilities.dp(64.0f);
                                                                        this.linkPreviewHeight += AndroidUtilities.dp(50.0f);
                                                                        StaticLayout staticLayout21 = this.docTitleLayout;
                                                                        if (staticLayout21 != null && staticLayout21.getLineCount() > 1) {
                                                                            int lineCount7 = (this.docTitleLayout.getLineCount() - 1) * AndroidUtilities.dp(16.0f);
                                                                            this.totalHeight += lineCount7;
                                                                            this.linkPreviewHeight += lineCount7;
                                                                        }
                                                                    }
                                                                }
                                                                i31 = dp6;
                                                                tLRPC$Photo3 = tLRPC$Photo2;
                                                                i32 = this.documentAttachType;
                                                                if (i32 == 5) {
                                                                }
                                                                messageObject10 = messageObject3;
                                                                i33 = 3;
                                                                i34 = 2;
                                                                f3 = 1.0f;
                                                                z20 = true;
                                                                createInstantViewButton();
                                                            }
                                                        }
                                                        tLRPC$Photo3 = tLRPC$Photo2;
                                                    }
                                                }
                                                i31 = i29;
                                                i32 = this.documentAttachType;
                                                if (i32 == 5) {
                                                }
                                                messageObject10 = messageObject3;
                                                i33 = 3;
                                                i34 = 2;
                                                f3 = 1.0f;
                                                z20 = true;
                                                createInstantViewButton();
                                            } else {
                                                if (tLRPC$Photo2 != null) {
                                                    webFile3 = webFile2;
                                                    if (str34 == null) {
                                                        str12 = str34;
                                                    } else {
                                                        str12 = str34;
                                                        if (str12.equals("photo")) {
                                                            messageObject3 = messageObject;
                                                            z24 = true;
                                                            this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(messageObject3.photoThumbs, (!z24 && z19) ? dp3 : AndroidUtilities.getPhotoSize(), !z24);
                                                            this.photoParentObject = messageObject3.photoThumbsObject;
                                                            this.checkOnlyButtonPressed = !z24;
                                                            bitmapDrawable = this.currentMessageObject.strippedThumb;
                                                            if (bitmapDrawable == null) {
                                                                this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject3.photoThumbs, 40);
                                                            } else {
                                                                this.currentPhotoObjectThumbStripped = bitmapDrawable;
                                                            }
                                                            if (this.currentPhotoObjectThumb == this.currentPhotoObject) {
                                                                this.currentPhotoObjectThumb = null;
                                                            }
                                                            i29 = i12;
                                                            i30 = extraTimeX2;
                                                        }
                                                    }
                                                    messageObject3 = messageObject;
                                                    z24 = false;
                                                    if (!z24) {
                                                        this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(messageObject3.photoThumbs, (!z24 && z19) ? dp3 : AndroidUtilities.getPhotoSize(), !z24);
                                                        this.photoParentObject = messageObject3.photoThumbsObject;
                                                        this.checkOnlyButtonPressed = !z24;
                                                        bitmapDrawable = this.currentMessageObject.strippedThumb;
                                                        if (bitmapDrawable == null) {
                                                        }
                                                        if (this.currentPhotoObjectThumb == this.currentPhotoObject) {
                                                        }
                                                        i29 = i12;
                                                        i30 = extraTimeX2;
                                                    }
                                                    this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(messageObject3.photoThumbs, (!z24 && z19) ? dp3 : AndroidUtilities.getPhotoSize(), !z24);
                                                    this.photoParentObject = messageObject3.photoThumbsObject;
                                                    this.checkOnlyButtonPressed = !z24;
                                                    bitmapDrawable = this.currentMessageObject.strippedThumb;
                                                    if (bitmapDrawable == null) {
                                                    }
                                                    if (this.currentPhotoObjectThumb == this.currentPhotoObject) {
                                                    }
                                                    i29 = i12;
                                                    i30 = extraTimeX2;
                                                } else if (webFile2 == null) {
                                                    messageObject3 = messageObject;
                                                    str12 = str34;
                                                    i29 = i12;
                                                    i30 = extraTimeX2;
                                                    webFile3 = webFile2;
                                                } else {
                                                    WebFile webFile6 = webFile2;
                                                    if (webFile6.mime_type.startsWith("image/")) {
                                                        webFile4 = webFile6;
                                                        z25 = false;
                                                    } else {
                                                        z25 = false;
                                                        webFile4 = null;
                                                    }
                                                    this.drawImageButton = z25;
                                                    webFile3 = webFile4;
                                                    str12 = str34;
                                                    i31 = i12;
                                                    i30 = extraTimeX2;
                                                    tLRPC$Photo3 = tLRPC$Photo2;
                                                    tLRPC$Document4 = tLRPC$Document3;
                                                    messageObject3 = messageObject;
                                                    i32 = this.documentAttachType;
                                                    if (i32 == 5 || i32 == 3 || i32 == 1) {
                                                        messageObject10 = messageObject3;
                                                        i33 = 3;
                                                        i34 = 2;
                                                        f3 = 1.0f;
                                                        z20 = true;
                                                    } else {
                                                        if (this.currentPhotoObject != null || webFile3 != null || i32 == 8 || i32 == 9) {
                                                            this.drawImageButton = (tLRPC$Photo3 != null && !z19) || (str12 != null && (str12.equals("photo") || ((str12.equals("document") && this.documentAttachType != 6) || str12.equals("gif") || (i35 = this.documentAttachType) == 4 || i35 == 8)));
                                                            i36 = this.linkPreviewHeight;
                                                            if (i36 != 0) {
                                                                this.linkPreviewHeight = i36 + AndroidUtilities.dp(2.0f);
                                                                this.totalHeight += AndroidUtilities.dp(2.0f);
                                                            }
                                                            if (this.imageBackgroundSideColor != 0) {
                                                                dp3 = AndroidUtilities.dp(208.0f);
                                                            } else {
                                                                TLRPC$PhotoSize tLRPC$PhotoSize31 = this.currentPhotoObject;
                                                                if ((tLRPC$PhotoSize31 instanceof TLRPC$TL_photoSizeEmpty) && (i47 = tLRPC$PhotoSize31.w) != 0) {
                                                                    dp3 = i47;
                                                                } else {
                                                                    int i238 = this.documentAttachType;
                                                                    if (i238 == 6 || i238 == 8 || i238 == 9) {
                                                                        if (AndroidUtilities.isTablet()) {
                                                                            minTabletSide3 = AndroidUtilities.getMinTabletSide();
                                                                        } else {
                                                                            minTabletSide3 = getParentWidth();
                                                                        }
                                                                        dp3 = (int) (minTabletSide3 * 0.5f);
                                                                    } else if (i238 == 7) {
                                                                        dp3 = AndroidUtilities.roundMessageSize;
                                                                        this.photoImage.setAllowDecodeSingleFrame(true);
                                                                    }
                                                                }
                                                            }
                                                            if (this.hasInvoicePreview && dp3 < (i46 = messageObject3.textWidth)) {
                                                                dp3 = i46 + AndroidUtilities.dp(22.0f);
                                                            }
                                                            max2 = Math.max(i7, (dp3 - (!this.hasInvoicePreview ? 0 : AndroidUtilities.dp(12.0f))) + dp5);
                                                            tLRPC$PhotoSize2 = this.currentPhotoObject;
                                                            if (tLRPC$PhotoSize2 != null) {
                                                                tLRPC$PhotoSize2.size = -1;
                                                                TLRPC$PhotoSize tLRPC$PhotoSize32 = this.currentPhotoObjectThumb;
                                                                if (tLRPC$PhotoSize32 != null) {
                                                                    tLRPC$PhotoSize32.size = -1;
                                                                }
                                                            } else if (webFile3 != null) {
                                                                webFile3.size = -1;
                                                            }
                                                            if (this.imageBackgroundSideColor != 0) {
                                                                this.imageBackgroundSideWidth = max2 - AndroidUtilities.dp(13.0f);
                                                            }
                                                            if (z19 || this.documentAttachType == 7) {
                                                                i37 = dp3;
                                                            } else if (this.hasGamePreview || this.hasInvoicePreview) {
                                                                if (this.hasInvoicePreview) {
                                                                    int size12 = webFile3.attributes.size();
                                                                    for (int i239 = 0; i239 < size12; i239++) {
                                                                        TLRPC$DocumentAttribute tLRPC$DocumentAttribute9 = webFile3.attributes.get(i239);
                                                                        if (tLRPC$DocumentAttribute9 instanceof TLRPC$TL_documentAttributeImageSize) {
                                                                            int i240 = tLRPC$DocumentAttribute9.w;
                                                                            i39 = tLRPC$DocumentAttribute9.h;
                                                                            i40 = i240;
                                                                            break;
                                                                        }
                                                                    }
                                                                }
                                                                i40 = 640;
                                                                i39 = 360;
                                                                float f35 = i40;
                                                                float dp63 = f35 / (dp3 - AndroidUtilities.dp(2.0f));
                                                                dp3 = (int) (i39 / dp63);
                                                                i37 = (int) (f35 / dp63);
                                                            } else {
                                                                if (this.drawInstantViewType == 7) {
                                                                    TLRPC$PhotoSize tLRPC$PhotoSize33 = this.currentPhotoObject;
                                                                    if (tLRPC$PhotoSize33 == null) {
                                                                        i41 = 30;
                                                                        i42 = 50;
                                                                    } else {
                                                                        int i241 = tLRPC$PhotoSize33.w;
                                                                        i42 = tLRPC$PhotoSize33.h;
                                                                        i41 = i241;
                                                                    }
                                                                } else {
                                                                    i41 = 560;
                                                                    i42 = 678;
                                                                }
                                                                float f36 = i41;
                                                                float dp64 = f36 / (dp3 - AndroidUtilities.dp(2.0f));
                                                                i37 = (int) (f36 / dp64);
                                                                i43 = (int) (i42 / dp64);
                                                                if (str10 == null || (!str10.toLowerCase().equals("instagram") && this.documentAttachType == 0)) {
                                                                    i44 = AndroidUtilities.displaySize.y;
                                                                    if (i43 > i44 / 3) {
                                                                        i43 = i44 / 3;
                                                                        if (this.imageBackgroundSideColor != 0) {
                                                                            float f37 = i43;
                                                                            float dp65 = f37 / AndroidUtilities.dp(160.0f);
                                                                            i37 = (int) (i37 / dp65);
                                                                            i43 = (int) (f37 / dp65);
                                                                        }
                                                                        dp3 = i43;
                                                                        if (dp3 < AndroidUtilities.dp(60.0f)) {
                                                                            dp3 = AndroidUtilities.dp(60.0f);
                                                                        }
                                                                    }
                                                                } else {
                                                                    i45 = AndroidUtilities.displaySize.y;
                                                                    if (i43 > i45 / 2) {
                                                                        i43 = i45 / 2;
                                                                    }
                                                                }
                                                                if (this.imageBackgroundSideColor != 0) {
                                                                }
                                                                dp3 = i43;
                                                                if (dp3 < AndroidUtilities.dp(60.0f)) {
                                                                }
                                                            }
                                                            if (!this.isSmallImage) {
                                                                if (AndroidUtilities.dp(50.0f) > this.linkPreviewHeight) {
                                                                    this.totalHeight += (AndroidUtilities.dp(50.0f) - this.linkPreviewHeight) + AndroidUtilities.dp(8.0f);
                                                                    this.linkPreviewHeight = AndroidUtilities.dp(50.0f);
                                                                }
                                                                this.linkPreviewHeight -= AndroidUtilities.dp(8.0f);
                                                            } else {
                                                                this.totalHeight += AndroidUtilities.dp(12.0f) + dp3;
                                                                this.linkPreviewHeight += dp3;
                                                            }
                                                            if (this.documentAttachType == 8 && this.imageBackgroundSideColor == 0) {
                                                                this.photoImage.setImageCoords(0.0f, 0.0f, Math.max(max2 - AndroidUtilities.dp(13.0f), i37), dp3);
                                                            } else {
                                                                this.photoImage.setImageCoords(0.0f, 0.0f, i37, dp3);
                                                            }
                                                            float f38 = AndroidUtilities.density;
                                                            int i242 = (int) (i37 / f38);
                                                            int i243 = (int) (dp3 / f38);
                                                            Locale locale = Locale.US;
                                                            this.currentPhotoFilter = String.format(locale, "%d_%d", Integer.valueOf(i242), Integer.valueOf(i243));
                                                            this.currentPhotoFilterThumb = String.format(locale, "%d_%d_b", Integer.valueOf(i242), Integer.valueOf(i243));
                                                            if (webFile3 != null) {
                                                                str13 = str12;
                                                                i38 = i30;
                                                                i33 = 3;
                                                                f3 = 1.0f;
                                                                messageObject10 = messageObject3;
                                                                i34 = 2;
                                                                this.photoImage.setImage(ImageLocation.getForWebFile(webFile3), this.currentPhotoFilter, null, null, webFile3.size, null, messageObject, 1);
                                                            } else {
                                                                int i244 = this.documentAttachType;
                                                                if (i244 == 8) {
                                                                    str13 = str12;
                                                                    i38 = i30;
                                                                    i33 = 3;
                                                                    f3 = 1.0f;
                                                                    messageObject10 = messageObject3;
                                                                    i34 = 2;
                                                                    if (messageObject10.mediaExists) {
                                                                        this.photoImage.setImage(ImageLocation.getForDocument(this.documentAttach), this.currentPhotoFilter, ImageLocation.getForDocument(this.currentPhotoObject, tLRPC$Document4), "b1", 0L, "jpg", messageObject, 1);
                                                                    } else {
                                                                        this.photoImage.setImage(null, null, ImageLocation.getForDocument(this.currentPhotoObject, tLRPC$Document4), "b1", 0L, "jpg", messageObject, 1);
                                                                    }
                                                                } else if (i244 == 9) {
                                                                    str13 = str12;
                                                                    i38 = i30;
                                                                    i33 = 3;
                                                                    f3 = 1.0f;
                                                                    messageObject10 = messageObject3;
                                                                    i34 = 2;
                                                                    if (tLRPC$Document4 instanceof DocumentObject.ThemeDocument) {
                                                                        this.photoImage.setImage(ImageLocation.getForDocument(tLRPC$Document4), this.currentPhotoFilter, null, "b1", 0L, "jpg", messageObject, 1);
                                                                    } else {
                                                                        this.photoImage.setImage(ImageLocation.getForDocument(this.currentPhotoObject, tLRPC$Document4), this.currentPhotoFilter, ImageLocation.getForDocument(this.currentPhotoObjectThumb, tLRPC$Document4), "b1", this.currentPhotoObjectThumbStripped, 0L, "jpg", messageObject, 1);
                                                                    }
                                                                } else if (i244 != 6) {
                                                                    if (i244 == 4) {
                                                                        str13 = str12;
                                                                        i38 = i30;
                                                                        f3 = 1.0f;
                                                                        messageObject10 = messageObject3;
                                                                        this.photoImage.setNeedsQualityThumb(true);
                                                                        this.photoImage.setShouldGenerateQualityThumb(true);
                                                                        if (SharedConfig.autoplayVideo && (this.currentMessageObject.mediaExists || (messageObject.canStreamVideo() && DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject)))) {
                                                                            this.photoImage.setAllowDecodeSingleFrame(true);
                                                                            this.photoImage.setAllowStartAnimation(true);
                                                                            this.photoImage.startAnimation();
                                                                            this.photoImage.setImage(ImageLocation.getForDocument(this.documentAttach), ImageLoader.AUTOPLAY_FILTER, ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForDocument(this.currentPhotoObjectThumb, this.documentAttach), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.documentAttach.size, null, messageObject, 0);
                                                                            this.autoPlayingMedia = true;
                                                                        } else if (this.currentPhotoObjectThumb != null || this.currentPhotoObjectThumbStripped != null) {
                                                                            this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 0);
                                                                        } else {
                                                                            ImageReceiver imageReceiver9 = this.photoImage;
                                                                            ImageLocation forObject6 = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                                                                            TLRPC$PhotoSize tLRPC$PhotoSize34 = this.currentPhotoObject;
                                                                            imageReceiver9.setImage(null, null, forObject6, (!(tLRPC$PhotoSize34 instanceof TLRPC$TL_photoStrippedSize) && !"s".equals(tLRPC$PhotoSize34.type)) ? this.currentPhotoFilter : this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 0);
                                                                        }
                                                                        i33 = 3;
                                                                    } else if (i244 == 2 || i244 == 7) {
                                                                        i38 = i30;
                                                                        f3 = 1.0f;
                                                                        this.photoImage.setAllowDecodeSingleFrame(true);
                                                                        if (MessageObject.isRoundVideoDocument(tLRPC$Document4)) {
                                                                            this.photoImage.setRoundRadius(AndroidUtilities.roundMessageSize / 2);
                                                                            canDownloadMedia = DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject);
                                                                            z20 = false;
                                                                        } else {
                                                                            canDownloadMedia = !MessageObject.isGifDocument(tLRPC$Document4, messageObject.hasValidGroupId()) ? false : DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject);
                                                                            z20 = true;
                                                                        }
                                                                        TLRPC$PhotoSize tLRPC$PhotoSize35 = this.currentPhotoObject;
                                                                        String str35 = (!(tLRPC$PhotoSize35 instanceof TLRPC$TL_photoStrippedSize) && !"s".equals(tLRPC$PhotoSize35.type)) ? this.currentPhotoFilter : this.currentPhotoFilterThumb;
                                                                        if (messageObject3.mediaExists || canDownloadMedia) {
                                                                            this.autoPlayingMedia = true;
                                                                            TLRPC$VideoSize documentVideoThumb2 = MessageObject.getDocumentVideoThumb(tLRPC$Document4);
                                                                            if (!messageObject3.mediaExists && documentVideoThumb2 != null && (this.currentPhotoObject == null || this.currentPhotoObjectThumb == null)) {
                                                                                str13 = str12;
                                                                                messageObject10 = messageObject3;
                                                                                ImageReceiver imageReceiver10 = this.photoImage;
                                                                                ImageLocation forDocument5 = ImageLocation.getForDocument(tLRPC$Document4);
                                                                                String str36 = tLRPC$Document4.size >= 32768 ? ImageLoader.AUTOPLAY_FILTER : null;
                                                                                ImageLocation forDocument6 = ImageLocation.getForDocument(documentVideoThumb2, this.documentAttach);
                                                                                TLRPC$PhotoSize tLRPC$PhotoSize36 = this.currentPhotoObject;
                                                                                if (tLRPC$PhotoSize36 == null) {
                                                                                    tLRPC$PhotoSize36 = this.currentPhotoObjectThumb;
                                                                                }
                                                                                ImageLocation forDocument7 = ImageLocation.getForDocument(tLRPC$PhotoSize36, this.documentAttach);
                                                                                if (this.currentPhotoObject == null) {
                                                                                    str35 = this.currentPhotoFilterThumb;
                                                                                }
                                                                                imageReceiver10.setImage(forDocument5, str36, forDocument6, null, forDocument7, str35, this.currentPhotoObjectThumbStripped, tLRPC$Document4.size, null, messageObject, 0);
                                                                            } else {
                                                                                str13 = str12;
                                                                                messageObject10 = messageObject3;
                                                                                this.photoImage.setImage(ImageLocation.getForDocument(tLRPC$Document4), tLRPC$Document4.size >= 32768 ? ImageLoader.AUTOPLAY_FILTER : null, ImageLocation.getForDocument(this.currentPhotoObject, this.documentAttach), str35, ImageLocation.getForDocument(this.currentPhotoObjectThumb, this.documentAttach), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, tLRPC$Document4.size, null, messageObject, 0);
                                                                            }
                                                                        } else {
                                                                            this.photoImage.setImage(null, null, ImageLocation.getForDocument(this.currentPhotoObject, this.documentAttach), str35, 0L, null, this.currentMessageObject, 0);
                                                                            str13 = str12;
                                                                            messageObject10 = messageObject3;
                                                                        }
                                                                        z21 = true;
                                                                        i33 = 3;
                                                                        i34 = 2;
                                                                        this.drawPhotoImage = z21;
                                                                        if (str13 != null && str13.equals(MediaStreamTrack.VIDEO_TRACK_KIND) && i11 != 0) {
                                                                            String formatShortDuration = AndroidUtilities.formatShortDuration(i11);
                                                                            this.durationWidth = (int) Math.ceil(Theme.chat_durationPaint.measureText(formatShortDuration));
                                                                            this.videoInfoLayout = new StaticLayout(formatShortDuration, Theme.chat_durationPaint, this.durationWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                                        } else if (this.hasGamePreview) {
                                                                            try {
                                                                                TLRPC$Message tLRPC$Message6 = messageObject10.messageOwner;
                                                                                j = tLRPC$Message6.via_bot_id;
                                                                                if (j == 0) {
                                                                                    j = tLRPC$Message6.from_id.user_id;
                                                                                }
                                                                            } catch (Exception unused3) {
                                                                            }
                                                                            if (j != 0 && (user = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(j))) != null && (str14 = user.username) != null) {
                                                                                if (str14.equals("donate")) {
                                                                                    z22 = false;
                                                                                    if (z22) {
                                                                                        String upperCase2 = LocaleController.getString("AttachGame", R.string.AttachGame).toUpperCase();
                                                                                        this.durationWidth = (int) Math.ceil(Theme.chat_gamePaint.measureText(upperCase2));
                                                                                        this.videoInfoLayout = new StaticLayout(upperCase2, Theme.chat_gamePaint, this.durationWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                                                    }
                                                                                }
                                                                            }
                                                                            z22 = true;
                                                                            if (z22) {
                                                                            }
                                                                        }
                                                                        i7 = max2;
                                                                    } else {
                                                                        boolean z65 = messageObject3.mediaExists;
                                                                        String attachFileName3 = FileLoader.getAttachFileName(this.currentPhotoObject);
                                                                        if (this.hasGamePreview || z65 || DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject)) {
                                                                            i38 = i30;
                                                                            z23 = false;
                                                                            f3 = 1.0f;
                                                                        } else if (!FileLoader.getInstance(this.currentAccount).isLoadingFile(attachFileName3)) {
                                                                            this.photoNotSet = true;
                                                                            TLRPC$PhotoSize tLRPC$PhotoSize37 = this.currentPhotoObjectThumb;
                                                                            if (tLRPC$PhotoSize37 != null || this.currentPhotoObjectThumbStripped != null) {
                                                                                f3 = 1.0f;
                                                                                i38 = i30;
                                                                                this.photoImage.setImage(null, null, ImageLocation.getForObject(tLRPC$PhotoSize37, this.photoParentObject), String.format(locale, "%d_%d_b", Integer.valueOf(i242), Integer.valueOf(i243)), this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 0);
                                                                                str13 = str12;
                                                                                messageObject10 = messageObject3;
                                                                                i33 = 3;
                                                                                i34 = 2;
                                                                            } else {
                                                                                this.photoImage.setImageBitmap((Drawable) null);
                                                                                str13 = str12;
                                                                                i38 = i30;
                                                                                i33 = 3;
                                                                                f3 = 1.0f;
                                                                                messageObject10 = messageObject3;
                                                                            }
                                                                        } else {
                                                                            i38 = i30;
                                                                            f3 = 1.0f;
                                                                            z23 = false;
                                                                        }
                                                                        this.photoNotSet = z23;
                                                                        this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 0);
                                                                        str13 = str12;
                                                                        messageObject10 = messageObject3;
                                                                        i33 = 3;
                                                                        i34 = 2;
                                                                    }
                                                                    i34 = 2;
                                                                } else {
                                                                    str13 = str12;
                                                                    i38 = i30;
                                                                    f3 = 1.0f;
                                                                    messageObject10 = messageObject3;
                                                                    boolean isSticker = messageObject.isSticker();
                                                                    if (!SharedConfig.loopStickers && messageObject.isVideoSticker()) {
                                                                        this.photoImage.animatedFileDrawableRepeatMaxCount = 1;
                                                                    }
                                                                    if (SharedConfig.loopStickers || (isSticker && !messageObject.isVideoSticker())) {
                                                                        i33 = 3;
                                                                        i34 = 2;
                                                                        this.photoImage.setAutoRepeat(1);
                                                                    } else {
                                                                        i33 = 3;
                                                                        i34 = 2;
                                                                        this.currentPhotoFilter = String.format(locale, "%d_%d_nr_messageId=%d", Integer.valueOf(i242), Integer.valueOf(i243), Integer.valueOf(messageObject10.stableId));
                                                                        ImageReceiver imageReceiver11 = this.photoImage;
                                                                        ChatMessageCellDelegate chatMessageCellDelegate4 = this.delegate;
                                                                        imageReceiver11.setAutoRepeat((chatMessageCellDelegate4 != null && chatMessageCellDelegate4.shouldRepeatSticker(messageObject10)) ? 2 : 3);
                                                                    }
                                                                    this.photoImage.setImage(ImageLocation.getForDocument(this.documentAttach), this.currentPhotoFilter, ImageLocation.getForDocument(this.currentPhotoObject, this.documentAttach), "b1", this.documentAttach.size, "webp", messageObject, 1);
                                                                }
                                                            }
                                                            z21 = true;
                                                            z20 = true;
                                                            this.drawPhotoImage = z21;
                                                            if (str13 != null) {
                                                                String formatShortDuration2 = AndroidUtilities.formatShortDuration(i11);
                                                                this.durationWidth = (int) Math.ceil(Theme.chat_durationPaint.measureText(formatShortDuration2));
                                                                this.videoInfoLayout = new StaticLayout(formatShortDuration2, Theme.chat_durationPaint, this.durationWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                                i7 = max2;
                                                            }
                                                            if (this.hasGamePreview) {
                                                            }
                                                            i7 = max2;
                                                        } else {
                                                            this.photoImage.setImageBitmap((Drawable) null);
                                                            this.linkPreviewHeight -= AndroidUtilities.dp(6.0f);
                                                            this.totalHeight += AndroidUtilities.dp(4.0f);
                                                            i38 = i30;
                                                            i33 = 3;
                                                            f3 = 1.0f;
                                                            z20 = true;
                                                            messageObject10 = messageObject3;
                                                            i34 = 2;
                                                        }
                                                        if (this.hasInvoicePreview) {
                                                            if ((MessageObject.getMedia(messageObject10.messageOwner).flags & 4) != 0) {
                                                                upperCase = LocaleController.getString("PaymentReceipt", R.string.PaymentReceipt).toUpperCase();
                                                            } else if (MessageObject.getMedia(messageObject10.messageOwner).test) {
                                                                upperCase = LocaleController.getString("PaymentTestInvoice", R.string.PaymentTestInvoice).toUpperCase();
                                                            } else {
                                                                upperCase = LocaleController.getString("PaymentInvoice", R.string.PaymentInvoice).toUpperCase();
                                                            }
                                                            String formatCurrencyString = LocaleController.getInstance().formatCurrencyString(MessageObject.getMedia(messageObject10.messageOwner).total_amount, MessageObject.getMedia(messageObject10.messageOwner).currency);
                                                            SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder(formatCurrencyString + " " + ((Object) upperCase));
                                                            spannableStringBuilder.setSpan(new TypefaceSpan(AndroidUtilities.getTypeface(AndroidUtilities.TYPEFACE_ROBOTO_MEDIUM)), 0, formatCurrencyString.length(), 33);
                                                            this.durationWidth = (int) Math.ceil((double) Theme.chat_shipmentPaint.measureText(spannableStringBuilder, 0, spannableStringBuilder.length()));
                                                            this.videoInfoLayout = new StaticLayout(spannableStringBuilder, Theme.chat_shipmentPaint, this.durationWidth + AndroidUtilities.dp(10.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                            if (!this.drawPhotoImage) {
                                                                this.totalHeight += AndroidUtilities.dp(6.0f);
                                                                int dp66 = this.timeWidth + AndroidUtilities.dp(14 + (!messageObject.isOutOwner() ? 0 : 20));
                                                                int i245 = this.durationWidth;
                                                                if (i245 + dp66 > i31) {
                                                                    max3 = Math.max(i245, i7);
                                                                    this.totalHeight += AndroidUtilities.dp(12.0f);
                                                                } else {
                                                                    max3 = Math.max(i245 + dp66, i7);
                                                                }
                                                                i7 = max3;
                                                            }
                                                        }
                                                        if (this.hasGamePreview && (i48 = messageObject10.textHeight) != 0) {
                                                            this.linkPreviewHeight += i48 + AndroidUtilities.dp(6.0f);
                                                            this.totalHeight += AndroidUtilities.dp(4.0f);
                                                        }
                                                        calcBackgroundWidth(i31, i38, i7);
                                                    }
                                                    createInstantViewButton();
                                                }
                                                tLRPC$Photo3 = tLRPC$Photo2;
                                                tLRPC$Document4 = tLRPC$Document3;
                                                i31 = i29;
                                                i32 = this.documentAttachType;
                                                if (i32 == 5) {
                                                    if (this.currentPhotoObject != null) {
                                                        this.photoImage.setImageBitmap((Drawable) null);
                                                        this.linkPreviewHeight -= AndroidUtilities.dp(6.0f);
                                                        this.totalHeight += AndroidUtilities.dp(4.0f);
                                                        i38 = i30;
                                                        i33 = 3;
                                                        f3 = 1.0f;
                                                        z20 = true;
                                                        messageObject10 = messageObject3;
                                                        i34 = 2;
                                                        if (this.hasInvoicePreview) {
                                                        }
                                                        if (this.hasGamePreview) {
                                                            this.linkPreviewHeight += i48 + AndroidUtilities.dp(6.0f);
                                                            this.totalHeight += AndroidUtilities.dp(4.0f);
                                                        }
                                                        calcBackgroundWidth(i31, i38, i7);
                                                        createInstantViewButton();
                                                    }
                                                    if (tLRPC$Photo3 != null) {
                                                        this.drawImageButton = (tLRPC$Photo3 != null && !z19) || (str12 != null && (str12.equals("photo") || ((str12.equals("document") && this.documentAttachType != 6) || str12.equals("gif") || (i35 = this.documentAttachType) == 4 || i35 == 8)));
                                                        i36 = this.linkPreviewHeight;
                                                        if (i36 != 0) {
                                                        }
                                                        if (this.imageBackgroundSideColor != 0) {
                                                        }
                                                        if (this.hasInvoicePreview) {
                                                            dp3 = i46 + AndroidUtilities.dp(22.0f);
                                                        }
                                                        max2 = Math.max(i7, (dp3 - (!this.hasInvoicePreview ? 0 : AndroidUtilities.dp(12.0f))) + dp5);
                                                        tLRPC$PhotoSize2 = this.currentPhotoObject;
                                                        if (tLRPC$PhotoSize2 != null) {
                                                        }
                                                        if (this.imageBackgroundSideColor != 0) {
                                                        }
                                                        if (z19) {
                                                            if (this.hasGamePreview) {
                                                                if (this.drawInstantViewType == 7) {
                                                                }
                                                                float f362 = i41;
                                                                float dp642 = f362 / (dp3 - AndroidUtilities.dp(2.0f));
                                                                i37 = (int) (f362 / dp642);
                                                                i43 = (int) (i42 / dp642);
                                                                if (str10 == null) {
                                                                    i45 = AndroidUtilities.displaySize.y;
                                                                    if (i43 > i45 / 2) {
                                                                    }
                                                                    if (this.imageBackgroundSideColor != 0) {
                                                                    }
                                                                    dp3 = i43;
                                                                    if (dp3 < AndroidUtilities.dp(60.0f)) {
                                                                    }
                                                                    if (!this.isSmallImage) {
                                                                    }
                                                                    if (this.documentAttachType == 8) {
                                                                        this.photoImage.setImageCoords(0.0f, 0.0f, Math.max(max2 - AndroidUtilities.dp(13.0f), i37), dp3);
                                                                        float f382 = AndroidUtilities.density;
                                                                        int i2422 = (int) (i37 / f382);
                                                                        int i2432 = (int) (dp3 / f382);
                                                                        Locale locale2 = Locale.US;
                                                                        this.currentPhotoFilter = String.format(locale2, "%d_%d", Integer.valueOf(i2422), Integer.valueOf(i2432));
                                                                        this.currentPhotoFilterThumb = String.format(locale2, "%d_%d_b", Integer.valueOf(i2422), Integer.valueOf(i2432));
                                                                        if (webFile3 != null) {
                                                                        }
                                                                        z21 = true;
                                                                        z20 = true;
                                                                        this.drawPhotoImage = z21;
                                                                        if (str13 != null) {
                                                                        }
                                                                        if (this.hasGamePreview) {
                                                                        }
                                                                        i7 = max2;
                                                                        if (this.hasInvoicePreview) {
                                                                        }
                                                                        if (this.hasGamePreview) {
                                                                        }
                                                                        calcBackgroundWidth(i31, i38, i7);
                                                                        createInstantViewButton();
                                                                    }
                                                                    this.photoImage.setImageCoords(0.0f, 0.0f, i37, dp3);
                                                                    float f3822 = AndroidUtilities.density;
                                                                    int i24222 = (int) (i37 / f3822);
                                                                    int i24322 = (int) (dp3 / f3822);
                                                                    Locale locale22 = Locale.US;
                                                                    this.currentPhotoFilter = String.format(locale22, "%d_%d", Integer.valueOf(i24222), Integer.valueOf(i24322));
                                                                    this.currentPhotoFilterThumb = String.format(locale22, "%d_%d_b", Integer.valueOf(i24222), Integer.valueOf(i24322));
                                                                    if (webFile3 != null) {
                                                                    }
                                                                    z21 = true;
                                                                    z20 = true;
                                                                    this.drawPhotoImage = z21;
                                                                    if (str13 != null) {
                                                                    }
                                                                    if (this.hasGamePreview) {
                                                                    }
                                                                    i7 = max2;
                                                                    if (this.hasInvoicePreview) {
                                                                    }
                                                                    if (this.hasGamePreview) {
                                                                    }
                                                                    calcBackgroundWidth(i31, i38, i7);
                                                                    createInstantViewButton();
                                                                }
                                                                i44 = AndroidUtilities.displaySize.y;
                                                                if (i43 > i44 / 3) {
                                                                }
                                                                if (this.imageBackgroundSideColor != 0) {
                                                                }
                                                                dp3 = i43;
                                                                if (dp3 < AndroidUtilities.dp(60.0f)) {
                                                                }
                                                                if (!this.isSmallImage) {
                                                                }
                                                                if (this.documentAttachType == 8) {
                                                                }
                                                                this.photoImage.setImageCoords(0.0f, 0.0f, i37, dp3);
                                                                float f38222 = AndroidUtilities.density;
                                                                int i242222 = (int) (i37 / f38222);
                                                                int i243222 = (int) (dp3 / f38222);
                                                                Locale locale222 = Locale.US;
                                                                this.currentPhotoFilter = String.format(locale222, "%d_%d", Integer.valueOf(i242222), Integer.valueOf(i243222));
                                                                this.currentPhotoFilterThumb = String.format(locale222, "%d_%d_b", Integer.valueOf(i242222), Integer.valueOf(i243222));
                                                                if (webFile3 != null) {
                                                                }
                                                                z21 = true;
                                                                z20 = true;
                                                                this.drawPhotoImage = z21;
                                                                if (str13 != null) {
                                                                }
                                                                if (this.hasGamePreview) {
                                                                }
                                                                i7 = max2;
                                                                if (this.hasInvoicePreview) {
                                                                }
                                                                if (this.hasGamePreview) {
                                                                }
                                                                calcBackgroundWidth(i31, i38, i7);
                                                                createInstantViewButton();
                                                            }
                                                            if (this.hasInvoicePreview) {
                                                            }
                                                            i40 = 640;
                                                            i39 = 360;
                                                            float f352 = i40;
                                                            float dp632 = f352 / (dp3 - AndroidUtilities.dp(2.0f));
                                                            dp3 = (int) (i39 / dp632);
                                                            i37 = (int) (f352 / dp632);
                                                            if (!this.isSmallImage) {
                                                            }
                                                            if (this.documentAttachType == 8) {
                                                            }
                                                            this.photoImage.setImageCoords(0.0f, 0.0f, i37, dp3);
                                                            float f382222 = AndroidUtilities.density;
                                                            int i2422222 = (int) (i37 / f382222);
                                                            int i2432222 = (int) (dp3 / f382222);
                                                            Locale locale2222 = Locale.US;
                                                            this.currentPhotoFilter = String.format(locale2222, "%d_%d", Integer.valueOf(i2422222), Integer.valueOf(i2432222));
                                                            this.currentPhotoFilterThumb = String.format(locale2222, "%d_%d_b", Integer.valueOf(i2422222), Integer.valueOf(i2432222));
                                                            if (webFile3 != null) {
                                                            }
                                                            z21 = true;
                                                            z20 = true;
                                                            this.drawPhotoImage = z21;
                                                            if (str13 != null) {
                                                            }
                                                            if (this.hasGamePreview) {
                                                            }
                                                            i7 = max2;
                                                            if (this.hasInvoicePreview) {
                                                            }
                                                            if (this.hasGamePreview) {
                                                            }
                                                            calcBackgroundWidth(i31, i38, i7);
                                                            createInstantViewButton();
                                                        }
                                                        i37 = dp3;
                                                        if (!this.isSmallImage) {
                                                        }
                                                        if (this.documentAttachType == 8) {
                                                        }
                                                        this.photoImage.setImageCoords(0.0f, 0.0f, i37, dp3);
                                                        float f3822222 = AndroidUtilities.density;
                                                        int i24222222 = (int) (i37 / f3822222);
                                                        int i24322222 = (int) (dp3 / f3822222);
                                                        Locale locale22222 = Locale.US;
                                                        this.currentPhotoFilter = String.format(locale22222, "%d_%d", Integer.valueOf(i24222222), Integer.valueOf(i24322222));
                                                        this.currentPhotoFilterThumb = String.format(locale22222, "%d_%d_b", Integer.valueOf(i24222222), Integer.valueOf(i24322222));
                                                        if (webFile3 != null) {
                                                        }
                                                        z21 = true;
                                                        z20 = true;
                                                        this.drawPhotoImage = z21;
                                                        if (str13 != null) {
                                                        }
                                                        if (this.hasGamePreview) {
                                                        }
                                                        i7 = max2;
                                                        if (this.hasInvoicePreview) {
                                                        }
                                                        if (this.hasGamePreview) {
                                                        }
                                                        calcBackgroundWidth(i31, i38, i7);
                                                        createInstantViewButton();
                                                    }
                                                    this.drawImageButton = (tLRPC$Photo3 != null && !z19) || (str12 != null && (str12.equals("photo") || ((str12.equals("document") && this.documentAttachType != 6) || str12.equals("gif") || (i35 = this.documentAttachType) == 4 || i35 == 8)));
                                                    i36 = this.linkPreviewHeight;
                                                    if (i36 != 0) {
                                                    }
                                                    if (this.imageBackgroundSideColor != 0) {
                                                    }
                                                    if (this.hasInvoicePreview) {
                                                    }
                                                    max2 = Math.max(i7, (dp3 - (!this.hasInvoicePreview ? 0 : AndroidUtilities.dp(12.0f))) + dp5);
                                                    tLRPC$PhotoSize2 = this.currentPhotoObject;
                                                    if (tLRPC$PhotoSize2 != null) {
                                                    }
                                                    if (this.imageBackgroundSideColor != 0) {
                                                    }
                                                    if (z19) {
                                                    }
                                                    i37 = dp3;
                                                    if (!this.isSmallImage) {
                                                    }
                                                    if (this.documentAttachType == 8) {
                                                    }
                                                    this.photoImage.setImageCoords(0.0f, 0.0f, i37, dp3);
                                                    float f38222222 = AndroidUtilities.density;
                                                    int i242222222 = (int) (i37 / f38222222);
                                                    int i243222222 = (int) (dp3 / f38222222);
                                                    Locale locale222222 = Locale.US;
                                                    this.currentPhotoFilter = String.format(locale222222, "%d_%d", Integer.valueOf(i242222222), Integer.valueOf(i243222222));
                                                    this.currentPhotoFilterThumb = String.format(locale222222, "%d_%d_b", Integer.valueOf(i242222222), Integer.valueOf(i243222222));
                                                    if (webFile3 != null) {
                                                    }
                                                    z21 = true;
                                                    z20 = true;
                                                    this.drawPhotoImage = z21;
                                                    if (str13 != null) {
                                                    }
                                                    if (this.hasGamePreview) {
                                                    }
                                                    i7 = max2;
                                                    if (this.hasInvoicePreview) {
                                                    }
                                                    if (this.hasGamePreview) {
                                                    }
                                                    calcBackgroundWidth(i31, i38, i7);
                                                    createInstantViewButton();
                                                }
                                                messageObject10 = messageObject3;
                                                i33 = 3;
                                                i34 = 2;
                                                f3 = 1.0f;
                                                z20 = true;
                                                createInstantViewButton();
                                            }
                                        } else {
                                            this.photoImage.setImageBitmap((Drawable) null);
                                            calcBackgroundWidth(i209, extraTimeX2, i7);
                                            messageObject10 = messageObject10;
                                            i33 = 3;
                                            i34 = 2;
                                            f3 = 1.0f;
                                            z20 = true;
                                        }
                                        z26 = z20;
                                        i50 = 0;
                                    }
                                }
                                int max13 = Math.max(i209, messageObject10.lastLineWidth) + AndroidUtilities.dp(31.0f);
                                this.backgroundWidth = max13;
                                this.backgroundWidth = Math.max(max13, this.timeWidth + AndroidUtilities.dp(31.0f));
                                this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                if (messageObject.isRoundVideo()) {
                                }
                                setMessageObjectInternal(messageObject);
                                if (!this.hasGamePreview) {
                                    this.backgroundWidth = messageObject10.textWidth + (getExtraTextX() * 2) + ((!this.hasGamePreview && !this.hasInvoicePreview) ? 0 : AndroidUtilities.dp(10.0f));
                                    this.totalHeight = messageObject10.textHeight + AndroidUtilities.dp(19.5f) + this.namesOffset;
                                    reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                                    if (!reactionsLayoutInBubble.isSmall) {
                                    }
                                    if (this.drawPinnedTop) {
                                    }
                                    max = Math.max(Math.max(Math.max(Math.max(this.backgroundWidth, this.nameWidth), this.forwardedNameWidth), this.replyNameWidth), this.replyTextWidth);
                                    if (this.commentLayout != null) {
                                        max = Math.max(max, this.totalCommentWidth);
                                    }
                                    i7 = max;
                                    if (this.hasLinkPreview) {
                                        this.photoImage.setImageBitmap((Drawable) null);
                                        calcBackgroundWidth(i209, extraTimeX2, i7);
                                        messageObject10 = messageObject10;
                                        i33 = 3;
                                        i34 = 2;
                                        f3 = 1.0f;
                                        z20 = true;
                                        z26 = z20;
                                        i50 = 0;
                                    }
                                    if (!AndroidUtilities.isTablet()) {
                                    }
                                    int i2142 = minTabletSide2 - dp2;
                                    if (this.drawSideButton != 0) {
                                    }
                                    dp3 = AndroidUtilities.dp(48.0f);
                                    dp4 = AndroidUtilities.dp(10.0f);
                                    if (this.hasLinkPreview) {
                                    }
                                    i14 = this.drawInstantViewType;
                                    if (i14 == 11) {
                                    }
                                    if (!this.hasInvoicePreview) {
                                    }
                                    i15 = i2142 - dp5;
                                    messageObject2 = this.currentMessageObject;
                                    String str342 = str8;
                                    if (messageObject2.photoThumbs == null) {
                                        messageObject2.generateThumbs(true);
                                    }
                                    if (string == null) {
                                    }
                                    if (str5 != null) {
                                    }
                                    if (str9 != null) {
                                        i49 = this.linkPreviewHeight;
                                        if (i49 == 0) {
                                        }
                                        str15 = str9;
                                        str16 = Emoji.replaceEmoji(str15, Theme.chat_replyNamePaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
                                        if (i17 == 3) {
                                        }
                                        StaticLayout generateStaticLayout322 = generateStaticLayout(str16, Theme.chat_replyNamePaint, i15, (i15 - dp3) - dp4, i17, 1);
                                        this.authorLayout = generateStaticLayout322;
                                        i17 -= generateStaticLayout322.getLineCount();
                                        StaticLayout staticLayout17222 = this.authorLayout;
                                        int lineBottom3222 = staticLayout17222.getLineBottom(staticLayout17222.getLineCount() - 1);
                                        this.linkPreviewHeight += lineBottom3222;
                                        this.totalHeight += lineBottom3222;
                                        max4 = (int) Math.max(this.authorLayout.getLineLeft(0), 0.0f);
                                        this.authorX = -max4;
                                        if (max4 == 0) {
                                        }
                                        int i227222 = width3 + dp5;
                                        i7 = Math.max(i7, i227222);
                                        i18 = Math.max(i18, i227222);
                                        if (str4 != null) {
                                        }
                                        str11 = i15;
                                        if (z13) {
                                            this.isSmallImage = false;
                                            z19 = false;
                                            if (!z19) {
                                            }
                                            if (tLRPC$Document3 == null) {
                                            }
                                        }
                                        z19 = z13;
                                        if (!z19) {
                                        }
                                        if (tLRPC$Document3 == null) {
                                        }
                                    }
                                    z17 = false;
                                    if (str4 != null) {
                                    }
                                    str11 = i15;
                                    if (z13) {
                                    }
                                    z19 = z13;
                                    if (!z19) {
                                    }
                                    if (tLRPC$Document3 == null) {
                                    }
                                }
                                this.backgroundWidth = messageObject10.textWidth + (getExtraTextX() * 2) + ((!this.hasGamePreview && !this.hasInvoicePreview) ? 0 : AndroidUtilities.dp(10.0f));
                                this.totalHeight = messageObject10.textHeight + AndroidUtilities.dp(19.5f) + this.namesOffset;
                                reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                                if (!reactionsLayoutInBubble.isSmall) {
                                }
                                if (this.drawPinnedTop) {
                                }
                                max = Math.max(Math.max(Math.max(Math.max(this.backgroundWidth, this.nameWidth), this.forwardedNameWidth), this.replyNameWidth), this.replyTextWidth);
                                if (this.commentLayout != null) {
                                }
                                i7 = max;
                                if (this.hasLinkPreview) {
                                }
                                if (!AndroidUtilities.isTablet()) {
                                }
                                int i21422 = minTabletSide2 - dp2;
                                if (this.drawSideButton != 0) {
                                }
                                dp3 = AndroidUtilities.dp(48.0f);
                                dp4 = AndroidUtilities.dp(10.0f);
                                if (this.hasLinkPreview) {
                                }
                                i14 = this.drawInstantViewType;
                                if (i14 == 11) {
                                }
                                if (!this.hasInvoicePreview) {
                                }
                                i15 = i21422 - dp5;
                                messageObject2 = this.currentMessageObject;
                                String str3422 = str8;
                                if (messageObject2.photoThumbs == null) {
                                }
                                if (string == null) {
                                }
                                if (str5 != null) {
                                }
                                if (str9 != null) {
                                }
                                z17 = false;
                                if (str4 != null) {
                                }
                                str11 = i15;
                                if (z13) {
                                }
                                z19 = z13;
                                if (!z19) {
                                }
                                if (tLRPC$Document3 == null) {
                                }
                            }
                        }
                    } else if ("telegram_livestream".equals(str28)) {
                        this.drawInstantView = true;
                        this.drawInstantViewType = 11;
                    } else if ("telegram_voicechat".equals(str28)) {
                        this.drawInstantView = true;
                        this.drawInstantViewType = 9;
                    } else if ("telegram_channel".equals(str28)) {
                        this.drawInstantView = true;
                        this.drawInstantViewType = 1;
                    } else if ("telegram_user".equals(str28)) {
                        this.drawInstantView = true;
                        this.drawInstantViewType = 13;
                    } else if ("telegram_megagroup".equals(str28)) {
                        this.drawInstantView = true;
                        this.drawInstantViewType = 2;
                    } else if ("telegram_message".equals(str28)) {
                        this.drawInstantView = true;
                        this.drawInstantViewType = 3;
                    } else if ("telegram_theme".equals(str28)) {
                        int size13 = MessageObject.getMedia(messageObject10.messageOwner).webpage.attributes.size();
                        tLRPC$Document = null;
                        int i246 = 0;
                        while (true) {
                            if (i246 >= size13) {
                                tLRPC$ThemeSettings = null;
                                break;
                            }
                            TLRPC$TL_webPageAttributeTheme tLRPC$TL_webPageAttributeTheme = MessageObject.getMedia(messageObject10.messageOwner).webpage.attributes.get(i246);
                            ArrayList<TLRPC$Document> arrayList8 = tLRPC$TL_webPageAttributeTheme.documents;
                            int size14 = arrayList8.size();
                            int i247 = 0;
                            while (true) {
                                if (i247 >= size14) {
                                    break;
                                }
                                TLRPC$Document tLRPC$Document8 = arrayList8.get(i247);
                                if ("application/x-tgtheme-android".equals(tLRPC$Document8.mime_type)) {
                                    this.drawInstantView = true;
                                    this.drawInstantViewType = 7;
                                    tLRPC$Document = tLRPC$Document8;
                                    break;
                                }
                                i247++;
                            }
                            if (this.drawInstantView) {
                                tLRPC$ThemeSettings = null;
                                break;
                            }
                            tLRPC$ThemeSettings = tLRPC$TL_webPageAttributeTheme.settings;
                            if (tLRPC$ThemeSettings != null) {
                                this.drawInstantView = true;
                                this.drawInstantViewType = 7;
                                break;
                            }
                            i246++;
                        }
                        z11 = false;
                        this.backgroundWidth = i209;
                        if (!this.hasLinkPreview) {
                            i51 = messageObject10.lastLineWidth;
                            if (i209 - i51 >= extraTimeX2) {
                            }
                        }
                        int max132 = Math.max(i209, messageObject10.lastLineWidth) + AndroidUtilities.dp(31.0f);
                        this.backgroundWidth = max132;
                        this.backgroundWidth = Math.max(max132, this.timeWidth + AndroidUtilities.dp(31.0f));
                        this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                        if (messageObject.isRoundVideo()) {
                        }
                        setMessageObjectInternal(messageObject);
                        this.backgroundWidth = messageObject10.textWidth + (getExtraTextX() * 2) + ((!this.hasGamePreview && !this.hasInvoicePreview) ? 0 : AndroidUtilities.dp(10.0f));
                        this.totalHeight = messageObject10.textHeight + AndroidUtilities.dp(19.5f) + this.namesOffset;
                        reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                        if (!reactionsLayoutInBubble.isSmall) {
                        }
                        if (this.drawPinnedTop) {
                        }
                        max = Math.max(Math.max(Math.max(Math.max(this.backgroundWidth, this.nameWidth), this.forwardedNameWidth), this.replyNameWidth), this.replyTextWidth);
                        if (this.commentLayout != null) {
                        }
                        i7 = max;
                        if (this.hasLinkPreview) {
                        }
                        if (!AndroidUtilities.isTablet()) {
                        }
                        int i214222 = minTabletSide2 - dp2;
                        if (this.drawSideButton != 0) {
                        }
                        dp3 = AndroidUtilities.dp(48.0f);
                        dp4 = AndroidUtilities.dp(10.0f);
                        if (this.hasLinkPreview) {
                        }
                        i14 = this.drawInstantViewType;
                        if (i14 == 11) {
                        }
                        if (!this.hasInvoicePreview) {
                        }
                        i15 = i214222 - dp5;
                        messageObject2 = this.currentMessageObject;
                        String str34222 = str8;
                        if (messageObject2.photoThumbs == null) {
                        }
                        if (string == null) {
                        }
                        if (str5 != null) {
                        }
                        if (str9 != null) {
                        }
                        z17 = false;
                        if (str4 != null) {
                        }
                        str11 = i15;
                        if (z13) {
                        }
                        z19 = z13;
                        if (!z19) {
                        }
                        if (tLRPC$Document3 == null) {
                        }
                    } else if ("telegram_background".equals(str28)) {
                        this.drawInstantView = true;
                        this.drawInstantViewType = 6;
                        try {
                            Uri parse2 = Uri.parse(MessageObject.getMedia(messageObject10.messageOwner).webpage.url);
                            this.imageBackgroundIntensity = Utilities.parseInt((CharSequence) parse2.getQueryParameter("intensity")).intValue();
                            String queryParameter = parse2.getQueryParameter("bg_color");
                            String queryParameter2 = parse2.getQueryParameter("rotation");
                            if (queryParameter2 != null) {
                                this.imageBackgroundGradientRotation = Utilities.parseInt((CharSequence) queryParameter2).intValue();
                            }
                            if (TextUtils.isEmpty(queryParameter)) {
                                TLRPC$Document document5 = messageObject.getDocument();
                                if (document5 != null && "image/png".equals(document5.mime_type)) {
                                    queryParameter = "ffffff";
                                }
                                if (this.imageBackgroundIntensity == 0.0f) {
                                    try {
                                        this.imageBackgroundIntensity = 50.0f;
                                        if (queryParameter == null) {
                                            int parseInt = Integer.parseInt(queryParameter.substring(0, 6), 16) | (-16777216);
                                            this.imageBackgroundColor = parseInt;
                                            if (queryParameter.length() >= 13 && AndroidUtilities.isValidWallChar(queryParameter.charAt(6))) {
                                                int parseInt2 = Integer.parseInt(queryParameter.substring(7, 13), 16) | (-16777216);
                                                this.imageBackgroundGradientColor1 = parseInt2;
                                                parseInt = AndroidUtilities.getAverageColor(this.imageBackgroundColor, parseInt2);
                                            }
                                            if (queryParameter.length() >= 20 && AndroidUtilities.isValidWallChar(queryParameter.charAt(13))) {
                                                this.imageBackgroundGradientColor2 = Integer.parseInt(queryParameter.substring(14, 20), 16) | (-16777216);
                                            }
                                            if (queryParameter.length() == 27 && AndroidUtilities.isValidWallChar(queryParameter.charAt(20))) {
                                                this.imageBackgroundGradientColor3 = Integer.parseInt(queryParameter.substring(21), 16) | (-16777216);
                                            }
                                            if (this.imageBackgroundIntensity < 0.0f) {
                                                this.imageBackgroundSideColor = -15658735;
                                            } else {
                                                this.imageBackgroundSideColor = AndroidUtilities.getPatternSideColor(parseInt);
                                            }
                                            this.photoImage.setColorFilter(new PorterDuffColorFilter(AndroidUtilities.getPatternColor(parseInt), PorterDuff.Mode.SRC_IN));
                                            this.photoImage.setAlpha(Math.abs(this.imageBackgroundIntensity) / 100.0f);
                                        } else {
                                            String lastPathSegment = parse2.getLastPathSegment();
                                            if (lastPathSegment != null && lastPathSegment.length() >= 6) {
                                                this.imageBackgroundColor = Integer.parseInt(lastPathSegment.substring(0, 6), 16) | (-16777216);
                                                if (lastPathSegment.length() >= 13 && AndroidUtilities.isValidWallChar(lastPathSegment.charAt(6))) {
                                                    this.imageBackgroundGradientColor1 = Integer.parseInt(lastPathSegment.substring(7, 13), 16) | (-16777216);
                                                }
                                                if (lastPathSegment.length() >= 20 && AndroidUtilities.isValidWallChar(lastPathSegment.charAt(13))) {
                                                    this.imageBackgroundGradientColor2 = Integer.parseInt(lastPathSegment.substring(14, 20), 16) | (-16777216);
                                                }
                                                if (lastPathSegment.length() == 27 && AndroidUtilities.isValidWallChar(lastPathSegment.charAt(20))) {
                                                    this.imageBackgroundGradientColor3 = Integer.parseInt(lastPathSegment.substring(21), 16) | (-16777216);
                                                }
                                                TLRPC$TL_photoSizeEmpty tLRPC$TL_photoSizeEmpty = new TLRPC$TL_photoSizeEmpty();
                                                this.currentPhotoObject = tLRPC$TL_photoSizeEmpty;
                                                tLRPC$TL_photoSizeEmpty.type = "s";
                                                tLRPC$TL_photoSizeEmpty.w = AndroidUtilities.dp(180.0f);
                                                this.currentPhotoObject.h = AndroidUtilities.dp(150.0f);
                                                this.currentPhotoObject.location = new TLRPC$TL_fileLocationUnavailable();
                                            }
                                        }
                                    } catch (Exception unused4) {
                                    }
                                }
                            }
                            if (queryParameter == null) {
                            }
                        } catch (Exception unused5) {
                        }
                    }
                    tLRPC$ThemeSettings = null;
                    tLRPC$Document = null;
                    z11 = false;
                    this.backgroundWidth = i209;
                    if (!this.hasLinkPreview) {
                    }
                    int max1322 = Math.max(i209, messageObject10.lastLineWidth) + AndroidUtilities.dp(31.0f);
                    this.backgroundWidth = max1322;
                    this.backgroundWidth = Math.max(max1322, this.timeWidth + AndroidUtilities.dp(31.0f));
                    this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                    if (messageObject.isRoundVideo()) {
                    }
                    setMessageObjectInternal(messageObject);
                    this.backgroundWidth = messageObject10.textWidth + (getExtraTextX() * 2) + ((!this.hasGamePreview && !this.hasInvoicePreview) ? 0 : AndroidUtilities.dp(10.0f));
                    this.totalHeight = messageObject10.textHeight + AndroidUtilities.dp(19.5f) + this.namesOffset;
                    reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                    if (!reactionsLayoutInBubble.isSmall) {
                    }
                    if (this.drawPinnedTop) {
                    }
                    max = Math.max(Math.max(Math.max(Math.max(this.backgroundWidth, this.nameWidth), this.forwardedNameWidth), this.replyNameWidth), this.replyTextWidth);
                    if (this.commentLayout != null) {
                    }
                    i7 = max;
                    if (this.hasLinkPreview) {
                    }
                    if (!AndroidUtilities.isTablet()) {
                    }
                    int i2142222 = minTabletSide2 - dp2;
                    if (this.drawSideButton != 0) {
                    }
                    dp3 = AndroidUtilities.dp(48.0f);
                    dp4 = AndroidUtilities.dp(10.0f);
                    if (this.hasLinkPreview) {
                    }
                    i14 = this.drawInstantViewType;
                    if (i14 == 11) {
                    }
                    if (!this.hasInvoicePreview) {
                    }
                    i15 = i2142222 - dp5;
                    messageObject2 = this.currentMessageObject;
                    String str342222 = str8;
                    if (messageObject2.photoThumbs == null) {
                    }
                    if (string == null) {
                    }
                    if (str5 != null) {
                    }
                    if (str9 != null) {
                    }
                    z17 = false;
                    if (str4 != null) {
                    }
                    str11 = i15;
                    if (z13) {
                    }
                    z19 = z13;
                    if (!z19) {
                    }
                    if (tLRPC$Document3 == null) {
                    }
                }
                if ((this.currentPosition != null || this.currentMessageObject.isMusic() || this.currentMessageObject.isDocument()) && !messageObject.isAnyKindOfSticker() && this.addedCaptionHeight == 0) {
                    if (!messageObject10.isRestrictedMessage && this.captionLayout == null && (messageObject10.caption != null || messageObject.isVoiceTranscriptionOpen())) {
                        voiceTranscription = messageObject.isVoiceTranscriptionOpen() ? messageObject10.caption : messageObject.getVoiceTranscription();
                        this.currentCaption = voiceTranscription;
                        if (voiceTranscription != null && !TextUtils.isEmpty(messageObject10.messageOwner.voiceTranscription) && this.currentMessageObject.isVoiceTranscriptionOpen() && !this.currentMessageObject.messageOwner.voiceTranscriptionFinal) {
                            str17 = ((Object) this.currentCaption) + " ";
                            this.currentCaption = str17;
                            if (!(str17 instanceof Spannable)) {
                                this.currentCaption = new SpannableString(this.currentCaption);
                            }
                            ((SpannableString) this.currentCaption).setSpan(new TranscribeButton.LoadingPointsSpan(), this.currentCaption.length() - 1, this.currentCaption.length(), 33);
                        }
                        try {
                            int i248 = this.backgroundWidth;
                            if (messageObject.isVoiceTranscriptionOpen()) {
                                if (AndroidUtilities.isTablet()) {
                                    minTabletSide5 = AndroidUtilities.getMinTabletSide();
                                    if (!z8) {
                                        f9 = 50.0f;
                                    }
                                    dp8 = AndroidUtilities.dp(f9);
                                } else {
                                    minTabletSide5 = getParentWidth();
                                    if (!z8) {
                                        f9 = 50.0f;
                                    }
                                    dp8 = AndroidUtilities.dp(f9);
                                }
                                i248 = minTabletSide5 - dp8;
                            }
                            int dp67 = ((i248 - AndroidUtilities.dp(31.0f)) - AndroidUtilities.dp(10.0f)) - (getExtraTextX() * 2);
                            if (Build.VERSION.SDK_INT < 24) {
                                CharSequence charSequence6 = this.currentCaption;
                                this.captionLayout = StaticLayout.Builder.obtain(charSequence6, 0, charSequence6.length(), Theme.chat_msgTextPaint, dp67).setBreakStrategy(1).setHyphenationFrequency(0).setAlignment(Layout.Alignment.ALIGN_NORMAL).build();
                            } else {
                                this.captionLayout = new StaticLayout(this.currentCaption, Theme.chat_msgTextPaint, dp67, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                            }
                            updateSeekBarWaveformWidth();
                            updateCaptionSpoilers();
                        } catch (Exception e25) {
                            FileLog.e(e25);
                        }
                    }
                    if (this.captionLayout == null || this.currentMessageObject.type == i34) {
                        if (!messageObject.isVoiceTranscriptionOpen() && this.captionLayout != null) {
                            float dp68 = ((this.backgroundWidth - AndroidUtilities.dp(31.0f)) - AndroidUtilities.dp(10.0f)) - (getExtraTextX() * 2);
                            float f39 = dp68;
                            for (i52 = 0; i52 < this.captionLayout.getLineCount(); i52++) {
                                float lineWidth2 = this.captionLayout.getLineWidth(i52);
                                if (lineWidth2 > f39) {
                                    f39 = lineWidth2;
                                }
                            }
                            this.backgroundWidth = (int) (this.backgroundWidth + (f39 - dp68));
                        }
                        int dp512222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                        staticLayout2 = this.captionLayout;
                        if (staticLayout2 == null && staticLayout2.getLineCount() > 0) {
                            StaticLayout staticLayout22 = this.captionLayout;
                            float lineWidth3 = staticLayout22.getLineWidth(staticLayout22.getLineCount() - 1);
                            StaticLayout staticLayout23 = this.captionLayout;
                            valueOf = Float.valueOf(lineWidth3 + staticLayout23.getLineLeft(staticLayout23.getLineCount() - 1));
                            if (valueOf != null) {
                                StaticLayout staticLayout24 = this.captionLayout;
                                if (staticLayout24 != null) {
                                    this.captionWidth = dp512222222222222;
                                    this.captionHeight = staticLayout24.getHeight();
                                }
                                this.totalHeight += this.captionHeight + AndroidUtilities.dp(9.0f);
                                ReactionsLayoutInBubble reactionsLayoutInBubble29 = this.reactionsLayoutInBubble;
                                if (!reactionsLayoutInBubble29.isEmpty && !reactionsLayoutInBubble29.isSmall) {
                                }
                                MessageObject.GroupedMessagePosition groupedMessagePosition25 = this.currentPosition;
                                if (groupedMessagePosition25 != null && (groupedMessagePosition25.flags & 8) == 0) {
                                }
                                if ((dp512222222222222 - AndroidUtilities.dp(8.0f)) - valueOf.floatValue() < this.timeWidth + (!messageObject.isOutOwner() ? 0 : AndroidUtilities.dp(20.0f)) + getExtraTimeX()) {
                                    this.totalHeight += AndroidUtilities.dp(14.0f);
                                    if (this.captionLayout != null) {
                                        this.captionHeight += AndroidUtilities.dp(14.0f);
                                        i53 = 2;
                                        i50 = i53;
                                    }
                                }
                                i53 = i50;
                                i50 = i53;
                            }
                        }
                        valueOf = this.currentMessageObject.type != i34 ? null : Float.valueOf(AndroidUtilities.dp(64.0f));
                        if (valueOf != null) {
                        }
                    }
                }
                groupedMessagePosition4 = this.currentPosition;
                if ((groupedMessagePosition4 != null || (groupedMessagePosition4.flags & 8) != 0) && this.captionLayout == null) {
                    int i2002222222222222 = this.widthBeforeNewTimeLine;
                }
                i54 = -1;
                messageObject4 = this.currentMessageObject;
                if (messageObject4.eventId == 0 || messageObject4.isMediaEmpty() || MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage == null) {
                    f4 = 0.0f;
                } else {
                    int dp69 = this.backgroundWidth - AndroidUtilities.dp(41.0f);
                    this.hasOldCaptionPreview = true;
                    this.linkPreviewHeight = 0;
                    TLRPC$WebPage tLRPC$WebPage = MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage;
                    try {
                        int ceil23 = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(tLRPC$WebPage.site_name) + f3);
                        this.siteNameWidth = ceil23;
                        StaticLayout staticLayout25 = new StaticLayout(tLRPC$WebPage.site_name, Theme.chat_replyNamePaint, Math.min(ceil23, dp69), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        this.siteNameLayout = staticLayout25;
                        float lineLeft3 = staticLayout25.getLineLeft(0);
                        f4 = 0.0f;
                    } catch (Exception e26) {
                        e = e26;
                        f4 = 0.0f;
                    }
                    try {
                        this.siteNameRtl = lineLeft3 == 0.0f;
                        StaticLayout staticLayout26 = this.siteNameLayout;
                        int lineBottom5 = staticLayout26.getLineBottom(staticLayout26.getLineCount() - 1);
                        this.linkPreviewHeight += lineBottom5;
                        this.totalHeight += lineBottom5;
                    } catch (Exception e27) {
                        e = e27;
                        FileLog.e(e);
                        this.descriptionX = 0;
                        if (this.linkPreviewHeight != 0) {
                        }
                        StaticLayout createStaticLayout = StaticLayoutEx.createStaticLayout(tLRPC$WebPage.description, Theme.chat_replyTextPaint, dp69, Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(f3), false, TextUtils.TruncateAt.END, dp69, 6);
                        this.descriptionLayout = createStaticLayout;
                        int lineBottom6 = createStaticLayout.getLineBottom(createStaticLayout.getLineCount() - 1);
                        this.linkPreviewHeight += lineBottom6;
                        this.totalHeight += lineBottom6;
                        z27 = false;
                        while (i56 < this.descriptionLayout.getLineCount()) {
                        }
                        if (z27) {
                        }
                        i55 = messageObject10.type;
                        if (i55 != 1) {
                        }
                        this.totalHeight += AndroidUtilities.dp(6.0f);
                        int dp70 = this.totalHeight + AndroidUtilities.dp(17.0f);
                        this.totalHeight = dp70;
                        if (i50 != 0) {
                        }
                        if (messageObject.isSponsored()) {
                        }
                        this.botButtons.clear();
                        if (z46) {
                        }
                        if (!messageObject10.isRestrictedMessage) {
                        }
                        this.substractBackgroundHeight = 0;
                        this.keyboardHeight = 0;
                        r6 = hashMap;
                        if (this.drawCommentButton) {
                        }
                        z29 = this.drawPinnedBottom;
                        if (z29) {
                        }
                        if (!z29) {
                        }
                        if (messageObject10.type != 19) {
                        }
                        if (!this.drawPhotoImage) {
                        }
                        i58 = 5;
                        if (this.documentAttachType == 5) {
                        }
                        calculateUnlockXY();
                        if (z26) {
                        }
                        updateAnimatedEmojis();
                        r62 = r6;
                        if (z46) {
                        }
                        transcribeButton = this.transcribeButton;
                        if (transcribeButton != null) {
                        }
                        updateWaveform();
                        updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                        if (!this.currentMessageObject.loadingCancelled) {
                        }
                        chatMessageCellDelegate2 = this.delegate;
                        if (chatMessageCellDelegate2 != null) {
                        }
                        this.accessibilityVirtualViewBounds.clear();
                        this.transitionParams.updatePhotoImageX = true;
                        updateFlagSecure();
                    }
                    this.descriptionX = 0;
                    if (this.linkPreviewHeight != 0) {
                        this.totalHeight += AndroidUtilities.dp(2.0f);
                    }
                    StaticLayout createStaticLayout2 = StaticLayoutEx.createStaticLayout(tLRPC$WebPage.description, Theme.chat_replyTextPaint, dp69, Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(f3), false, TextUtils.TruncateAt.END, dp69, 6);
                    this.descriptionLayout = createStaticLayout2;
                    int lineBottom62 = createStaticLayout2.getLineBottom(createStaticLayout2.getLineCount() - 1);
                    this.linkPreviewHeight += lineBottom62;
                    this.totalHeight += lineBottom62;
                    z27 = false;
                    for (i56 = 0; i56 < this.descriptionLayout.getLineCount(); i56++) {
                        int ceil24 = (int) Math.ceil(this.descriptionLayout.getLineLeft(i56));
                        if (ceil24 == 0) {
                            z27 = true;
                        } else {
                            int i249 = this.descriptionX;
                            if (i249 == 0) {
                                this.descriptionX = -ceil24;
                            } else {
                                this.descriptionX = Math.max(i249, -ceil24);
                            }
                        }
                    }
                    if (z27) {
                        this.descriptionX = 0;
                    }
                    i55 = messageObject10.type;
                    if (i55 != 1 || i55 == i33 || i55 == 20) {
                        this.totalHeight += AndroidUtilities.dp(6.0f);
                    }
                    int dp702 = this.totalHeight + AndroidUtilities.dp(17.0f);
                    this.totalHeight = dp702;
                    if (i50 != 0) {
                        this.totalHeight = dp702 - AndroidUtilities.dp(14.0f);
                        if (i50 == i34) {
                            this.captionHeight -= AndroidUtilities.dp(14.0f);
                        }
                    }
                }
                if (messageObject.isSponsored()) {
                    this.drawInstantView = true;
                    if (messageObject10.sponsoredChannelPost != 0) {
                        this.drawInstantViewType = 12;
                    } else {
                        this.drawInstantViewType = 1;
                    }
                    long peerId2 = MessageObject.getPeerId(messageObject10.messageOwner.from_id);
                    if (peerId2 > 0 && (user2 = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(peerId2))) != null && user2.bot) {
                        this.drawInstantViewType = 10;
                    }
                    createInstantViewButton();
                }
                this.botButtons.clear();
                if (z46) {
                    hashMap = null;
                } else {
                    this.botButtonsByData.clear();
                    this.botButtonsByPosition.clear();
                    hashMap = null;
                    this.botButtonsLayout = null;
                }
                if (!messageObject10.isRestrictedMessage && this.currentPosition == null && (messageObject10.messageOwner.reply_markup instanceof TLRPC$TL_replyInlineMarkup) && !messageObject.hasExtendedMedia()) {
                    TLRPC$ReplyMarkup tLRPC$ReplyMarkup = messageObject10.messageOwner.reply_markup;
                    int size15 = tLRPC$ReplyMarkup instanceof TLRPC$TL_replyInlineMarkup ? 1 : tLRPC$ReplyMarkup.rows.size();
                    int dp71 = (AndroidUtilities.dp(48.0f) * size15) + AndroidUtilities.dp(f3);
                    this.keyboardHeight = dp71;
                    this.substractBackgroundHeight = dp71;
                    dp9 = this.backgroundWidth - AndroidUtilities.dp(this.mediaBackground ? 9.0f : 0.0f);
                    this.widthForButtons = dp9;
                    if (messageObject10.wantedBotKeyboardWidth > dp9) {
                        int i250 = -AndroidUtilities.dp(!z8 ? 10.0f : 62.0f);
                        if (AndroidUtilities.isTablet()) {
                            minTabletSide6 = AndroidUtilities.getMinTabletSide();
                        } else {
                            minTabletSide6 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y) - AndroidUtilities.dp(5.0f);
                        }
                        this.widthForButtons = Math.max(this.backgroundWidth, Math.min(messageObject10.wantedBotKeyboardWidth, i250 + minTabletSide6));
                    }
                    HashMap hashMap4 = new HashMap(this.botButtonsByData);
                    sb = messageObject10.botButtonsLayout;
                    if (sb != null && (str18 = this.botButtonsLayout) != null && str18.equals(sb.toString())) {
                        hashMap2 = new HashMap(this.botButtonsByPosition);
                    } else {
                        sb2 = messageObject10.botButtonsLayout;
                        if (sb2 != null) {
                            this.botButtonsLayout = sb2.toString();
                        }
                        hashMap2 = hashMap;
                    }
                    this.botButtonsByData.clear();
                    if (!(messageObject10.messageOwner.reply_markup instanceof TLRPC$TL_replyInlineMarkup)) {
                        i57 = 0;
                        hashMap3 = hashMap;
                    } else {
                        int i251 = 0;
                        int i252 = 0;
                        HashMap hashMap5 = hashMap;
                        while (i252 < size15) {
                            TLRPC$TL_keyboardButtonRow tLRPC$TL_keyboardButtonRow = messageObject10.messageOwner.reply_markup.rows.get(i252);
                            int size16 = tLRPC$TL_keyboardButtonRow.buttons.size();
                            if (size16 != 0) {
                                int dp72 = ((this.widthForButtons - (AndroidUtilities.dp(5.0f) * (size16 - 1))) - AndroidUtilities.dp(2.0f)) / size16;
                                int i253 = 0;
                                ?? r63 = hashMap5;
                                while (i253 < tLRPC$TL_keyboardButtonRow.buttons.size()) {
                                    BotButton botButton2 = new BotButton();
                                    botButton2.button = tLRPC$TL_keyboardButtonRow.buttons.get(i253);
                                    String bytesToHex = Utilities.bytesToHex(botButton2.button.data);
                                    String str37 = i252 + "" + i253;
                                    if (hashMap2 != null) {
                                        botButton = (BotButton) hashMap2.get(str37);
                                    } else {
                                        botButton = (BotButton) hashMap4.get(bytesToHex);
                                    }
                                    if (botButton == null) {
                                        botButton2.lastUpdateTime = System.currentTimeMillis();
                                    } else {
                                        botButton2.progressAlpha = botButton.progressAlpha;
                                        botButton2.angle = botButton.angle;
                                        botButton2.lastUpdateTime = botButton.lastUpdateTime;
                                    }
                                    this.botButtonsByData.put(bytesToHex, botButton2);
                                    this.botButtonsByPosition.put(str37, botButton2);
                                    botButton2.x = (AndroidUtilities.dp(5.0f) + dp72) * i253;
                                    botButton2.y = (AndroidUtilities.dp(48.0f) * i252) + AndroidUtilities.dp(5.0f);
                                    botButton2.width = dp72;
                                    botButton2.height = AndroidUtilities.dp(44.0f);
                                    TextPaint textPaint2 = (TextPaint) getThemedPaint("paintChatBotButton");
                                    if ((botButton2.button instanceof TLRPC$TL_keyboardButtonBuy) && (MessageObject.getMedia(messageObject10.messageOwner).flags & 4) != 0) {
                                        string2 = LocaleController.getString("PaymentReceipt", R.string.PaymentReceipt);
                                        botButton2.title = new StaticLayout(string2, textPaint2, dp72 - AndroidUtilities.dp(10.0f), Layout.Alignment.ALIGN_CENTER, 1.0f, 0.0f, false);
                                        this.botButtons.add(botButton2);
                                        if (i253 == tLRPC$TL_keyboardButtonRow.buttons.size() - 1) {
                                            i251 = Math.max(i251, botButton2.x + botButton2.width);
                                        }
                                        if (messageObject.isFromUser() && (botButton2.button instanceof TLRPC$TL_keyboardButtonUrl)) {
                                            try {
                                                parse = Uri.parse(botButton2.button.url);
                                                String lowerCase2 = parse.getHost().toLowerCase();
                                                if (parse.getQueryParameter("startgroup") != null) {
                                                    if (!"http".equals(parse.getScheme()) && !"https".equals(parse.getScheme())) {
                                                        if ("tg".equals(parse.getScheme())) {
                                                            if (botButton2.button.url.startsWith("tg:resolve")) {
                                                            }
                                                            z28 = true;
                                                            botButton2.isInviteButton = z28;
                                                        }
                                                    }
                                                    if (!"t.me".equals(lowerCase2)) {
                                                        if (!"telegram.me".equals(lowerCase2)) {
                                                            if ("telegram.dog".equals(lowerCase2)) {
                                                            }
                                                            if ("tg".equals(parse.getScheme())) {
                                                            }
                                                        }
                                                    }
                                                    z28 = true;
                                                    botButton2.isInviteButton = z28;
                                                }
                                                z28 = false;
                                                botButton2.isInviteButton = z28;
                                            } catch (Exception unused6) {
                                            }
                                        }
                                        i253++;
                                        r63 = 0;
                                    }
                                    string2 = TextUtils.ellipsize(Emoji.replaceEmoji(botButton2.button.text != null ? botButton2.button.text : "", textPaint2.getFontMetricsInt(), AndroidUtilities.dp(15.0f), false), textPaint2, dp72 - AndroidUtilities.dp(10.0f), TextUtils.TruncateAt.END);
                                    botButton2.title = new StaticLayout(string2, textPaint2, dp72 - AndroidUtilities.dp(10.0f), Layout.Alignment.ALIGN_CENTER, 1.0f, 0.0f, false);
                                    this.botButtons.add(botButton2);
                                    if (i253 == tLRPC$TL_keyboardButtonRow.buttons.size() - 1) {
                                    }
                                    if (messageObject.isFromUser()) {
                                        parse = Uri.parse(botButton2.button.url);
                                        String lowerCase22 = parse.getHost().toLowerCase();
                                        if (parse.getQueryParameter("startgroup") != null) {
                                        }
                                        z28 = false;
                                        botButton2.isInviteButton = z28;
                                    }
                                    i253++;
                                    r63 = 0;
                                }
                            }
                            i252++;
                            i54 = -1;
                            f4 = 0.0f;
                            hashMap5 = null;
                            i33 = 3;
                            i34 = 2;
                        }
                        i57 = i251;
                        hashMap3 = hashMap5;
                    }
                    this.widthForButtons = i57;
                    r6 = hashMap3;
                } else {
                    this.substractBackgroundHeight = 0;
                    this.keyboardHeight = 0;
                    r6 = hashMap;
                }
                if (this.drawCommentButton) {
                    this.totalHeight += AndroidUtilities.dp(!shouldDrawTimeOnMedia() ? 43.0f : 41.3f);
                    createSelectorDrawable(1);
                }
                z29 = this.drawPinnedBottom;
                if (z29 && this.drawPinnedTop) {
                    this.totalHeight -= AndroidUtilities.dp(2.0f);
                } else if (!z29) {
                    this.totalHeight -= AndroidUtilities.dp(f3);
                } else if (this.drawPinnedTop && this.pinnedBottom && (groupedMessagePosition5 = this.currentPosition) != null && groupedMessagePosition5.siblingHeights == null) {
                    this.totalHeight -= AndroidUtilities.dp(f3);
                }
                if (messageObject10.type != 19) {
                    if (messageObject.isAnyKindOfSticker() && this.totalHeight < AndroidUtilities.dp(70.0f)) {
                        int dp73 = AndroidUtilities.dp(70.0f);
                        int i254 = this.totalHeight;
                        int i255 = dp73 - i254;
                        this.additionalTimeOffsetY = i255;
                        this.totalHeight = i254 + i255;
                    } else if (messageObject.isAnimatedEmoji()) {
                        this.additionalTimeOffsetY = AndroidUtilities.dp(16.0f);
                        this.totalHeight += AndroidUtilities.dp(16.0f);
                    }
                }
                if (!this.drawPhotoImage) {
                    this.photoImage.setImageBitmap(r6);
                }
                i58 = 5;
                if (this.documentAttachType == 5) {
                    if (MessageObject.isDocumentHasThumb(this.documentAttach)) {
                        this.radialProgress.setImageOverlay(FileLoader.getClosestPhotoSizeWithSize(this.documentAttach.thumbs, 90), this.documentAttach, messageObject10);
                    } else {
                        String artworkUrl = messageObject10.getArtworkUrl(true);
                        if (!TextUtils.isEmpty(artworkUrl)) {
                            this.radialProgress.setImageOverlay(artworkUrl);
                        } else {
                            this.radialProgress.setImageOverlay(r6, r6, r6);
                        }
                    }
                } else {
                    this.radialProgress.setImageOverlay(r6, r6, r6);
                }
                calculateUnlockXY();
                if (z26) {
                    int dp74 = AndroidUtilities.dp(4.0f);
                    int i256 = SharedConfig.bubbleRadius;
                    if (i256 > i34) {
                        dp10 = AndroidUtilities.dp(i256 - i34);
                    } else {
                        dp10 = AndroidUtilities.dp(i256);
                    }
                    int min6 = Math.min(AndroidUtilities.dp(3.0f), dp10);
                    if (dp74 > dp10) {
                        dp74 = dp10;
                    }
                    if (this.hasLinkPreview || this.hasGamePreview || this.hasInvoicePreview) {
                        dp10 = dp74;
                    }
                    int i257 = (this.forwardedNameLayout[0] == null && this.replyNameLayout == null && !this.drawNameLayout) ? dp10 : dp74;
                    if (this.captionLayout != null || this.drawCommentButton) {
                        dp10 = dp74;
                    }
                    if (this.documentAttachType != 1) {
                        i60 = dp10;
                        i59 = i257;
                    } else {
                        i59 = dp74;
                        i60 = i59;
                    }
                    MessageObject.GroupedMessagePosition groupedMessagePosition26 = this.currentPosition;
                    if (groupedMessagePosition26 != null && this.currentMessagesGroup != null) {
                        int i258 = groupedMessagePosition26.flags;
                        if ((i258 & 2) == 0) {
                            i59 = dp74;
                            i60 = i59;
                        }
                        if ((i258 & 1) == 0) {
                            dp10 = dp74;
                            i257 = dp10;
                        }
                        if ((i258 & 8) == 0) {
                            dp10 = dp74;
                            i60 = dp10;
                        }
                        if ((i258 & 4) == 0) {
                            i59 = dp74;
                            if (this.pinnedTop) {
                                if (!this.currentMessageObject.isOutOwner()) {
                                    dp74 = min6;
                                } else {
                                    i59 = min6;
                                }
                            }
                            if (this.pinnedBottom) {
                                if (!this.currentMessageObject.isOutOwner()) {
                                    dp10 = min6;
                                } else {
                                    i60 = min6;
                                }
                            }
                            if (!this.mediaBackground || this.currentMessageObject.isOutOwner()) {
                                min6 = dp10;
                            }
                            this.photoImage.setRoundRadius(dp74, i59, i60, min6);
                        }
                    }
                    dp74 = i257;
                    if (this.pinnedTop) {
                    }
                    if (this.pinnedBottom) {
                    }
                    if (!this.mediaBackground) {
                    }
                    min6 = dp10;
                    this.photoImage.setRoundRadius(dp74, i59, i60, min6);
                }
                updateAnimatedEmojis();
                r62 = r6;
            }
            if (z46) {
                this.currentUrl = r62;
                this.currentWebFile = r62;
                this.lastWebFile = r62;
                this.loadingProgressLayout = r62;
                this.animatingLoadingProgressProgress = f4;
                this.lastLoadingSizeTotal = 0L;
                this.selectedBackgroundProgress = f4;
                ValueAnimator valueAnimator = this.statusDrawableAnimator;
                if (valueAnimator != null) {
                    valueAnimator.removeAllListeners();
                    this.statusDrawableAnimator.cancel();
                }
                this.transitionParams.lastStatusDrawableParams = i54;
                this.statusDrawableAnimationInProgress = false;
                if (this.documentAttachType == i58) {
                    this.toSeekBarProgress = !MediaController.getInstance().isPlayingMessage(this.currentMessageObject) ? 0.0f : 1.0f;
                }
                this.seekBarWaveform.setProgress(f4);
                AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable swapAnimatedEmojiDrawable = this.currentNameStatusDrawable;
                if (swapAnimatedEmojiDrawable != null) {
                    swapAnimatedEmojiDrawable.play();
                }
            }
            transcribeButton = this.transcribeButton;
            if (transcribeButton != null) {
                TLRPC$Message tLRPC$Message7 = this.currentMessageObject.messageOwner;
                transcribeButton.setOpen(tLRPC$Message7 != null && tLRPC$Message7.voiceTranscriptionOpen && tLRPC$Message7.voiceTranscriptionFinal, !z46);
                this.transcribeButton.setLoading(TranscribeButton.isTranscribing(this.currentMessageObject), !z46);
            }
            updateWaveform();
            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
            if (!this.currentMessageObject.loadingCancelled && this.buttonState == i34 && this.documentAttachType == i33 && DownloadController.getInstance(this.currentAccount).canDownloadMedia(messageObject10)) {
                FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 1, 0);
                this.buttonState = 4;
                this.radialProgress.setIcon(getIconForCurrentState(), false, false);
            }
            chatMessageCellDelegate2 = this.delegate;
            if (chatMessageCellDelegate2 != null && chatMessageCellDelegate2.getTextSelectionHelper() != null && !z46 && z3) {
                this.delegate.getTextSelectionHelper().checkDataChanged(messageObject10);
            }
            this.accessibilityVirtualViewBounds.clear();
            this.transitionParams.updatePhotoImageX = true;
            updateFlagSecure();
        }
        z3 = true;
        MessageObject messageObject122 = this.currentMessageObject;
        if (messageObject122 != null) {
            if (groupedMessages != this.currentMessagesGroup) {
            }
            if (!z46) {
                messageObject10.copyStableParams(messageObject9);
            }
            this.accessibilityText = null;
            if (!this.drawCommentButton) {
            }
            z4 = true;
            if (!z3) {
                setCurrentDiceValue(this.isUpdating);
            }
            if (!z3) {
                if (MessageObject.getMedia(messageObject10.messageOwner) instanceof TLRPC$TL_messageMediaPoll) {
                }
                if (arrayList4 == null) {
                    if (!z43) {
                        z43 = true;
                    }
                    tLRPC$Poll2 = this.lastPoll;
                    if (tLRPC$Poll2 == tLRPC$Poll) {
                        if (!this.pollVoted) {
                        }
                        z6 = true;
                        this.animatePollAvatars = z44;
                        if (z6) {
                            this.pollAnimationProgressTime = 0.0f;
                            if (this.pollVoted) {
                                this.pollUnvoteInProgress = true;
                            }
                            int i1152 = this.lastPollResultsVoters;
                            if (i1152 == 0) {
                                this.animatePollAvatars = i1152 == 0 || (i1152 != 0 && i112 == 0);
                            }
                            this.animatePollAvatars = i1152 == 0 || (i1152 != 0 && i112 == 0);
                        }
                        if (!z46) {
                            size2 = tLRPC$TL_messageMediaPoll.results.results.size();
                            i113 = 0;
                            while (true) {
                                if (i113 < size2) {
                                }
                                i113++;
                            }
                            if (tLRPC$TL_pollAnswerVoters != null) {
                            }
                        }
                        if (!z5) {
                            if ((groupedMessages.messages.size() > 1 ? null : this.currentMessagesGroup.positions.get(this.currentMessageObject)) == this.currentPosition) {
                            }
                        }
                        i = -1;
                        f = 1.0f;
                        i2 = 2;
                        if (!z3) {
                            i54 = -1;
                            f4 = 0.0f;
                            r62 = 0;
                            i58 = 5;
                            i33 = 3;
                            i34 = 2;
                            if (z46) {
                            }
                            transcribeButton = this.transcribeButton;
                            if (transcribeButton != null) {
                            }
                            updateWaveform();
                            if (!z46) {
                                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                if (!this.currentMessageObject.loadingCancelled) {
                                    FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 1, 0);
                                    this.buttonState = 4;
                                    this.radialProgress.setIcon(getIconForCurrentState(), false, false);
                                }
                                chatMessageCellDelegate2 = this.delegate;
                                if (chatMessageCellDelegate2 != null) {
                                    this.delegate.getTextSelectionHelper().checkDataChanged(messageObject10);
                                }
                                this.accessibilityVirtualViewBounds.clear();
                                this.transitionParams.updatePhotoImageX = true;
                                updateFlagSecure();
                            }
                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                            if (!this.currentMessageObject.loadingCancelled) {
                            }
                            chatMessageCellDelegate2 = this.delegate;
                            if (chatMessageCellDelegate2 != null) {
                            }
                            this.accessibilityVirtualViewBounds.clear();
                            this.transitionParams.updatePhotoImageX = true;
                            updateFlagSecure();
                        }
                        this.wasPinned = this.isPinned;
                        this.pinnedBottom = z;
                        this.pinnedTop = z2;
                        this.currentMessageObject = messageObject10;
                        this.currentMessagesGroup = groupedMessages;
                        this.lastTime = -2;
                        this.lastPostAuthor = messageObject10.messageOwner.post_author;
                        this.isHighlightedAnimated = false;
                        this.widthBeforeNewTimeLine = -1;
                        if (groupedMessages != null) {
                            groupedMessagePosition = this.currentMessagesGroup.positions.get(this.currentMessageObject);
                            this.currentPosition = groupedMessagePosition;
                            if (groupedMessagePosition == null) {
                            }
                            groupedMessages2 = this.currentMessagesGroup;
                            if (groupedMessages2 == null) {
                                if (this.pinnedTop) {
                                    this.drawPinnedTop = this.pinnedTop && ((groupedMessagePosition17 = this.currentPosition) == null || (groupedMessagePosition17.flags & 4) != 0);
                                    if (this.pinnedBottom) {
                                        this.drawPinnedBottom = this.pinnedBottom && ((groupedMessagePosition16 = this.currentPosition) == null || (groupedMessagePosition16.flags & 8) != 0);
                                        if (this.isRoundVideo) {
                                            this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                                            this.photoImage.setCrossfadeWithOldImage(false);
                                            this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                                            this.photoImage.setGradientBitmap(null);
                                            TLRPC$Message tLRPC$Message52 = messageObject10.messageOwner;
                                            this.lastSendState = tLRPC$Message52.send_state;
                                            this.lastDeleteDate = tLRPC$Message52.destroyTime;
                                            this.lastViewsCount = tLRPC$Message52.views;
                                            this.lastRepliesCount = getRepliesCount();
                                            if (!z46) {
                                            }
                                            this.gamePreviewPressed = z7;
                                            this.sideButtonPressed = z7;
                                            this.hasNewLineForTime = z7;
                                            this.flipImage = z7;
                                            if (!this.isThreadChat) {
                                                this.isThreadPost = z47;
                                                if (!z47) {
                                                    this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                                                    if (this.isChat) {
                                                        if (messageObject10.customAvatarDrawable != null) {
                                                        }
                                                        this.wasLayout = r2;
                                                        this.groupPhotoInvisible = r2;
                                                        int i1172 = r2 == true ? 1 : 0;
                                                        int i1182 = r2 == true ? 1 : 0;
                                                        this.animatingDrawVideoImageButton = i1172;
                                                        this.drawVideoSize = r2;
                                                        this.canStreamVideo = r2;
                                                        this.animatingNoSound = r2;
                                                        if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                                                            if (!this.isRepliesChat) {
                                                                this.drawSideButton = i119;
                                                                if (!this.isPinnedChat) {
                                                                }
                                                                this.drawSideButton = 2;
                                                                r22 = 0;
                                                                this.replyNameLayout = null;
                                                                this.adminLayout = null;
                                                                this.checkOnlyButtonPressed = r22;
                                                                this.replyTextLayout = null;
                                                                AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                                                this.lastReplyMessage = null;
                                                                this.hasEmbed = r22;
                                                                this.autoPlayingMedia = r22;
                                                                int i1202 = r22 == true ? 1 : 0;
                                                                int i1212 = r22 == true ? 1 : 0;
                                                                this.replyNameWidth = i1202;
                                                                this.replyTextWidth = r22;
                                                                this.viaWidth = r22;
                                                                this.viaNameWidth = r22;
                                                                this.addedCaptionHeight = r22;
                                                                this.currentReplyPhoto = null;
                                                                this.currentUser = null;
                                                                this.currentChat = null;
                                                                this.currentViaBotUser = null;
                                                                this.instantViewLayout = null;
                                                                this.drawNameLayout = r22;
                                                                this.lastLoadingSizeTotal = 0L;
                                                                if (this.scheduledInvalidate) {
                                                                }
                                                                this.links.clear();
                                                                this.pressedLink = null;
                                                                this.pressedEmoji = null;
                                                                this.pressedLinkType = -1;
                                                                messageObject10.forceUpdate = r22;
                                                                this.drawPhotoImage = r22;
                                                                this.drawMediaCheckBox = r22;
                                                                this.hasLinkPreview = r22;
                                                                this.hasOldCaptionPreview = r22;
                                                                this.hasGamePreview = r22;
                                                                this.hasInvoicePreview = r22;
                                                                this.commentButtonPressed = r22;
                                                                this.instantButtonPressed = r22;
                                                                this.instantPressed = r22;
                                                                if (!z6) {
                                                                    i3 = 0;
                                                                    while (true) {
                                                                        drawableArr = this.selectorDrawable;
                                                                        if (i3 < drawableArr.length) {
                                                                        }
                                                                        i3++;
                                                                        z4 = z49;
                                                                        f = 1.0f;
                                                                        i2 = 2;
                                                                        r13 = 1;
                                                                        i = -1;
                                                                    }
                                                                }
                                                                this.spoilerPressed = null;
                                                                this.isCaptionSpoilerPressed = false;
                                                                this.isSpoilerRevealing = false;
                                                                this.linkPreviewPressed = false;
                                                                this.buttonPressed = 0;
                                                                this.additionalTimeOffsetY = 0;
                                                                this.miniButtonPressed = 0;
                                                                this.pressedBotButton = i;
                                                                this.pressedVoteButton = i;
                                                                this.pollHintPressed = false;
                                                                this.psaHintPressed = false;
                                                                this.linkPreviewHeight = 0;
                                                                this.mediaOffsetY = 0;
                                                                this.documentAttachType = 0;
                                                                this.documentAttach = null;
                                                                this.descriptionLayout = null;
                                                                this.titleLayout = null;
                                                                this.videoInfoLayout = null;
                                                                this.photosCountLayout = null;
                                                                this.siteNameLayout = null;
                                                                this.authorLayout = null;
                                                                this.captionLayout = null;
                                                                this.captionWidth = 0;
                                                                this.captionHeight = 0;
                                                                this.captionOffsetX = 0;
                                                                this.currentCaption = null;
                                                                this.docTitleLayout = null;
                                                                this.drawImageButton = false;
                                                                this.drawVideoImageButton = false;
                                                                this.currentPhotoObject = null;
                                                                this.photoParentObject = null;
                                                                this.currentPhotoObjectThumb = null;
                                                                this.currentPhotoObjectThumbStripped = null;
                                                                if (!z3) {
                                                                }
                                                                this.currentPhotoFilter = null;
                                                                this.buttonState = i;
                                                                this.miniButtonState = i;
                                                                this.hasMiniProgress = 0;
                                                                if (this.addedForTest) {
                                                                    ImageLoader.getInstance().removeTestWebFile(this.currentUrl);
                                                                }
                                                                this.addedForTest = false;
                                                                this.photoNotSet = false;
                                                                this.drawBackground = r13;
                                                                this.drawName = false;
                                                                this.useSeekBarWaveform = false;
                                                                this.useTranscribeButton = false;
                                                                this.drawInstantView = false;
                                                                this.drawInstantViewType = 0;
                                                                this.drawForwardedName = false;
                                                                this.drawCommentButton = false;
                                                                this.photoImage.setSideClip(0.0f);
                                                                this.photoImage.setAspectFit(false);
                                                                this.gradientShader = null;
                                                                this.motionBackgroundDrawable = null;
                                                                this.imageBackgroundColor = 0;
                                                                this.imageBackgroundGradientColor1 = 0;
                                                                this.imageBackgroundGradientColor2 = 0;
                                                                this.imageBackgroundIntensity = 0.0f;
                                                                this.imageBackgroundGradientColor3 = 0;
                                                                this.imageBackgroundGradientRotation = 45;
                                                                this.imageBackgroundSideColor = 0;
                                                                this.mediaBackground = false;
                                                                this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                                                TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader22 = messageObject10.messageOwner.fwd_from;
                                                                if (tLRPC$MessageFwdHeader22 != null) {
                                                                    this.hasPsaHint = z9;
                                                                    if (z9) {
                                                                    }
                                                                    this.photoImage.setAlpha(f);
                                                                    if (!z3) {
                                                                    }
                                                                    this.pollButtons.clear();
                                                                    this.availableTimeWidth = 0;
                                                                    this.photoImage.setForceLoading(false);
                                                                    this.photoImage.setNeedsQualityThumb(false);
                                                                    this.photoImage.setShouldGenerateQualityThumb(false);
                                                                    this.photoImage.setAllowDecodeSingleFrame(false);
                                                                    this.photoImage.setColorFilter(null);
                                                                    this.photoImage.setMediaStartEndTime(-1L, -1L);
                                                                    if (!z46) {
                                                                    }
                                                                    messageObject10.reactionsChanged = false;
                                                                    groupedMessagePosition3 = this.currentPosition;
                                                                    if (groupedMessagePosition3 == null) {
                                                                        this.reactionsLayoutInBubble.setMessage(null, false, this.resourcesProvider);
                                                                        if (z3) {
                                                                        }
                                                                        groupedMessages3 = this.currentMessagesGroup;
                                                                        if (groupedMessages3 != null) {
                                                                            isLinkedToChat = this.currentMessagesGroup.messages.get(0).isLinkedToChat(this.linkedChatId);
                                                                            if (this.hasDiscussion) {
                                                                                repliesCount = getRepliesCount();
                                                                                if (!messageObject.shouldDrawWithoutBackground()) {
                                                                                    this.drawCommentButton = r13;
                                                                                    if (this.commentProgress == null) {
                                                                                    }
                                                                                    if (!this.isRepliesChat) {
                                                                                    }
                                                                                    i111 = 0;
                                                                                    int ceil322 = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(string6));
                                                                                    this.totalCommentWidth = ceil322;
                                                                                    this.commentWidth = ceil322;
                                                                                    this.commentLayout = new StaticLayout(string6, Theme.chat_replyNamePaint, this.commentWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                                                    if (repliesCount != 0) {
                                                                                    }
                                                                                    this.drawCommentNumber = false;
                                                                                    animatedNumberLayout2 = this.commentNumberLayout;
                                                                                    if (animatedNumberLayout2 != null) {
                                                                                    }
                                                                                    this.totalCommentWidth += AndroidUtilities.dp(i111 + 70);
                                                                                    i5 = messageObject10.type;
                                                                                    float f92 = 102.0f;
                                                                                    if (i5 == 0) {
                                                                                    }
                                                                                    if (this.currentPosition != null) {
                                                                                    }
                                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                                        if (messageObject.isVoiceTranscriptionOpen()) {
                                                                                        }
                                                                                        this.currentCaption = voiceTranscription;
                                                                                        if (voiceTranscription != null) {
                                                                                            str17 = ((Object) this.currentCaption) + " ";
                                                                                            this.currentCaption = str17;
                                                                                            if (!(str17 instanceof Spannable)) {
                                                                                            }
                                                                                            ((SpannableString) this.currentCaption).setSpan(new TranscribeButton.LoadingPointsSpan(), this.currentCaption.length() - 1, this.currentCaption.length(), 33);
                                                                                        }
                                                                                        int i2482 = this.backgroundWidth;
                                                                                        if (messageObject.isVoiceTranscriptionOpen()) {
                                                                                        }
                                                                                        int dp672 = ((i2482 - AndroidUtilities.dp(31.0f)) - AndroidUtilities.dp(10.0f)) - (getExtraTextX() * 2);
                                                                                        if (Build.VERSION.SDK_INT < 24) {
                                                                                        }
                                                                                        updateSeekBarWaveformWidth();
                                                                                        updateCaptionSpoilers();
                                                                                    }
                                                                                    if (this.captionLayout == null) {
                                                                                    }
                                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                                        float dp682 = ((this.backgroundWidth - AndroidUtilities.dp(31.0f)) - AndroidUtilities.dp(10.0f)) - (getExtraTextX() * 2);
                                                                                        float f392 = dp682;
                                                                                        while (i52 < this.captionLayout.getLineCount()) {
                                                                                        }
                                                                                        this.backgroundWidth = (int) (this.backgroundWidth + (f392 - dp682));
                                                                                    }
                                                                                    int dp5122222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                                    staticLayout2 = this.captionLayout;
                                                                                    if (staticLayout2 == null) {
                                                                                        StaticLayout staticLayout222 = this.captionLayout;
                                                                                        float lineWidth32 = staticLayout222.getLineWidth(staticLayout222.getLineCount() - 1);
                                                                                        StaticLayout staticLayout232 = this.captionLayout;
                                                                                        valueOf = Float.valueOf(lineWidth32 + staticLayout232.getLineLeft(staticLayout232.getLineCount() - 1));
                                                                                        if (valueOf != null) {
                                                                                        }
                                                                                        groupedMessagePosition4 = this.currentPosition;
                                                                                        if (groupedMessagePosition4 != null) {
                                                                                        }
                                                                                        int i20022222222222222 = this.widthBeforeNewTimeLine;
                                                                                        i54 = -1;
                                                                                        messageObject4 = this.currentMessageObject;
                                                                                        if (messageObject4.eventId == 0) {
                                                                                            int dp692 = this.backgroundWidth - AndroidUtilities.dp(41.0f);
                                                                                            this.hasOldCaptionPreview = true;
                                                                                            this.linkPreviewHeight = 0;
                                                                                            TLRPC$WebPage tLRPC$WebPage2 = MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage;
                                                                                            int ceil232 = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(tLRPC$WebPage2.site_name) + f3);
                                                                                            this.siteNameWidth = ceil232;
                                                                                            StaticLayout staticLayout252 = new StaticLayout(tLRPC$WebPage2.site_name, Theme.chat_replyNamePaint, Math.min(ceil232, dp692), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                                                            this.siteNameLayout = staticLayout252;
                                                                                            float lineLeft32 = staticLayout252.getLineLeft(0);
                                                                                            f4 = 0.0f;
                                                                                            this.siteNameRtl = lineLeft32 == 0.0f;
                                                                                            StaticLayout staticLayout262 = this.siteNameLayout;
                                                                                            int lineBottom52 = staticLayout262.getLineBottom(staticLayout262.getLineCount() - 1);
                                                                                            this.linkPreviewHeight += lineBottom52;
                                                                                            this.totalHeight += lineBottom52;
                                                                                            this.descriptionX = 0;
                                                                                            if (this.linkPreviewHeight != 0) {
                                                                                            }
                                                                                            StaticLayout createStaticLayout22 = StaticLayoutEx.createStaticLayout(tLRPC$WebPage2.description, Theme.chat_replyTextPaint, dp692, Layout.Alignment.ALIGN_NORMAL, 1.0f, AndroidUtilities.dp(f3), false, TextUtils.TruncateAt.END, dp692, 6);
                                                                                            this.descriptionLayout = createStaticLayout22;
                                                                                            int lineBottom622 = createStaticLayout22.getLineBottom(createStaticLayout22.getLineCount() - 1);
                                                                                            this.linkPreviewHeight += lineBottom622;
                                                                                            this.totalHeight += lineBottom622;
                                                                                            z27 = false;
                                                                                            while (i56 < this.descriptionLayout.getLineCount()) {
                                                                                            }
                                                                                            if (z27) {
                                                                                            }
                                                                                            i55 = messageObject10.type;
                                                                                            if (i55 != 1) {
                                                                                            }
                                                                                            this.totalHeight += AndroidUtilities.dp(6.0f);
                                                                                            int dp7022 = this.totalHeight + AndroidUtilities.dp(17.0f);
                                                                                            this.totalHeight = dp7022;
                                                                                            if (i50 != 0) {
                                                                                            }
                                                                                            if (messageObject.isSponsored()) {
                                                                                            }
                                                                                            this.botButtons.clear();
                                                                                            if (z46) {
                                                                                            }
                                                                                            if (!messageObject10.isRestrictedMessage) {
                                                                                                TLRPC$ReplyMarkup tLRPC$ReplyMarkup2 = messageObject10.messageOwner.reply_markup;
                                                                                                if (tLRPC$ReplyMarkup2 instanceof TLRPC$TL_replyInlineMarkup) {
                                                                                                }
                                                                                                int dp712 = (AndroidUtilities.dp(48.0f) * size15) + AndroidUtilities.dp(f3);
                                                                                                this.keyboardHeight = dp712;
                                                                                                this.substractBackgroundHeight = dp712;
                                                                                                dp9 = this.backgroundWidth - AndroidUtilities.dp(this.mediaBackground ? 9.0f : 0.0f);
                                                                                                this.widthForButtons = dp9;
                                                                                                if (messageObject10.wantedBotKeyboardWidth > dp9) {
                                                                                                }
                                                                                                HashMap hashMap42 = new HashMap(this.botButtonsByData);
                                                                                                sb = messageObject10.botButtonsLayout;
                                                                                                if (sb != null) {
                                                                                                    hashMap2 = new HashMap(this.botButtonsByPosition);
                                                                                                    this.botButtonsByData.clear();
                                                                                                    if (!(messageObject10.messageOwner.reply_markup instanceof TLRPC$TL_replyInlineMarkup)) {
                                                                                                    }
                                                                                                    this.widthForButtons = i57;
                                                                                                    r6 = hashMap3;
                                                                                                    if (this.drawCommentButton) {
                                                                                                    }
                                                                                                    z29 = this.drawPinnedBottom;
                                                                                                    if (z29) {
                                                                                                        this.totalHeight -= AndroidUtilities.dp(2.0f);
                                                                                                        if (messageObject10.type != 19) {
                                                                                                        }
                                                                                                        if (!this.drawPhotoImage) {
                                                                                                        }
                                                                                                        i58 = 5;
                                                                                                        if (this.documentAttachType == 5) {
                                                                                                        }
                                                                                                        calculateUnlockXY();
                                                                                                        if (z26) {
                                                                                                        }
                                                                                                        updateAnimatedEmojis();
                                                                                                        r62 = r6;
                                                                                                        if (z46) {
                                                                                                        }
                                                                                                        transcribeButton = this.transcribeButton;
                                                                                                        if (transcribeButton != null) {
                                                                                                        }
                                                                                                        updateWaveform();
                                                                                                        updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                                        if (!this.currentMessageObject.loadingCancelled) {
                                                                                                        }
                                                                                                        chatMessageCellDelegate2 = this.delegate;
                                                                                                        if (chatMessageCellDelegate2 != null) {
                                                                                                        }
                                                                                                        this.accessibilityVirtualViewBounds.clear();
                                                                                                        this.transitionParams.updatePhotoImageX = true;
                                                                                                        updateFlagSecure();
                                                                                                    }
                                                                                                    if (!z29) {
                                                                                                    }
                                                                                                    if (messageObject10.type != 19) {
                                                                                                    }
                                                                                                    if (!this.drawPhotoImage) {
                                                                                                    }
                                                                                                    i58 = 5;
                                                                                                    if (this.documentAttachType == 5) {
                                                                                                    }
                                                                                                    calculateUnlockXY();
                                                                                                    if (z26) {
                                                                                                    }
                                                                                                    updateAnimatedEmojis();
                                                                                                    r62 = r6;
                                                                                                    if (z46) {
                                                                                                    }
                                                                                                    transcribeButton = this.transcribeButton;
                                                                                                    if (transcribeButton != null) {
                                                                                                    }
                                                                                                    updateWaveform();
                                                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                                                    }
                                                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                                                    if (chatMessageCellDelegate2 != null) {
                                                                                                    }
                                                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                                                    updateFlagSecure();
                                                                                                }
                                                                                                sb2 = messageObject10.botButtonsLayout;
                                                                                                if (sb2 != null) {
                                                                                                }
                                                                                                hashMap2 = hashMap;
                                                                                                this.botButtonsByData.clear();
                                                                                                if (!(messageObject10.messageOwner.reply_markup instanceof TLRPC$TL_replyInlineMarkup)) {
                                                                                                }
                                                                                                this.widthForButtons = i57;
                                                                                                r6 = hashMap3;
                                                                                                if (this.drawCommentButton) {
                                                                                                }
                                                                                                z29 = this.drawPinnedBottom;
                                                                                                if (z29) {
                                                                                                }
                                                                                                if (!z29) {
                                                                                                }
                                                                                                if (messageObject10.type != 19) {
                                                                                                }
                                                                                                if (!this.drawPhotoImage) {
                                                                                                }
                                                                                                i58 = 5;
                                                                                                if (this.documentAttachType == 5) {
                                                                                                }
                                                                                                calculateUnlockXY();
                                                                                                if (z26) {
                                                                                                }
                                                                                                updateAnimatedEmojis();
                                                                                                r62 = r6;
                                                                                                if (z46) {
                                                                                                }
                                                                                                transcribeButton = this.transcribeButton;
                                                                                                if (transcribeButton != null) {
                                                                                                }
                                                                                                updateWaveform();
                                                                                                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                                if (!this.currentMessageObject.loadingCancelled) {
                                                                                                }
                                                                                                chatMessageCellDelegate2 = this.delegate;
                                                                                                if (chatMessageCellDelegate2 != null) {
                                                                                                }
                                                                                                this.accessibilityVirtualViewBounds.clear();
                                                                                                this.transitionParams.updatePhotoImageX = true;
                                                                                                updateFlagSecure();
                                                                                            }
                                                                                            this.substractBackgroundHeight = 0;
                                                                                            this.keyboardHeight = 0;
                                                                                            r6 = hashMap;
                                                                                            if (this.drawCommentButton) {
                                                                                            }
                                                                                            z29 = this.drawPinnedBottom;
                                                                                            if (z29) {
                                                                                            }
                                                                                            if (!z29) {
                                                                                            }
                                                                                            if (messageObject10.type != 19) {
                                                                                            }
                                                                                            if (!this.drawPhotoImage) {
                                                                                            }
                                                                                            i58 = 5;
                                                                                            if (this.documentAttachType == 5) {
                                                                                            }
                                                                                            calculateUnlockXY();
                                                                                            if (z26) {
                                                                                            }
                                                                                            updateAnimatedEmojis();
                                                                                            r62 = r6;
                                                                                            if (z46) {
                                                                                            }
                                                                                            transcribeButton = this.transcribeButton;
                                                                                            if (transcribeButton != null) {
                                                                                            }
                                                                                            updateWaveform();
                                                                                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                            if (!this.currentMessageObject.loadingCancelled) {
                                                                                            }
                                                                                            chatMessageCellDelegate2 = this.delegate;
                                                                                            if (chatMessageCellDelegate2 != null) {
                                                                                            }
                                                                                            this.accessibilityVirtualViewBounds.clear();
                                                                                            this.transitionParams.updatePhotoImageX = true;
                                                                                            updateFlagSecure();
                                                                                        }
                                                                                        f4 = 0.0f;
                                                                                        if (messageObject.isSponsored()) {
                                                                                        }
                                                                                        this.botButtons.clear();
                                                                                        if (z46) {
                                                                                        }
                                                                                        if (!messageObject10.isRestrictedMessage) {
                                                                                        }
                                                                                        this.substractBackgroundHeight = 0;
                                                                                        this.keyboardHeight = 0;
                                                                                        r6 = hashMap;
                                                                                        if (this.drawCommentButton) {
                                                                                        }
                                                                                        z29 = this.drawPinnedBottom;
                                                                                        if (z29) {
                                                                                        }
                                                                                        if (!z29) {
                                                                                        }
                                                                                        if (messageObject10.type != 19) {
                                                                                        }
                                                                                        if (!this.drawPhotoImage) {
                                                                                        }
                                                                                        i58 = 5;
                                                                                        if (this.documentAttachType == 5) {
                                                                                        }
                                                                                        calculateUnlockXY();
                                                                                        if (z26) {
                                                                                        }
                                                                                        updateAnimatedEmojis();
                                                                                        r62 = r6;
                                                                                        if (z46) {
                                                                                        }
                                                                                        transcribeButton = this.transcribeButton;
                                                                                        if (transcribeButton != null) {
                                                                                        }
                                                                                        updateWaveform();
                                                                                        updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                        if (!this.currentMessageObject.loadingCancelled) {
                                                                                        }
                                                                                        chatMessageCellDelegate2 = this.delegate;
                                                                                        if (chatMessageCellDelegate2 != null) {
                                                                                        }
                                                                                        this.accessibilityVirtualViewBounds.clear();
                                                                                        this.transitionParams.updatePhotoImageX = true;
                                                                                        updateFlagSecure();
                                                                                    }
                                                                                    if (this.currentMessageObject.type != i34) {
                                                                                    }
                                                                                    if (valueOf != null) {
                                                                                    }
                                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                                    if (groupedMessagePosition4 != null) {
                                                                                    }
                                                                                    int i200222222222222222 = this.widthBeforeNewTimeLine;
                                                                                    i54 = -1;
                                                                                    messageObject4 = this.currentMessageObject;
                                                                                    if (messageObject4.eventId == 0) {
                                                                                    }
                                                                                    f4 = 0.0f;
                                                                                    if (messageObject.isSponsored()) {
                                                                                    }
                                                                                    this.botButtons.clear();
                                                                                    if (z46) {
                                                                                    }
                                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                                    }
                                                                                    this.substractBackgroundHeight = 0;
                                                                                    this.keyboardHeight = 0;
                                                                                    r6 = hashMap;
                                                                                    if (this.drawCommentButton) {
                                                                                    }
                                                                                    z29 = this.drawPinnedBottom;
                                                                                    if (z29) {
                                                                                    }
                                                                                    if (!z29) {
                                                                                    }
                                                                                    if (messageObject10.type != 19) {
                                                                                    }
                                                                                    if (!this.drawPhotoImage) {
                                                                                    }
                                                                                    i58 = 5;
                                                                                    if (this.documentAttachType == 5) {
                                                                                    }
                                                                                    calculateUnlockXY();
                                                                                    if (z26) {
                                                                                    }
                                                                                    updateAnimatedEmojis();
                                                                                    r62 = r6;
                                                                                    if (z46) {
                                                                                    }
                                                                                    transcribeButton = this.transcribeButton;
                                                                                    if (transcribeButton != null) {
                                                                                    }
                                                                                    updateWaveform();
                                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                                    }
                                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                                    if (chatMessageCellDelegate2 != null) {
                                                                                    }
                                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                                    updateFlagSecure();
                                                                                }
                                                                                if (!this.isRepliesChat) {
                                                                                    String formatShortNumber2 = LocaleController.formatShortNumber(repliesCount, null);
                                                                                    int ceil42 = (int) Math.ceil(Theme.chat_stickerCommentCountPaint.measureText(formatShortNumber2));
                                                                                    this.totalCommentWidth = ceil42;
                                                                                    this.commentWidth = ceil42;
                                                                                    this.commentLayout = new StaticLayout(formatShortNumber2, Theme.chat_stickerCommentCountPaint, this.commentWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                                                                    this.drawCommentNumber = false;
                                                                                    this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                                                    i5 = messageObject10.type;
                                                                                    float f922 = 102.0f;
                                                                                    if (i5 == 0) {
                                                                                    }
                                                                                    if (this.currentPosition != null) {
                                                                                    }
                                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                                    }
                                                                                    if (this.captionLayout == null) {
                                                                                    }
                                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                                    }
                                                                                    int dp51222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                                    staticLayout2 = this.captionLayout;
                                                                                    if (staticLayout2 == null) {
                                                                                    }
                                                                                    if (this.currentMessageObject.type != i34) {
                                                                                    }
                                                                                    if (valueOf != null) {
                                                                                    }
                                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                                    if (groupedMessagePosition4 != null) {
                                                                                    }
                                                                                    int i2002222222222222222 = this.widthBeforeNewTimeLine;
                                                                                    i54 = -1;
                                                                                    messageObject4 = this.currentMessageObject;
                                                                                    if (messageObject4.eventId == 0) {
                                                                                    }
                                                                                    f4 = 0.0f;
                                                                                    if (messageObject.isSponsored()) {
                                                                                    }
                                                                                    this.botButtons.clear();
                                                                                    if (z46) {
                                                                                    }
                                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                                    }
                                                                                    this.substractBackgroundHeight = 0;
                                                                                    this.keyboardHeight = 0;
                                                                                    r6 = hashMap;
                                                                                    if (this.drawCommentButton) {
                                                                                    }
                                                                                    z29 = this.drawPinnedBottom;
                                                                                    if (z29) {
                                                                                    }
                                                                                    if (!z29) {
                                                                                    }
                                                                                    if (messageObject10.type != 19) {
                                                                                    }
                                                                                    if (!this.drawPhotoImage) {
                                                                                    }
                                                                                    i58 = 5;
                                                                                    if (this.documentAttachType == 5) {
                                                                                    }
                                                                                    calculateUnlockXY();
                                                                                    if (z26) {
                                                                                    }
                                                                                    updateAnimatedEmojis();
                                                                                    r62 = r6;
                                                                                    if (z46) {
                                                                                    }
                                                                                    transcribeButton = this.transcribeButton;
                                                                                    if (transcribeButton != null) {
                                                                                    }
                                                                                    updateWaveform();
                                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                                    }
                                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                                    if (chatMessageCellDelegate2 != null) {
                                                                                    }
                                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                                    updateFlagSecure();
                                                                                }
                                                                                this.commentLayout = null;
                                                                                this.drawCommentNumber = false;
                                                                                this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                                                i5 = messageObject10.type;
                                                                                float f9222 = 102.0f;
                                                                                if (i5 == 0) {
                                                                                }
                                                                                if (this.currentPosition != null) {
                                                                                }
                                                                                if (!messageObject10.isRestrictedMessage) {
                                                                                }
                                                                                if (this.captionLayout == null) {
                                                                                }
                                                                                if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                                }
                                                                                int dp512222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                                staticLayout2 = this.captionLayout;
                                                                                if (staticLayout2 == null) {
                                                                                }
                                                                                if (this.currentMessageObject.type != i34) {
                                                                                }
                                                                                if (valueOf != null) {
                                                                                }
                                                                                groupedMessagePosition4 = this.currentPosition;
                                                                                if (groupedMessagePosition4 != null) {
                                                                                }
                                                                                int i20022222222222222222 = this.widthBeforeNewTimeLine;
                                                                                i54 = -1;
                                                                                messageObject4 = this.currentMessageObject;
                                                                                if (messageObject4.eventId == 0) {
                                                                                }
                                                                                f4 = 0.0f;
                                                                                if (messageObject.isSponsored()) {
                                                                                }
                                                                                this.botButtons.clear();
                                                                                if (z46) {
                                                                                }
                                                                                if (!messageObject10.isRestrictedMessage) {
                                                                                }
                                                                                this.substractBackgroundHeight = 0;
                                                                                this.keyboardHeight = 0;
                                                                                r6 = hashMap;
                                                                                if (this.drawCommentButton) {
                                                                                }
                                                                                z29 = this.drawPinnedBottom;
                                                                                if (z29) {
                                                                                }
                                                                                if (!z29) {
                                                                                }
                                                                                if (messageObject10.type != 19) {
                                                                                }
                                                                                if (!this.drawPhotoImage) {
                                                                                }
                                                                                i58 = 5;
                                                                                if (this.documentAttachType == 5) {
                                                                                }
                                                                                calculateUnlockXY();
                                                                                if (z26) {
                                                                                }
                                                                                updateAnimatedEmojis();
                                                                                r62 = r6;
                                                                                if (z46) {
                                                                                }
                                                                                transcribeButton = this.transcribeButton;
                                                                                if (transcribeButton != null) {
                                                                                }
                                                                                updateWaveform();
                                                                                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                                if (!this.currentMessageObject.loadingCancelled) {
                                                                                }
                                                                                chatMessageCellDelegate2 = this.delegate;
                                                                                if (chatMessageCellDelegate2 != null) {
                                                                                }
                                                                                this.accessibilityVirtualViewBounds.clear();
                                                                                this.transitionParams.updatePhotoImageX = true;
                                                                                updateFlagSecure();
                                                                            }
                                                                            repliesCount = getRepliesCount();
                                                                            if (!messageObject.shouldDrawWithoutBackground()) {
                                                                            }
                                                                            if (!this.isRepliesChat) {
                                                                            }
                                                                            this.commentLayout = null;
                                                                            this.drawCommentNumber = false;
                                                                            this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                                            i5 = messageObject10.type;
                                                                            float f92222 = 102.0f;
                                                                            if (i5 == 0) {
                                                                            }
                                                                            if (this.currentPosition != null) {
                                                                            }
                                                                            if (!messageObject10.isRestrictedMessage) {
                                                                            }
                                                                            if (this.captionLayout == null) {
                                                                            }
                                                                            if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                            }
                                                                            int dp5122222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                            staticLayout2 = this.captionLayout;
                                                                            if (staticLayout2 == null) {
                                                                            }
                                                                            if (this.currentMessageObject.type != i34) {
                                                                            }
                                                                            if (valueOf != null) {
                                                                            }
                                                                            groupedMessagePosition4 = this.currentPosition;
                                                                            if (groupedMessagePosition4 != null) {
                                                                            }
                                                                            int i200222222222222222222 = this.widthBeforeNewTimeLine;
                                                                            i54 = -1;
                                                                            messageObject4 = this.currentMessageObject;
                                                                            if (messageObject4.eventId == 0) {
                                                                            }
                                                                            f4 = 0.0f;
                                                                            if (messageObject.isSponsored()) {
                                                                            }
                                                                            this.botButtons.clear();
                                                                            if (z46) {
                                                                            }
                                                                            if (!messageObject10.isRestrictedMessage) {
                                                                            }
                                                                            this.substractBackgroundHeight = 0;
                                                                            this.keyboardHeight = 0;
                                                                            r6 = hashMap;
                                                                            if (this.drawCommentButton) {
                                                                            }
                                                                            z29 = this.drawPinnedBottom;
                                                                            if (z29) {
                                                                            }
                                                                            if (!z29) {
                                                                            }
                                                                            if (messageObject10.type != 19) {
                                                                            }
                                                                            if (!this.drawPhotoImage) {
                                                                            }
                                                                            i58 = 5;
                                                                            if (this.documentAttachType == 5) {
                                                                            }
                                                                            calculateUnlockXY();
                                                                            if (z26) {
                                                                            }
                                                                            updateAnimatedEmojis();
                                                                            r62 = r6;
                                                                            if (z46) {
                                                                            }
                                                                            transcribeButton = this.transcribeButton;
                                                                            if (transcribeButton != null) {
                                                                            }
                                                                            updateWaveform();
                                                                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                            if (!this.currentMessageObject.loadingCancelled) {
                                                                            }
                                                                            chatMessageCellDelegate2 = this.delegate;
                                                                            if (chatMessageCellDelegate2 != null) {
                                                                            }
                                                                            this.accessibilityVirtualViewBounds.clear();
                                                                            this.transitionParams.updatePhotoImageX = true;
                                                                            updateFlagSecure();
                                                                        }
                                                                        isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                                                        if (this.hasDiscussion) {
                                                                        }
                                                                        repliesCount = getRepliesCount();
                                                                        if (!messageObject.shouldDrawWithoutBackground()) {
                                                                        }
                                                                        if (!this.isRepliesChat) {
                                                                        }
                                                                        this.commentLayout = null;
                                                                        this.drawCommentNumber = false;
                                                                        this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                                        i5 = messageObject10.type;
                                                                        float f922222 = 102.0f;
                                                                        if (i5 == 0) {
                                                                        }
                                                                        if (this.currentPosition != null) {
                                                                        }
                                                                        if (!messageObject10.isRestrictedMessage) {
                                                                        }
                                                                        if (this.captionLayout == null) {
                                                                        }
                                                                        if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                        }
                                                                        int dp51222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                        staticLayout2 = this.captionLayout;
                                                                        if (staticLayout2 == null) {
                                                                        }
                                                                        if (this.currentMessageObject.type != i34) {
                                                                        }
                                                                        if (valueOf != null) {
                                                                        }
                                                                        groupedMessagePosition4 = this.currentPosition;
                                                                        if (groupedMessagePosition4 != null) {
                                                                        }
                                                                        int i2002222222222222222222 = this.widthBeforeNewTimeLine;
                                                                        i54 = -1;
                                                                        messageObject4 = this.currentMessageObject;
                                                                        if (messageObject4.eventId == 0) {
                                                                        }
                                                                        f4 = 0.0f;
                                                                        if (messageObject.isSponsored()) {
                                                                        }
                                                                        this.botButtons.clear();
                                                                        if (z46) {
                                                                        }
                                                                        if (!messageObject10.isRestrictedMessage) {
                                                                        }
                                                                        this.substractBackgroundHeight = 0;
                                                                        this.keyboardHeight = 0;
                                                                        r6 = hashMap;
                                                                        if (this.drawCommentButton) {
                                                                        }
                                                                        z29 = this.drawPinnedBottom;
                                                                        if (z29) {
                                                                        }
                                                                        if (!z29) {
                                                                        }
                                                                        if (messageObject10.type != 19) {
                                                                        }
                                                                        if (!this.drawPhotoImage) {
                                                                        }
                                                                        i58 = 5;
                                                                        if (this.documentAttachType == 5) {
                                                                        }
                                                                        calculateUnlockXY();
                                                                        if (z26) {
                                                                        }
                                                                        updateAnimatedEmojis();
                                                                        r62 = r6;
                                                                        if (z46) {
                                                                        }
                                                                        transcribeButton = this.transcribeButton;
                                                                        if (transcribeButton != null) {
                                                                        }
                                                                        updateWaveform();
                                                                        updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                        if (!this.currentMessageObject.loadingCancelled) {
                                                                        }
                                                                        chatMessageCellDelegate2 = this.delegate;
                                                                        if (chatMessageCellDelegate2 != null) {
                                                                        }
                                                                        this.accessibilityVirtualViewBounds.clear();
                                                                        this.transitionParams.updatePhotoImageX = true;
                                                                        updateFlagSecure();
                                                                    }
                                                                    if (!messageObject.shouldDrawReactionsInLayout()) {
                                                                    }
                                                                    if (z10) {
                                                                        int i1222 = 0;
                                                                        int i1232 = 0;
                                                                        while (i4 < messageObject10.messageOwner.reactions.results.size()) {
                                                                        }
                                                                    }
                                                                    if (this.currentPosition != null) {
                                                                    }
                                                                    if (z3) {
                                                                    }
                                                                    groupedMessages3 = this.currentMessagesGroup;
                                                                    if (groupedMessages3 != null) {
                                                                    }
                                                                    isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                                                    if (this.hasDiscussion) {
                                                                    }
                                                                    repliesCount = getRepliesCount();
                                                                    if (!messageObject.shouldDrawWithoutBackground()) {
                                                                    }
                                                                    if (!this.isRepliesChat) {
                                                                    }
                                                                    this.commentLayout = null;
                                                                    this.drawCommentNumber = false;
                                                                    this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                                    i5 = messageObject10.type;
                                                                    float f9222222 = 102.0f;
                                                                    if (i5 == 0) {
                                                                    }
                                                                    if (this.currentPosition != null) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    if (this.captionLayout == null) {
                                                                    }
                                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                    }
                                                                    int dp512222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                    staticLayout2 = this.captionLayout;
                                                                    if (staticLayout2 == null) {
                                                                    }
                                                                    if (this.currentMessageObject.type != i34) {
                                                                    }
                                                                    if (valueOf != null) {
                                                                    }
                                                                    groupedMessagePosition4 = this.currentPosition;
                                                                    if (groupedMessagePosition4 != null) {
                                                                    }
                                                                    int i20022222222222222222222 = this.widthBeforeNewTimeLine;
                                                                    i54 = -1;
                                                                    messageObject4 = this.currentMessageObject;
                                                                    if (messageObject4.eventId == 0) {
                                                                    }
                                                                    f4 = 0.0f;
                                                                    if (messageObject.isSponsored()) {
                                                                    }
                                                                    this.botButtons.clear();
                                                                    if (z46) {
                                                                    }
                                                                    if (!messageObject10.isRestrictedMessage) {
                                                                    }
                                                                    this.substractBackgroundHeight = 0;
                                                                    this.keyboardHeight = 0;
                                                                    r6 = hashMap;
                                                                    if (this.drawCommentButton) {
                                                                    }
                                                                    z29 = this.drawPinnedBottom;
                                                                    if (z29) {
                                                                    }
                                                                    if (!z29) {
                                                                    }
                                                                    if (messageObject10.type != 19) {
                                                                    }
                                                                    if (!this.drawPhotoImage) {
                                                                    }
                                                                    i58 = 5;
                                                                    if (this.documentAttachType == 5) {
                                                                    }
                                                                    calculateUnlockXY();
                                                                    if (z26) {
                                                                    }
                                                                    updateAnimatedEmojis();
                                                                    r62 = r6;
                                                                    if (z46) {
                                                                    }
                                                                    transcribeButton = this.transcribeButton;
                                                                    if (transcribeButton != null) {
                                                                    }
                                                                    updateWaveform();
                                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                                    }
                                                                    chatMessageCellDelegate2 = this.delegate;
                                                                    if (chatMessageCellDelegate2 != null) {
                                                                    }
                                                                    this.accessibilityVirtualViewBounds.clear();
                                                                    this.transitionParams.updatePhotoImageX = true;
                                                                    updateFlagSecure();
                                                                }
                                                                this.hasPsaHint = z9;
                                                                if (z9) {
                                                                }
                                                                this.photoImage.setAlpha(f);
                                                                if (!z3) {
                                                                }
                                                                this.pollButtons.clear();
                                                                this.availableTimeWidth = 0;
                                                                this.photoImage.setForceLoading(false);
                                                                this.photoImage.setNeedsQualityThumb(false);
                                                                this.photoImage.setShouldGenerateQualityThumb(false);
                                                                this.photoImage.setAllowDecodeSingleFrame(false);
                                                                this.photoImage.setColorFilter(null);
                                                                this.photoImage.setMediaStartEndTime(-1L, -1L);
                                                                if (!z46) {
                                                                }
                                                                messageObject10.reactionsChanged = false;
                                                                groupedMessagePosition3 = this.currentPosition;
                                                                if (groupedMessagePosition3 == null) {
                                                                }
                                                                if (!messageObject.shouldDrawReactionsInLayout()) {
                                                                }
                                                                if (z10) {
                                                                }
                                                                if (this.currentPosition != null) {
                                                                }
                                                                if (z3) {
                                                                }
                                                                groupedMessages3 = this.currentMessagesGroup;
                                                                if (groupedMessages3 != null) {
                                                                }
                                                                isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                                                if (this.hasDiscussion) {
                                                                }
                                                                repliesCount = getRepliesCount();
                                                                if (!messageObject.shouldDrawWithoutBackground()) {
                                                                }
                                                                if (!this.isRepliesChat) {
                                                                }
                                                                this.commentLayout = null;
                                                                this.drawCommentNumber = false;
                                                                this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                                i5 = messageObject10.type;
                                                                float f92222222 = 102.0f;
                                                                if (i5 == 0) {
                                                                }
                                                                if (this.currentPosition != null) {
                                                                }
                                                                if (!messageObject10.isRestrictedMessage) {
                                                                }
                                                                if (this.captionLayout == null) {
                                                                }
                                                                if (!messageObject.isVoiceTranscriptionOpen()) {
                                                                }
                                                                int dp5122222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                                staticLayout2 = this.captionLayout;
                                                                if (staticLayout2 == null) {
                                                                }
                                                                if (this.currentMessageObject.type != i34) {
                                                                }
                                                                if (valueOf != null) {
                                                                }
                                                                groupedMessagePosition4 = this.currentPosition;
                                                                if (groupedMessagePosition4 != null) {
                                                                }
                                                                int i200222222222222222222222 = this.widthBeforeNewTimeLine;
                                                                i54 = -1;
                                                                messageObject4 = this.currentMessageObject;
                                                                if (messageObject4.eventId == 0) {
                                                                }
                                                                f4 = 0.0f;
                                                                if (messageObject.isSponsored()) {
                                                                }
                                                                this.botButtons.clear();
                                                                if (z46) {
                                                                }
                                                                if (!messageObject10.isRestrictedMessage) {
                                                                }
                                                                this.substractBackgroundHeight = 0;
                                                                this.keyboardHeight = 0;
                                                                r6 = hashMap;
                                                                if (this.drawCommentButton) {
                                                                }
                                                                z29 = this.drawPinnedBottom;
                                                                if (z29) {
                                                                }
                                                                if (!z29) {
                                                                }
                                                                if (messageObject10.type != 19) {
                                                                }
                                                                if (!this.drawPhotoImage) {
                                                                }
                                                                i58 = 5;
                                                                if (this.documentAttachType == 5) {
                                                                }
                                                                calculateUnlockXY();
                                                                if (z26) {
                                                                }
                                                                updateAnimatedEmojis();
                                                                r62 = r6;
                                                                if (z46) {
                                                                }
                                                                transcribeButton = this.transcribeButton;
                                                                if (transcribeButton != null) {
                                                                }
                                                                updateWaveform();
                                                                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                                if (!this.currentMessageObject.loadingCancelled) {
                                                                }
                                                                chatMessageCellDelegate2 = this.delegate;
                                                                if (chatMessageCellDelegate2 != null) {
                                                                }
                                                                this.accessibilityVirtualViewBounds.clear();
                                                                this.transitionParams.updatePhotoImageX = true;
                                                                updateFlagSecure();
                                                            }
                                                            this.drawSideButton = i119;
                                                            if (!this.isPinnedChat) {
                                                            }
                                                            this.drawSideButton = 2;
                                                            r22 = 0;
                                                            this.replyNameLayout = null;
                                                            this.adminLayout = null;
                                                            this.checkOnlyButtonPressed = r22;
                                                            this.replyTextLayout = null;
                                                            AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                                            this.lastReplyMessage = null;
                                                            this.hasEmbed = r22;
                                                            this.autoPlayingMedia = r22;
                                                            int i12022 = r22 == true ? 1 : 0;
                                                            int i12122 = r22 == true ? 1 : 0;
                                                            this.replyNameWidth = i12022;
                                                            this.replyTextWidth = r22;
                                                            this.viaWidth = r22;
                                                            this.viaNameWidth = r22;
                                                            this.addedCaptionHeight = r22;
                                                            this.currentReplyPhoto = null;
                                                            this.currentUser = null;
                                                            this.currentChat = null;
                                                            this.currentViaBotUser = null;
                                                            this.instantViewLayout = null;
                                                            this.drawNameLayout = r22;
                                                            this.lastLoadingSizeTotal = 0L;
                                                            if (this.scheduledInvalidate) {
                                                            }
                                                            this.links.clear();
                                                            this.pressedLink = null;
                                                            this.pressedEmoji = null;
                                                            this.pressedLinkType = -1;
                                                            messageObject10.forceUpdate = r22;
                                                            this.drawPhotoImage = r22;
                                                            this.drawMediaCheckBox = r22;
                                                            this.hasLinkPreview = r22;
                                                            this.hasOldCaptionPreview = r22;
                                                            this.hasGamePreview = r22;
                                                            this.hasInvoicePreview = r22;
                                                            this.commentButtonPressed = r22;
                                                            this.instantButtonPressed = r22;
                                                            this.instantPressed = r22;
                                                            if (!z6) {
                                                            }
                                                            this.spoilerPressed = null;
                                                            this.isCaptionSpoilerPressed = false;
                                                            this.isSpoilerRevealing = false;
                                                            this.linkPreviewPressed = false;
                                                            this.buttonPressed = 0;
                                                            this.additionalTimeOffsetY = 0;
                                                            this.miniButtonPressed = 0;
                                                            this.pressedBotButton = i;
                                                            this.pressedVoteButton = i;
                                                            this.pollHintPressed = false;
                                                            this.psaHintPressed = false;
                                                            this.linkPreviewHeight = 0;
                                                            this.mediaOffsetY = 0;
                                                            this.documentAttachType = 0;
                                                            this.documentAttach = null;
                                                            this.descriptionLayout = null;
                                                            this.titleLayout = null;
                                                            this.videoInfoLayout = null;
                                                            this.photosCountLayout = null;
                                                            this.siteNameLayout = null;
                                                            this.authorLayout = null;
                                                            this.captionLayout = null;
                                                            this.captionWidth = 0;
                                                            this.captionHeight = 0;
                                                            this.captionOffsetX = 0;
                                                            this.currentCaption = null;
                                                            this.docTitleLayout = null;
                                                            this.drawImageButton = false;
                                                            this.drawVideoImageButton = false;
                                                            this.currentPhotoObject = null;
                                                            this.photoParentObject = null;
                                                            this.currentPhotoObjectThumb = null;
                                                            this.currentPhotoObjectThumbStripped = null;
                                                            if (!z3) {
                                                            }
                                                            this.currentPhotoFilter = null;
                                                            this.buttonState = i;
                                                            this.miniButtonState = i;
                                                            this.hasMiniProgress = 0;
                                                            if (this.addedForTest) {
                                                            }
                                                            this.addedForTest = false;
                                                            this.photoNotSet = false;
                                                            this.drawBackground = r13;
                                                            this.drawName = false;
                                                            this.useSeekBarWaveform = false;
                                                            this.useTranscribeButton = false;
                                                            this.drawInstantView = false;
                                                            this.drawInstantViewType = 0;
                                                            this.drawForwardedName = false;
                                                            this.drawCommentButton = false;
                                                            this.photoImage.setSideClip(0.0f);
                                                            this.photoImage.setAspectFit(false);
                                                            this.gradientShader = null;
                                                            this.motionBackgroundDrawable = null;
                                                            this.imageBackgroundColor = 0;
                                                            this.imageBackgroundGradientColor1 = 0;
                                                            this.imageBackgroundGradientColor2 = 0;
                                                            this.imageBackgroundIntensity = 0.0f;
                                                            this.imageBackgroundGradientColor3 = 0;
                                                            this.imageBackgroundGradientRotation = 45;
                                                            this.imageBackgroundSideColor = 0;
                                                            this.mediaBackground = false;
                                                            this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                                            TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader222 = messageObject10.messageOwner.fwd_from;
                                                            if (tLRPC$MessageFwdHeader222 != null) {
                                                            }
                                                            this.hasPsaHint = z9;
                                                            if (z9) {
                                                            }
                                                            this.photoImage.setAlpha(f);
                                                            if (!z3) {
                                                            }
                                                            this.pollButtons.clear();
                                                            this.availableTimeWidth = 0;
                                                            this.photoImage.setForceLoading(false);
                                                            this.photoImage.setNeedsQualityThumb(false);
                                                            this.photoImage.setShouldGenerateQualityThumb(false);
                                                            this.photoImage.setAllowDecodeSingleFrame(false);
                                                            this.photoImage.setColorFilter(null);
                                                            this.photoImage.setMediaStartEndTime(-1L, -1L);
                                                            if (!z46) {
                                                            }
                                                            messageObject10.reactionsChanged = false;
                                                            groupedMessagePosition3 = this.currentPosition;
                                                            if (groupedMessagePosition3 == null) {
                                                            }
                                                            if (!messageObject.shouldDrawReactionsInLayout()) {
                                                            }
                                                            if (z10) {
                                                            }
                                                            if (this.currentPosition != null) {
                                                            }
                                                            if (z3) {
                                                            }
                                                            groupedMessages3 = this.currentMessagesGroup;
                                                            if (groupedMessages3 != null) {
                                                            }
                                                            isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                                            if (this.hasDiscussion) {
                                                            }
                                                            repliesCount = getRepliesCount();
                                                            if (!messageObject.shouldDrawWithoutBackground()) {
                                                            }
                                                            if (!this.isRepliesChat) {
                                                            }
                                                            this.commentLayout = null;
                                                            this.drawCommentNumber = false;
                                                            this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                            i5 = messageObject10.type;
                                                            float f922222222 = 102.0f;
                                                            if (i5 == 0) {
                                                            }
                                                            if (this.currentPosition != null) {
                                                            }
                                                            if (!messageObject10.isRestrictedMessage) {
                                                            }
                                                            if (this.captionLayout == null) {
                                                            }
                                                            if (!messageObject.isVoiceTranscriptionOpen()) {
                                                            }
                                                            int dp51222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                            staticLayout2 = this.captionLayout;
                                                            if (staticLayout2 == null) {
                                                            }
                                                            if (this.currentMessageObject.type != i34) {
                                                            }
                                                            if (valueOf != null) {
                                                            }
                                                            groupedMessagePosition4 = this.currentPosition;
                                                            if (groupedMessagePosition4 != null) {
                                                            }
                                                            int i2002222222222222222222222 = this.widthBeforeNewTimeLine;
                                                            i54 = -1;
                                                            messageObject4 = this.currentMessageObject;
                                                            if (messageObject4.eventId == 0) {
                                                            }
                                                            f4 = 0.0f;
                                                            if (messageObject.isSponsored()) {
                                                            }
                                                            this.botButtons.clear();
                                                            if (z46) {
                                                            }
                                                            if (!messageObject10.isRestrictedMessage) {
                                                            }
                                                            this.substractBackgroundHeight = 0;
                                                            this.keyboardHeight = 0;
                                                            r6 = hashMap;
                                                            if (this.drawCommentButton) {
                                                            }
                                                            z29 = this.drawPinnedBottom;
                                                            if (z29) {
                                                            }
                                                            if (!z29) {
                                                            }
                                                            if (messageObject10.type != 19) {
                                                            }
                                                            if (!this.drawPhotoImage) {
                                                            }
                                                            i58 = 5;
                                                            if (this.documentAttachType == 5) {
                                                            }
                                                            calculateUnlockXY();
                                                            if (z26) {
                                                            }
                                                            updateAnimatedEmojis();
                                                            r62 = r6;
                                                            if (z46) {
                                                            }
                                                            transcribeButton = this.transcribeButton;
                                                            if (transcribeButton != null) {
                                                            }
                                                            updateWaveform();
                                                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                            if (!this.currentMessageObject.loadingCancelled) {
                                                            }
                                                            chatMessageCellDelegate2 = this.delegate;
                                                            if (chatMessageCellDelegate2 != null) {
                                                            }
                                                            this.accessibilityVirtualViewBounds.clear();
                                                            this.transitionParams.updatePhotoImageX = true;
                                                            updateFlagSecure();
                                                        }
                                                        r22 = 0;
                                                        this.drawSideButton = 0;
                                                        this.replyNameLayout = null;
                                                        this.adminLayout = null;
                                                        this.checkOnlyButtonPressed = r22;
                                                        this.replyTextLayout = null;
                                                        AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                                        this.lastReplyMessage = null;
                                                        this.hasEmbed = r22;
                                                        this.autoPlayingMedia = r22;
                                                        int i120222 = r22 == true ? 1 : 0;
                                                        int i121222 = r22 == true ? 1 : 0;
                                                        this.replyNameWidth = i120222;
                                                        this.replyTextWidth = r22;
                                                        this.viaWidth = r22;
                                                        this.viaNameWidth = r22;
                                                        this.addedCaptionHeight = r22;
                                                        this.currentReplyPhoto = null;
                                                        this.currentUser = null;
                                                        this.currentChat = null;
                                                        this.currentViaBotUser = null;
                                                        this.instantViewLayout = null;
                                                        this.drawNameLayout = r22;
                                                        this.lastLoadingSizeTotal = 0L;
                                                        if (this.scheduledInvalidate) {
                                                        }
                                                        this.links.clear();
                                                        this.pressedLink = null;
                                                        this.pressedEmoji = null;
                                                        this.pressedLinkType = -1;
                                                        messageObject10.forceUpdate = r22;
                                                        this.drawPhotoImage = r22;
                                                        this.drawMediaCheckBox = r22;
                                                        this.hasLinkPreview = r22;
                                                        this.hasOldCaptionPreview = r22;
                                                        this.hasGamePreview = r22;
                                                        this.hasInvoicePreview = r22;
                                                        this.commentButtonPressed = r22;
                                                        this.instantButtonPressed = r22;
                                                        this.instantPressed = r22;
                                                        if (!z6) {
                                                        }
                                                        this.spoilerPressed = null;
                                                        this.isCaptionSpoilerPressed = false;
                                                        this.isSpoilerRevealing = false;
                                                        this.linkPreviewPressed = false;
                                                        this.buttonPressed = 0;
                                                        this.additionalTimeOffsetY = 0;
                                                        this.miniButtonPressed = 0;
                                                        this.pressedBotButton = i;
                                                        this.pressedVoteButton = i;
                                                        this.pollHintPressed = false;
                                                        this.psaHintPressed = false;
                                                        this.linkPreviewHeight = 0;
                                                        this.mediaOffsetY = 0;
                                                        this.documentAttachType = 0;
                                                        this.documentAttach = null;
                                                        this.descriptionLayout = null;
                                                        this.titleLayout = null;
                                                        this.videoInfoLayout = null;
                                                        this.photosCountLayout = null;
                                                        this.siteNameLayout = null;
                                                        this.authorLayout = null;
                                                        this.captionLayout = null;
                                                        this.captionWidth = 0;
                                                        this.captionHeight = 0;
                                                        this.captionOffsetX = 0;
                                                        this.currentCaption = null;
                                                        this.docTitleLayout = null;
                                                        this.drawImageButton = false;
                                                        this.drawVideoImageButton = false;
                                                        this.currentPhotoObject = null;
                                                        this.photoParentObject = null;
                                                        this.currentPhotoObjectThumb = null;
                                                        this.currentPhotoObjectThumbStripped = null;
                                                        if (!z3) {
                                                        }
                                                        this.currentPhotoFilter = null;
                                                        this.buttonState = i;
                                                        this.miniButtonState = i;
                                                        this.hasMiniProgress = 0;
                                                        if (this.addedForTest) {
                                                        }
                                                        this.addedForTest = false;
                                                        this.photoNotSet = false;
                                                        this.drawBackground = r13;
                                                        this.drawName = false;
                                                        this.useSeekBarWaveform = false;
                                                        this.useTranscribeButton = false;
                                                        this.drawInstantView = false;
                                                        this.drawInstantViewType = 0;
                                                        this.drawForwardedName = false;
                                                        this.drawCommentButton = false;
                                                        this.photoImage.setSideClip(0.0f);
                                                        this.photoImage.setAspectFit(false);
                                                        this.gradientShader = null;
                                                        this.motionBackgroundDrawable = null;
                                                        this.imageBackgroundColor = 0;
                                                        this.imageBackgroundGradientColor1 = 0;
                                                        this.imageBackgroundGradientColor2 = 0;
                                                        this.imageBackgroundIntensity = 0.0f;
                                                        this.imageBackgroundGradientColor3 = 0;
                                                        this.imageBackgroundGradientRotation = 45;
                                                        this.imageBackgroundSideColor = 0;
                                                        this.mediaBackground = false;
                                                        this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                                        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader2222 = messageObject10.messageOwner.fwd_from;
                                                        if (tLRPC$MessageFwdHeader2222 != null) {
                                                        }
                                                        this.hasPsaHint = z9;
                                                        if (z9) {
                                                        }
                                                        this.photoImage.setAlpha(f);
                                                        if (!z3) {
                                                        }
                                                        this.pollButtons.clear();
                                                        this.availableTimeWidth = 0;
                                                        this.photoImage.setForceLoading(false);
                                                        this.photoImage.setNeedsQualityThumb(false);
                                                        this.photoImage.setShouldGenerateQualityThumb(false);
                                                        this.photoImage.setAllowDecodeSingleFrame(false);
                                                        this.photoImage.setColorFilter(null);
                                                        this.photoImage.setMediaStartEndTime(-1L, -1L);
                                                        if (!z46) {
                                                        }
                                                        messageObject10.reactionsChanged = false;
                                                        groupedMessagePosition3 = this.currentPosition;
                                                        if (groupedMessagePosition3 == null) {
                                                        }
                                                        if (!messageObject.shouldDrawReactionsInLayout()) {
                                                        }
                                                        if (z10) {
                                                        }
                                                        if (this.currentPosition != null) {
                                                        }
                                                        if (z3) {
                                                        }
                                                        groupedMessages3 = this.currentMessagesGroup;
                                                        if (groupedMessages3 != null) {
                                                        }
                                                        isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                                        if (this.hasDiscussion) {
                                                        }
                                                        repliesCount = getRepliesCount();
                                                        if (!messageObject.shouldDrawWithoutBackground()) {
                                                        }
                                                        if (!this.isRepliesChat) {
                                                        }
                                                        this.commentLayout = null;
                                                        this.drawCommentNumber = false;
                                                        this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                        i5 = messageObject10.type;
                                                        float f9222222222 = 102.0f;
                                                        if (i5 == 0) {
                                                        }
                                                        if (this.currentPosition != null) {
                                                        }
                                                        if (!messageObject10.isRestrictedMessage) {
                                                        }
                                                        if (this.captionLayout == null) {
                                                        }
                                                        if (!messageObject.isVoiceTranscriptionOpen()) {
                                                        }
                                                        int dp512222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                        staticLayout2 = this.captionLayout;
                                                        if (staticLayout2 == null) {
                                                        }
                                                        if (this.currentMessageObject.type != i34) {
                                                        }
                                                        if (valueOf != null) {
                                                        }
                                                        groupedMessagePosition4 = this.currentPosition;
                                                        if (groupedMessagePosition4 != null) {
                                                        }
                                                        int i20022222222222222222222222 = this.widthBeforeNewTimeLine;
                                                        i54 = -1;
                                                        messageObject4 = this.currentMessageObject;
                                                        if (messageObject4.eventId == 0) {
                                                        }
                                                        f4 = 0.0f;
                                                        if (messageObject.isSponsored()) {
                                                        }
                                                        this.botButtons.clear();
                                                        if (z46) {
                                                        }
                                                        if (!messageObject10.isRestrictedMessage) {
                                                        }
                                                        this.substractBackgroundHeight = 0;
                                                        this.keyboardHeight = 0;
                                                        r6 = hashMap;
                                                        if (this.drawCommentButton) {
                                                        }
                                                        z29 = this.drawPinnedBottom;
                                                        if (z29) {
                                                        }
                                                        if (!z29) {
                                                        }
                                                        if (messageObject10.type != 19) {
                                                        }
                                                        if (!this.drawPhotoImage) {
                                                        }
                                                        i58 = 5;
                                                        if (this.documentAttachType == 5) {
                                                        }
                                                        calculateUnlockXY();
                                                        if (z26) {
                                                        }
                                                        updateAnimatedEmojis();
                                                        r62 = r6;
                                                        if (z46) {
                                                        }
                                                        transcribeButton = this.transcribeButton;
                                                        if (transcribeButton != null) {
                                                        }
                                                        updateWaveform();
                                                        updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                        if (!this.currentMessageObject.loadingCancelled) {
                                                        }
                                                        chatMessageCellDelegate2 = this.delegate;
                                                        if (chatMessageCellDelegate2 != null) {
                                                        }
                                                        this.accessibilityVirtualViewBounds.clear();
                                                        this.transitionParams.updatePhotoImageX = true;
                                                        updateFlagSecure();
                                                    }
                                                    if (messageObject10.customAvatarDrawable != null) {
                                                    }
                                                    this.wasLayout = r2;
                                                    this.groupPhotoInvisible = r2;
                                                    int i11722 = r2 == true ? 1 : 0;
                                                    int i11822 = r2 == true ? 1 : 0;
                                                    this.animatingDrawVideoImageButton = i11722;
                                                    this.drawVideoSize = r2;
                                                    this.canStreamVideo = r2;
                                                    this.animatingNoSound = r2;
                                                    if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                                                    }
                                                    r22 = 0;
                                                    this.drawSideButton = 0;
                                                    this.replyNameLayout = null;
                                                    this.adminLayout = null;
                                                    this.checkOnlyButtonPressed = r22;
                                                    this.replyTextLayout = null;
                                                    AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                                    this.lastReplyMessage = null;
                                                    this.hasEmbed = r22;
                                                    this.autoPlayingMedia = r22;
                                                    int i1202222 = r22 == true ? 1 : 0;
                                                    int i1212222 = r22 == true ? 1 : 0;
                                                    this.replyNameWidth = i1202222;
                                                    this.replyTextWidth = r22;
                                                    this.viaWidth = r22;
                                                    this.viaNameWidth = r22;
                                                    this.addedCaptionHeight = r22;
                                                    this.currentReplyPhoto = null;
                                                    this.currentUser = null;
                                                    this.currentChat = null;
                                                    this.currentViaBotUser = null;
                                                    this.instantViewLayout = null;
                                                    this.drawNameLayout = r22;
                                                    this.lastLoadingSizeTotal = 0L;
                                                    if (this.scheduledInvalidate) {
                                                    }
                                                    this.links.clear();
                                                    this.pressedLink = null;
                                                    this.pressedEmoji = null;
                                                    this.pressedLinkType = -1;
                                                    messageObject10.forceUpdate = r22;
                                                    this.drawPhotoImage = r22;
                                                    this.drawMediaCheckBox = r22;
                                                    this.hasLinkPreview = r22;
                                                    this.hasOldCaptionPreview = r22;
                                                    this.hasGamePreview = r22;
                                                    this.hasInvoicePreview = r22;
                                                    this.commentButtonPressed = r22;
                                                    this.instantButtonPressed = r22;
                                                    this.instantPressed = r22;
                                                    if (!z6) {
                                                    }
                                                    this.spoilerPressed = null;
                                                    this.isCaptionSpoilerPressed = false;
                                                    this.isSpoilerRevealing = false;
                                                    this.linkPreviewPressed = false;
                                                    this.buttonPressed = 0;
                                                    this.additionalTimeOffsetY = 0;
                                                    this.miniButtonPressed = 0;
                                                    this.pressedBotButton = i;
                                                    this.pressedVoteButton = i;
                                                    this.pollHintPressed = false;
                                                    this.psaHintPressed = false;
                                                    this.linkPreviewHeight = 0;
                                                    this.mediaOffsetY = 0;
                                                    this.documentAttachType = 0;
                                                    this.documentAttach = null;
                                                    this.descriptionLayout = null;
                                                    this.titleLayout = null;
                                                    this.videoInfoLayout = null;
                                                    this.photosCountLayout = null;
                                                    this.siteNameLayout = null;
                                                    this.authorLayout = null;
                                                    this.captionLayout = null;
                                                    this.captionWidth = 0;
                                                    this.captionHeight = 0;
                                                    this.captionOffsetX = 0;
                                                    this.currentCaption = null;
                                                    this.docTitleLayout = null;
                                                    this.drawImageButton = false;
                                                    this.drawVideoImageButton = false;
                                                    this.currentPhotoObject = null;
                                                    this.photoParentObject = null;
                                                    this.currentPhotoObjectThumb = null;
                                                    this.currentPhotoObjectThumbStripped = null;
                                                    if (!z3) {
                                                    }
                                                    this.currentPhotoFilter = null;
                                                    this.buttonState = i;
                                                    this.miniButtonState = i;
                                                    this.hasMiniProgress = 0;
                                                    if (this.addedForTest) {
                                                    }
                                                    this.addedForTest = false;
                                                    this.photoNotSet = false;
                                                    this.drawBackground = r13;
                                                    this.drawName = false;
                                                    this.useSeekBarWaveform = false;
                                                    this.useTranscribeButton = false;
                                                    this.drawInstantView = false;
                                                    this.drawInstantViewType = 0;
                                                    this.drawForwardedName = false;
                                                    this.drawCommentButton = false;
                                                    this.photoImage.setSideClip(0.0f);
                                                    this.photoImage.setAspectFit(false);
                                                    this.gradientShader = null;
                                                    this.motionBackgroundDrawable = null;
                                                    this.imageBackgroundColor = 0;
                                                    this.imageBackgroundGradientColor1 = 0;
                                                    this.imageBackgroundGradientColor2 = 0;
                                                    this.imageBackgroundIntensity = 0.0f;
                                                    this.imageBackgroundGradientColor3 = 0;
                                                    this.imageBackgroundGradientRotation = 45;
                                                    this.imageBackgroundSideColor = 0;
                                                    this.mediaBackground = false;
                                                    this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                                    TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader22222 = messageObject10.messageOwner.fwd_from;
                                                    if (tLRPC$MessageFwdHeader22222 != null) {
                                                    }
                                                    this.hasPsaHint = z9;
                                                    if (z9) {
                                                    }
                                                    this.photoImage.setAlpha(f);
                                                    if (!z3) {
                                                    }
                                                    this.pollButtons.clear();
                                                    this.availableTimeWidth = 0;
                                                    this.photoImage.setForceLoading(false);
                                                    this.photoImage.setNeedsQualityThumb(false);
                                                    this.photoImage.setShouldGenerateQualityThumb(false);
                                                    this.photoImage.setAllowDecodeSingleFrame(false);
                                                    this.photoImage.setColorFilter(null);
                                                    this.photoImage.setMediaStartEndTime(-1L, -1L);
                                                    if (!z46) {
                                                    }
                                                    messageObject10.reactionsChanged = false;
                                                    groupedMessagePosition3 = this.currentPosition;
                                                    if (groupedMessagePosition3 == null) {
                                                    }
                                                    if (!messageObject.shouldDrawReactionsInLayout()) {
                                                    }
                                                    if (z10) {
                                                    }
                                                    if (this.currentPosition != null) {
                                                    }
                                                    if (z3) {
                                                    }
                                                    groupedMessages3 = this.currentMessagesGroup;
                                                    if (groupedMessages3 != null) {
                                                    }
                                                    isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                                    if (this.hasDiscussion) {
                                                    }
                                                    repliesCount = getRepliesCount();
                                                    if (!messageObject.shouldDrawWithoutBackground()) {
                                                    }
                                                    if (!this.isRepliesChat) {
                                                    }
                                                    this.commentLayout = null;
                                                    this.drawCommentNumber = false;
                                                    this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                    i5 = messageObject10.type;
                                                    float f92222222222 = 102.0f;
                                                    if (i5 == 0) {
                                                    }
                                                    if (this.currentPosition != null) {
                                                    }
                                                    if (!messageObject10.isRestrictedMessage) {
                                                    }
                                                    if (this.captionLayout == null) {
                                                    }
                                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                                    }
                                                    int dp5122222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                    staticLayout2 = this.captionLayout;
                                                    if (staticLayout2 == null) {
                                                    }
                                                    if (this.currentMessageObject.type != i34) {
                                                    }
                                                    if (valueOf != null) {
                                                    }
                                                    groupedMessagePosition4 = this.currentPosition;
                                                    if (groupedMessagePosition4 != null) {
                                                    }
                                                    int i200222222222222222222222222 = this.widthBeforeNewTimeLine;
                                                    i54 = -1;
                                                    messageObject4 = this.currentMessageObject;
                                                    if (messageObject4.eventId == 0) {
                                                    }
                                                    f4 = 0.0f;
                                                    if (messageObject.isSponsored()) {
                                                    }
                                                    this.botButtons.clear();
                                                    if (z46) {
                                                    }
                                                    if (!messageObject10.isRestrictedMessage) {
                                                    }
                                                    this.substractBackgroundHeight = 0;
                                                    this.keyboardHeight = 0;
                                                    r6 = hashMap;
                                                    if (this.drawCommentButton) {
                                                    }
                                                    z29 = this.drawPinnedBottom;
                                                    if (z29) {
                                                    }
                                                    if (!z29) {
                                                    }
                                                    if (messageObject10.type != 19) {
                                                    }
                                                    if (!this.drawPhotoImage) {
                                                    }
                                                    i58 = 5;
                                                    if (this.documentAttachType == 5) {
                                                    }
                                                    calculateUnlockXY();
                                                    if (z26) {
                                                    }
                                                    updateAnimatedEmojis();
                                                    r62 = r6;
                                                    if (z46) {
                                                    }
                                                    transcribeButton = this.transcribeButton;
                                                    if (transcribeButton != null) {
                                                    }
                                                    updateWaveform();
                                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                    if (!this.currentMessageObject.loadingCancelled) {
                                                    }
                                                    chatMessageCellDelegate2 = this.delegate;
                                                    if (chatMessageCellDelegate2 != null) {
                                                    }
                                                    this.accessibilityVirtualViewBounds.clear();
                                                    this.transitionParams.updatePhotoImageX = true;
                                                    updateFlagSecure();
                                                }
                                                this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                                                if (this.isChat) {
                                                }
                                                if (messageObject10.customAvatarDrawable != null) {
                                                }
                                                this.wasLayout = r2;
                                                this.groupPhotoInvisible = r2;
                                                int i117222 = r2 == true ? 1 : 0;
                                                int i118222 = r2 == true ? 1 : 0;
                                                this.animatingDrawVideoImageButton = i117222;
                                                this.drawVideoSize = r2;
                                                this.canStreamVideo = r2;
                                                this.animatingNoSound = r2;
                                                if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                                                }
                                                r22 = 0;
                                                this.drawSideButton = 0;
                                                this.replyNameLayout = null;
                                                this.adminLayout = null;
                                                this.checkOnlyButtonPressed = r22;
                                                this.replyTextLayout = null;
                                                AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                                this.lastReplyMessage = null;
                                                this.hasEmbed = r22;
                                                this.autoPlayingMedia = r22;
                                                int i12022222 = r22 == true ? 1 : 0;
                                                int i12122222 = r22 == true ? 1 : 0;
                                                this.replyNameWidth = i12022222;
                                                this.replyTextWidth = r22;
                                                this.viaWidth = r22;
                                                this.viaNameWidth = r22;
                                                this.addedCaptionHeight = r22;
                                                this.currentReplyPhoto = null;
                                                this.currentUser = null;
                                                this.currentChat = null;
                                                this.currentViaBotUser = null;
                                                this.instantViewLayout = null;
                                                this.drawNameLayout = r22;
                                                this.lastLoadingSizeTotal = 0L;
                                                if (this.scheduledInvalidate) {
                                                }
                                                this.links.clear();
                                                this.pressedLink = null;
                                                this.pressedEmoji = null;
                                                this.pressedLinkType = -1;
                                                messageObject10.forceUpdate = r22;
                                                this.drawPhotoImage = r22;
                                                this.drawMediaCheckBox = r22;
                                                this.hasLinkPreview = r22;
                                                this.hasOldCaptionPreview = r22;
                                                this.hasGamePreview = r22;
                                                this.hasInvoicePreview = r22;
                                                this.commentButtonPressed = r22;
                                                this.instantButtonPressed = r22;
                                                this.instantPressed = r22;
                                                if (!z6) {
                                                }
                                                this.spoilerPressed = null;
                                                this.isCaptionSpoilerPressed = false;
                                                this.isSpoilerRevealing = false;
                                                this.linkPreviewPressed = false;
                                                this.buttonPressed = 0;
                                                this.additionalTimeOffsetY = 0;
                                                this.miniButtonPressed = 0;
                                                this.pressedBotButton = i;
                                                this.pressedVoteButton = i;
                                                this.pollHintPressed = false;
                                                this.psaHintPressed = false;
                                                this.linkPreviewHeight = 0;
                                                this.mediaOffsetY = 0;
                                                this.documentAttachType = 0;
                                                this.documentAttach = null;
                                                this.descriptionLayout = null;
                                                this.titleLayout = null;
                                                this.videoInfoLayout = null;
                                                this.photosCountLayout = null;
                                                this.siteNameLayout = null;
                                                this.authorLayout = null;
                                                this.captionLayout = null;
                                                this.captionWidth = 0;
                                                this.captionHeight = 0;
                                                this.captionOffsetX = 0;
                                                this.currentCaption = null;
                                                this.docTitleLayout = null;
                                                this.drawImageButton = false;
                                                this.drawVideoImageButton = false;
                                                this.currentPhotoObject = null;
                                                this.photoParentObject = null;
                                                this.currentPhotoObjectThumb = null;
                                                this.currentPhotoObjectThumbStripped = null;
                                                if (!z3) {
                                                }
                                                this.currentPhotoFilter = null;
                                                this.buttonState = i;
                                                this.miniButtonState = i;
                                                this.hasMiniProgress = 0;
                                                if (this.addedForTest) {
                                                }
                                                this.addedForTest = false;
                                                this.photoNotSet = false;
                                                this.drawBackground = r13;
                                                this.drawName = false;
                                                this.useSeekBarWaveform = false;
                                                this.useTranscribeButton = false;
                                                this.drawInstantView = false;
                                                this.drawInstantViewType = 0;
                                                this.drawForwardedName = false;
                                                this.drawCommentButton = false;
                                                this.photoImage.setSideClip(0.0f);
                                                this.photoImage.setAspectFit(false);
                                                this.gradientShader = null;
                                                this.motionBackgroundDrawable = null;
                                                this.imageBackgroundColor = 0;
                                                this.imageBackgroundGradientColor1 = 0;
                                                this.imageBackgroundGradientColor2 = 0;
                                                this.imageBackgroundIntensity = 0.0f;
                                                this.imageBackgroundGradientColor3 = 0;
                                                this.imageBackgroundGradientRotation = 45;
                                                this.imageBackgroundSideColor = 0;
                                                this.mediaBackground = false;
                                                this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                                TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader222222 = messageObject10.messageOwner.fwd_from;
                                                if (tLRPC$MessageFwdHeader222222 != null) {
                                                }
                                                this.hasPsaHint = z9;
                                                if (z9) {
                                                }
                                                this.photoImage.setAlpha(f);
                                                if (!z3) {
                                                }
                                                this.pollButtons.clear();
                                                this.availableTimeWidth = 0;
                                                this.photoImage.setForceLoading(false);
                                                this.photoImage.setNeedsQualityThumb(false);
                                                this.photoImage.setShouldGenerateQualityThumb(false);
                                                this.photoImage.setAllowDecodeSingleFrame(false);
                                                this.photoImage.setColorFilter(null);
                                                this.photoImage.setMediaStartEndTime(-1L, -1L);
                                                if (!z46) {
                                                }
                                                messageObject10.reactionsChanged = false;
                                                groupedMessagePosition3 = this.currentPosition;
                                                if (groupedMessagePosition3 == null) {
                                                }
                                                if (!messageObject.shouldDrawReactionsInLayout()) {
                                                }
                                                if (z10) {
                                                }
                                                if (this.currentPosition != null) {
                                                }
                                                if (z3) {
                                                }
                                                groupedMessages3 = this.currentMessagesGroup;
                                                if (groupedMessages3 != null) {
                                                }
                                                isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                                if (this.hasDiscussion) {
                                                }
                                                repliesCount = getRepliesCount();
                                                if (!messageObject.shouldDrawWithoutBackground()) {
                                                }
                                                if (!this.isRepliesChat) {
                                                }
                                                this.commentLayout = null;
                                                this.drawCommentNumber = false;
                                                this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                                i5 = messageObject10.type;
                                                float f922222222222 = 102.0f;
                                                if (i5 == 0) {
                                                }
                                                if (this.currentPosition != null) {
                                                }
                                                if (!messageObject10.isRestrictedMessage) {
                                                }
                                                if (this.captionLayout == null) {
                                                }
                                                if (!messageObject.isVoiceTranscriptionOpen()) {
                                                }
                                                int dp51222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                                staticLayout2 = this.captionLayout;
                                                if (staticLayout2 == null) {
                                                }
                                                if (this.currentMessageObject.type != i34) {
                                                }
                                                if (valueOf != null) {
                                                }
                                                groupedMessagePosition4 = this.currentPosition;
                                                if (groupedMessagePosition4 != null) {
                                                }
                                                int i2002222222222222222222222222 = this.widthBeforeNewTimeLine;
                                                i54 = -1;
                                                messageObject4 = this.currentMessageObject;
                                                if (messageObject4.eventId == 0) {
                                                }
                                                f4 = 0.0f;
                                                if (messageObject.isSponsored()) {
                                                }
                                                this.botButtons.clear();
                                                if (z46) {
                                                }
                                                if (!messageObject10.isRestrictedMessage) {
                                                }
                                                this.substractBackgroundHeight = 0;
                                                this.keyboardHeight = 0;
                                                r6 = hashMap;
                                                if (this.drawCommentButton) {
                                                }
                                                z29 = this.drawPinnedBottom;
                                                if (z29) {
                                                }
                                                if (!z29) {
                                                }
                                                if (messageObject10.type != 19) {
                                                }
                                                if (!this.drawPhotoImage) {
                                                }
                                                i58 = 5;
                                                if (this.documentAttachType == 5) {
                                                }
                                                calculateUnlockXY();
                                                if (z26) {
                                                }
                                                updateAnimatedEmojis();
                                                r62 = r6;
                                                if (z46) {
                                                }
                                                transcribeButton = this.transcribeButton;
                                                if (transcribeButton != null) {
                                                }
                                                updateWaveform();
                                                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                                if (!this.currentMessageObject.loadingCancelled) {
                                                }
                                                chatMessageCellDelegate2 = this.delegate;
                                                if (chatMessageCellDelegate2 != null) {
                                                }
                                                this.accessibilityVirtualViewBounds.clear();
                                                this.transitionParams.updatePhotoImageX = true;
                                                updateFlagSecure();
                                            }
                                            this.isThreadPost = z47;
                                            this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                                            if (this.isChat) {
                                            }
                                            if (messageObject10.customAvatarDrawable != null) {
                                            }
                                            this.wasLayout = r2;
                                            this.groupPhotoInvisible = r2;
                                            int i1172222 = r2 == true ? 1 : 0;
                                            int i1182222 = r2 == true ? 1 : 0;
                                            this.animatingDrawVideoImageButton = i1172222;
                                            this.drawVideoSize = r2;
                                            this.canStreamVideo = r2;
                                            this.animatingNoSound = r2;
                                            if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                                            }
                                            r22 = 0;
                                            this.drawSideButton = 0;
                                            this.replyNameLayout = null;
                                            this.adminLayout = null;
                                            this.checkOnlyButtonPressed = r22;
                                            this.replyTextLayout = null;
                                            AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                            this.lastReplyMessage = null;
                                            this.hasEmbed = r22;
                                            this.autoPlayingMedia = r22;
                                            int i120222222 = r22 == true ? 1 : 0;
                                            int i121222222 = r22 == true ? 1 : 0;
                                            this.replyNameWidth = i120222222;
                                            this.replyTextWidth = r22;
                                            this.viaWidth = r22;
                                            this.viaNameWidth = r22;
                                            this.addedCaptionHeight = r22;
                                            this.currentReplyPhoto = null;
                                            this.currentUser = null;
                                            this.currentChat = null;
                                            this.currentViaBotUser = null;
                                            this.instantViewLayout = null;
                                            this.drawNameLayout = r22;
                                            this.lastLoadingSizeTotal = 0L;
                                            if (this.scheduledInvalidate) {
                                            }
                                            this.links.clear();
                                            this.pressedLink = null;
                                            this.pressedEmoji = null;
                                            this.pressedLinkType = -1;
                                            messageObject10.forceUpdate = r22;
                                            this.drawPhotoImage = r22;
                                            this.drawMediaCheckBox = r22;
                                            this.hasLinkPreview = r22;
                                            this.hasOldCaptionPreview = r22;
                                            this.hasGamePreview = r22;
                                            this.hasInvoicePreview = r22;
                                            this.commentButtonPressed = r22;
                                            this.instantButtonPressed = r22;
                                            this.instantPressed = r22;
                                            if (!z6) {
                                            }
                                            this.spoilerPressed = null;
                                            this.isCaptionSpoilerPressed = false;
                                            this.isSpoilerRevealing = false;
                                            this.linkPreviewPressed = false;
                                            this.buttonPressed = 0;
                                            this.additionalTimeOffsetY = 0;
                                            this.miniButtonPressed = 0;
                                            this.pressedBotButton = i;
                                            this.pressedVoteButton = i;
                                            this.pollHintPressed = false;
                                            this.psaHintPressed = false;
                                            this.linkPreviewHeight = 0;
                                            this.mediaOffsetY = 0;
                                            this.documentAttachType = 0;
                                            this.documentAttach = null;
                                            this.descriptionLayout = null;
                                            this.titleLayout = null;
                                            this.videoInfoLayout = null;
                                            this.photosCountLayout = null;
                                            this.siteNameLayout = null;
                                            this.authorLayout = null;
                                            this.captionLayout = null;
                                            this.captionWidth = 0;
                                            this.captionHeight = 0;
                                            this.captionOffsetX = 0;
                                            this.currentCaption = null;
                                            this.docTitleLayout = null;
                                            this.drawImageButton = false;
                                            this.drawVideoImageButton = false;
                                            this.currentPhotoObject = null;
                                            this.photoParentObject = null;
                                            this.currentPhotoObjectThumb = null;
                                            this.currentPhotoObjectThumbStripped = null;
                                            if (!z3) {
                                            }
                                            this.currentPhotoFilter = null;
                                            this.buttonState = i;
                                            this.miniButtonState = i;
                                            this.hasMiniProgress = 0;
                                            if (this.addedForTest) {
                                            }
                                            this.addedForTest = false;
                                            this.photoNotSet = false;
                                            this.drawBackground = r13;
                                            this.drawName = false;
                                            this.useSeekBarWaveform = false;
                                            this.useTranscribeButton = false;
                                            this.drawInstantView = false;
                                            this.drawInstantViewType = 0;
                                            this.drawForwardedName = false;
                                            this.drawCommentButton = false;
                                            this.photoImage.setSideClip(0.0f);
                                            this.photoImage.setAspectFit(false);
                                            this.gradientShader = null;
                                            this.motionBackgroundDrawable = null;
                                            this.imageBackgroundColor = 0;
                                            this.imageBackgroundGradientColor1 = 0;
                                            this.imageBackgroundGradientColor2 = 0;
                                            this.imageBackgroundIntensity = 0.0f;
                                            this.imageBackgroundGradientColor3 = 0;
                                            this.imageBackgroundGradientRotation = 45;
                                            this.imageBackgroundSideColor = 0;
                                            this.mediaBackground = false;
                                            this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                            TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader2222222 = messageObject10.messageOwner.fwd_from;
                                            if (tLRPC$MessageFwdHeader2222222 != null) {
                                            }
                                            this.hasPsaHint = z9;
                                            if (z9) {
                                            }
                                            this.photoImage.setAlpha(f);
                                            if (!z3) {
                                            }
                                            this.pollButtons.clear();
                                            this.availableTimeWidth = 0;
                                            this.photoImage.setForceLoading(false);
                                            this.photoImage.setNeedsQualityThumb(false);
                                            this.photoImage.setShouldGenerateQualityThumb(false);
                                            this.photoImage.setAllowDecodeSingleFrame(false);
                                            this.photoImage.setColorFilter(null);
                                            this.photoImage.setMediaStartEndTime(-1L, -1L);
                                            if (!z46) {
                                            }
                                            messageObject10.reactionsChanged = false;
                                            groupedMessagePosition3 = this.currentPosition;
                                            if (groupedMessagePosition3 == null) {
                                            }
                                            if (!messageObject.shouldDrawReactionsInLayout()) {
                                            }
                                            if (z10) {
                                            }
                                            if (this.currentPosition != null) {
                                            }
                                            if (z3) {
                                            }
                                            groupedMessages3 = this.currentMessagesGroup;
                                            if (groupedMessages3 != null) {
                                            }
                                            isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                            if (this.hasDiscussion) {
                                            }
                                            repliesCount = getRepliesCount();
                                            if (!messageObject.shouldDrawWithoutBackground()) {
                                            }
                                            if (!this.isRepliesChat) {
                                            }
                                            this.commentLayout = null;
                                            this.drawCommentNumber = false;
                                            this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                            i5 = messageObject10.type;
                                            float f9222222222222 = 102.0f;
                                            if (i5 == 0) {
                                            }
                                            if (this.currentPosition != null) {
                                            }
                                            if (!messageObject10.isRestrictedMessage) {
                                            }
                                            if (this.captionLayout == null) {
                                            }
                                            if (!messageObject.isVoiceTranscriptionOpen()) {
                                            }
                                            int dp512222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                            staticLayout2 = this.captionLayout;
                                            if (staticLayout2 == null) {
                                            }
                                            if (this.currentMessageObject.type != i34) {
                                            }
                                            if (valueOf != null) {
                                            }
                                            groupedMessagePosition4 = this.currentPosition;
                                            if (groupedMessagePosition4 != null) {
                                            }
                                            int i20022222222222222222222222222 = this.widthBeforeNewTimeLine;
                                            i54 = -1;
                                            messageObject4 = this.currentMessageObject;
                                            if (messageObject4.eventId == 0) {
                                            }
                                            f4 = 0.0f;
                                            if (messageObject.isSponsored()) {
                                            }
                                            this.botButtons.clear();
                                            if (z46) {
                                            }
                                            if (!messageObject10.isRestrictedMessage) {
                                            }
                                            this.substractBackgroundHeight = 0;
                                            this.keyboardHeight = 0;
                                            r6 = hashMap;
                                            if (this.drawCommentButton) {
                                            }
                                            z29 = this.drawPinnedBottom;
                                            if (z29) {
                                            }
                                            if (!z29) {
                                            }
                                            if (messageObject10.type != 19) {
                                            }
                                            if (!this.drawPhotoImage) {
                                            }
                                            i58 = 5;
                                            if (this.documentAttachType == 5) {
                                            }
                                            calculateUnlockXY();
                                            if (z26) {
                                            }
                                            updateAnimatedEmojis();
                                            r62 = r6;
                                            if (z46) {
                                            }
                                            transcribeButton = this.transcribeButton;
                                            if (transcribeButton != null) {
                                            }
                                            updateWaveform();
                                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                            if (!this.currentMessageObject.loadingCancelled) {
                                            }
                                            chatMessageCellDelegate2 = this.delegate;
                                            if (chatMessageCellDelegate2 != null) {
                                            }
                                            this.accessibilityVirtualViewBounds.clear();
                                            this.transitionParams.updatePhotoImageX = true;
                                            updateFlagSecure();
                                        }
                                        this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                                        this.photoImage.setCrossfadeWithOldImage(false);
                                        this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                                        this.photoImage.setGradientBitmap(null);
                                        TLRPC$Message tLRPC$Message522 = messageObject10.messageOwner;
                                        this.lastSendState = tLRPC$Message522.send_state;
                                        this.lastDeleteDate = tLRPC$Message522.destroyTime;
                                        this.lastViewsCount = tLRPC$Message522.views;
                                        this.lastRepliesCount = getRepliesCount();
                                        if (!z46) {
                                        }
                                        this.gamePreviewPressed = z7;
                                        this.sideButtonPressed = z7;
                                        this.hasNewLineForTime = z7;
                                        this.flipImage = z7;
                                        if (!this.isThreadChat) {
                                        }
                                        this.isThreadPost = z47;
                                        this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                                        if (this.isChat) {
                                        }
                                        if (messageObject10.customAvatarDrawable != null) {
                                        }
                                        this.wasLayout = r2;
                                        this.groupPhotoInvisible = r2;
                                        int i11722222 = r2 == true ? 1 : 0;
                                        int i11822222 = r2 == true ? 1 : 0;
                                        this.animatingDrawVideoImageButton = i11722222;
                                        this.drawVideoSize = r2;
                                        this.canStreamVideo = r2;
                                        this.animatingNoSound = r2;
                                        if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                                        }
                                        r22 = 0;
                                        this.drawSideButton = 0;
                                        this.replyNameLayout = null;
                                        this.adminLayout = null;
                                        this.checkOnlyButtonPressed = r22;
                                        this.replyTextLayout = null;
                                        AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                        this.lastReplyMessage = null;
                                        this.hasEmbed = r22;
                                        this.autoPlayingMedia = r22;
                                        int i1202222222 = r22 == true ? 1 : 0;
                                        int i1212222222 = r22 == true ? 1 : 0;
                                        this.replyNameWidth = i1202222222;
                                        this.replyTextWidth = r22;
                                        this.viaWidth = r22;
                                        this.viaNameWidth = r22;
                                        this.addedCaptionHeight = r22;
                                        this.currentReplyPhoto = null;
                                        this.currentUser = null;
                                        this.currentChat = null;
                                        this.currentViaBotUser = null;
                                        this.instantViewLayout = null;
                                        this.drawNameLayout = r22;
                                        this.lastLoadingSizeTotal = 0L;
                                        if (this.scheduledInvalidate) {
                                        }
                                        this.links.clear();
                                        this.pressedLink = null;
                                        this.pressedEmoji = null;
                                        this.pressedLinkType = -1;
                                        messageObject10.forceUpdate = r22;
                                        this.drawPhotoImage = r22;
                                        this.drawMediaCheckBox = r22;
                                        this.hasLinkPreview = r22;
                                        this.hasOldCaptionPreview = r22;
                                        this.hasGamePreview = r22;
                                        this.hasInvoicePreview = r22;
                                        this.commentButtonPressed = r22;
                                        this.instantButtonPressed = r22;
                                        this.instantPressed = r22;
                                        if (!z6) {
                                        }
                                        this.spoilerPressed = null;
                                        this.isCaptionSpoilerPressed = false;
                                        this.isSpoilerRevealing = false;
                                        this.linkPreviewPressed = false;
                                        this.buttonPressed = 0;
                                        this.additionalTimeOffsetY = 0;
                                        this.miniButtonPressed = 0;
                                        this.pressedBotButton = i;
                                        this.pressedVoteButton = i;
                                        this.pollHintPressed = false;
                                        this.psaHintPressed = false;
                                        this.linkPreviewHeight = 0;
                                        this.mediaOffsetY = 0;
                                        this.documentAttachType = 0;
                                        this.documentAttach = null;
                                        this.descriptionLayout = null;
                                        this.titleLayout = null;
                                        this.videoInfoLayout = null;
                                        this.photosCountLayout = null;
                                        this.siteNameLayout = null;
                                        this.authorLayout = null;
                                        this.captionLayout = null;
                                        this.captionWidth = 0;
                                        this.captionHeight = 0;
                                        this.captionOffsetX = 0;
                                        this.currentCaption = null;
                                        this.docTitleLayout = null;
                                        this.drawImageButton = false;
                                        this.drawVideoImageButton = false;
                                        this.currentPhotoObject = null;
                                        this.photoParentObject = null;
                                        this.currentPhotoObjectThumb = null;
                                        this.currentPhotoObjectThumbStripped = null;
                                        if (!z3) {
                                        }
                                        this.currentPhotoFilter = null;
                                        this.buttonState = i;
                                        this.miniButtonState = i;
                                        this.hasMiniProgress = 0;
                                        if (this.addedForTest) {
                                        }
                                        this.addedForTest = false;
                                        this.photoNotSet = false;
                                        this.drawBackground = r13;
                                        this.drawName = false;
                                        this.useSeekBarWaveform = false;
                                        this.useTranscribeButton = false;
                                        this.drawInstantView = false;
                                        this.drawInstantViewType = 0;
                                        this.drawForwardedName = false;
                                        this.drawCommentButton = false;
                                        this.photoImage.setSideClip(0.0f);
                                        this.photoImage.setAspectFit(false);
                                        this.gradientShader = null;
                                        this.motionBackgroundDrawable = null;
                                        this.imageBackgroundColor = 0;
                                        this.imageBackgroundGradientColor1 = 0;
                                        this.imageBackgroundGradientColor2 = 0;
                                        this.imageBackgroundIntensity = 0.0f;
                                        this.imageBackgroundGradientColor3 = 0;
                                        this.imageBackgroundGradientRotation = 45;
                                        this.imageBackgroundSideColor = 0;
                                        this.mediaBackground = false;
                                        this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader22222222 = messageObject10.messageOwner.fwd_from;
                                        if (tLRPC$MessageFwdHeader22222222 != null) {
                                        }
                                        this.hasPsaHint = z9;
                                        if (z9) {
                                        }
                                        this.photoImage.setAlpha(f);
                                        if (!z3) {
                                        }
                                        this.pollButtons.clear();
                                        this.availableTimeWidth = 0;
                                        this.photoImage.setForceLoading(false);
                                        this.photoImage.setNeedsQualityThumb(false);
                                        this.photoImage.setShouldGenerateQualityThumb(false);
                                        this.photoImage.setAllowDecodeSingleFrame(false);
                                        this.photoImage.setColorFilter(null);
                                        this.photoImage.setMediaStartEndTime(-1L, -1L);
                                        if (!z46) {
                                        }
                                        messageObject10.reactionsChanged = false;
                                        groupedMessagePosition3 = this.currentPosition;
                                        if (groupedMessagePosition3 == null) {
                                        }
                                        if (!messageObject.shouldDrawReactionsInLayout()) {
                                        }
                                        if (z10) {
                                        }
                                        if (this.currentPosition != null) {
                                        }
                                        if (z3) {
                                        }
                                        groupedMessages3 = this.currentMessagesGroup;
                                        if (groupedMessages3 != null) {
                                        }
                                        isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                        if (this.hasDiscussion) {
                                        }
                                        repliesCount = getRepliesCount();
                                        if (!messageObject.shouldDrawWithoutBackground()) {
                                        }
                                        if (!this.isRepliesChat) {
                                        }
                                        this.commentLayout = null;
                                        this.drawCommentNumber = false;
                                        this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                        i5 = messageObject10.type;
                                        float f92222222222222 = 102.0f;
                                        if (i5 == 0) {
                                        }
                                        if (this.currentPosition != null) {
                                        }
                                        if (!messageObject10.isRestrictedMessage) {
                                        }
                                        if (this.captionLayout == null) {
                                        }
                                        if (!messageObject.isVoiceTranscriptionOpen()) {
                                        }
                                        int dp5122222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                        staticLayout2 = this.captionLayout;
                                        if (staticLayout2 == null) {
                                        }
                                        if (this.currentMessageObject.type != i34) {
                                        }
                                        if (valueOf != null) {
                                        }
                                        groupedMessagePosition4 = this.currentPosition;
                                        if (groupedMessagePosition4 != null) {
                                        }
                                        int i200222222222222222222222222222 = this.widthBeforeNewTimeLine;
                                        i54 = -1;
                                        messageObject4 = this.currentMessageObject;
                                        if (messageObject4.eventId == 0) {
                                        }
                                        f4 = 0.0f;
                                        if (messageObject.isSponsored()) {
                                        }
                                        this.botButtons.clear();
                                        if (z46) {
                                        }
                                        if (!messageObject10.isRestrictedMessage) {
                                        }
                                        this.substractBackgroundHeight = 0;
                                        this.keyboardHeight = 0;
                                        r6 = hashMap;
                                        if (this.drawCommentButton) {
                                        }
                                        z29 = this.drawPinnedBottom;
                                        if (z29) {
                                        }
                                        if (!z29) {
                                        }
                                        if (messageObject10.type != 19) {
                                        }
                                        if (!this.drawPhotoImage) {
                                        }
                                        i58 = 5;
                                        if (this.documentAttachType == 5) {
                                        }
                                        calculateUnlockXY();
                                        if (z26) {
                                        }
                                        updateAnimatedEmojis();
                                        r62 = r6;
                                        if (z46) {
                                        }
                                        transcribeButton = this.transcribeButton;
                                        if (transcribeButton != null) {
                                        }
                                        updateWaveform();
                                        updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                        if (!this.currentMessageObject.loadingCancelled) {
                                        }
                                        chatMessageCellDelegate2 = this.delegate;
                                        if (chatMessageCellDelegate2 != null) {
                                        }
                                        this.accessibilityVirtualViewBounds.clear();
                                        this.transitionParams.updatePhotoImageX = true;
                                        updateFlagSecure();
                                    }
                                    this.drawPinnedBottom = this.pinnedBottom && ((groupedMessagePosition16 = this.currentPosition) == null || (groupedMessagePosition16.flags & 8) != 0);
                                    this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                                    this.photoImage.setCrossfadeWithOldImage(false);
                                    this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                                    this.photoImage.setGradientBitmap(null);
                                    TLRPC$Message tLRPC$Message5222 = messageObject10.messageOwner;
                                    this.lastSendState = tLRPC$Message5222.send_state;
                                    this.lastDeleteDate = tLRPC$Message5222.destroyTime;
                                    this.lastViewsCount = tLRPC$Message5222.views;
                                    this.lastRepliesCount = getRepliesCount();
                                    if (!z46) {
                                    }
                                    this.gamePreviewPressed = z7;
                                    this.sideButtonPressed = z7;
                                    this.hasNewLineForTime = z7;
                                    this.flipImage = z7;
                                    if (!this.isThreadChat) {
                                    }
                                    this.isThreadPost = z47;
                                    this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                                    if (this.isChat) {
                                    }
                                    if (messageObject10.customAvatarDrawable != null) {
                                    }
                                    this.wasLayout = r2;
                                    this.groupPhotoInvisible = r2;
                                    int i117222222 = r2 == true ? 1 : 0;
                                    int i118222222 = r2 == true ? 1 : 0;
                                    this.animatingDrawVideoImageButton = i117222222;
                                    this.drawVideoSize = r2;
                                    this.canStreamVideo = r2;
                                    this.animatingNoSound = r2;
                                    if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                                    }
                                    r22 = 0;
                                    this.drawSideButton = 0;
                                    this.replyNameLayout = null;
                                    this.adminLayout = null;
                                    this.checkOnlyButtonPressed = r22;
                                    this.replyTextLayout = null;
                                    AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                    this.lastReplyMessage = null;
                                    this.hasEmbed = r22;
                                    this.autoPlayingMedia = r22;
                                    int i12022222222 = r22 == true ? 1 : 0;
                                    int i12122222222 = r22 == true ? 1 : 0;
                                    this.replyNameWidth = i12022222222;
                                    this.replyTextWidth = r22;
                                    this.viaWidth = r22;
                                    this.viaNameWidth = r22;
                                    this.addedCaptionHeight = r22;
                                    this.currentReplyPhoto = null;
                                    this.currentUser = null;
                                    this.currentChat = null;
                                    this.currentViaBotUser = null;
                                    this.instantViewLayout = null;
                                    this.drawNameLayout = r22;
                                    this.lastLoadingSizeTotal = 0L;
                                    if (this.scheduledInvalidate) {
                                    }
                                    this.links.clear();
                                    this.pressedLink = null;
                                    this.pressedEmoji = null;
                                    this.pressedLinkType = -1;
                                    messageObject10.forceUpdate = r22;
                                    this.drawPhotoImage = r22;
                                    this.drawMediaCheckBox = r22;
                                    this.hasLinkPreview = r22;
                                    this.hasOldCaptionPreview = r22;
                                    this.hasGamePreview = r22;
                                    this.hasInvoicePreview = r22;
                                    this.commentButtonPressed = r22;
                                    this.instantButtonPressed = r22;
                                    this.instantPressed = r22;
                                    if (!z6) {
                                    }
                                    this.spoilerPressed = null;
                                    this.isCaptionSpoilerPressed = false;
                                    this.isSpoilerRevealing = false;
                                    this.linkPreviewPressed = false;
                                    this.buttonPressed = 0;
                                    this.additionalTimeOffsetY = 0;
                                    this.miniButtonPressed = 0;
                                    this.pressedBotButton = i;
                                    this.pressedVoteButton = i;
                                    this.pollHintPressed = false;
                                    this.psaHintPressed = false;
                                    this.linkPreviewHeight = 0;
                                    this.mediaOffsetY = 0;
                                    this.documentAttachType = 0;
                                    this.documentAttach = null;
                                    this.descriptionLayout = null;
                                    this.titleLayout = null;
                                    this.videoInfoLayout = null;
                                    this.photosCountLayout = null;
                                    this.siteNameLayout = null;
                                    this.authorLayout = null;
                                    this.captionLayout = null;
                                    this.captionWidth = 0;
                                    this.captionHeight = 0;
                                    this.captionOffsetX = 0;
                                    this.currentCaption = null;
                                    this.docTitleLayout = null;
                                    this.drawImageButton = false;
                                    this.drawVideoImageButton = false;
                                    this.currentPhotoObject = null;
                                    this.photoParentObject = null;
                                    this.currentPhotoObjectThumb = null;
                                    this.currentPhotoObjectThumbStripped = null;
                                    if (!z3) {
                                    }
                                    this.currentPhotoFilter = null;
                                    this.buttonState = i;
                                    this.miniButtonState = i;
                                    this.hasMiniProgress = 0;
                                    if (this.addedForTest) {
                                    }
                                    this.addedForTest = false;
                                    this.photoNotSet = false;
                                    this.drawBackground = r13;
                                    this.drawName = false;
                                    this.useSeekBarWaveform = false;
                                    this.useTranscribeButton = false;
                                    this.drawInstantView = false;
                                    this.drawInstantViewType = 0;
                                    this.drawForwardedName = false;
                                    this.drawCommentButton = false;
                                    this.photoImage.setSideClip(0.0f);
                                    this.photoImage.setAspectFit(false);
                                    this.gradientShader = null;
                                    this.motionBackgroundDrawable = null;
                                    this.imageBackgroundColor = 0;
                                    this.imageBackgroundGradientColor1 = 0;
                                    this.imageBackgroundGradientColor2 = 0;
                                    this.imageBackgroundIntensity = 0.0f;
                                    this.imageBackgroundGradientColor3 = 0;
                                    this.imageBackgroundGradientRotation = 45;
                                    this.imageBackgroundSideColor = 0;
                                    this.mediaBackground = false;
                                    this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                    TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader222222222 = messageObject10.messageOwner.fwd_from;
                                    if (tLRPC$MessageFwdHeader222222222 != null) {
                                    }
                                    this.hasPsaHint = z9;
                                    if (z9) {
                                    }
                                    this.photoImage.setAlpha(f);
                                    if (!z3) {
                                    }
                                    this.pollButtons.clear();
                                    this.availableTimeWidth = 0;
                                    this.photoImage.setForceLoading(false);
                                    this.photoImage.setNeedsQualityThumb(false);
                                    this.photoImage.setShouldGenerateQualityThumb(false);
                                    this.photoImage.setAllowDecodeSingleFrame(false);
                                    this.photoImage.setColorFilter(null);
                                    this.photoImage.setMediaStartEndTime(-1L, -1L);
                                    if (!z46) {
                                    }
                                    messageObject10.reactionsChanged = false;
                                    groupedMessagePosition3 = this.currentPosition;
                                    if (groupedMessagePosition3 == null) {
                                    }
                                    if (!messageObject.shouldDrawReactionsInLayout()) {
                                    }
                                    if (z10) {
                                    }
                                    if (this.currentPosition != null) {
                                    }
                                    if (z3) {
                                    }
                                    groupedMessages3 = this.currentMessagesGroup;
                                    if (groupedMessages3 != null) {
                                    }
                                    isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                    if (this.hasDiscussion) {
                                    }
                                    repliesCount = getRepliesCount();
                                    if (!messageObject.shouldDrawWithoutBackground()) {
                                    }
                                    if (!this.isRepliesChat) {
                                    }
                                    this.commentLayout = null;
                                    this.drawCommentNumber = false;
                                    this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                    i5 = messageObject10.type;
                                    float f922222222222222 = 102.0f;
                                    if (i5 == 0) {
                                    }
                                    if (this.currentPosition != null) {
                                    }
                                    if (!messageObject10.isRestrictedMessage) {
                                    }
                                    if (this.captionLayout == null) {
                                    }
                                    if (!messageObject.isVoiceTranscriptionOpen()) {
                                    }
                                    int dp51222222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                    staticLayout2 = this.captionLayout;
                                    if (staticLayout2 == null) {
                                    }
                                    if (this.currentMessageObject.type != i34) {
                                    }
                                    if (valueOf != null) {
                                    }
                                    groupedMessagePosition4 = this.currentPosition;
                                    if (groupedMessagePosition4 != null) {
                                    }
                                    int i2002222222222222222222222222222 = this.widthBeforeNewTimeLine;
                                    i54 = -1;
                                    messageObject4 = this.currentMessageObject;
                                    if (messageObject4.eventId == 0) {
                                    }
                                    f4 = 0.0f;
                                    if (messageObject.isSponsored()) {
                                    }
                                    this.botButtons.clear();
                                    if (z46) {
                                    }
                                    if (!messageObject10.isRestrictedMessage) {
                                    }
                                    this.substractBackgroundHeight = 0;
                                    this.keyboardHeight = 0;
                                    r6 = hashMap;
                                    if (this.drawCommentButton) {
                                    }
                                    z29 = this.drawPinnedBottom;
                                    if (z29) {
                                    }
                                    if (!z29) {
                                    }
                                    if (messageObject10.type != 19) {
                                    }
                                    if (!this.drawPhotoImage) {
                                    }
                                    i58 = 5;
                                    if (this.documentAttachType == 5) {
                                    }
                                    calculateUnlockXY();
                                    if (z26) {
                                    }
                                    updateAnimatedEmojis();
                                    r62 = r6;
                                    if (z46) {
                                    }
                                    transcribeButton = this.transcribeButton;
                                    if (transcribeButton != null) {
                                    }
                                    updateWaveform();
                                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                    if (!this.currentMessageObject.loadingCancelled) {
                                    }
                                    chatMessageCellDelegate2 = this.delegate;
                                    if (chatMessageCellDelegate2 != null) {
                                    }
                                    this.accessibilityVirtualViewBounds.clear();
                                    this.transitionParams.updatePhotoImageX = true;
                                    updateFlagSecure();
                                }
                                this.drawPinnedTop = this.pinnedTop && ((groupedMessagePosition17 = this.currentPosition) == null || (groupedMessagePosition17.flags & 4) != 0);
                                this.drawPinnedBottom = this.pinnedBottom && ((groupedMessagePosition16 = this.currentPosition) == null || (groupedMessagePosition16.flags & 8) != 0);
                                this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                                this.photoImage.setCrossfadeWithOldImage(false);
                                this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                                this.photoImage.setGradientBitmap(null);
                                TLRPC$Message tLRPC$Message52222 = messageObject10.messageOwner;
                                this.lastSendState = tLRPC$Message52222.send_state;
                                this.lastDeleteDate = tLRPC$Message52222.destroyTime;
                                this.lastViewsCount = tLRPC$Message52222.views;
                                this.lastRepliesCount = getRepliesCount();
                                if (!z46) {
                                }
                                this.gamePreviewPressed = z7;
                                this.sideButtonPressed = z7;
                                this.hasNewLineForTime = z7;
                                this.flipImage = z7;
                                if (!this.isThreadChat) {
                                }
                                this.isThreadPost = z47;
                                this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                                if (this.isChat) {
                                }
                                if (messageObject10.customAvatarDrawable != null) {
                                }
                                this.wasLayout = r2;
                                this.groupPhotoInvisible = r2;
                                int i1172222222 = r2 == true ? 1 : 0;
                                int i1182222222 = r2 == true ? 1 : 0;
                                this.animatingDrawVideoImageButton = i1172222222;
                                this.drawVideoSize = r2;
                                this.canStreamVideo = r2;
                                this.animatingNoSound = r2;
                                if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                                }
                                r22 = 0;
                                this.drawSideButton = 0;
                                this.replyNameLayout = null;
                                this.adminLayout = null;
                                this.checkOnlyButtonPressed = r22;
                                this.replyTextLayout = null;
                                AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                                this.lastReplyMessage = null;
                                this.hasEmbed = r22;
                                this.autoPlayingMedia = r22;
                                int i120222222222 = r22 == true ? 1 : 0;
                                int i121222222222 = r22 == true ? 1 : 0;
                                this.replyNameWidth = i120222222222;
                                this.replyTextWidth = r22;
                                this.viaWidth = r22;
                                this.viaNameWidth = r22;
                                this.addedCaptionHeight = r22;
                                this.currentReplyPhoto = null;
                                this.currentUser = null;
                                this.currentChat = null;
                                this.currentViaBotUser = null;
                                this.instantViewLayout = null;
                                this.drawNameLayout = r22;
                                this.lastLoadingSizeTotal = 0L;
                                if (this.scheduledInvalidate) {
                                }
                                this.links.clear();
                                this.pressedLink = null;
                                this.pressedEmoji = null;
                                this.pressedLinkType = -1;
                                messageObject10.forceUpdate = r22;
                                this.drawPhotoImage = r22;
                                this.drawMediaCheckBox = r22;
                                this.hasLinkPreview = r22;
                                this.hasOldCaptionPreview = r22;
                                this.hasGamePreview = r22;
                                this.hasInvoicePreview = r22;
                                this.commentButtonPressed = r22;
                                this.instantButtonPressed = r22;
                                this.instantPressed = r22;
                                if (!z6) {
                                }
                                this.spoilerPressed = null;
                                this.isCaptionSpoilerPressed = false;
                                this.isSpoilerRevealing = false;
                                this.linkPreviewPressed = false;
                                this.buttonPressed = 0;
                                this.additionalTimeOffsetY = 0;
                                this.miniButtonPressed = 0;
                                this.pressedBotButton = i;
                                this.pressedVoteButton = i;
                                this.pollHintPressed = false;
                                this.psaHintPressed = false;
                                this.linkPreviewHeight = 0;
                                this.mediaOffsetY = 0;
                                this.documentAttachType = 0;
                                this.documentAttach = null;
                                this.descriptionLayout = null;
                                this.titleLayout = null;
                                this.videoInfoLayout = null;
                                this.photosCountLayout = null;
                                this.siteNameLayout = null;
                                this.authorLayout = null;
                                this.captionLayout = null;
                                this.captionWidth = 0;
                                this.captionHeight = 0;
                                this.captionOffsetX = 0;
                                this.currentCaption = null;
                                this.docTitleLayout = null;
                                this.drawImageButton = false;
                                this.drawVideoImageButton = false;
                                this.currentPhotoObject = null;
                                this.photoParentObject = null;
                                this.currentPhotoObjectThumb = null;
                                this.currentPhotoObjectThumbStripped = null;
                                if (!z3) {
                                }
                                this.currentPhotoFilter = null;
                                this.buttonState = i;
                                this.miniButtonState = i;
                                this.hasMiniProgress = 0;
                                if (this.addedForTest) {
                                }
                                this.addedForTest = false;
                                this.photoNotSet = false;
                                this.drawBackground = r13;
                                this.drawName = false;
                                this.useSeekBarWaveform = false;
                                this.useTranscribeButton = false;
                                this.drawInstantView = false;
                                this.drawInstantViewType = 0;
                                this.drawForwardedName = false;
                                this.drawCommentButton = false;
                                this.photoImage.setSideClip(0.0f);
                                this.photoImage.setAspectFit(false);
                                this.gradientShader = null;
                                this.motionBackgroundDrawable = null;
                                this.imageBackgroundColor = 0;
                                this.imageBackgroundGradientColor1 = 0;
                                this.imageBackgroundGradientColor2 = 0;
                                this.imageBackgroundIntensity = 0.0f;
                                this.imageBackgroundGradientColor3 = 0;
                                this.imageBackgroundGradientRotation = 45;
                                this.imageBackgroundSideColor = 0;
                                this.mediaBackground = false;
                                this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                                TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader2222222222 = messageObject10.messageOwner.fwd_from;
                                if (tLRPC$MessageFwdHeader2222222222 != null) {
                                }
                                this.hasPsaHint = z9;
                                if (z9) {
                                }
                                this.photoImage.setAlpha(f);
                                if (!z3) {
                                }
                                this.pollButtons.clear();
                                this.availableTimeWidth = 0;
                                this.photoImage.setForceLoading(false);
                                this.photoImage.setNeedsQualityThumb(false);
                                this.photoImage.setShouldGenerateQualityThumb(false);
                                this.photoImage.setAllowDecodeSingleFrame(false);
                                this.photoImage.setColorFilter(null);
                                this.photoImage.setMediaStartEndTime(-1L, -1L);
                                if (!z46) {
                                }
                                messageObject10.reactionsChanged = false;
                                groupedMessagePosition3 = this.currentPosition;
                                if (groupedMessagePosition3 == null) {
                                }
                                if (!messageObject.shouldDrawReactionsInLayout()) {
                                }
                                if (z10) {
                                }
                                if (this.currentPosition != null) {
                                }
                                if (z3) {
                                }
                                groupedMessages3 = this.currentMessagesGroup;
                                if (groupedMessages3 != null) {
                                }
                                isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                                if (this.hasDiscussion) {
                                }
                                repliesCount = getRepliesCount();
                                if (!messageObject.shouldDrawWithoutBackground()) {
                                }
                                if (!this.isRepliesChat) {
                                }
                                this.commentLayout = null;
                                this.drawCommentNumber = false;
                                this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                                i5 = messageObject10.type;
                                float f9222222222222222 = 102.0f;
                                if (i5 == 0) {
                                }
                                if (this.currentPosition != null) {
                                }
                                if (!messageObject10.isRestrictedMessage) {
                                }
                                if (this.captionLayout == null) {
                                }
                                if (!messageObject.isVoiceTranscriptionOpen()) {
                                }
                                int dp512222222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                                staticLayout2 = this.captionLayout;
                                if (staticLayout2 == null) {
                                }
                                if (this.currentMessageObject.type != i34) {
                                }
                                if (valueOf != null) {
                                }
                                groupedMessagePosition4 = this.currentPosition;
                                if (groupedMessagePosition4 != null) {
                                }
                                int i20022222222222222222222222222222 = this.widthBeforeNewTimeLine;
                                i54 = -1;
                                messageObject4 = this.currentMessageObject;
                                if (messageObject4.eventId == 0) {
                                }
                                f4 = 0.0f;
                                if (messageObject.isSponsored()) {
                                }
                                this.botButtons.clear();
                                if (z46) {
                                }
                                if (!messageObject10.isRestrictedMessage) {
                                }
                                this.substractBackgroundHeight = 0;
                                this.keyboardHeight = 0;
                                r6 = hashMap;
                                if (this.drawCommentButton) {
                                }
                                z29 = this.drawPinnedBottom;
                                if (z29) {
                                }
                                if (!z29) {
                                }
                                if (messageObject10.type != 19) {
                                }
                                if (!this.drawPhotoImage) {
                                }
                                i58 = 5;
                                if (this.documentAttachType == 5) {
                                }
                                calculateUnlockXY();
                                if (z26) {
                                }
                                updateAnimatedEmojis();
                                r62 = r6;
                                if (z46) {
                                }
                                transcribeButton = this.transcribeButton;
                                if (transcribeButton != null) {
                                }
                                updateWaveform();
                                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                                if (!this.currentMessageObject.loadingCancelled) {
                                }
                                chatMessageCellDelegate2 = this.delegate;
                                if (chatMessageCellDelegate2 != null) {
                                }
                                this.accessibilityVirtualViewBounds.clear();
                                this.transitionParams.updatePhotoImageX = true;
                                updateFlagSecure();
                            }
                            this.drawPinnedTop = this.pinnedTop;
                            this.drawPinnedBottom = this.pinnedBottom;
                            this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                            this.photoImage.setCrossfadeWithOldImage(false);
                            this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                            this.photoImage.setGradientBitmap(null);
                            TLRPC$Message tLRPC$Message522222 = messageObject10.messageOwner;
                            this.lastSendState = tLRPC$Message522222.send_state;
                            this.lastDeleteDate = tLRPC$Message522222.destroyTime;
                            this.lastViewsCount = tLRPC$Message522222.views;
                            this.lastRepliesCount = getRepliesCount();
                            if (!z46) {
                            }
                            this.gamePreviewPressed = z7;
                            this.sideButtonPressed = z7;
                            this.hasNewLineForTime = z7;
                            this.flipImage = z7;
                            if (!this.isThreadChat) {
                            }
                            this.isThreadPost = z47;
                            this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                            if (this.isChat) {
                            }
                            if (messageObject10.customAvatarDrawable != null) {
                            }
                            this.wasLayout = r2;
                            this.groupPhotoInvisible = r2;
                            int i11722222222 = r2 == true ? 1 : 0;
                            int i11822222222 = r2 == true ? 1 : 0;
                            this.animatingDrawVideoImageButton = i11722222222;
                            this.drawVideoSize = r2;
                            this.canStreamVideo = r2;
                            this.animatingNoSound = r2;
                            if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                            }
                            r22 = 0;
                            this.drawSideButton = 0;
                            this.replyNameLayout = null;
                            this.adminLayout = null;
                            this.checkOnlyButtonPressed = r22;
                            this.replyTextLayout = null;
                            AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                            this.lastReplyMessage = null;
                            this.hasEmbed = r22;
                            this.autoPlayingMedia = r22;
                            int i1202222222222 = r22 == true ? 1 : 0;
                            int i1212222222222 = r22 == true ? 1 : 0;
                            this.replyNameWidth = i1202222222222;
                            this.replyTextWidth = r22;
                            this.viaWidth = r22;
                            this.viaNameWidth = r22;
                            this.addedCaptionHeight = r22;
                            this.currentReplyPhoto = null;
                            this.currentUser = null;
                            this.currentChat = null;
                            this.currentViaBotUser = null;
                            this.instantViewLayout = null;
                            this.drawNameLayout = r22;
                            this.lastLoadingSizeTotal = 0L;
                            if (this.scheduledInvalidate) {
                            }
                            this.links.clear();
                            this.pressedLink = null;
                            this.pressedEmoji = null;
                            this.pressedLinkType = -1;
                            messageObject10.forceUpdate = r22;
                            this.drawPhotoImage = r22;
                            this.drawMediaCheckBox = r22;
                            this.hasLinkPreview = r22;
                            this.hasOldCaptionPreview = r22;
                            this.hasGamePreview = r22;
                            this.hasInvoicePreview = r22;
                            this.commentButtonPressed = r22;
                            this.instantButtonPressed = r22;
                            this.instantPressed = r22;
                            if (!z6) {
                            }
                            this.spoilerPressed = null;
                            this.isCaptionSpoilerPressed = false;
                            this.isSpoilerRevealing = false;
                            this.linkPreviewPressed = false;
                            this.buttonPressed = 0;
                            this.additionalTimeOffsetY = 0;
                            this.miniButtonPressed = 0;
                            this.pressedBotButton = i;
                            this.pressedVoteButton = i;
                            this.pollHintPressed = false;
                            this.psaHintPressed = false;
                            this.linkPreviewHeight = 0;
                            this.mediaOffsetY = 0;
                            this.documentAttachType = 0;
                            this.documentAttach = null;
                            this.descriptionLayout = null;
                            this.titleLayout = null;
                            this.videoInfoLayout = null;
                            this.photosCountLayout = null;
                            this.siteNameLayout = null;
                            this.authorLayout = null;
                            this.captionLayout = null;
                            this.captionWidth = 0;
                            this.captionHeight = 0;
                            this.captionOffsetX = 0;
                            this.currentCaption = null;
                            this.docTitleLayout = null;
                            this.drawImageButton = false;
                            this.drawVideoImageButton = false;
                            this.currentPhotoObject = null;
                            this.photoParentObject = null;
                            this.currentPhotoObjectThumb = null;
                            this.currentPhotoObjectThumbStripped = null;
                            if (!z3) {
                            }
                            this.currentPhotoFilter = null;
                            this.buttonState = i;
                            this.miniButtonState = i;
                            this.hasMiniProgress = 0;
                            if (this.addedForTest) {
                            }
                            this.addedForTest = false;
                            this.photoNotSet = false;
                            this.drawBackground = r13;
                            this.drawName = false;
                            this.useSeekBarWaveform = false;
                            this.useTranscribeButton = false;
                            this.drawInstantView = false;
                            this.drawInstantViewType = 0;
                            this.drawForwardedName = false;
                            this.drawCommentButton = false;
                            this.photoImage.setSideClip(0.0f);
                            this.photoImage.setAspectFit(false);
                            this.gradientShader = null;
                            this.motionBackgroundDrawable = null;
                            this.imageBackgroundColor = 0;
                            this.imageBackgroundGradientColor1 = 0;
                            this.imageBackgroundGradientColor2 = 0;
                            this.imageBackgroundIntensity = 0.0f;
                            this.imageBackgroundGradientColor3 = 0;
                            this.imageBackgroundGradientRotation = 45;
                            this.imageBackgroundSideColor = 0;
                            this.mediaBackground = false;
                            this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                            TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader22222222222 = messageObject10.messageOwner.fwd_from;
                            if (tLRPC$MessageFwdHeader22222222222 != null) {
                            }
                            this.hasPsaHint = z9;
                            if (z9) {
                            }
                            this.photoImage.setAlpha(f);
                            if (!z3) {
                            }
                            this.pollButtons.clear();
                            this.availableTimeWidth = 0;
                            this.photoImage.setForceLoading(false);
                            this.photoImage.setNeedsQualityThumb(false);
                            this.photoImage.setShouldGenerateQualityThumb(false);
                            this.photoImage.setAllowDecodeSingleFrame(false);
                            this.photoImage.setColorFilter(null);
                            this.photoImage.setMediaStartEndTime(-1L, -1L);
                            if (!z46) {
                            }
                            messageObject10.reactionsChanged = false;
                            groupedMessagePosition3 = this.currentPosition;
                            if (groupedMessagePosition3 == null) {
                            }
                            if (!messageObject.shouldDrawReactionsInLayout()) {
                            }
                            if (z10) {
                            }
                            if (this.currentPosition != null) {
                            }
                            if (z3) {
                            }
                            groupedMessages3 = this.currentMessagesGroup;
                            if (groupedMessages3 != null) {
                            }
                            isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                            if (this.hasDiscussion) {
                            }
                            repliesCount = getRepliesCount();
                            if (!messageObject.shouldDrawWithoutBackground()) {
                            }
                            if (!this.isRepliesChat) {
                            }
                            this.commentLayout = null;
                            this.drawCommentNumber = false;
                            this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                            i5 = messageObject10.type;
                            float f92222222222222222 = 102.0f;
                            if (i5 == 0) {
                            }
                            if (this.currentPosition != null) {
                            }
                            if (!messageObject10.isRestrictedMessage) {
                            }
                            if (this.captionLayout == null) {
                            }
                            if (!messageObject.isVoiceTranscriptionOpen()) {
                            }
                            int dp5122222222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                            staticLayout2 = this.captionLayout;
                            if (staticLayout2 == null) {
                            }
                            if (this.currentMessageObject.type != i34) {
                            }
                            if (valueOf != null) {
                            }
                            groupedMessagePosition4 = this.currentPosition;
                            if (groupedMessagePosition4 != null) {
                            }
                            int i200222222222222222222222222222222 = this.widthBeforeNewTimeLine;
                            i54 = -1;
                            messageObject4 = this.currentMessageObject;
                            if (messageObject4.eventId == 0) {
                            }
                            f4 = 0.0f;
                            if (messageObject.isSponsored()) {
                            }
                            this.botButtons.clear();
                            if (z46) {
                            }
                            if (!messageObject10.isRestrictedMessage) {
                            }
                            this.substractBackgroundHeight = 0;
                            this.keyboardHeight = 0;
                            r6 = hashMap;
                            if (this.drawCommentButton) {
                            }
                            z29 = this.drawPinnedBottom;
                            if (z29) {
                            }
                            if (!z29) {
                            }
                            if (messageObject10.type != 19) {
                            }
                            if (!this.drawPhotoImage) {
                            }
                            i58 = 5;
                            if (this.documentAttachType == 5) {
                            }
                            calculateUnlockXY();
                            if (z26) {
                            }
                            updateAnimatedEmojis();
                            r62 = r6;
                            if (z46) {
                            }
                            transcribeButton = this.transcribeButton;
                            if (transcribeButton != null) {
                            }
                            updateWaveform();
                            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                            if (!this.currentMessageObject.loadingCancelled) {
                            }
                            chatMessageCellDelegate2 = this.delegate;
                            if (chatMessageCellDelegate2 != null) {
                            }
                            this.accessibilityVirtualViewBounds.clear();
                            this.transitionParams.updatePhotoImageX = true;
                            updateFlagSecure();
                        }
                        this.currentMessagesGroup = null;
                        this.currentPosition = null;
                        groupedMessages2 = this.currentMessagesGroup;
                        if (groupedMessages2 == null) {
                        }
                        this.drawPinnedTop = this.pinnedTop;
                        this.drawPinnedBottom = this.pinnedBottom;
                        this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                        this.photoImage.setCrossfadeWithOldImage(false);
                        this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                        this.photoImage.setGradientBitmap(null);
                        TLRPC$Message tLRPC$Message5222222 = messageObject10.messageOwner;
                        this.lastSendState = tLRPC$Message5222222.send_state;
                        this.lastDeleteDate = tLRPC$Message5222222.destroyTime;
                        this.lastViewsCount = tLRPC$Message5222222.views;
                        this.lastRepliesCount = getRepliesCount();
                        if (!z46) {
                        }
                        this.gamePreviewPressed = z7;
                        this.sideButtonPressed = z7;
                        this.hasNewLineForTime = z7;
                        this.flipImage = z7;
                        if (!this.isThreadChat) {
                        }
                        this.isThreadPost = z47;
                        this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                        if (this.isChat) {
                        }
                        if (messageObject10.customAvatarDrawable != null) {
                        }
                        this.wasLayout = r2;
                        this.groupPhotoInvisible = r2;
                        int i117222222222 = r2 == true ? 1 : 0;
                        int i118222222222 = r2 == true ? 1 : 0;
                        this.animatingDrawVideoImageButton = i117222222222;
                        this.drawVideoSize = r2;
                        this.canStreamVideo = r2;
                        this.animatingNoSound = r2;
                        if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                        }
                        r22 = 0;
                        this.drawSideButton = 0;
                        this.replyNameLayout = null;
                        this.adminLayout = null;
                        this.checkOnlyButtonPressed = r22;
                        this.replyTextLayout = null;
                        AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                        this.lastReplyMessage = null;
                        this.hasEmbed = r22;
                        this.autoPlayingMedia = r22;
                        int i12022222222222 = r22 == true ? 1 : 0;
                        int i12122222222222 = r22 == true ? 1 : 0;
                        this.replyNameWidth = i12022222222222;
                        this.replyTextWidth = r22;
                        this.viaWidth = r22;
                        this.viaNameWidth = r22;
                        this.addedCaptionHeight = r22;
                        this.currentReplyPhoto = null;
                        this.currentUser = null;
                        this.currentChat = null;
                        this.currentViaBotUser = null;
                        this.instantViewLayout = null;
                        this.drawNameLayout = r22;
                        this.lastLoadingSizeTotal = 0L;
                        if (this.scheduledInvalidate) {
                        }
                        this.links.clear();
                        this.pressedLink = null;
                        this.pressedEmoji = null;
                        this.pressedLinkType = -1;
                        messageObject10.forceUpdate = r22;
                        this.drawPhotoImage = r22;
                        this.drawMediaCheckBox = r22;
                        this.hasLinkPreview = r22;
                        this.hasOldCaptionPreview = r22;
                        this.hasGamePreview = r22;
                        this.hasInvoicePreview = r22;
                        this.commentButtonPressed = r22;
                        this.instantButtonPressed = r22;
                        this.instantPressed = r22;
                        if (!z6) {
                        }
                        this.spoilerPressed = null;
                        this.isCaptionSpoilerPressed = false;
                        this.isSpoilerRevealing = false;
                        this.linkPreviewPressed = false;
                        this.buttonPressed = 0;
                        this.additionalTimeOffsetY = 0;
                        this.miniButtonPressed = 0;
                        this.pressedBotButton = i;
                        this.pressedVoteButton = i;
                        this.pollHintPressed = false;
                        this.psaHintPressed = false;
                        this.linkPreviewHeight = 0;
                        this.mediaOffsetY = 0;
                        this.documentAttachType = 0;
                        this.documentAttach = null;
                        this.descriptionLayout = null;
                        this.titleLayout = null;
                        this.videoInfoLayout = null;
                        this.photosCountLayout = null;
                        this.siteNameLayout = null;
                        this.authorLayout = null;
                        this.captionLayout = null;
                        this.captionWidth = 0;
                        this.captionHeight = 0;
                        this.captionOffsetX = 0;
                        this.currentCaption = null;
                        this.docTitleLayout = null;
                        this.drawImageButton = false;
                        this.drawVideoImageButton = false;
                        this.currentPhotoObject = null;
                        this.photoParentObject = null;
                        this.currentPhotoObjectThumb = null;
                        this.currentPhotoObjectThumbStripped = null;
                        if (!z3) {
                        }
                        this.currentPhotoFilter = null;
                        this.buttonState = i;
                        this.miniButtonState = i;
                        this.hasMiniProgress = 0;
                        if (this.addedForTest) {
                        }
                        this.addedForTest = false;
                        this.photoNotSet = false;
                        this.drawBackground = r13;
                        this.drawName = false;
                        this.useSeekBarWaveform = false;
                        this.useTranscribeButton = false;
                        this.drawInstantView = false;
                        this.drawInstantViewType = 0;
                        this.drawForwardedName = false;
                        this.drawCommentButton = false;
                        this.photoImage.setSideClip(0.0f);
                        this.photoImage.setAspectFit(false);
                        this.gradientShader = null;
                        this.motionBackgroundDrawable = null;
                        this.imageBackgroundColor = 0;
                        this.imageBackgroundGradientColor1 = 0;
                        this.imageBackgroundGradientColor2 = 0;
                        this.imageBackgroundIntensity = 0.0f;
                        this.imageBackgroundGradientColor3 = 0;
                        this.imageBackgroundGradientRotation = 45;
                        this.imageBackgroundSideColor = 0;
                        this.mediaBackground = false;
                        this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader222222222222 = messageObject10.messageOwner.fwd_from;
                        if (tLRPC$MessageFwdHeader222222222222 != null) {
                        }
                        this.hasPsaHint = z9;
                        if (z9) {
                        }
                        this.photoImage.setAlpha(f);
                        if (!z3) {
                        }
                        this.pollButtons.clear();
                        this.availableTimeWidth = 0;
                        this.photoImage.setForceLoading(false);
                        this.photoImage.setNeedsQualityThumb(false);
                        this.photoImage.setShouldGenerateQualityThumb(false);
                        this.photoImage.setAllowDecodeSingleFrame(false);
                        this.photoImage.setColorFilter(null);
                        this.photoImage.setMediaStartEndTime(-1L, -1L);
                        if (!z46) {
                        }
                        messageObject10.reactionsChanged = false;
                        groupedMessagePosition3 = this.currentPosition;
                        if (groupedMessagePosition3 == null) {
                        }
                        if (!messageObject.shouldDrawReactionsInLayout()) {
                        }
                        if (z10) {
                        }
                        if (this.currentPosition != null) {
                        }
                        if (z3) {
                        }
                        groupedMessages3 = this.currentMessagesGroup;
                        if (groupedMessages3 != null) {
                        }
                        isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                        if (this.hasDiscussion) {
                        }
                        repliesCount = getRepliesCount();
                        if (!messageObject.shouldDrawWithoutBackground()) {
                        }
                        if (!this.isRepliesChat) {
                        }
                        this.commentLayout = null;
                        this.drawCommentNumber = false;
                        this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                        i5 = messageObject10.type;
                        float f922222222222222222 = 102.0f;
                        if (i5 == 0) {
                        }
                        if (this.currentPosition != null) {
                        }
                        if (!messageObject10.isRestrictedMessage) {
                        }
                        if (this.captionLayout == null) {
                        }
                        if (!messageObject.isVoiceTranscriptionOpen()) {
                        }
                        int dp51222222222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                        staticLayout2 = this.captionLayout;
                        if (staticLayout2 == null) {
                        }
                        if (this.currentMessageObject.type != i34) {
                        }
                        if (valueOf != null) {
                        }
                        groupedMessagePosition4 = this.currentPosition;
                        if (groupedMessagePosition4 != null) {
                        }
                        int i2002222222222222222222222222222222 = this.widthBeforeNewTimeLine;
                        i54 = -1;
                        messageObject4 = this.currentMessageObject;
                        if (messageObject4.eventId == 0) {
                        }
                        f4 = 0.0f;
                        if (messageObject.isSponsored()) {
                        }
                        this.botButtons.clear();
                        if (z46) {
                        }
                        if (!messageObject10.isRestrictedMessage) {
                        }
                        this.substractBackgroundHeight = 0;
                        this.keyboardHeight = 0;
                        r6 = hashMap;
                        if (this.drawCommentButton) {
                        }
                        z29 = this.drawPinnedBottom;
                        if (z29) {
                        }
                        if (!z29) {
                        }
                        if (messageObject10.type != 19) {
                        }
                        if (!this.drawPhotoImage) {
                        }
                        i58 = 5;
                        if (this.documentAttachType == 5) {
                        }
                        calculateUnlockXY();
                        if (z26) {
                        }
                        updateAnimatedEmojis();
                        r62 = r6;
                        if (z46) {
                        }
                        transcribeButton = this.transcribeButton;
                        if (transcribeButton != null) {
                        }
                        updateWaveform();
                        updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                        if (!this.currentMessageObject.loadingCancelled) {
                        }
                        chatMessageCellDelegate2 = this.delegate;
                        if (chatMessageCellDelegate2 != null) {
                        }
                        this.accessibilityVirtualViewBounds.clear();
                        this.transitionParams.updatePhotoImageX = true;
                        updateFlagSecure();
                    }
                    z6 = z43;
                    z44 = false;
                    this.animatePollAvatars = z44;
                    if (z6) {
                    }
                    if (!z46) {
                    }
                    if (!z5) {
                    }
                    i = -1;
                    f = 1.0f;
                    i2 = 2;
                    if (!z3) {
                    }
                    this.wasPinned = this.isPinned;
                    this.pinnedBottom = z;
                    this.pinnedTop = z2;
                    this.currentMessageObject = messageObject10;
                    this.currentMessagesGroup = groupedMessages;
                    this.lastTime = -2;
                    this.lastPostAuthor = messageObject10.messageOwner.post_author;
                    this.isHighlightedAnimated = false;
                    this.widthBeforeNewTimeLine = -1;
                    if (groupedMessages != null) {
                    }
                    this.currentMessagesGroup = null;
                    this.currentPosition = null;
                    groupedMessages2 = this.currentMessagesGroup;
                    if (groupedMessages2 == null) {
                    }
                    this.drawPinnedTop = this.pinnedTop;
                    this.drawPinnedBottom = this.pinnedBottom;
                    this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                    this.photoImage.setCrossfadeWithOldImage(false);
                    this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                    this.photoImage.setGradientBitmap(null);
                    TLRPC$Message tLRPC$Message52222222 = messageObject10.messageOwner;
                    this.lastSendState = tLRPC$Message52222222.send_state;
                    this.lastDeleteDate = tLRPC$Message52222222.destroyTime;
                    this.lastViewsCount = tLRPC$Message52222222.views;
                    this.lastRepliesCount = getRepliesCount();
                    if (!z46) {
                    }
                    this.gamePreviewPressed = z7;
                    this.sideButtonPressed = z7;
                    this.hasNewLineForTime = z7;
                    this.flipImage = z7;
                    if (!this.isThreadChat) {
                    }
                    this.isThreadPost = z47;
                    this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                    if (this.isChat) {
                    }
                    if (messageObject10.customAvatarDrawable != null) {
                    }
                    this.wasLayout = r2;
                    this.groupPhotoInvisible = r2;
                    int i1172222222222 = r2 == true ? 1 : 0;
                    int i1182222222222 = r2 == true ? 1 : 0;
                    this.animatingDrawVideoImageButton = i1172222222222;
                    this.drawVideoSize = r2;
                    this.canStreamVideo = r2;
                    this.animatingNoSound = r2;
                    if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                    }
                    r22 = 0;
                    this.drawSideButton = 0;
                    this.replyNameLayout = null;
                    this.adminLayout = null;
                    this.checkOnlyButtonPressed = r22;
                    this.replyTextLayout = null;
                    AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                    this.lastReplyMessage = null;
                    this.hasEmbed = r22;
                    this.autoPlayingMedia = r22;
                    int i120222222222222 = r22 == true ? 1 : 0;
                    int i121222222222222 = r22 == true ? 1 : 0;
                    this.replyNameWidth = i120222222222222;
                    this.replyTextWidth = r22;
                    this.viaWidth = r22;
                    this.viaNameWidth = r22;
                    this.addedCaptionHeight = r22;
                    this.currentReplyPhoto = null;
                    this.currentUser = null;
                    this.currentChat = null;
                    this.currentViaBotUser = null;
                    this.instantViewLayout = null;
                    this.drawNameLayout = r22;
                    this.lastLoadingSizeTotal = 0L;
                    if (this.scheduledInvalidate) {
                    }
                    this.links.clear();
                    this.pressedLink = null;
                    this.pressedEmoji = null;
                    this.pressedLinkType = -1;
                    messageObject10.forceUpdate = r22;
                    this.drawPhotoImage = r22;
                    this.drawMediaCheckBox = r22;
                    this.hasLinkPreview = r22;
                    this.hasOldCaptionPreview = r22;
                    this.hasGamePreview = r22;
                    this.hasInvoicePreview = r22;
                    this.commentButtonPressed = r22;
                    this.instantButtonPressed = r22;
                    this.instantPressed = r22;
                    if (!z6) {
                    }
                    this.spoilerPressed = null;
                    this.isCaptionSpoilerPressed = false;
                    this.isSpoilerRevealing = false;
                    this.linkPreviewPressed = false;
                    this.buttonPressed = 0;
                    this.additionalTimeOffsetY = 0;
                    this.miniButtonPressed = 0;
                    this.pressedBotButton = i;
                    this.pressedVoteButton = i;
                    this.pollHintPressed = false;
                    this.psaHintPressed = false;
                    this.linkPreviewHeight = 0;
                    this.mediaOffsetY = 0;
                    this.documentAttachType = 0;
                    this.documentAttach = null;
                    this.descriptionLayout = null;
                    this.titleLayout = null;
                    this.videoInfoLayout = null;
                    this.photosCountLayout = null;
                    this.siteNameLayout = null;
                    this.authorLayout = null;
                    this.captionLayout = null;
                    this.captionWidth = 0;
                    this.captionHeight = 0;
                    this.captionOffsetX = 0;
                    this.currentCaption = null;
                    this.docTitleLayout = null;
                    this.drawImageButton = false;
                    this.drawVideoImageButton = false;
                    this.currentPhotoObject = null;
                    this.photoParentObject = null;
                    this.currentPhotoObjectThumb = null;
                    this.currentPhotoObjectThumbStripped = null;
                    if (!z3) {
                    }
                    this.currentPhotoFilter = null;
                    this.buttonState = i;
                    this.miniButtonState = i;
                    this.hasMiniProgress = 0;
                    if (this.addedForTest) {
                    }
                    this.addedForTest = false;
                    this.photoNotSet = false;
                    this.drawBackground = r13;
                    this.drawName = false;
                    this.useSeekBarWaveform = false;
                    this.useTranscribeButton = false;
                    this.drawInstantView = false;
                    this.drawInstantViewType = 0;
                    this.drawForwardedName = false;
                    this.drawCommentButton = false;
                    this.photoImage.setSideClip(0.0f);
                    this.photoImage.setAspectFit(false);
                    this.gradientShader = null;
                    this.motionBackgroundDrawable = null;
                    this.imageBackgroundColor = 0;
                    this.imageBackgroundGradientColor1 = 0;
                    this.imageBackgroundGradientColor2 = 0;
                    this.imageBackgroundIntensity = 0.0f;
                    this.imageBackgroundGradientColor3 = 0;
                    this.imageBackgroundGradientRotation = 45;
                    this.imageBackgroundSideColor = 0;
                    this.mediaBackground = false;
                    this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                    TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader2222222222222 = messageObject10.messageOwner.fwd_from;
                    if (tLRPC$MessageFwdHeader2222222222222 != null) {
                    }
                    this.hasPsaHint = z9;
                    if (z9) {
                    }
                    this.photoImage.setAlpha(f);
                    if (!z3) {
                    }
                    this.pollButtons.clear();
                    this.availableTimeWidth = 0;
                    this.photoImage.setForceLoading(false);
                    this.photoImage.setNeedsQualityThumb(false);
                    this.photoImage.setShouldGenerateQualityThumb(false);
                    this.photoImage.setAllowDecodeSingleFrame(false);
                    this.photoImage.setColorFilter(null);
                    this.photoImage.setMediaStartEndTime(-1L, -1L);
                    if (!z46) {
                    }
                    messageObject10.reactionsChanged = false;
                    groupedMessagePosition3 = this.currentPosition;
                    if (groupedMessagePosition3 == null) {
                    }
                    if (!messageObject.shouldDrawReactionsInLayout()) {
                    }
                    if (z10) {
                    }
                    if (this.currentPosition != null) {
                    }
                    if (z3) {
                    }
                    groupedMessages3 = this.currentMessagesGroup;
                    if (groupedMessages3 != null) {
                    }
                    isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                    if (this.hasDiscussion) {
                    }
                    repliesCount = getRepliesCount();
                    if (!messageObject.shouldDrawWithoutBackground()) {
                    }
                    if (!this.isRepliesChat) {
                    }
                    this.commentLayout = null;
                    this.drawCommentNumber = false;
                    this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                    i5 = messageObject10.type;
                    float f9222222222222222222 = 102.0f;
                    if (i5 == 0) {
                    }
                    if (this.currentPosition != null) {
                    }
                    if (!messageObject10.isRestrictedMessage) {
                    }
                    if (this.captionLayout == null) {
                    }
                    if (!messageObject.isVoiceTranscriptionOpen()) {
                    }
                    int dp512222222222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                    staticLayout2 = this.captionLayout;
                    if (staticLayout2 == null) {
                    }
                    if (this.currentMessageObject.type != i34) {
                    }
                    if (valueOf != null) {
                    }
                    groupedMessagePosition4 = this.currentPosition;
                    if (groupedMessagePosition4 != null) {
                    }
                    int i20022222222222222222222222222222222 = this.widthBeforeNewTimeLine;
                    i54 = -1;
                    messageObject4 = this.currentMessageObject;
                    if (messageObject4.eventId == 0) {
                    }
                    f4 = 0.0f;
                    if (messageObject.isSponsored()) {
                    }
                    this.botButtons.clear();
                    if (z46) {
                    }
                    if (!messageObject10.isRestrictedMessage) {
                    }
                    this.substractBackgroundHeight = 0;
                    this.keyboardHeight = 0;
                    r6 = hashMap;
                    if (this.drawCommentButton) {
                    }
                    z29 = this.drawPinnedBottom;
                    if (z29) {
                    }
                    if (!z29) {
                    }
                    if (messageObject10.type != 19) {
                    }
                    if (!this.drawPhotoImage) {
                    }
                    i58 = 5;
                    if (this.documentAttachType == 5) {
                    }
                    calculateUnlockXY();
                    if (z26) {
                    }
                    updateAnimatedEmojis();
                    r62 = r6;
                    if (z46) {
                    }
                    transcribeButton = this.transcribeButton;
                    if (transcribeButton != null) {
                    }
                    updateWaveform();
                    updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                    if (!this.currentMessageObject.loadingCancelled) {
                    }
                    chatMessageCellDelegate2 = this.delegate;
                    if (chatMessageCellDelegate2 != null) {
                    }
                    this.accessibilityVirtualViewBounds.clear();
                    this.transitionParams.updatePhotoImageX = true;
                    updateFlagSecure();
                }
                if (!z43) {
                }
                tLRPC$Poll2 = this.lastPoll;
                if (tLRPC$Poll2 == tLRPC$Poll) {
                }
                z6 = z43;
                z44 = false;
                this.animatePollAvatars = z44;
                if (z6) {
                }
                if (!z46) {
                }
                if (!z5) {
                }
                i = -1;
                f = 1.0f;
                i2 = 2;
                if (!z3) {
                }
                this.wasPinned = this.isPinned;
                this.pinnedBottom = z;
                this.pinnedTop = z2;
                this.currentMessageObject = messageObject10;
                this.currentMessagesGroup = groupedMessages;
                this.lastTime = -2;
                this.lastPostAuthor = messageObject10.messageOwner.post_author;
                this.isHighlightedAnimated = false;
                this.widthBeforeNewTimeLine = -1;
                if (groupedMessages != null) {
                }
                this.currentMessagesGroup = null;
                this.currentPosition = null;
                groupedMessages2 = this.currentMessagesGroup;
                if (groupedMessages2 == null) {
                }
                this.drawPinnedTop = this.pinnedTop;
                this.drawPinnedBottom = this.pinnedBottom;
                this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
                this.photoImage.setCrossfadeWithOldImage(false);
                this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                this.photoImage.setGradientBitmap(null);
                TLRPC$Message tLRPC$Message522222222 = messageObject10.messageOwner;
                this.lastSendState = tLRPC$Message522222222.send_state;
                this.lastDeleteDate = tLRPC$Message522222222.destroyTime;
                this.lastViewsCount = tLRPC$Message522222222.views;
                this.lastRepliesCount = getRepliesCount();
                if (!z46) {
                }
                this.gamePreviewPressed = z7;
                this.sideButtonPressed = z7;
                this.hasNewLineForTime = z7;
                this.flipImage = z7;
                if (!this.isThreadChat) {
                }
                this.isThreadPost = z47;
                this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
                if (this.isChat) {
                }
                if (messageObject10.customAvatarDrawable != null) {
                }
                this.wasLayout = r2;
                this.groupPhotoInvisible = r2;
                int i11722222222222 = r2 == true ? 1 : 0;
                int i11822222222222 = r2 == true ? 1 : 0;
                this.animatingDrawVideoImageButton = i11722222222222;
                this.drawVideoSize = r2;
                this.canStreamVideo = r2;
                this.animatingNoSound = r2;
                if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
                }
                r22 = 0;
                this.drawSideButton = 0;
                this.replyNameLayout = null;
                this.adminLayout = null;
                this.checkOnlyButtonPressed = r22;
                this.replyTextLayout = null;
                AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
                this.lastReplyMessage = null;
                this.hasEmbed = r22;
                this.autoPlayingMedia = r22;
                int i1202222222222222 = r22 == true ? 1 : 0;
                int i1212222222222222 = r22 == true ? 1 : 0;
                this.replyNameWidth = i1202222222222222;
                this.replyTextWidth = r22;
                this.viaWidth = r22;
                this.viaNameWidth = r22;
                this.addedCaptionHeight = r22;
                this.currentReplyPhoto = null;
                this.currentUser = null;
                this.currentChat = null;
                this.currentViaBotUser = null;
                this.instantViewLayout = null;
                this.drawNameLayout = r22;
                this.lastLoadingSizeTotal = 0L;
                if (this.scheduledInvalidate) {
                }
                this.links.clear();
                this.pressedLink = null;
                this.pressedEmoji = null;
                this.pressedLinkType = -1;
                messageObject10.forceUpdate = r22;
                this.drawPhotoImage = r22;
                this.drawMediaCheckBox = r22;
                this.hasLinkPreview = r22;
                this.hasOldCaptionPreview = r22;
                this.hasGamePreview = r22;
                this.hasInvoicePreview = r22;
                this.commentButtonPressed = r22;
                this.instantButtonPressed = r22;
                this.instantPressed = r22;
                if (!z6) {
                }
                this.spoilerPressed = null;
                this.isCaptionSpoilerPressed = false;
                this.isSpoilerRevealing = false;
                this.linkPreviewPressed = false;
                this.buttonPressed = 0;
                this.additionalTimeOffsetY = 0;
                this.miniButtonPressed = 0;
                this.pressedBotButton = i;
                this.pressedVoteButton = i;
                this.pollHintPressed = false;
                this.psaHintPressed = false;
                this.linkPreviewHeight = 0;
                this.mediaOffsetY = 0;
                this.documentAttachType = 0;
                this.documentAttach = null;
                this.descriptionLayout = null;
                this.titleLayout = null;
                this.videoInfoLayout = null;
                this.photosCountLayout = null;
                this.siteNameLayout = null;
                this.authorLayout = null;
                this.captionLayout = null;
                this.captionWidth = 0;
                this.captionHeight = 0;
                this.captionOffsetX = 0;
                this.currentCaption = null;
                this.docTitleLayout = null;
                this.drawImageButton = false;
                this.drawVideoImageButton = false;
                this.currentPhotoObject = null;
                this.photoParentObject = null;
                this.currentPhotoObjectThumb = null;
                this.currentPhotoObjectThumbStripped = null;
                if (!z3) {
                }
                this.currentPhotoFilter = null;
                this.buttonState = i;
                this.miniButtonState = i;
                this.hasMiniProgress = 0;
                if (this.addedForTest) {
                }
                this.addedForTest = false;
                this.photoNotSet = false;
                this.drawBackground = r13;
                this.drawName = false;
                this.useSeekBarWaveform = false;
                this.useTranscribeButton = false;
                this.drawInstantView = false;
                this.drawInstantViewType = 0;
                this.drawForwardedName = false;
                this.drawCommentButton = false;
                this.photoImage.setSideClip(0.0f);
                this.photoImage.setAspectFit(false);
                this.gradientShader = null;
                this.motionBackgroundDrawable = null;
                this.imageBackgroundColor = 0;
                this.imageBackgroundGradientColor1 = 0;
                this.imageBackgroundGradientColor2 = 0;
                this.imageBackgroundIntensity = 0.0f;
                this.imageBackgroundGradientColor3 = 0;
                this.imageBackgroundGradientRotation = 45;
                this.imageBackgroundSideColor = 0;
                this.mediaBackground = false;
                this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
                TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader22222222222222 = messageObject10.messageOwner.fwd_from;
                if (tLRPC$MessageFwdHeader22222222222222 != null) {
                }
                this.hasPsaHint = z9;
                if (z9) {
                }
                this.photoImage.setAlpha(f);
                if (!z3) {
                }
                this.pollButtons.clear();
                this.availableTimeWidth = 0;
                this.photoImage.setForceLoading(false);
                this.photoImage.setNeedsQualityThumb(false);
                this.photoImage.setShouldGenerateQualityThumb(false);
                this.photoImage.setAllowDecodeSingleFrame(false);
                this.photoImage.setColorFilter(null);
                this.photoImage.setMediaStartEndTime(-1L, -1L);
                if (!z46) {
                }
                messageObject10.reactionsChanged = false;
                groupedMessagePosition3 = this.currentPosition;
                if (groupedMessagePosition3 == null) {
                }
                if (!messageObject.shouldDrawReactionsInLayout()) {
                }
                if (z10) {
                }
                if (this.currentPosition != null) {
                }
                if (z3) {
                }
                groupedMessages3 = this.currentMessagesGroup;
                if (groupedMessages3 != null) {
                }
                isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
                if (this.hasDiscussion) {
                }
                repliesCount = getRepliesCount();
                if (!messageObject.shouldDrawWithoutBackground()) {
                }
                if (!this.isRepliesChat) {
                }
                this.commentLayout = null;
                this.drawCommentNumber = false;
                this.drawSideButton = !this.isRepliesChat ? 3 : 2;
                i5 = messageObject10.type;
                float f92222222222222222222 = 102.0f;
                if (i5 == 0) {
                }
                if (this.currentPosition != null) {
                }
                if (!messageObject10.isRestrictedMessage) {
                }
                if (this.captionLayout == null) {
                }
                if (!messageObject.isVoiceTranscriptionOpen()) {
                }
                int dp5122222222222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                staticLayout2 = this.captionLayout;
                if (staticLayout2 == null) {
                }
                if (this.currentMessageObject.type != i34) {
                }
                if (valueOf != null) {
                }
                groupedMessagePosition4 = this.currentPosition;
                if (groupedMessagePosition4 != null) {
                }
                int i200222222222222222222222222222222222 = this.widthBeforeNewTimeLine;
                i54 = -1;
                messageObject4 = this.currentMessageObject;
                if (messageObject4.eventId == 0) {
                }
                f4 = 0.0f;
                if (messageObject.isSponsored()) {
                }
                this.botButtons.clear();
                if (z46) {
                }
                if (!messageObject10.isRestrictedMessage) {
                }
                this.substractBackgroundHeight = 0;
                this.keyboardHeight = 0;
                r6 = hashMap;
                if (this.drawCommentButton) {
                }
                z29 = this.drawPinnedBottom;
                if (z29) {
                }
                if (!z29) {
                }
                if (messageObject10.type != 19) {
                }
                if (!this.drawPhotoImage) {
                }
                i58 = 5;
                if (this.documentAttachType == 5) {
                }
                calculateUnlockXY();
                if (z26) {
                }
                updateAnimatedEmojis();
                r62 = r6;
                if (z46) {
                }
                transcribeButton = this.transcribeButton;
                if (transcribeButton != null) {
                }
                updateWaveform();
                updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
                if (!this.currentMessageObject.loadingCancelled) {
                }
                chatMessageCellDelegate2 = this.delegate;
                if (chatMessageCellDelegate2 != null) {
                }
                this.accessibilityVirtualViewBounds.clear();
                this.transitionParams.updatePhotoImageX = true;
                updateFlagSecure();
            }
            z6 = false;
            if (!z5) {
            }
            i = -1;
            f = 1.0f;
            i2 = 2;
            if (!z3) {
            }
            this.wasPinned = this.isPinned;
            this.pinnedBottom = z;
            this.pinnedTop = z2;
            this.currentMessageObject = messageObject10;
            this.currentMessagesGroup = groupedMessages;
            this.lastTime = -2;
            this.lastPostAuthor = messageObject10.messageOwner.post_author;
            this.isHighlightedAnimated = false;
            this.widthBeforeNewTimeLine = -1;
            if (groupedMessages != null) {
            }
            this.currentMessagesGroup = null;
            this.currentPosition = null;
            groupedMessages2 = this.currentMessagesGroup;
            if (groupedMessages2 == null) {
            }
            this.drawPinnedTop = this.pinnedTop;
            this.drawPinnedBottom = this.pinnedBottom;
            this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
            this.photoImage.setCrossfadeWithOldImage(false);
            this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
            this.photoImage.setGradientBitmap(null);
            TLRPC$Message tLRPC$Message5222222222 = messageObject10.messageOwner;
            this.lastSendState = tLRPC$Message5222222222.send_state;
            this.lastDeleteDate = tLRPC$Message5222222222.destroyTime;
            this.lastViewsCount = tLRPC$Message5222222222.views;
            this.lastRepliesCount = getRepliesCount();
            if (!z46) {
            }
            this.gamePreviewPressed = z7;
            this.sideButtonPressed = z7;
            this.hasNewLineForTime = z7;
            this.flipImage = z7;
            if (!this.isThreadChat) {
            }
            this.isThreadPost = z47;
            this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
            if (this.isChat) {
            }
            if (messageObject10.customAvatarDrawable != null) {
            }
            this.wasLayout = r2;
            this.groupPhotoInvisible = r2;
            int i117222222222222 = r2 == true ? 1 : 0;
            int i118222222222222 = r2 == true ? 1 : 0;
            this.animatingDrawVideoImageButton = i117222222222222;
            this.drawVideoSize = r2;
            this.canStreamVideo = r2;
            this.animatingNoSound = r2;
            if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
            }
            r22 = 0;
            this.drawSideButton = 0;
            this.replyNameLayout = null;
            this.adminLayout = null;
            this.checkOnlyButtonPressed = r22;
            this.replyTextLayout = null;
            AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
            this.lastReplyMessage = null;
            this.hasEmbed = r22;
            this.autoPlayingMedia = r22;
            int i12022222222222222 = r22 == true ? 1 : 0;
            int i12122222222222222 = r22 == true ? 1 : 0;
            this.replyNameWidth = i12022222222222222;
            this.replyTextWidth = r22;
            this.viaWidth = r22;
            this.viaNameWidth = r22;
            this.addedCaptionHeight = r22;
            this.currentReplyPhoto = null;
            this.currentUser = null;
            this.currentChat = null;
            this.currentViaBotUser = null;
            this.instantViewLayout = null;
            this.drawNameLayout = r22;
            this.lastLoadingSizeTotal = 0L;
            if (this.scheduledInvalidate) {
            }
            this.links.clear();
            this.pressedLink = null;
            this.pressedEmoji = null;
            this.pressedLinkType = -1;
            messageObject10.forceUpdate = r22;
            this.drawPhotoImage = r22;
            this.drawMediaCheckBox = r22;
            this.hasLinkPreview = r22;
            this.hasOldCaptionPreview = r22;
            this.hasGamePreview = r22;
            this.hasInvoicePreview = r22;
            this.commentButtonPressed = r22;
            this.instantButtonPressed = r22;
            this.instantPressed = r22;
            if (!z6) {
            }
            this.spoilerPressed = null;
            this.isCaptionSpoilerPressed = false;
            this.isSpoilerRevealing = false;
            this.linkPreviewPressed = false;
            this.buttonPressed = 0;
            this.additionalTimeOffsetY = 0;
            this.miniButtonPressed = 0;
            this.pressedBotButton = i;
            this.pressedVoteButton = i;
            this.pollHintPressed = false;
            this.psaHintPressed = false;
            this.linkPreviewHeight = 0;
            this.mediaOffsetY = 0;
            this.documentAttachType = 0;
            this.documentAttach = null;
            this.descriptionLayout = null;
            this.titleLayout = null;
            this.videoInfoLayout = null;
            this.photosCountLayout = null;
            this.siteNameLayout = null;
            this.authorLayout = null;
            this.captionLayout = null;
            this.captionWidth = 0;
            this.captionHeight = 0;
            this.captionOffsetX = 0;
            this.currentCaption = null;
            this.docTitleLayout = null;
            this.drawImageButton = false;
            this.drawVideoImageButton = false;
            this.currentPhotoObject = null;
            this.photoParentObject = null;
            this.currentPhotoObjectThumb = null;
            this.currentPhotoObjectThumbStripped = null;
            if (!z3) {
            }
            this.currentPhotoFilter = null;
            this.buttonState = i;
            this.miniButtonState = i;
            this.hasMiniProgress = 0;
            if (this.addedForTest) {
            }
            this.addedForTest = false;
            this.photoNotSet = false;
            this.drawBackground = r13;
            this.drawName = false;
            this.useSeekBarWaveform = false;
            this.useTranscribeButton = false;
            this.drawInstantView = false;
            this.drawInstantViewType = 0;
            this.drawForwardedName = false;
            this.drawCommentButton = false;
            this.photoImage.setSideClip(0.0f);
            this.photoImage.setAspectFit(false);
            this.gradientShader = null;
            this.motionBackgroundDrawable = null;
            this.imageBackgroundColor = 0;
            this.imageBackgroundGradientColor1 = 0;
            this.imageBackgroundGradientColor2 = 0;
            this.imageBackgroundIntensity = 0.0f;
            this.imageBackgroundGradientColor3 = 0;
            this.imageBackgroundGradientRotation = 45;
            this.imageBackgroundSideColor = 0;
            this.mediaBackground = false;
            this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
            TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader222222222222222 = messageObject10.messageOwner.fwd_from;
            if (tLRPC$MessageFwdHeader222222222222222 != null) {
            }
            this.hasPsaHint = z9;
            if (z9) {
            }
            this.photoImage.setAlpha(f);
            if (!z3) {
            }
            this.pollButtons.clear();
            this.availableTimeWidth = 0;
            this.photoImage.setForceLoading(false);
            this.photoImage.setNeedsQualityThumb(false);
            this.photoImage.setShouldGenerateQualityThumb(false);
            this.photoImage.setAllowDecodeSingleFrame(false);
            this.photoImage.setColorFilter(null);
            this.photoImage.setMediaStartEndTime(-1L, -1L);
            if (!z46) {
            }
            messageObject10.reactionsChanged = false;
            groupedMessagePosition3 = this.currentPosition;
            if (groupedMessagePosition3 == null) {
            }
            if (!messageObject.shouldDrawReactionsInLayout()) {
            }
            if (z10) {
            }
            if (this.currentPosition != null) {
            }
            if (z3) {
            }
            groupedMessages3 = this.currentMessagesGroup;
            if (groupedMessages3 != null) {
            }
            isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
            if (this.hasDiscussion) {
            }
            repliesCount = getRepliesCount();
            if (!messageObject.shouldDrawWithoutBackground()) {
            }
            if (!this.isRepliesChat) {
            }
            this.commentLayout = null;
            this.drawCommentNumber = false;
            this.drawSideButton = !this.isRepliesChat ? 3 : 2;
            i5 = messageObject10.type;
            float f922222222222222222222 = 102.0f;
            if (i5 == 0) {
            }
            if (this.currentPosition != null) {
            }
            if (!messageObject10.isRestrictedMessage) {
            }
            if (this.captionLayout == null) {
            }
            if (!messageObject.isVoiceTranscriptionOpen()) {
            }
            int dp51222222222222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
            staticLayout2 = this.captionLayout;
            if (staticLayout2 == null) {
            }
            if (this.currentMessageObject.type != i34) {
            }
            if (valueOf != null) {
            }
            groupedMessagePosition4 = this.currentPosition;
            if (groupedMessagePosition4 != null) {
            }
            int i2002222222222222222222222222222222222 = this.widthBeforeNewTimeLine;
            i54 = -1;
            messageObject4 = this.currentMessageObject;
            if (messageObject4.eventId == 0) {
            }
            f4 = 0.0f;
            if (messageObject.isSponsored()) {
            }
            this.botButtons.clear();
            if (z46) {
            }
            if (!messageObject10.isRestrictedMessage) {
            }
            this.substractBackgroundHeight = 0;
            this.keyboardHeight = 0;
            r6 = hashMap;
            if (this.drawCommentButton) {
            }
            z29 = this.drawPinnedBottom;
            if (z29) {
            }
            if (!z29) {
            }
            if (messageObject10.type != 19) {
            }
            if (!this.drawPhotoImage) {
            }
            i58 = 5;
            if (this.documentAttachType == 5) {
            }
            calculateUnlockXY();
            if (z26) {
            }
            updateAnimatedEmojis();
            r62 = r6;
            if (z46) {
            }
            transcribeButton = this.transcribeButton;
            if (transcribeButton != null) {
            }
            updateWaveform();
            updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
            if (!this.currentMessageObject.loadingCancelled) {
            }
            chatMessageCellDelegate2 = this.delegate;
            if (chatMessageCellDelegate2 != null) {
            }
            this.accessibilityVirtualViewBounds.clear();
            this.transitionParams.updatePhotoImageX = true;
            updateFlagSecure();
        }
        if (groupedMessages != this.currentMessagesGroup) {
        }
        if (!z46) {
        }
        this.accessibilityText = null;
        if (!this.drawCommentButton) {
        }
        z4 = true;
        if (!z3) {
        }
        if (!z3) {
        }
        z6 = false;
        if (!z5) {
        }
        i = -1;
        f = 1.0f;
        i2 = 2;
        if (!z3) {
        }
        this.wasPinned = this.isPinned;
        this.pinnedBottom = z;
        this.pinnedTop = z2;
        this.currentMessageObject = messageObject10;
        this.currentMessagesGroup = groupedMessages;
        this.lastTime = -2;
        this.lastPostAuthor = messageObject10.messageOwner.post_author;
        this.isHighlightedAnimated = false;
        this.widthBeforeNewTimeLine = -1;
        if (groupedMessages != null) {
        }
        this.currentMessagesGroup = null;
        this.currentPosition = null;
        groupedMessages2 = this.currentMessagesGroup;
        if (groupedMessages2 == null) {
        }
        this.drawPinnedTop = this.pinnedTop;
        this.drawPinnedBottom = this.pinnedBottom;
        this.isPlayingRound = this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && (chatMessageCellDelegate = this.delegate) != null && !chatMessageCellDelegate.keyboardIsOpened() && !this.delegate.isLandscape();
        this.photoImage.setCrossfadeWithOldImage(false);
        this.photoImage.setCrossfadeDuration(ImageReceiver.DEFAULT_CROSSFADE_DURATION);
        this.photoImage.setGradientBitmap(null);
        TLRPC$Message tLRPC$Message52222222222 = messageObject10.messageOwner;
        this.lastSendState = tLRPC$Message52222222222.send_state;
        this.lastDeleteDate = tLRPC$Message52222222222.destroyTime;
        this.lastViewsCount = tLRPC$Message52222222222.views;
        this.lastRepliesCount = getRepliesCount();
        if (!z46) {
        }
        this.gamePreviewPressed = z7;
        this.sideButtonPressed = z7;
        this.hasNewLineForTime = z7;
        this.flipImage = z7;
        if (!this.isThreadChat) {
        }
        this.isThreadPost = z47;
        this.isAvatarVisible = !z47 && this.isChat && !messageObject.isOutOwner() && messageObject.needDrawAvatar() && ((groupedMessagePosition15 = this.currentPosition) == null || groupedMessagePosition15.edge);
        if (this.isChat) {
        }
        if (messageObject10.customAvatarDrawable != null) {
        }
        this.wasLayout = r2;
        this.groupPhotoInvisible = r2;
        int i1172222222222222 = r2 == true ? 1 : 0;
        int i1182222222222222 = r2 == true ? 1 : 0;
        this.animatingDrawVideoImageButton = i1172222222222222;
        this.drawVideoSize = r2;
        this.canStreamVideo = r2;
        this.animatingNoSound = r2;
        if (MessagesController.getInstance(this.currentAccount).isChatNoForwards(messageObject.getChatId())) {
        }
        r22 = 0;
        this.drawSideButton = 0;
        this.replyNameLayout = null;
        this.adminLayout = null;
        this.checkOnlyButtonPressed = r22;
        this.replyTextLayout = null;
        AnimatedEmojiSpan.release(this, this.animatedEmojiReplyStack);
        this.lastReplyMessage = null;
        this.hasEmbed = r22;
        this.autoPlayingMedia = r22;
        int i120222222222222222 = r22 == true ? 1 : 0;
        int i121222222222222222 = r22 == true ? 1 : 0;
        this.replyNameWidth = i120222222222222222;
        this.replyTextWidth = r22;
        this.viaWidth = r22;
        this.viaNameWidth = r22;
        this.addedCaptionHeight = r22;
        this.currentReplyPhoto = null;
        this.currentUser = null;
        this.currentChat = null;
        this.currentViaBotUser = null;
        this.instantViewLayout = null;
        this.drawNameLayout = r22;
        this.lastLoadingSizeTotal = 0L;
        if (this.scheduledInvalidate) {
        }
        this.links.clear();
        this.pressedLink = null;
        this.pressedEmoji = null;
        this.pressedLinkType = -1;
        messageObject10.forceUpdate = r22;
        this.drawPhotoImage = r22;
        this.drawMediaCheckBox = r22;
        this.hasLinkPreview = r22;
        this.hasOldCaptionPreview = r22;
        this.hasGamePreview = r22;
        this.hasInvoicePreview = r22;
        this.commentButtonPressed = r22;
        this.instantButtonPressed = r22;
        this.instantPressed = r22;
        if (!z6) {
        }
        this.spoilerPressed = null;
        this.isCaptionSpoilerPressed = false;
        this.isSpoilerRevealing = false;
        this.linkPreviewPressed = false;
        this.buttonPressed = 0;
        this.additionalTimeOffsetY = 0;
        this.miniButtonPressed = 0;
        this.pressedBotButton = i;
        this.pressedVoteButton = i;
        this.pollHintPressed = false;
        this.psaHintPressed = false;
        this.linkPreviewHeight = 0;
        this.mediaOffsetY = 0;
        this.documentAttachType = 0;
        this.documentAttach = null;
        this.descriptionLayout = null;
        this.titleLayout = null;
        this.videoInfoLayout = null;
        this.photosCountLayout = null;
        this.siteNameLayout = null;
        this.authorLayout = null;
        this.captionLayout = null;
        this.captionWidth = 0;
        this.captionHeight = 0;
        this.captionOffsetX = 0;
        this.currentCaption = null;
        this.docTitleLayout = null;
        this.drawImageButton = false;
        this.drawVideoImageButton = false;
        this.currentPhotoObject = null;
        this.photoParentObject = null;
        this.currentPhotoObjectThumb = null;
        this.currentPhotoObjectThumbStripped = null;
        if (!z3) {
        }
        this.currentPhotoFilter = null;
        this.buttonState = i;
        this.miniButtonState = i;
        this.hasMiniProgress = 0;
        if (this.addedForTest) {
        }
        this.addedForTest = false;
        this.photoNotSet = false;
        this.drawBackground = r13;
        this.drawName = false;
        this.useSeekBarWaveform = false;
        this.useTranscribeButton = false;
        this.drawInstantView = false;
        this.drawInstantViewType = 0;
        this.drawForwardedName = false;
        this.drawCommentButton = false;
        this.photoImage.setSideClip(0.0f);
        this.photoImage.setAspectFit(false);
        this.gradientShader = null;
        this.motionBackgroundDrawable = null;
        this.imageBackgroundColor = 0;
        this.imageBackgroundGradientColor1 = 0;
        this.imageBackgroundGradientColor2 = 0;
        this.imageBackgroundIntensity = 0.0f;
        this.imageBackgroundGradientColor3 = 0;
        this.imageBackgroundGradientRotation = 45;
        this.imageBackgroundSideColor = 0;
        this.mediaBackground = false;
        this.photoImage.animatedFileDrawableRepeatMaxCount = 0;
        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader2222222222222222 = messageObject10.messageOwner.fwd_from;
        if (tLRPC$MessageFwdHeader2222222222222222 != null) {
        }
        this.hasPsaHint = z9;
        if (z9) {
        }
        this.photoImage.setAlpha(f);
        if (!z3) {
        }
        this.pollButtons.clear();
        this.availableTimeWidth = 0;
        this.photoImage.setForceLoading(false);
        this.photoImage.setNeedsQualityThumb(false);
        this.photoImage.setShouldGenerateQualityThumb(false);
        this.photoImage.setAllowDecodeSingleFrame(false);
        this.photoImage.setColorFilter(null);
        this.photoImage.setMediaStartEndTime(-1L, -1L);
        if (!z46) {
        }
        messageObject10.reactionsChanged = false;
        groupedMessagePosition3 = this.currentPosition;
        if (groupedMessagePosition3 == null) {
        }
        if (!messageObject.shouldDrawReactionsInLayout()) {
        }
        if (z10) {
        }
        if (this.currentPosition != null) {
        }
        if (z3) {
        }
        groupedMessages3 = this.currentMessagesGroup;
        if (groupedMessages3 != null) {
        }
        isLinkedToChat = messageObject10.isLinkedToChat(this.linkedChatId);
        if (this.hasDiscussion) {
        }
        repliesCount = getRepliesCount();
        if (!messageObject.shouldDrawWithoutBackground()) {
        }
        if (!this.isRepliesChat) {
        }
        this.commentLayout = null;
        this.drawCommentNumber = false;
        this.drawSideButton = !this.isRepliesChat ? 3 : 2;
        i5 = messageObject10.type;
        float f9222222222222222222222 = 102.0f;
        if (i5 == 0) {
        }
        if (this.currentPosition != null) {
        }
        if (!messageObject10.isRestrictedMessage) {
        }
        if (this.captionLayout == null) {
        }
        if (!messageObject.isVoiceTranscriptionOpen()) {
        }
        int dp512222222222222222222222222222222222 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
        staticLayout2 = this.captionLayout;
        if (staticLayout2 == null) {
        }
        if (this.currentMessageObject.type != i34) {
        }
        if (valueOf != null) {
        }
        groupedMessagePosition4 = this.currentPosition;
        if (groupedMessagePosition4 != null) {
        }
        int i20022222222222222222222222222222222222 = this.widthBeforeNewTimeLine;
        i54 = -1;
        messageObject4 = this.currentMessageObject;
        if (messageObject4.eventId == 0) {
        }
        f4 = 0.0f;
        if (messageObject.isSponsored()) {
        }
        this.botButtons.clear();
        if (z46) {
        }
        if (!messageObject10.isRestrictedMessage) {
        }
        this.substractBackgroundHeight = 0;
        this.keyboardHeight = 0;
        r6 = hashMap;
        if (this.drawCommentButton) {
        }
        z29 = this.drawPinnedBottom;
        if (z29) {
        }
        if (!z29) {
        }
        if (messageObject10.type != 19) {
        }
        if (!this.drawPhotoImage) {
        }
        i58 = 5;
        if (this.documentAttachType == 5) {
        }
        calculateUnlockXY();
        if (z26) {
        }
        updateAnimatedEmojis();
        r62 = r6;
        if (z46) {
        }
        transcribeButton = this.transcribeButton;
        if (transcribeButton != null) {
        }
        updateWaveform();
        updateButtonState(false, !z46 && !messageObject10.cancelEditing, true);
        if (!this.currentMessageObject.loadingCancelled) {
        }
        chatMessageCellDelegate2 = this.delegate;
        if (chatMessageCellDelegate2 != null) {
        }
        this.accessibilityVirtualViewBounds.clear();
        this.transitionParams.updatePhotoImageX = true;
        updateFlagSecure();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public static /* synthetic */ int lambda$setMessageContent$5(PollButton pollButton, PollButton pollButton2) {
        if (pollButton.decimal > pollButton2.decimal) {
            return -1;
        }
        if (pollButton.decimal < pollButton2.decimal) {
            return 1;
        }
        if (pollButton.decimal != pollButton2.decimal) {
            return 0;
        }
        if (pollButton.percent > pollButton2.percent) {
            return 1;
        }
        return pollButton.percent < pollButton2.percent ? -1 : 0;
    }

    private void calculateUnlockXY() {
        if (this.currentMessageObject.type != 20 || this.unlockLayout == null) {
            return;
        }
        this.unlockX = this.backgroundDrawableLeft + ((this.photoImage.getImageWidth() - this.unlockLayout.getWidth()) / 2.0f);
        this.unlockY = this.backgroundDrawableTop + this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - this.unlockLayout.getHeight()) / 2.0f);
    }

    private void updateFlagSecure() {
        Runnable runnable;
        TLRPC$Message tLRPC$Message;
        MessageObject messageObject = this.currentMessageObject;
        boolean z = (messageObject == null || (tLRPC$Message = messageObject.messageOwner) == null || (!tLRPC$Message.noforwards && !messageObject.hasRevealedExtendedMedia())) ? false : true;
        Activity findActivity = AndroidUtilities.findActivity(getContext());
        if (z && this.unregisterFlagSecure == null && findActivity != null) {
            this.unregisterFlagSecure = AndroidUtilities.registerFlagSecure(findActivity.getWindow());
        } else if (z || (runnable = this.unregisterFlagSecure) == null) {
        } else {
            runnable.run();
            this.unregisterFlagSecure = null;
        }
    }

    public void checkVideoPlayback(boolean z, Bitmap bitmap) {
        if (this.currentMessageObject.isVideo()) {
            if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                this.photoImage.setAllowStartAnimation(false);
                this.photoImage.stopAnimation();
                return;
            }
            this.photoImage.setAllowStartAnimation(true);
            this.photoImage.startAnimation();
            return;
        }
        if (z) {
            MessageObject playingMessageObject = MediaController.getInstance().getPlayingMessageObject();
            z = playingMessageObject == null || !playingMessageObject.isRoundVideo();
        }
        this.photoImage.setAllowStartAnimation(z);
        if (bitmap != null) {
            this.photoImage.startCrossfadeFromStaticThumb(bitmap);
        }
        if (z) {
            this.photoImage.startAnimation();
        } else {
            this.photoImage.stopAnimation();
        }
    }

    private static boolean spanSupportsLongPress(CharacterStyle characterStyle) {
        return (characterStyle instanceof URLSpanMono) || (characterStyle instanceof URLSpan);
    }

    @Override // org.telegram.ui.Cells.BaseCell
    protected boolean onLongPress() {
        int i;
        int i2;
        boolean z = false;
        if (this.isRoundVideo && this.isPlayingRound && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && ((this.lastTouchX - this.photoImage.getCenterX()) * (this.lastTouchX - this.photoImage.getCenterX())) + ((this.lastTouchY - this.photoImage.getCenterY()) * (this.lastTouchY - this.photoImage.getCenterY())) < (this.photoImage.getImageWidth() / 2.0f) * (this.photoImage.getImageWidth() / 2.0f) && (this.lastTouchX > this.photoImage.getCenterX() + (this.photoImage.getImageWidth() / 4.0f) || this.lastTouchX < this.photoImage.getCenterX() - (this.photoImage.getImageWidth() / 4.0f))) {
            boolean z2 = this.lastTouchX > this.photoImage.getCenterX();
            if (this.videoPlayerRewinder == null) {
                this.videoForwardDrawable = new VideoForwardDrawable(true);
                this.videoPlayerRewinder = new VideoPlayerRewinder() { // from class: org.telegram.ui.Cells.ChatMessageCell.4
                    @Override // org.telegram.messenger.video.VideoPlayerRewinder
                    protected void onRewindCanceled() {
                        ChatMessageCell.this.onTouchEvent(MotionEvent.obtain(0L, 0L, 3, 0.0f, 0.0f, 0));
                        ChatMessageCell.this.videoForwardDrawable.setShowing(false);
                    }

                    @Override // org.telegram.messenger.video.VideoPlayerRewinder
                    protected void updateRewindProgressUi(long j, float f, boolean z3) {
                        ChatMessageCell.this.videoForwardDrawable.setTime(Math.abs(j));
                        if (z3) {
                            ChatMessageCell.this.currentMessageObject.audioProgress = f;
                            ChatMessageCell.this.updatePlayingMessageProgress();
                        }
                    }

                    @Override // org.telegram.messenger.video.VideoPlayerRewinder
                    protected void onRewindStart(boolean z3) {
                        ChatMessageCell.this.videoForwardDrawable.setDelegate(new VideoForwardDrawable.VideoForwardDrawableDelegate() { // from class: org.telegram.ui.Cells.ChatMessageCell.4.1
                            @Override // org.telegram.ui.Components.VideoForwardDrawable.VideoForwardDrawableDelegate
                            public void onAnimationEnd() {
                            }

                            @Override // org.telegram.ui.Components.VideoForwardDrawable.VideoForwardDrawableDelegate
                            public void invalidate() {
                                ChatMessageCell.this.invalidate();
                            }
                        });
                        ChatMessageCell.this.videoForwardDrawable.setOneShootAnimation(false);
                        ChatMessageCell.this.videoForwardDrawable.setLeftSide(!z3);
                        ChatMessageCell.this.videoForwardDrawable.setShowing(true);
                        ChatMessageCell.this.invalidate();
                    }
                };
                getParent().requestDisallowInterceptTouchEvent(true);
            }
            this.videoPlayerRewinder.startRewind(MediaController.getInstance().getVideoPlayer(), z2, MediaController.getInstance().getPlaybackSpeed(false));
            return false;
        }
        if (this.pressedEmoji != null) {
            this.pressedEmoji = null;
        }
        LinkSpanDrawable linkSpanDrawable = this.pressedLink;
        if (linkSpanDrawable != null) {
            if (linkSpanDrawable.getSpan() instanceof URLSpanMono) {
                this.hadLongPress = true;
                this.delegate.didPressUrl(this, this.pressedLink.getSpan(), true);
                return true;
            } else if (this.pressedLink.getSpan() instanceof URLSpanNoUnderline) {
                URLSpanNoUnderline uRLSpanNoUnderline = (URLSpanNoUnderline) this.pressedLink.getSpan();
                if (ChatActivity.isClickableLink(uRLSpanNoUnderline.getURL()) || uRLSpanNoUnderline.getURL().startsWith("/")) {
                    this.hadLongPress = true;
                    this.delegate.didPressUrl(this, this.pressedLink.getSpan(), true);
                    return true;
                }
            } else if (this.pressedLink.getSpan() instanceof URLSpan) {
                this.hadLongPress = true;
                this.delegate.didPressUrl(this, this.pressedLink.getSpan(), true);
                return true;
            }
        }
        resetPressedLink(-1);
        if (this.buttonPressed != 0 || this.miniButtonPressed != 0 || this.videoButtonPressed != 0 || this.pressedBotButton != -1) {
            this.buttonPressed = 0;
            this.miniButtonPressed = 0;
            this.videoButtonPressed = 0;
            this.pressedBotButton = -1;
            invalidate();
        }
        this.linkPreviewPressed = false;
        this.sideButtonPressed = false;
        this.imagePressed = false;
        this.timePressed = false;
        this.gamePreviewPressed = false;
        if (this.pressedVoteButton != -1 || this.pollHintPressed || this.psaHintPressed || this.instantPressed || this.otherPressed || this.commentButtonPressed) {
            this.commentButtonPressed = false;
            this.instantButtonPressed = false;
            this.instantPressed = false;
            this.pressedVoteButton = -1;
            this.pollHintPressed = false;
            this.psaHintPressed = false;
            this.otherPressed = false;
            if (Build.VERSION.SDK_INT >= 21) {
                int i3 = 0;
                while (true) {
                    Drawable[] drawableArr = this.selectorDrawable;
                    if (i3 >= drawableArr.length) {
                        break;
                    }
                    if (drawableArr[i3] != null) {
                        drawableArr[i3].setState(StateSet.NOTHING);
                    }
                    i3++;
                }
            }
            invalidate();
        }
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        if (chatMessageCellDelegate != null) {
            if (this.avatarPressed) {
                TLRPC$User tLRPC$User = this.currentUser;
                if (tLRPC$User != null) {
                    if (tLRPC$User.id != 0) {
                        z = chatMessageCellDelegate.didLongPressUserAvatar(this, tLRPC$User, this.lastTouchX, this.lastTouchY);
                    }
                } else {
                    TLRPC$Chat tLRPC$Chat = this.currentChat;
                    if (tLRPC$Chat != null) {
                        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader = this.currentMessageObject.messageOwner.fwd_from;
                        if (tLRPC$MessageFwdHeader != null) {
                            if ((tLRPC$MessageFwdHeader.flags & 16) != 0) {
                                i2 = tLRPC$MessageFwdHeader.saved_from_msg_id;
                            } else {
                                i2 = tLRPC$MessageFwdHeader.channel_post;
                            }
                            i = i2;
                        } else {
                            i = 0;
                        }
                        z = chatMessageCellDelegate.didLongPressChannelAvatar(this, tLRPC$Chat, i, this.lastTouchX, this.lastTouchY);
                    }
                }
            }
            if (!z) {
                this.delegate.didLongPress(this, this.lastTouchX, this.lastTouchY);
            }
        }
        return true;
    }

    public void showHintButton(boolean z, boolean z2, int i) {
        float f = 1.0f;
        if (i == -1 || i == 0) {
            if (this.hintButtonVisible == z) {
                return;
            }
            this.hintButtonVisible = z;
            if (!z2) {
                this.hintButtonProgress = z ? 1.0f : 0.0f;
            } else {
                invalidate();
            }
        }
        if ((i == -1 || i == 1) && this.psaButtonVisible != z) {
            this.psaButtonVisible = z;
            if (!z2) {
                if (!z) {
                    f = 0.0f;
                }
                this.psaButtonProgress = f;
                return;
            }
            setInvalidatesParent(true);
            invalidate();
        }
    }

    public void setCheckPressed(boolean z, boolean z2) {
        this.isCheckPressed = z;
        this.isPressed = z2;
        updateRadialProgressBackground();
        if (this.useSeekBarWaveform) {
            this.seekBarWaveform.setSelected(isDrawSelectionBackground());
        } else {
            this.seekBar.setSelected(isDrawSelectionBackground());
        }
        invalidate();
    }

    public void setInvalidateSpoilersParent(boolean z) {
        this.invalidateSpoilersParent = z;
    }

    public void setInvalidatesParent(boolean z) {
        this.invalidatesParent = z;
    }

    @Override // android.view.View, org.telegram.ui.Cells.TextSelectionHelper.SelectableView
    public void invalidate() {
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.currentMessageObject == null) {
            return;
        }
        super.invalidate();
        if ((this.invalidatesParent || (this.currentMessagesGroup != null && (!this.links.isEmpty() || !this.reactionsLayoutInBubble.isEmpty))) && getParent() != null) {
            View view = (View) getParent();
            if (view.getParent() != null) {
                view.invalidate();
                ((View) view.getParent()).invalidate();
            }
        }
        if (!this.isBlurred || (chatMessageCellDelegate = this.delegate) == null) {
            return;
        }
        chatMessageCellDelegate.invalidateBlur();
    }

    @Override // android.view.View
    public void invalidate(int i, int i2, int i3, int i4) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.currentMessageObject == null) {
            return;
        }
        super.invalidate(i, i2, i3, i4);
        if (this.invalidatesParent && getParent() != null) {
            ((View) getParent()).invalidate(((int) getX()) + i, ((int) getY()) + i2, ((int) getX()) + i3, ((int) getY()) + i4);
        }
        if (!this.isBlurred || (chatMessageCellDelegate = this.delegate) == null) {
            return;
        }
        chatMessageCellDelegate.invalidateBlur();
    }

    public boolean isHighlightedAnimated() {
        return this.isHighlightedAnimated;
    }

    public void setHighlightedAnimated() {
        this.isHighlightedAnimated = true;
        this.highlightProgress = 1000;
        this.lastHighlightProgressTime = System.currentTimeMillis();
        invalidate();
        if (getParent() != null) {
            ((View) getParent()).invalidate();
        }
    }

    public boolean isHighlighted() {
        return this.isHighlighted;
    }

    public void setHighlighted(boolean z) {
        if (this.isHighlighted == z) {
            return;
        }
        this.isHighlighted = z;
        if (!z) {
            this.lastHighlightProgressTime = System.currentTimeMillis();
            this.isHighlightedAnimated = true;
            this.highlightProgress = 300;
        } else {
            this.isHighlightedAnimated = false;
            this.highlightProgress = 0;
        }
        updateRadialProgressBackground();
        if (this.useSeekBarWaveform) {
            this.seekBarWaveform.setSelected(isDrawSelectionBackground());
        } else {
            this.seekBar.setSelected(isDrawSelectionBackground());
        }
        invalidate();
        if (getParent() == null) {
            return;
        }
        ((View) getParent()).invalidate();
    }

    @Override // android.view.View
    public void setPressed(boolean z) {
        super.setPressed(z);
        updateRadialProgressBackground();
        if (this.useSeekBarWaveform) {
            this.seekBarWaveform.setSelected(isDrawSelectionBackground());
        } else {
            this.seekBar.setSelected(isDrawSelectionBackground());
        }
        invalidate();
    }

    private void updateRadialProgressBackground() {
        if (this.drawRadialCheckBackground) {
            return;
        }
        boolean z = true;
        boolean z2 = (this.isHighlighted || this.isPressed || isPressed()) && (!this.drawPhotoImage || !this.photoImage.hasBitmapImage());
        this.radialProgress.setPressed(z2 || this.buttonPressed != 0, false);
        if (this.hasMiniProgress != 0) {
            this.radialProgress.setPressed(z2 || this.miniButtonPressed != 0, true);
        }
        RadialProgress2 radialProgress2 = this.videoRadialProgress;
        if (!z2 && this.videoButtonPressed == 0) {
            z = false;
        }
        radialProgress2.setPressed(z, false);
    }

    @Override // org.telegram.ui.Components.SeekBar.SeekBarDelegate
    public void onSeekBarDrag(float f) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        messageObject.audioProgress = f;
        MediaController.getInstance().seekToProgress(this.currentMessageObject, f);
        updatePlayingMessageProgress();
    }

    @Override // org.telegram.ui.Components.SeekBar.SeekBarDelegate
    public void onSeekBarContinuousDrag(float f) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        messageObject.audioProgress = f;
        messageObject.audioProgressSec = (int) (messageObject.getDuration() * f);
        updatePlayingMessageProgress();
    }

    public boolean isAnimatingPollAnswer() {
        return this.animatePollAnswerAlpha;
    }

    private void updateWaveform() {
        TLRPC$Message tLRPC$Message;
        if (this.currentMessageObject == null || this.documentAttachType != 3) {
            return;
        }
        boolean z = false;
        int i = 0;
        while (true) {
            if (i >= this.documentAttach.attributes.size()) {
                break;
            }
            TLRPC$DocumentAttribute tLRPC$DocumentAttribute = this.documentAttach.attributes.get(i);
            if (tLRPC$DocumentAttribute instanceof TLRPC$TL_documentAttributeAudio) {
                byte[] bArr = tLRPC$DocumentAttribute.waveform;
                if (bArr == null || bArr.length == 0) {
                    MediaController.getInstance().generateWaveform(this.currentMessageObject);
                }
                byte[] bArr2 = tLRPC$DocumentAttribute.waveform;
                this.useSeekBarWaveform = bArr2 != null;
                this.seekBarWaveform.setWaveform(bArr2);
            } else {
                i++;
            }
        }
        if (this.currentMessageObject.isVoice() && this.useSeekBarWaveform && (tLRPC$Message = this.currentMessageObject.messageOwner) != null && !(MessageObject.getMedia(tLRPC$Message) instanceof TLRPC$TL_messageMediaWebPage) && UserConfig.getInstance(this.currentAccount).isPremium()) {
            z = true;
        }
        this.useTranscribeButton = z;
        updateSeekBarWaveformWidth();
    }

    private void updateSeekBarWaveformWidth() {
        if (this.seekBarWaveform != null) {
            int dp = (-AndroidUtilities.dp((this.hasLinkPreview ? 10 : 0) + 92)) - AndroidUtilities.dp(this.useTranscribeButton ? 34.0f : 0.0f);
            TransitionParams transitionParams = this.transitionParams;
            if (transitionParams.animateBackgroundBoundsInner && this.documentAttachType == 3) {
                int i = this.backgroundWidth;
                this.seekBarWaveform.setSize(((int) ((i - transitionParams.deltaLeft) + transitionParams.deltaRight)) + dp, AndroidUtilities.dp(30.0f), i + dp, ((int) ((i - transitionParams.toDeltaLeft) + transitionParams.toDeltaRight)) + dp);
                return;
            }
            this.seekBarWaveform.setSize(this.backgroundWidth + dp, AndroidUtilities.dp(30.0f));
        }
    }

    private int createDocumentLayout(int i, MessageObject messageObject) {
        int i2;
        int i3;
        int i4 = i;
        if (messageObject.type == 0) {
            this.documentAttach = MessageObject.getMedia(messageObject.messageOwner).webpage.document;
        } else {
            this.documentAttach = messageObject.getDocument();
        }
        TLRPC$Document tLRPC$Document = this.documentAttach;
        int i5 = 0;
        if (tLRPC$Document == null) {
            return 0;
        }
        if (MessageObject.isVoiceDocument(tLRPC$Document)) {
            this.documentAttachType = 3;
            int i6 = 0;
            while (true) {
                if (i6 >= this.documentAttach.attributes.size()) {
                    i3 = 0;
                    break;
                }
                TLRPC$DocumentAttribute tLRPC$DocumentAttribute = this.documentAttach.attributes.get(i6);
                if (tLRPC$DocumentAttribute instanceof TLRPC$TL_documentAttributeAudio) {
                    i3 = tLRPC$DocumentAttribute.duration;
                    break;
                }
                i6++;
            }
            this.widthBeforeNewTimeLine = (i4 - AndroidUtilities.dp(94.0f)) - ((int) Math.ceil(Theme.chat_audioTimePaint.measureText("00:00")));
            this.availableTimeWidth = i4 - AndroidUtilities.dp(18.0f);
            measureTime(messageObject);
            int dp = AndroidUtilities.dp(174.0f) + this.timeWidth;
            if (!this.hasLinkPreview) {
                this.backgroundWidth = Math.min(i4, dp + ((int) Math.ceil(Theme.chat_audioTimePaint.measureText(AndroidUtilities.formatLongDuration(i3)))));
            }
            this.seekBarWaveform.setMessageObject(messageObject);
            return 0;
        } else if (MessageObject.isVideoDocument(this.documentAttach)) {
            this.documentAttachType = 4;
            if (!messageObject.needDrawBluredPreview()) {
                updatePlayingMessageProgress();
                String format = String.format("%s", AndroidUtilities.formatFileSize(this.documentAttach.size));
                this.docTitleWidth = (int) Math.ceil(Theme.chat_infoPaint.measureText(format));
                this.docTitleLayout = new StaticLayout(format, Theme.chat_infoPaint, this.docTitleWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            }
            return 0;
        } else if (MessageObject.isMusicDocument(this.documentAttach)) {
            this.documentAttachType = 5;
            int dp2 = i4 - AndroidUtilities.dp(92.0f);
            if (dp2 < 0) {
                dp2 = AndroidUtilities.dp(100.0f);
            }
            int i7 = dp2;
            StaticLayout staticLayout = new StaticLayout(TextUtils.ellipsize(messageObject.getMusicTitle().replace('\n', ' '), Theme.chat_audioTitlePaint, i7 - AndroidUtilities.dp(12.0f), TextUtils.TruncateAt.END), Theme.chat_audioTitlePaint, i7, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            this.songLayout = staticLayout;
            if (staticLayout.getLineCount() > 0) {
                this.songX = -((int) Math.ceil(this.songLayout.getLineLeft(0)));
            }
            StaticLayout staticLayout2 = new StaticLayout(TextUtils.ellipsize(messageObject.getMusicAuthor().replace('\n', ' '), Theme.chat_audioPerformerPaint, i7, TextUtils.TruncateAt.END), Theme.chat_audioPerformerPaint, i7, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            this.performerLayout = staticLayout2;
            if (staticLayout2.getLineCount() > 0) {
                this.performerX = -((int) Math.ceil(this.performerLayout.getLineLeft(0)));
            }
            int i8 = 0;
            while (true) {
                if (i8 >= this.documentAttach.attributes.size()) {
                    break;
                }
                TLRPC$DocumentAttribute tLRPC$DocumentAttribute2 = this.documentAttach.attributes.get(i8);
                if (tLRPC$DocumentAttribute2 instanceof TLRPC$TL_documentAttributeAudio) {
                    i5 = tLRPC$DocumentAttribute2.duration;
                    break;
                }
                i8++;
            }
            int ceil = (int) Math.ceil(Theme.chat_audioTimePaint.measureText(AndroidUtilities.formatShortDuration(i5, i5)));
            this.widthBeforeNewTimeLine = (this.backgroundWidth - AndroidUtilities.dp(86.0f)) - ceil;
            this.availableTimeWidth = this.backgroundWidth - AndroidUtilities.dp(28.0f);
            return ceil;
        } else if (MessageObject.isGifDocument(this.documentAttach, messageObject.hasValidGroupId())) {
            this.documentAttachType = 2;
            if (!messageObject.needDrawBluredPreview()) {
                String string = LocaleController.getString("AttachGif", R.string.AttachGif);
                this.infoWidth = (int) Math.ceil(Theme.chat_infoPaint.measureText(string));
                this.infoLayout = new StaticLayout(string, Theme.chat_infoPaint, this.infoWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                String format2 = String.format("%s", AndroidUtilities.formatFileSize(this.documentAttach.size));
                this.docTitleWidth = (int) Math.ceil(Theme.chat_infoPaint.measureText(format2));
                this.docTitleLayout = new StaticLayout(format2, Theme.chat_infoPaint, this.docTitleWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            }
            return 0;
        } else {
            String str = this.documentAttach.mime_type;
            boolean z = (str != null && (str.toLowerCase().startsWith("image/") || this.documentAttach.mime_type.toLowerCase().startsWith("video/mp4"))) || MessageObject.isDocumentHasThumb(this.documentAttach);
            this.drawPhotoImage = z;
            if (!z) {
                i4 += AndroidUtilities.dp(30.0f);
            }
            this.documentAttachType = 1;
            String documentFileName = FileLoader.getDocumentFileName(this.documentAttach);
            if (documentFileName.length() == 0) {
                documentFileName = LocaleController.getString("AttachDocument", R.string.AttachDocument);
            }
            StaticLayout createStaticLayout = StaticLayoutEx.createStaticLayout(documentFileName, Theme.chat_docNamePaint, i4, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false, TextUtils.TruncateAt.MIDDLE, i4, 2, false);
            this.docTitleLayout = createStaticLayout;
            this.docTitleOffsetX = Integer.MIN_VALUE;
            if (createStaticLayout != null && createStaticLayout.getLineCount() > 0) {
                int i9 = 0;
                while (i5 < this.docTitleLayout.getLineCount()) {
                    i9 = Math.max(i9, (int) Math.ceil(this.docTitleLayout.getLineWidth(i5)));
                    this.docTitleOffsetX = Math.max(this.docTitleOffsetX, (int) Math.ceil(-this.docTitleLayout.getLineLeft(i5)));
                    i5++;
                }
                i2 = Math.min(i4, i9);
            } else {
                this.docTitleOffsetX = 0;
                i2 = i4;
            }
            int dp3 = i4 - AndroidUtilities.dp(30.0f);
            TextPaint textPaint = Theme.chat_infoPaint;
            int min = Math.min(dp3, (int) Math.ceil(textPaint.measureText("000.0 mm / " + AndroidUtilities.formatFileSize(this.documentAttach.size))));
            this.infoWidth = min;
            CharSequence ellipsize = TextUtils.ellipsize(AndroidUtilities.formatFileSize(this.documentAttach.size) + " " + FileLoader.getDocumentExtension(this.documentAttach), Theme.chat_infoPaint, (float) min, TextUtils.TruncateAt.END);
            try {
                if (this.infoWidth < 0) {
                    this.infoWidth = AndroidUtilities.dp(10.0f);
                }
                this.infoLayout = new StaticLayout(ellipsize, Theme.chat_infoPaint, this.infoWidth + AndroidUtilities.dp(6.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            } catch (Exception e) {
                FileLog.e(e);
            }
            if (this.drawPhotoImage) {
                this.currentPhotoObject = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 320);
                this.currentPhotoObjectThumb = FileLoader.getClosestPhotoSizeWithSize(messageObject.photoThumbs, 40);
                if ((DownloadController.getInstance(this.currentAccount).getAutodownloadMask() & 1) == 0) {
                    this.currentPhotoObject = null;
                }
                TLRPC$PhotoSize tLRPC$PhotoSize = this.currentPhotoObject;
                if (tLRPC$PhotoSize == null || tLRPC$PhotoSize == this.currentPhotoObjectThumb) {
                    this.currentPhotoObject = null;
                    this.photoImage.setNeedsQualityThumb(true);
                    this.photoImage.setShouldGenerateQualityThumb(true);
                } else {
                    BitmapDrawable bitmapDrawable = this.currentMessageObject.strippedThumb;
                    if (bitmapDrawable != null) {
                        this.currentPhotoObjectThumb = null;
                        this.currentPhotoObjectThumbStripped = bitmapDrawable;
                    }
                }
                this.currentPhotoFilter = "86_86_b";
                this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, messageObject.photoThumbsObject), "86_86", ImageLocation.getForObject(this.currentPhotoObjectThumb, messageObject.photoThumbsObject), this.currentPhotoFilter, this.currentPhotoObjectThumbStripped, 0L, null, messageObject, 1);
            }
            return i2;
        }
    }

    private void calcBackgroundWidth(int i, int i2, int i3) {
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        boolean z = reactionsLayoutInBubble.isEmpty;
        int i4 = (z || reactionsLayoutInBubble.isSmall) ? this.currentMessageObject.lastLineWidth : reactionsLayoutInBubble.lastLineX;
        boolean z2 = false;
        if (!z && !reactionsLayoutInBubble.isSmall) {
            if (i - i4 < i2 || this.currentMessageObject.hasRtl) {
                z2 = true;
            }
            if (this.hasInvoicePreview) {
                this.totalHeight += AndroidUtilities.dp(14.0f);
            }
        } else if (this.hasLinkPreview || this.hasOldCaptionPreview || this.hasGamePreview || this.hasInvoicePreview || i - i4 < i2 || this.currentMessageObject.hasRtl) {
            z2 = true;
        }
        if (z2) {
            this.totalHeight += AndroidUtilities.dp(14.0f);
            this.hasNewLineForTime = true;
            int max = Math.max(i3, i4) + AndroidUtilities.dp(31.0f);
            this.backgroundWidth = max;
            this.backgroundWidth = Math.max(max, (this.currentMessageObject.isOutOwner() ? this.timeWidth + AndroidUtilities.dp(17.0f) : this.timeWidth) + AndroidUtilities.dp(31.0f));
            return;
        }
        int extraTextX = (i3 - getExtraTextX()) - i4;
        if (extraTextX >= 0 && extraTextX <= i2) {
            this.backgroundWidth = ((i3 + i2) - extraTextX) + AndroidUtilities.dp(31.0f);
        } else {
            this.backgroundWidth = Math.max(i3, i4 + i2) + AndroidUtilities.dp(31.0f);
        }
    }

    public void setHighlightedText(String str) {
        MessageObject messageObject = this.messageObjectToSet;
        if (messageObject == null) {
            messageObject = this.currentMessageObject;
        }
        if (messageObject == null || messageObject.messageOwner.message == null || TextUtils.isEmpty(str)) {
            if (this.urlPathSelection.isEmpty()) {
                return;
            }
            this.linkSelectionBlockNum = -1;
            resetUrlPaths();
            invalidate();
            return;
        }
        String lowerCase = str.toLowerCase();
        String lowerCase2 = messageObject.messageOwner.message.toLowerCase();
        int length = lowerCase2.length();
        int i = -1;
        int i2 = -1;
        for (int i3 = 0; i3 < length; i3++) {
            int min = Math.min(lowerCase.length(), length - i3);
            int i4 = 0;
            for (int i5 = 0; i5 < min; i5++) {
                boolean z = lowerCase2.charAt(i3 + i5) == lowerCase.charAt(i5);
                if (z) {
                    if (i4 != 0 || i3 == 0 || " !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~\n".indexOf(lowerCase2.charAt(i3 - 1)) >= 0) {
                        i4++;
                    } else {
                        z = false;
                    }
                }
                if (!z || i5 == min - 1) {
                    if (i4 > 0 && i4 > i2) {
                        i = i3;
                        i2 = i4;
                    }
                }
            }
        }
        if (i == -1) {
            if (this.urlPathSelection.isEmpty()) {
                return;
            }
            this.linkSelectionBlockNum = -1;
            resetUrlPaths();
            invalidate();
            return;
        }
        int length2 = lowerCase2.length();
        for (int i6 = i + i2; i6 < length2 && " !\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~\n".indexOf(lowerCase2.charAt(i6)) < 0; i6++) {
            i2++;
        }
        int i7 = i + i2;
        if (this.captionLayout != null && !TextUtils.isEmpty(messageObject.caption)) {
            resetUrlPaths();
            try {
                LinkPath obtainNewUrlPath = obtainNewUrlPath();
                obtainNewUrlPath.setCurrentLayout(this.captionLayout, i, 0.0f);
                this.captionLayout.getSelectionPath(i, i7, obtainNewUrlPath);
            } catch (Exception e) {
                FileLog.e(e);
            }
            invalidate();
        } else if (messageObject.textLayoutBlocks != null) {
            for (int i8 = 0; i8 < messageObject.textLayoutBlocks.size(); i8++) {
                MessageObject.TextLayoutBlock textLayoutBlock = messageObject.textLayoutBlocks.get(i8);
                if (i >= textLayoutBlock.charactersOffset && i < textLayoutBlock.charactersEnd) {
                    this.linkSelectionBlockNum = i8;
                    resetUrlPaths();
                    try {
                        LinkPath obtainNewUrlPath2 = obtainNewUrlPath();
                        obtainNewUrlPath2.setCurrentLayout(textLayoutBlock.textLayout, i, 0.0f);
                        textLayoutBlock.textLayout.getSelectionPath(i, i7, obtainNewUrlPath2);
                        if (i7 >= textLayoutBlock.charactersOffset + i2) {
                            for (int i9 = i8 + 1; i9 < messageObject.textLayoutBlocks.size(); i9++) {
                                MessageObject.TextLayoutBlock textLayoutBlock2 = messageObject.textLayoutBlocks.get(i9);
                                int i10 = textLayoutBlock2.charactersEnd - textLayoutBlock2.charactersOffset;
                                LinkPath obtainNewUrlPath3 = obtainNewUrlPath();
                                obtainNewUrlPath3.setCurrentLayout(textLayoutBlock2.textLayout, 0, textLayoutBlock2.height);
                                textLayoutBlock2.textLayout.getSelectionPath(0, i7 - textLayoutBlock2.charactersOffset, obtainNewUrlPath3);
                                if (i7 < (textLayoutBlock.charactersOffset + i10) - 1) {
                                    break;
                                }
                            }
                        }
                    } catch (Exception e2) {
                        FileLog.e(e2);
                    }
                    invalidate();
                    return;
                }
            }
        }
    }

    @Override // android.view.View
    protected boolean verifyDrawable(Drawable drawable) {
        if (!super.verifyDrawable(drawable)) {
            Drawable[] drawableArr = this.selectorDrawable;
            if (drawable != drawableArr[0] && drawable != drawableArr[1]) {
                return false;
            }
        }
        return true;
    }

    @Override // android.view.View, android.graphics.drawable.Drawable.Callback
    public void invalidateDrawable(Drawable drawable) {
        super.invalidateDrawable(drawable);
        if (this.currentMessagesGroup != null) {
            invalidateWithParent();
        }
    }

    private boolean isCurrentLocationTimeExpired(MessageObject messageObject) {
        return MessageObject.getMedia(this.currentMessageObject.messageOwner).period % 60 == 0 ? Math.abs(ConnectionsManager.getInstance(this.currentAccount).getCurrentTime() - messageObject.messageOwner.date) > MessageObject.getMedia(messageObject.messageOwner).period : Math.abs(ConnectionsManager.getInstance(this.currentAccount).getCurrentTime() - messageObject.messageOwner.date) > MessageObject.getMedia(messageObject.messageOwner).period + (-5);
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void checkLocationExpired() {
        boolean isCurrentLocationTimeExpired;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || (isCurrentLocationTimeExpired = isCurrentLocationTimeExpired(messageObject)) == this.locationExpired) {
            return;
        }
        this.locationExpired = isCurrentLocationTimeExpired;
        if (!isCurrentLocationTimeExpired) {
            AndroidUtilities.runOnUIThread(this.invalidateRunnable, 1000L);
            this.scheduledInvalidate = true;
            int dp = this.backgroundWidth - AndroidUtilities.dp(91.0f);
            this.docTitleLayout = new StaticLayout(TextUtils.ellipsize(LocaleController.getString("AttachLiveLocation", R.string.AttachLiveLocation), Theme.chat_locationTitlePaint, dp, TextUtils.TruncateAt.END), Theme.chat_locationTitlePaint, dp, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            return;
        }
        MessageObject messageObject2 = this.currentMessageObject;
        this.currentMessageObject = null;
        setMessageObject(messageObject2, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop);
    }

    public void setIsUpdating(boolean z) {
        this.isUpdating = true;
    }

    public void setMessageObject(MessageObject messageObject, MessageObject.GroupedMessages groupedMessages, boolean z, boolean z2) {
        if (this.attachedToWindow) {
            setMessageContent(messageObject, groupedMessages, z, z2);
            return;
        }
        this.messageObjectToSet = messageObject;
        this.groupedMessagesToSet = groupedMessages;
        this.bottomNearToSet = z;
        this.topNearToSet = z2;
    }

    private int getAdditionalWidthForPosition(MessageObject.GroupedMessagePosition groupedMessagePosition) {
        int i = 0;
        if (groupedMessagePosition != null) {
            if ((groupedMessagePosition.flags & 2) == 0) {
                i = 0 + AndroidUtilities.dp(4.0f);
            }
            return (groupedMessagePosition.flags & 1) == 0 ? i + AndroidUtilities.dp(4.0f) : i;
        }
        return 0;
    }

    public void createSelectorDrawable(final int i) {
        int themedColor;
        if (Build.VERSION.SDK_INT < 21) {
            return;
        }
        String str = "chat_outPreviewInstantText";
        if (this.psaHintPressed) {
            themedColor = getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outViews" : "chat_inViews");
        } else {
            themedColor = getThemedColor(this.currentMessageObject.isOutOwner() ? str : "chat_inPreviewInstantText");
        }
        Drawable[] drawableArr = this.selectorDrawable;
        if (drawableArr[i] == null) {
            final Paint paint = new Paint(1);
            paint.setColor(-1);
            Drawable drawable = new Drawable() { // from class: org.telegram.ui.Cells.ChatMessageCell.5
                RectF rect = new RectF();
                Path path = new Path();

                @Override // android.graphics.drawable.Drawable
                public int getOpacity() {
                    return -2;
                }

                @Override // android.graphics.drawable.Drawable
                public void setAlpha(int i2) {
                }

                @Override // android.graphics.drawable.Drawable
                public void setColorFilter(ColorFilter colorFilter) {
                }

                @Override // android.graphics.drawable.Drawable
                public void draw(Canvas canvas) {
                    Rect bounds = getBounds();
                    this.rect.set(bounds.left, bounds.top, bounds.right, bounds.bottom);
                    if (ChatMessageCell.this.selectorDrawableMaskType[i] != 3 && ChatMessageCell.this.selectorDrawableMaskType[i] != 4) {
                        float f = 0.0f;
                        if (ChatMessageCell.this.selectorDrawableMaskType[i] == 2) {
                            this.path.reset();
                            boolean z = ChatMessageCell.this.currentMessageObject != null && ChatMessageCell.this.currentMessageObject.isOutOwner();
                            for (int i2 = 0; i2 < 4; i2++) {
                                if (!ChatMessageCell.this.instantTextNewLine) {
                                    if (i2 == 2 && !z) {
                                        float[] fArr = ChatMessageCell.radii;
                                        int i3 = i2 * 2;
                                        float dp = AndroidUtilities.dp(SharedConfig.bubbleRadius);
                                        ChatMessageCell.radii[i3 + 1] = dp;
                                        fArr[i3] = dp;
                                    } else if (i2 != 3 || !z) {
                                        if ((ChatMessageCell.this.mediaBackground || ChatMessageCell.this.pinnedBottom) && (i2 == 2 || i2 == 3)) {
                                            float[] fArr2 = ChatMessageCell.radii;
                                            int i4 = i2 * 2;
                                            float[] fArr3 = ChatMessageCell.radii;
                                            int i5 = i4 + 1;
                                            float dp2 = AndroidUtilities.dp(ChatMessageCell.this.pinnedBottom ? Math.min(5, SharedConfig.bubbleRadius) : SharedConfig.bubbleRadius);
                                            fArr3[i5] = dp2;
                                            fArr2[i4] = dp2;
                                        }
                                    } else {
                                        float[] fArr4 = ChatMessageCell.radii;
                                        int i6 = i2 * 2;
                                        float dp3 = AndroidUtilities.dp(SharedConfig.bubbleRadius);
                                        ChatMessageCell.radii[i6 + 1] = dp3;
                                        fArr4[i6] = dp3;
                                    }
                                }
                                float[] fArr5 = ChatMessageCell.radii;
                                int i7 = i2 * 2;
                                ChatMessageCell.radii[i7 + 1] = 0.0f;
                                fArr5[i7] = 0.0f;
                            }
                            this.path.addRoundRect(this.rect, ChatMessageCell.radii, Path.Direction.CW);
                            this.path.close();
                            canvas.drawPath(this.path, paint);
                            return;
                        }
                        RectF rectF = this.rect;
                        float dp4 = ChatMessageCell.this.selectorDrawableMaskType[i] == 0 ? AndroidUtilities.dp(6.0f) : 0.0f;
                        if (ChatMessageCell.this.selectorDrawableMaskType[i] == 0) {
                            f = AndroidUtilities.dp(6.0f);
                        }
                        canvas.drawRoundRect(rectF, dp4, f, paint);
                        return;
                    }
                    canvas.drawCircle(this.rect.centerX(), this.rect.centerY(), AndroidUtilities.dp(ChatMessageCell.this.selectorDrawableMaskType[i] == 3 ? 16.0f : 20.0f), paint);
                }
            };
            int[][] iArr = {StateSet.WILD_CARD};
            int[] iArr2 = new int[1];
            if (!this.currentMessageObject.isOutOwner()) {
                str = "chat_inPreviewInstantText";
            }
            iArr2[0] = getThemedColor(str) & 436207615;
            this.selectorDrawable[i] = new RippleDrawable(new ColorStateList(iArr, iArr2), null, drawable);
            this.selectorDrawable[i].setCallback(this);
        } else {
            Theme.setSelectorDrawableColor(drawableArr[i], themedColor & 436207615, true);
        }
        this.selectorDrawable[i].setVisible(true, false);
    }

    private void createInstantViewButton() {
        String string;
        int measureText;
        if (Build.VERSION.SDK_INT >= 21 && this.drawInstantView) {
            createSelectorDrawable(0);
        }
        if (!this.drawInstantView || this.instantViewLayout != null) {
            return;
        }
        this.instantWidth = AndroidUtilities.dp(33.0f);
        int i = this.drawInstantViewType;
        if (i == 12) {
            string = LocaleController.getString("OpenChannelPost", R.string.OpenChannelPost);
        } else if (i == 1) {
            string = LocaleController.getString("OpenChannel", R.string.OpenChannel);
        } else if (i == 13) {
            string = LocaleController.getString("SendMessage", R.string.SendMessage).toUpperCase();
        } else if (i == 10) {
            string = LocaleController.getString("OpenBot", R.string.OpenBot);
        } else if (i == 2) {
            string = LocaleController.getString("OpenGroup", R.string.OpenGroup);
        } else if (i == 3) {
            string = LocaleController.getString("OpenMessage", R.string.OpenMessage);
        } else if (i == 5) {
            string = LocaleController.getString("ViewContact", R.string.ViewContact);
        } else if (i == 6) {
            string = LocaleController.getString("OpenBackground", R.string.OpenBackground);
        } else if (i == 7) {
            string = LocaleController.getString("OpenTheme", R.string.OpenTheme);
        } else if (i == 8) {
            if (this.pollVoted || this.pollClosed) {
                string = LocaleController.getString("PollViewResults", R.string.PollViewResults);
            } else {
                string = LocaleController.getString("PollSubmitVotes", R.string.PollSubmitVotes);
            }
        } else if (i == 9 || i == 11) {
            TLRPC$TL_webPage tLRPC$TL_webPage = (TLRPC$TL_webPage) MessageObject.getMedia(this.currentMessageObject.messageOwner).webpage;
            if (tLRPC$TL_webPage != null && tLRPC$TL_webPage.url.contains("voicechat=")) {
                string = LocaleController.getString("VoipGroupJoinAsSpeaker", R.string.VoipGroupJoinAsSpeaker);
            } else {
                string = LocaleController.getString("VoipGroupJoinAsLinstener", R.string.VoipGroupJoinAsLinstener);
            }
        } else {
            string = LocaleController.getString("InstantView", R.string.InstantView);
        }
        if (this.currentMessageObject.isSponsored() && this.backgroundWidth < (measureText = (int) (Theme.chat_instantViewPaint.measureText(string) + AndroidUtilities.dp(75.0f)))) {
            this.backgroundWidth = measureText;
        }
        int dp = this.backgroundWidth - AndroidUtilities.dp(75.0f);
        this.instantViewLayout = new StaticLayout(TextUtils.ellipsize(string, Theme.chat_instantViewPaint, dp, TextUtils.TruncateAt.END), Theme.chat_instantViewPaint, dp + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
        if (this.drawInstantViewType == 8) {
            this.instantWidth = this.backgroundWidth - AndroidUtilities.dp(13.0f);
        } else {
            this.instantWidth = this.backgroundWidth - AndroidUtilities.dp(34.0f);
        }
        int dp2 = this.totalHeight + AndroidUtilities.dp(46.0f);
        this.totalHeight = dp2;
        if (this.currentMessageObject.type == 12) {
            this.totalHeight = dp2 + AndroidUtilities.dp(14.0f);
        }
        if (this.currentMessageObject.isSponsored() && this.hasNewLineForTime) {
            this.totalHeight += AndroidUtilities.dp(16.0f);
        }
        StaticLayout staticLayout = this.instantViewLayout;
        if (staticLayout == null || staticLayout.getLineCount() <= 0) {
            return;
        }
        double d = this.instantWidth;
        double ceil = Math.ceil(this.instantViewLayout.getLineWidth(0));
        Double.isNaN(d);
        this.instantTextX = (((int) (d - ceil)) / 2) + (this.drawInstantViewType == 0 ? AndroidUtilities.dp(8.0f) : 0);
        int lineLeft = (int) this.instantViewLayout.getLineLeft(0);
        this.instantTextLeftX = lineLeft;
        this.instantTextX += -lineLeft;
    }

    @Override // android.view.View, android.view.ViewParent
    public void requestLayout() {
        if (this.inLayout) {
            return;
        }
        super.requestLayout();
    }

    @Override // android.view.View
    protected void onMeasure(int i, int i2) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && (messageObject.checkLayout() || this.lastHeight != AndroidUtilities.displaySize.y)) {
            this.inLayout = true;
            MessageObject messageObject2 = this.currentMessageObject;
            this.currentMessageObject = null;
            setMessageObject(messageObject2, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop);
            this.inLayout = false;
        }
        updateSelectionTextPosition();
        setMeasuredDimension(View.MeasureSpec.getSize(i), this.totalHeight + this.keyboardHeight);
    }

    public void forceResetMessageObject() {
        MessageObject messageObject = this.messageObjectToSet;
        if (messageObject == null) {
            messageObject = this.currentMessageObject;
        }
        this.currentMessageObject = null;
        setMessageObject(messageObject, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop);
    }

    private int getGroupPhotosWidth() {
        int parentWidth = getParentWidth();
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && messageObject.preview) {
            parentWidth = this.parentWidth;
        }
        if (AndroidUtilities.isInMultiwindow || !AndroidUtilities.isTablet()) {
            return parentWidth;
        }
        if (AndroidUtilities.isSmallTablet() && getResources().getConfiguration().orientation != 2) {
            return parentWidth;
        }
        int i = (parentWidth / 100) * 35;
        if (i < AndroidUtilities.dp(320.0f)) {
            i = AndroidUtilities.dp(320.0f);
        }
        return parentWidth - i;
    }

    private int getExtraTextX() {
        int i = SharedConfig.bubbleRadius;
        if (i >= 15) {
            return AndroidUtilities.dp(2.0f);
        }
        if (i < 11) {
            return 0;
        }
        return AndroidUtilities.dp(1.0f);
    }

    private int getExtraTimeX() {
        int i;
        if (!this.currentMessageObject.isOutOwner() && ((!this.mediaBackground || this.captionLayout != null) && (i = SharedConfig.bubbleRadius) > 11)) {
            return AndroidUtilities.dp((i - 11) / 1.5f);
        }
        if (!this.currentMessageObject.isOutOwner() && this.isPlayingRound && this.isAvatarVisible && this.currentMessageObject.type == 5) {
            return (int) ((AndroidUtilities.roundPlayingMessageSize - AndroidUtilities.roundMessageSize) * 0.7f);
        }
        return 0;
    }

    @Override // android.view.ViewGroup, android.view.View
    @SuppressLint({"DrawAllocation"})
    protected void onLayout(boolean z, int i, int i2, int i3, int i4) {
        int i5;
        int i6;
        int dp;
        int dp2;
        int i7;
        int dp3;
        int i8;
        int i9;
        int dp4;
        int dp5;
        if (this.currentMessageObject == null) {
            return;
        }
        int measuredHeight = getMeasuredHeight() + (getMeasuredWidth() << 16);
        int i10 = 10;
        if (this.lastSize != measuredHeight || !this.wasLayout) {
            this.layoutWidth = getMeasuredWidth();
            this.layoutHeight = getMeasuredHeight() - this.substractBackgroundHeight;
            if (this.timeTextWidth < 0) {
                this.timeTextWidth = AndroidUtilities.dp(10.0f);
            }
            this.timeLayout = new StaticLayout(this.currentTimeString, Theme.chat_timePaint, AndroidUtilities.dp(100.0f) + this.timeTextWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            if (this.mediaBackground) {
                if (this.currentMessageObject.isOutOwner()) {
                    this.timeX = (this.layoutWidth - this.timeWidth) - AndroidUtilities.dp(42.0f);
                } else {
                    this.timeX = (this.backgroundWidth - AndroidUtilities.dp(4.0f)) - this.timeWidth;
                    if (this.currentMessageObject.isAnyKindOfSticker()) {
                        this.timeX = Math.max(AndroidUtilities.dp(26.0f), this.timeX);
                    }
                    if (this.isAvatarVisible) {
                        this.timeX += AndroidUtilities.dp(48.0f);
                    }
                    MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                    if (groupedMessagePosition != null && (i5 = groupedMessagePosition.leftSpanOffset) != 0) {
                        this.timeX += (int) Math.ceil((i5 / 1000.0f) * getGroupPhotosWidth());
                    }
                    if (this.captionLayout != null && this.currentPosition != null) {
                        this.timeX += AndroidUtilities.dp(4.0f);
                    }
                }
                if (SharedConfig.bubbleRadius >= 10 && this.captionLayout == null && (i6 = this.documentAttachType) != 7 && i6 != 6) {
                    this.timeX -= AndroidUtilities.dp(2.0f);
                }
            } else if (this.currentMessageObject.isOutOwner()) {
                this.timeX = (this.layoutWidth - this.timeWidth) - AndroidUtilities.dp(38.5f);
            } else {
                this.timeX = (this.backgroundWidth - AndroidUtilities.dp(9.0f)) - this.timeWidth;
                if (this.currentMessageObject.isAnyKindOfSticker()) {
                    this.timeX = Math.max(0, this.timeX);
                }
                if (this.isAvatarVisible) {
                    this.timeX += AndroidUtilities.dp(48.0f);
                }
                if (shouldDrawTimeOnMedia()) {
                    this.timeX -= AndroidUtilities.dp(7.0f);
                }
            }
            this.timeX -= getExtraTimeX();
            if ((this.currentMessageObject.messageOwner.flags & 1024) != 0) {
                this.viewsLayout = new StaticLayout(this.currentViewsString, Theme.chat_timePaint, this.viewsTextWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            } else {
                this.viewsLayout = null;
            }
            if (this.currentRepliesString != null && !this.currentMessageObject.scheduled) {
                this.repliesLayout = new StaticLayout(this.currentRepliesString, Theme.chat_timePaint, this.repliesTextWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            } else {
                this.repliesLayout = null;
            }
            if (this.isAvatarVisible) {
                this.avatarImage.setImageCoords(AndroidUtilities.dp(6.0f), this.avatarImage.getImageY(), AndroidUtilities.dp(42.0f), AndroidUtilities.dp(42.0f));
            }
            if (this.currentMessageObject.type == 20 && this.currentUnlockString != null) {
                this.unlockLayout = new StaticLayout(this.currentUnlockString, Theme.chat_unlockExtendedMediaTextPaint, this.unlockTextWidth, Layout.Alignment.ALIGN_CENTER, 1.0f, 0.0f, false);
                int i11 = ((TLRPC$TL_messageExtendedMediaPreview) this.currentMessageObject.messageOwner.media.extended_media).video_duration;
                if (i11 != 0) {
                    String formatDuration = AndroidUtilities.formatDuration(i11, false);
                    this.durationWidth = (int) Math.ceil(Theme.chat_durationPaint.measureText(formatDuration));
                    this.videoInfoLayout = new StaticLayout(formatDuration, Theme.chat_durationPaint, this.durationWidth, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                } else {
                    this.videoInfoLayout = null;
                }
            } else {
                this.unlockLayout = null;
            }
            this.wasLayout = true;
        }
        this.lastSize = measuredHeight;
        if (this.currentMessageObject.type == 0) {
            this.textY = AndroidUtilities.dp(10.0f) + this.namesOffset;
        }
        if (this.isRoundVideo) {
            updatePlayingMessageProgress();
        }
        int i12 = this.documentAttachType;
        if (i12 == 3) {
            if (this.currentMessageObject.isOutOwner()) {
                this.seekBarX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(57.0f);
                this.buttonX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(14.0f);
                this.timeAudioX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(67.0f);
            } else if (this.isChat && !this.isThreadPost && this.currentMessageObject.needDrawAvatar()) {
                this.seekBarX = AndroidUtilities.dp(114.0f);
                this.buttonX = AndroidUtilities.dp(71.0f);
                this.timeAudioX = AndroidUtilities.dp(124.0f);
            } else {
                this.seekBarX = AndroidUtilities.dp(66.0f);
                this.buttonX = AndroidUtilities.dp(23.0f);
                this.timeAudioX = AndroidUtilities.dp(76.0f);
            }
            if (this.hasLinkPreview) {
                this.seekBarX += AndroidUtilities.dp(10.0f);
                this.buttonX += AndroidUtilities.dp(10.0f);
                this.timeAudioX += AndroidUtilities.dp(10.0f);
            }
            updateSeekBarWaveformWidth();
            SeekBar seekBar = this.seekBar;
            int i13 = this.backgroundWidth;
            if (!this.hasLinkPreview) {
                i10 = 0;
            }
            seekBar.setSize(i13 - AndroidUtilities.dp(i10 + 72), AndroidUtilities.dp(30.0f));
            this.seekBarY = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY;
            int dp6 = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY;
            this.buttonY = dp6;
            RadialProgress2 radialProgress2 = this.radialProgress;
            int i14 = this.buttonX;
            radialProgress2.setProgressRect(i14, dp6, AndroidUtilities.dp(44.0f) + i14, this.buttonY + AndroidUtilities.dp(44.0f));
            updatePlayingMessageProgress();
        } else if (i12 == 5) {
            if (this.currentMessageObject.isOutOwner()) {
                this.seekBarX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(56.0f);
                this.buttonX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(14.0f);
                this.timeAudioX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(67.0f);
            } else if (this.isChat && !this.isThreadPost && this.currentMessageObject.needDrawAvatar()) {
                this.seekBarX = AndroidUtilities.dp(113.0f);
                this.buttonX = AndroidUtilities.dp(71.0f);
                this.timeAudioX = AndroidUtilities.dp(124.0f);
            } else {
                this.seekBarX = AndroidUtilities.dp(65.0f);
                this.buttonX = AndroidUtilities.dp(23.0f);
                this.timeAudioX = AndroidUtilities.dp(76.0f);
            }
            if (this.hasLinkPreview) {
                this.seekBarX += AndroidUtilities.dp(10.0f);
                this.buttonX += AndroidUtilities.dp(10.0f);
                this.timeAudioX += AndroidUtilities.dp(10.0f);
            }
            SeekBar seekBar2 = this.seekBar;
            int i15 = this.backgroundWidth;
            if (!this.hasLinkPreview) {
                i10 = 0;
            }
            seekBar2.setSize(i15 - AndroidUtilities.dp(i10 + 65), AndroidUtilities.dp(30.0f));
            this.seekBarY = AndroidUtilities.dp(29.0f) + this.namesOffset + this.mediaOffsetY;
            int dp7 = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY;
            this.buttonY = dp7;
            RadialProgress2 radialProgress22 = this.radialProgress;
            int i16 = this.buttonX;
            radialProgress22.setProgressRect(i16, dp7, AndroidUtilities.dp(44.0f) + i16, this.buttonY + AndroidUtilities.dp(44.0f));
            updatePlayingMessageProgress();
        } else if (i12 == 1 && !this.drawPhotoImage) {
            if (this.currentMessageObject.isOutOwner()) {
                this.buttonX = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(14.0f);
            } else if (this.isChat && !this.isThreadPost && this.currentMessageObject.needDrawAvatar()) {
                this.buttonX = AndroidUtilities.dp(71.0f);
            } else {
                this.buttonX = AndroidUtilities.dp(23.0f);
            }
            if (this.hasLinkPreview) {
                this.buttonX += AndroidUtilities.dp(10.0f);
            }
            int dp8 = AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY;
            this.buttonY = dp8;
            RadialProgress2 radialProgress23 = this.radialProgress;
            int i17 = this.buttonX;
            radialProgress23.setProgressRect(i17, dp8, AndroidUtilities.dp(44.0f) + i17, this.buttonY + AndroidUtilities.dp(44.0f));
            this.photoImage.setImageCoords(this.buttonX - AndroidUtilities.dp(10.0f), this.buttonY - AndroidUtilities.dp(10.0f), this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
        } else {
            MessageObject messageObject = this.currentMessageObject;
            int i18 = messageObject.type;
            if (i18 == 12) {
                if (messageObject.isOutOwner()) {
                    dp5 = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(14.0f);
                } else if (this.isChat && !this.isThreadPost && this.currentMessageObject.needDrawAvatar()) {
                    dp5 = AndroidUtilities.dp(72.0f);
                } else {
                    dp5 = AndroidUtilities.dp(23.0f);
                }
                this.photoImage.setImageCoords(dp5, AndroidUtilities.dp(13.0f) + this.namesOffset, AndroidUtilities.dp(44.0f), AndroidUtilities.dp(44.0f));
                return;
            }
            if (i18 == 0 && (this.hasLinkPreview || this.hasGamePreview || this.hasInvoicePreview)) {
                if (this.hasGamePreview) {
                    i7 = this.unmovedTextX - AndroidUtilities.dp(10.0f);
                } else {
                    if (this.hasInvoicePreview) {
                        i9 = this.unmovedTextX;
                        dp4 = AndroidUtilities.dp(1.0f);
                    } else {
                        i9 = this.unmovedTextX;
                        dp4 = AndroidUtilities.dp(1.0f);
                    }
                    i7 = i9 + dp4;
                }
                if (this.isSmallImage) {
                    dp = i7 + this.backgroundWidth;
                    dp2 = AndroidUtilities.dp(81.0f);
                    dp -= dp2;
                } else {
                    dp3 = this.hasInvoicePreview ? -AndroidUtilities.dp(6.3f) : AndroidUtilities.dp(10.0f);
                    dp = i7 + dp3;
                }
            } else {
                if (messageObject.isOutOwner()) {
                    if (this.mediaBackground) {
                        dp = this.layoutWidth - this.backgroundWidth;
                        dp2 = AndroidUtilities.dp(3.0f);
                    } else {
                        i7 = this.layoutWidth - this.backgroundWidth;
                        dp3 = AndroidUtilities.dp(6.0f);
                        dp = i7 + dp3;
                    }
                } else {
                    if (this.isChat && this.isAvatarVisible && !this.isPlayingRound) {
                        dp = AndroidUtilities.dp(63.0f);
                    } else {
                        dp = AndroidUtilities.dp(15.0f);
                    }
                    MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
                    if (groupedMessagePosition2 != null && !groupedMessagePosition2.edge) {
                        dp2 = AndroidUtilities.dp(10.0f);
                    }
                }
                dp -= dp2;
            }
            MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
            if (groupedMessagePosition3 != null) {
                if ((groupedMessagePosition3.flags & 1) == 0) {
                    dp -= AndroidUtilities.dp(2.0f);
                }
                if (this.currentPosition.leftSpanOffset != 0) {
                    dp += (int) Math.ceil((i8 / 1000.0f) * getGroupPhotosWidth());
                }
            }
            if (this.currentMessageObject.type != 0) {
                dp -= AndroidUtilities.dp(2.0f);
            }
            TransitionParams transitionParams = this.transitionParams;
            if (!transitionParams.imageChangeBoundsTransition || transitionParams.updatePhotoImageX) {
                transitionParams.updatePhotoImageX = false;
                ImageReceiver imageReceiver = this.photoImage;
                imageReceiver.setImageCoords(dp, imageReceiver.getImageY(), this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
            }
            this.buttonX = (int) (dp + ((this.photoImage.getImageWidth() - AndroidUtilities.dp(48.0f)) / 2.0f));
            int imageY = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - AndroidUtilities.dp(48.0f)) / 2.0f));
            this.buttonY = imageY;
            RadialProgress2 radialProgress24 = this.radialProgress;
            int i19 = this.buttonX;
            radialProgress24.setProgressRect(i19, imageY, AndroidUtilities.dp(48.0f) + i19, this.buttonY + AndroidUtilities.dp(48.0f));
            this.deleteProgressRect.set(this.buttonX + AndroidUtilities.dp(5.0f), this.buttonY + AndroidUtilities.dp(5.0f), this.buttonX + AndroidUtilities.dp(43.0f), this.buttonY + AndroidUtilities.dp(43.0f));
            int i20 = this.documentAttachType;
            if (i20 != 4 && i20 != 2) {
                return;
            }
            this.videoButtonX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(8.0f));
            int imageY2 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.0f));
            this.videoButtonY = imageY2;
            RadialProgress2 radialProgress25 = this.videoRadialProgress;
            int i21 = this.videoButtonX;
            radialProgress25.setProgressRect(i21, imageY2, AndroidUtilities.dp(24.0f) + i21, this.videoButtonY + AndroidUtilities.dp(24.0f));
        }
    }

    public boolean needDelayRoundProgressDraw() {
        int i = this.documentAttachType;
        return (i == 7 || i == 4) && this.currentMessageObject.type != 5 && MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
    }

    /* JADX WARN: Removed duplicated region for block: B:21:0x0069  */
    /* JADX WARN: Removed duplicated region for block: B:27:0x0094  */
    /* JADX WARN: Removed duplicated region for block: B:30:0x00a6  */
    /* JADX WARN: Removed duplicated region for block: B:37:0x00cb  */
    /* JADX WARN: Removed duplicated region for block: B:40:0x0128  */
    /* JADX WARN: Removed duplicated region for block: B:43:0x0140  */
    /* JADX WARN: Removed duplicated region for block: B:48:0x018c  */
    /* JADX WARN: Removed duplicated region for block: B:51:0x0197  */
    /* JADX WARN: Removed duplicated region for block: B:54:0x0255  */
    /* JADX WARN: Removed duplicated region for block: B:60:0x026d  */
    /* JADX WARN: Removed duplicated region for block: B:65:0x02cc  */
    /* JADX WARN: Removed duplicated region for block: B:70:0x02b4  */
    /* JADX WARN: Removed duplicated region for block: B:71:0x024c  */
    /* JADX WARN: Removed duplicated region for block: B:72:0x0191  */
    /* JADX WARN: Removed duplicated region for block: B:73:0x013b  */
    /* JADX WARN: Removed duplicated region for block: B:74:0x009d  */
    /* JADX WARN: Removed duplicated region for block: B:77:0x007f  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawRoundProgress(Canvas canvas) {
        float interpolation;
        TransitionParams transitionParams;
        int i;
        VideoForwardDrawable videoForwardDrawable;
        int i2;
        float f;
        int i3;
        float dp = this.isPlayingRound ? AndroidUtilities.dp(4.0f) : 0.0f;
        boolean z = false;
        boolean z2 = MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && MediaController.getInstance().isMessagePaused();
        if (z2 && this.roundSeekbarTouched == 1) {
            z = true;
        }
        if (z2) {
            float f2 = this.roundToPauseProgress;
            if (f2 != 1.0f) {
                float f3 = f2 + 0.07272727f;
                this.roundToPauseProgress = f3;
                if (f3 > 1.0f) {
                    this.roundToPauseProgress = 1.0f;
                } else {
                    invalidate();
                }
                if (z) {
                    float f4 = this.roundToPauseProgress2;
                    if (f4 != 1.0f) {
                        float f5 = f4 + 0.10666667f;
                        this.roundToPauseProgress2 = f5;
                        if (f5 > 1.0f) {
                            this.roundToPauseProgress2 = 1.0f;
                        } else {
                            invalidate();
                        }
                        interpolation = z2 ? AndroidUtilities.overshootInterpolator.getInterpolation(this.roundToPauseProgress) : this.roundToPauseProgress;
                        transitionParams = this.transitionParams;
                        if (transitionParams.animatePlayingRound) {
                            dp = (this.isPlayingRound ? transitionParams.animateChangeProgress : 1.0f - transitionParams.animateChangeProgress) * AndroidUtilities.dp(4.0f);
                        }
                        float dp2 = dp + (AndroidUtilities.dp(16.0f) * interpolation);
                        if (this.roundToPauseProgress > 0.0f) {
                            Theme.getRadialSeekbarShadowDrawable().draw(canvas, this.photoImage.getCenterX(), this.photoImage.getCenterY(), this.photoImage.getImageWidth() / 2.0f, this.roundToPauseProgress);
                        }
                        this.rect.set(this.photoImage.getImageX() + AndroidUtilities.dpf2(1.5f) + dp2, this.photoImage.getImageY() + AndroidUtilities.dpf2(1.5f) + dp2, (this.photoImage.getImageX2() - AndroidUtilities.dpf2(1.5f)) - dp2, (this.photoImage.getImageY2() - AndroidUtilities.dpf2(1.5f)) - dp2);
                        if (this.roundProgressAlpha != 1.0f) {
                            int alpha = Theme.chat_radialProgressPaint.getAlpha();
                            Theme.chat_radialProgressPaint.setAlpha((int) (this.roundProgressAlpha * alpha));
                            i = alpha;
                        } else {
                            i = -1;
                        }
                        videoForwardDrawable = this.videoForwardDrawable;
                        if (videoForwardDrawable != null && videoForwardDrawable.isAnimating()) {
                            this.videoForwardDrawable.setBounds((int) this.photoImage.getImageX(), (int) this.photoImage.getImageY(), (int) (this.photoImage.getImageX() + this.photoImage.getImageWidth()), (int) (this.photoImage.getImageY() + this.photoImage.getImageHeight()));
                            this.videoForwardDrawable.draw(canvas);
                        }
                        int alpha2 = Theme.chat_radialProgressPaint.getAlpha();
                        float strokeWidth = Theme.chat_radialProgressPaint.getStrokeWidth();
                        float f6 = this.roundProgressAlpha == 1.0f ? this.currentMessageObject.audioProgress : this.lastDrawingAudioProgress;
                        if (interpolation > 0.0f) {
                            float width = this.rect.width() / 2.0f;
                            Theme.chat_radialProgressPaint.setStrokeWidth((0.5f * strokeWidth * this.roundToPauseProgress) + strokeWidth);
                            Theme.chat_radialProgressPaint.setAlpha((int) (alpha2 * this.roundToPauseProgress * 0.3f));
                            canvas.drawCircle(this.rect.centerX(), this.rect.centerY(), width, Theme.chat_radialProgressPaint);
                            Theme.chat_radialProgressPaint.setAlpha(alpha2);
                            double centerX = this.rect.centerX();
                            double d = ((-360.0f) * f6) + 180.0f;
                            double sin = Math.sin(Math.toRadians(d));
                            i2 = i;
                            double d2 = width;
                            Double.isNaN(d2);
                            Double.isNaN(centerX);
                            this.seekbarRoundX = (float) (centerX + (sin * d2));
                            double centerY = this.rect.centerY();
                            double cos = Math.cos(Math.toRadians(d));
                            Double.isNaN(d2);
                            Double.isNaN(centerY);
                            this.seekbarRoundY = (float) (centerY + (cos * d2));
                            Theme.chat_radialProgressPausedSeekbarPaint.setColor(-1);
                            Theme.chat_radialProgressPausedSeekbarPaint.setAlpha((int) (Math.min(1.0f, interpolation) * 255.0f));
                            canvas.drawCircle(this.seekbarRoundX, this.seekbarRoundY, AndroidUtilities.dp(3.0f) + (AndroidUtilities.dp(5.0f) * interpolation) + (AndroidUtilities.dp(3.0f) * this.roundToPauseProgress2), Theme.chat_radialProgressPausedSeekbarPaint);
                        } else {
                            i2 = i;
                        }
                        f = this.roundSeekbarOutAlpha;
                        if (f != 0.0f) {
                            float f7 = f - 0.10666667f;
                            this.roundSeekbarOutAlpha = f7;
                            if (f7 < 0.0f) {
                                this.roundSeekbarOutAlpha = 0.0f;
                            } else {
                                invalidate();
                            }
                        }
                        if (this.roundSeekbarOutAlpha != 0.0f) {
                            int i4 = i2;
                            i3 = i4 == -1 ? Theme.chat_radialProgressPaint.getAlpha() : i4;
                            float f8 = alpha2;
                            Theme.chat_radialProgressPaint.setAlpha((int) ((1.0f - this.roundSeekbarOutAlpha) * f8));
                            canvas.drawArc(this.rect, -90.0f, f6 * 360.0f, false, Theme.chat_radialProgressPaint);
                            Theme.chat_radialProgressPaint.setAlpha((int) (f8 * this.roundSeekbarOutAlpha));
                            canvas.drawArc(this.rect, -90.0f, this.roundSeekbarOutProgress * 360.0f, false, Theme.chat_radialProgressPaint);
                        } else {
                            canvas.drawArc(this.rect, -90.0f, f6 * 360.0f, false, Theme.chat_radialProgressPaint);
                            i3 = i2;
                        }
                        if (i3 != -1) {
                            Theme.chat_radialProgressPaint.setAlpha(i3);
                        }
                        Theme.chat_radialProgressPaint.setStrokeWidth(strokeWidth);
                    }
                }
                if (!z) {
                    float f9 = this.roundToPauseProgress2;
                    if (f9 != 0.0f) {
                        float f10 = f9 - 0.10666667f;
                        this.roundToPauseProgress2 = f10;
                        if (f10 < 0.0f) {
                            this.roundToPauseProgress2 = 0.0f;
                        } else {
                            invalidate();
                        }
                    }
                }
                interpolation = z2 ? AndroidUtilities.overshootInterpolator.getInterpolation(this.roundToPauseProgress) : this.roundToPauseProgress;
                transitionParams = this.transitionParams;
                if (transitionParams.animatePlayingRound) {
                }
                float dp22 = dp + (AndroidUtilities.dp(16.0f) * interpolation);
                if (this.roundToPauseProgress > 0.0f) {
                }
                this.rect.set(this.photoImage.getImageX() + AndroidUtilities.dpf2(1.5f) + dp22, this.photoImage.getImageY() + AndroidUtilities.dpf2(1.5f) + dp22, (this.photoImage.getImageX2() - AndroidUtilities.dpf2(1.5f)) - dp22, (this.photoImage.getImageY2() - AndroidUtilities.dpf2(1.5f)) - dp22);
                if (this.roundProgressAlpha != 1.0f) {
                }
                videoForwardDrawable = this.videoForwardDrawable;
                if (videoForwardDrawable != null) {
                    this.videoForwardDrawable.setBounds((int) this.photoImage.getImageX(), (int) this.photoImage.getImageY(), (int) (this.photoImage.getImageX() + this.photoImage.getImageWidth()), (int) (this.photoImage.getImageY() + this.photoImage.getImageHeight()));
                    this.videoForwardDrawable.draw(canvas);
                }
                int alpha22 = Theme.chat_radialProgressPaint.getAlpha();
                float strokeWidth2 = Theme.chat_radialProgressPaint.getStrokeWidth();
                if (this.roundProgressAlpha == 1.0f) {
                }
                if (interpolation > 0.0f) {
                }
                f = this.roundSeekbarOutAlpha;
                if (f != 0.0f) {
                }
                if (this.roundSeekbarOutAlpha != 0.0f) {
                }
                if (i3 != -1) {
                }
                Theme.chat_radialProgressPaint.setStrokeWidth(strokeWidth2);
            }
        }
        if (!z2) {
            float f11 = this.roundToPauseProgress;
            if (f11 != 0.0f) {
                float f12 = f11 - 0.10666667f;
                this.roundToPauseProgress = f12;
                if (f12 < 0.0f) {
                    this.roundToPauseProgress = 0.0f;
                } else {
                    invalidate();
                }
            }
        }
        if (z) {
        }
        if (!z) {
        }
        interpolation = z2 ? AndroidUtilities.overshootInterpolator.getInterpolation(this.roundToPauseProgress) : this.roundToPauseProgress;
        transitionParams = this.transitionParams;
        if (transitionParams.animatePlayingRound) {
        }
        float dp222 = dp + (AndroidUtilities.dp(16.0f) * interpolation);
        if (this.roundToPauseProgress > 0.0f) {
        }
        this.rect.set(this.photoImage.getImageX() + AndroidUtilities.dpf2(1.5f) + dp222, this.photoImage.getImageY() + AndroidUtilities.dpf2(1.5f) + dp222, (this.photoImage.getImageX2() - AndroidUtilities.dpf2(1.5f)) - dp222, (this.photoImage.getImageY2() - AndroidUtilities.dpf2(1.5f)) - dp222);
        if (this.roundProgressAlpha != 1.0f) {
        }
        videoForwardDrawable = this.videoForwardDrawable;
        if (videoForwardDrawable != null) {
        }
        int alpha222 = Theme.chat_radialProgressPaint.getAlpha();
        float strokeWidth22 = Theme.chat_radialProgressPaint.getStrokeWidth();
        if (this.roundProgressAlpha == 1.0f) {
        }
        if (interpolation > 0.0f) {
        }
        f = this.roundSeekbarOutAlpha;
        if (f != 0.0f) {
        }
        if (this.roundSeekbarOutAlpha != 0.0f) {
        }
        if (i3 != -1) {
        }
        Theme.chat_radialProgressPaint.setStrokeWidth(strokeWidth22);
    }

    /* JADX WARN: Removed duplicated region for block: B:33:0x00b8  */
    /* JADX WARN: Removed duplicated region for block: B:54:? A[RETURN, SYNTHETIC] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void updatePollAnimations(long j) {
        if (this.pollVoteInProgress) {
            float f = this.voteRadOffset + (((float) (360 * j)) / 2000.0f);
            this.voteRadOffset = f;
            int i = 360;
            this.voteRadOffset = f - (((int) (f / 360.0f)) * 360);
            float f2 = this.voteCurrentProgressTime + ((float) j);
            this.voteCurrentProgressTime = f2;
            if (f2 >= 500.0f) {
                this.voteCurrentProgressTime = 500.0f;
            }
            if (this.voteRisingCircleLength) {
                this.voteCurrentCircleLength = (AndroidUtilities.accelerateInterpolator.getInterpolation(this.voteCurrentProgressTime / 500.0f) * 266.0f) + 4.0f;
            } else {
                if (!this.firstCircleLength) {
                    i = 270;
                }
                this.voteCurrentCircleLength = 4.0f - (i * (1.0f - AndroidUtilities.decelerateInterpolator.getInterpolation(this.voteCurrentProgressTime / 500.0f)));
            }
            if (this.voteCurrentProgressTime == 500.0f) {
                boolean z = this.voteRisingCircleLength;
                if (z) {
                    this.voteRadOffset += 270.0f;
                    this.voteCurrentCircleLength = -266.0f;
                }
                this.voteRisingCircleLength = !z;
                if (this.firstCircleLength) {
                    this.firstCircleLength = false;
                }
                this.voteCurrentProgressTime = 0.0f;
            }
            invalidate();
        }
        boolean z2 = this.hintButtonVisible;
        if (z2) {
            float f3 = this.hintButtonProgress;
            if (f3 < 1.0f) {
                float f4 = f3 + (((float) j) / 180.0f);
                this.hintButtonProgress = f4;
                if (f4 > 1.0f) {
                    this.hintButtonProgress = 1.0f;
                }
                invalidate();
                if (this.animatePollAnswer) {
                    return;
                }
                float f5 = this.pollAnimationProgressTime + ((float) j);
                this.pollAnimationProgressTime = f5;
                if (f5 >= 300.0f) {
                    this.pollAnimationProgressTime = 300.0f;
                }
                float interpolation = AndroidUtilities.decelerateInterpolator.getInterpolation(this.pollAnimationProgressTime / 300.0f);
                this.pollAnimationProgress = interpolation;
                if (interpolation >= 1.0f) {
                    this.pollAnimationProgress = 1.0f;
                    this.animatePollAnswer = false;
                    this.animatePollAnswerAlpha = false;
                    this.pollVoteInProgress = false;
                    if (this.pollUnvoteInProgress && this.animatePollAvatars) {
                        int i2 = 0;
                        while (true) {
                            ImageReceiver[] imageReceiverArr = this.pollAvatarImages;
                            if (i2 >= imageReceiverArr.length) {
                                break;
                            }
                            imageReceiverArr[i2].setImageBitmap((Drawable) null);
                            this.pollAvatarImagesVisible[i2] = false;
                            i2++;
                        }
                    }
                    this.pollUnvoteInProgress = false;
                    int size = this.pollButtons.size();
                    for (int i3 = 0; i3 < size; i3++) {
                        this.pollButtons.get(i3).prevChosen = false;
                    }
                }
                invalidate();
                return;
            }
        }
        if (!z2) {
            float f6 = this.hintButtonProgress;
            if (f6 > 0.0f) {
                float f7 = f6 - (((float) j) / 180.0f);
                this.hintButtonProgress = f7;
                if (f7 < 0.0f) {
                    this.hintButtonProgress = 0.0f;
                }
                invalidate();
            }
        }
        if (this.animatePollAnswer) {
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:252:0x0d76  */
    /* JADX WARN: Removed duplicated region for block: B:253:0x0d29  */
    /* JADX WARN: Removed duplicated region for block: B:260:0x0d14  */
    /* JADX WARN: Removed duplicated region for block: B:261:0x0c93  */
    /* JADX WARN: Removed duplicated region for block: B:262:0x0c76  */
    /* JADX WARN: Removed duplicated region for block: B:309:0x08c3  */
    /* JADX WARN: Removed duplicated region for block: B:316:0x090d  */
    /* JADX WARN: Removed duplicated region for block: B:327:0x09ab  */
    /* JADX WARN: Removed duplicated region for block: B:77:0x0c73  */
    /* JADX WARN: Removed duplicated region for block: B:80:0x0c90  */
    /* JADX WARN: Removed duplicated region for block: B:83:0x0cbc  */
    /* JADX WARN: Removed duplicated region for block: B:92:0x0d1d  */
    /* JADX WARN: Removed duplicated region for block: B:95:0x0d38  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawContent(Canvas canvas) {
        String str;
        int i;
        MessageObject messageObject;
        ArrayList<MessageObject.TextLayoutBlock> arrayList;
        AudioVisualizerDrawable animatedOutAudioVisualizerDrawable;
        float f;
        Drawable drawable;
        float f2;
        float f3;
        float f4;
        int i2;
        boolean isPlayingMessage;
        int i3;
        int i4;
        Drawable drawable2;
        float dp;
        int dp2;
        int dp3;
        StaticLayout staticLayout;
        StaticLayout staticLayout2;
        int imageX;
        int i5;
        int dp4;
        ViewGroup viewGroup;
        boolean z = this.needNewVisiblePart && this.currentMessageObject.type == 0;
        boolean hasSpoilers = hasSpoilers();
        if (z || hasSpoilers) {
            getLocalVisibleRect(this.scrollRect);
            if (hasSpoilers) {
                Rect rect = this.scrollRect;
                updateSpoilersVisiblePart(rect.top, rect.bottom);
            }
            if (z) {
                Rect rect2 = this.scrollRect;
                int i6 = rect2.top;
                setVisiblePart(i6, rect2.bottom - i6, this.parentHeight, this.parentViewTopOffset, this.viewTop, this.parentWidth, this.backgroundHeight, this.blurredViewTopOffset, this.blurredViewBottomOffset);
                this.needNewVisiblePart = false;
            }
        }
        float f5 = this.buttonX;
        float f6 = this.buttonY;
        if (this.transitionParams.animateButton) {
            float f7 = this.transitionParams.animateFromButtonX;
            TransitionParams transitionParams = this.transitionParams;
            float f8 = transitionParams.animateChangeProgress;
            f5 = (f7 * (1.0f - f8)) + (this.buttonX * f8);
            float f9 = transitionParams.animateFromButtonY;
            float f10 = this.transitionParams.animateChangeProgress;
            f6 = (f9 * (1.0f - f10)) + (this.buttonY * f10);
            int i7 = (int) f5;
            int i8 = (int) f6;
            this.radialProgress.setProgressRect(i7, i8, AndroidUtilities.dp(44.0f) + i7, AndroidUtilities.dp(44.0f) + i8);
        }
        float f11 = f6;
        updateSeekBarWaveformWidth();
        this.forceNotDrawTime = this.currentMessagesGroup != null;
        this.photoImage.setPressed(((this.isHighlightedAnimated || this.isHighlighted) && this.currentPosition != null) ? 2 : 0);
        this.photoImage.setVisible(!PhotoViewer.isShowingImage(this.currentMessageObject) && !SecretMediaViewer.getInstance().isShowingImage(this.currentMessageObject), false);
        if (!this.photoImage.getVisible()) {
            this.mediaWasInvisible = true;
            this.timeWasInvisible = true;
            int i9 = this.animatingNoSound;
            if (i9 == 1) {
                this.animatingNoSoundProgress = 0.0f;
                this.animatingNoSound = 0;
            } else if (i9 == 2) {
                this.animatingNoSoundProgress = 1.0f;
                this.animatingNoSound = 0;
            }
        } else if (this.groupPhotoInvisible) {
            this.timeWasInvisible = true;
        } else {
            boolean z2 = this.mediaWasInvisible;
            if (z2 || this.timeWasInvisible) {
                if (z2) {
                    this.controlsAlpha = 0.0f;
                    this.mediaWasInvisible = false;
                }
                if (this.timeWasInvisible) {
                    this.timeAlpha = 0.0f;
                    this.timeWasInvisible = false;
                }
                this.lastControlsAlphaChangeTime = System.currentTimeMillis();
                this.totalChangeTime = 0L;
            }
        }
        this.radialProgress.setProgressColor(getThemedColor("chat_mediaProgress"));
        this.videoRadialProgress.setProgressColor(getThemedColor("chat_mediaProgress"));
        this.imageDrawn = false;
        this.radialProgress.setCircleCrossfadeColor(null, 0.0f, 1.0f);
        MessageObject messageObject2 = this.currentMessageObject;
        int i10 = messageObject2.type;
        float f12 = 11.0f;
        if (i10 == 0 || i10 == 19) {
            if (messageObject2.isOutOwner()) {
                this.textX = getCurrentBackgroundLeft() + AndroidUtilities.dp(11.0f) + getExtraTextX();
            } else {
                this.textX = getCurrentBackgroundLeft() + AndroidUtilities.dp((this.mediaBackground || !this.drawPinnedBottom) ? 17.0f : 11.0f) + getExtraTextX();
            }
            if (this.hasGamePreview) {
                this.textX += AndroidUtilities.dp(11.0f);
                int dp5 = AndroidUtilities.dp(14.0f) + this.namesOffset;
                this.textY = dp5;
                StaticLayout staticLayout3 = this.siteNameLayout;
                if (staticLayout3 != null) {
                    this.textY = dp5 + staticLayout3.getLineBottom(staticLayout3.getLineCount() - 1);
                }
            } else if (this.hasInvoicePreview) {
                int dp6 = AndroidUtilities.dp(14.0f) + this.namesOffset;
                this.textY = dp6;
                StaticLayout staticLayout4 = this.siteNameLayout;
                if (staticLayout4 != null) {
                    this.textY = dp6 + staticLayout4.getLineBottom(staticLayout4.getLineCount() - 1);
                }
            } else if (this.currentMessageObject.type == 19) {
                this.textY = AndroidUtilities.dp(6.0f) + this.namesOffset;
                if (!this.currentMessageObject.isOut()) {
                    this.textX = getCurrentBackgroundLeft();
                } else {
                    this.textX -= AndroidUtilities.dp(4.0f);
                }
            } else {
                this.textY = AndroidUtilities.dp(8.0f) + this.namesOffset;
            }
            this.unmovedTextX = this.textX;
            if (this.currentMessageObject.textXOffset != 0.0f && this.replyNameLayout != null) {
                int dp7 = this.backgroundWidth - AndroidUtilities.dp(31.0f);
                MessageObject messageObject3 = this.currentMessageObject;
                int i11 = dp7 - messageObject3.textWidth;
                if (!this.hasNewLineForTime) {
                    i11 -= this.timeWidth + AndroidUtilities.dp((messageObject3.isOutOwner() ? 20 : 0) + 4);
                }
                if (i11 > 0) {
                    this.textX += i11 - getExtraTimeX();
                }
            }
            if (this.enterTransitionInProgress || (messageObject = this.currentMessageObject) == null || messageObject.preview) {
                str = "chat_mediaProgress";
                i = 5;
            } else {
                if (!this.drawForBlur && this.animatedEmojiStack != null && (((arrayList = messageObject.textLayoutBlocks) != null && !arrayList.isEmpty()) || (this.transitionParams.animateOutTextBlocks != null && !this.transitionParams.animateOutTextBlocks.isEmpty()))) {
                    this.animatedEmojiStack.clearPositions();
                }
                TransitionParams transitionParams2 = this.transitionParams;
                if (transitionParams2.animateChangeProgress != 1.0f && transitionParams2.animateMessageText) {
                    canvas.save();
                    Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
                    if (messageDrawable != null) {
                        Rect bounds = messageDrawable.getBounds();
                        if (this.currentMessageObject.isOutOwner() && !this.mediaBackground && !this.pinnedBottom) {
                            canvas.clipRect(bounds.left + AndroidUtilities.dp(4.0f), bounds.top + AndroidUtilities.dp(4.0f), bounds.right - AndroidUtilities.dp(10.0f), bounds.bottom - AndroidUtilities.dp(4.0f));
                        } else {
                            canvas.clipRect(bounds.left + AndroidUtilities.dp(4.0f), bounds.top + AndroidUtilities.dp(4.0f), bounds.right - AndroidUtilities.dp(4.0f), bounds.bottom - AndroidUtilities.dp(4.0f));
                        }
                    }
                    i = 5;
                    str = "chat_mediaProgress";
                    drawMessageText(canvas, this.transitionParams.animateOutTextBlocks, false, 1.0f - this.transitionParams.animateChangeProgress, false);
                    drawMessageText(canvas, this.currentMessageObject.textLayoutBlocks, true, this.transitionParams.animateChangeProgress, false);
                    canvas.restore();
                } else {
                    str = "chat_mediaProgress";
                    i = 5;
                    drawMessageText(canvas, this.currentMessageObject.textLayoutBlocks, true, 1.0f, false);
                }
            }
            if (!this.enterTransitionInProgress || this.currentMessageObject.isVoice()) {
                drawLinkPreview(canvas, 1.0f);
            }
            this.drawTime = true;
        } else {
            if (this.drawPhotoImage) {
                if (this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && MediaController.getInstance().isVideoDrawingReady() && canvas.isHardwareAccelerated()) {
                    this.imageDrawn = true;
                    this.drawTime = true;
                } else {
                    int i12 = this.currentMessageObject.type;
                    if (i12 == 5 && Theme.chat_roundVideoShadow != null) {
                        float imageX2 = this.photoImage.getImageX() - AndroidUtilities.dp(3.0f);
                        float imageY = this.photoImage.getImageY() - AndroidUtilities.dp(2.0f);
                        Theme.chat_roundVideoShadow.setAlpha(255);
                        Theme.chat_roundVideoShadow.setBounds((int) imageX2, (int) imageY, (int) (imageX2 + this.photoImage.getImageWidth() + AndroidUtilities.dp(6.0f)), (int) (imageY + this.photoImage.getImageHeight() + AndroidUtilities.dp(6.0f)));
                        Theme.chat_roundVideoShadow.draw(canvas);
                        if (!this.photoImage.hasBitmapImage() || this.photoImage.getCurrentAlpha() != 1.0f) {
                            Theme.chat_docBackPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outBubble" : "chat_inBubble"));
                            canvas.drawCircle(this.photoImage.getCenterX(), this.photoImage.getCenterY(), this.photoImage.getImageWidth() / 2.0f, Theme.chat_docBackPaint);
                        }
                    } else if (i12 == 4) {
                        this.rect.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
                        Theme.chat_docBackPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outLocationBackground" : "chat_inLocationBackground"));
                        int[] roundRadius = this.photoImage.getRoundRadius();
                        this.rectPath.reset();
                        for (int i13 = 0; i13 < roundRadius.length; i13++) {
                            float[] fArr = radii;
                            int i14 = i13 * 2;
                            float f13 = roundRadius[i13];
                            fArr[i14 + 1] = f13;
                            fArr[i14] = f13;
                        }
                        this.rectPath.addRoundRect(this.rect, radii, Path.Direction.CW);
                        this.rectPath.close();
                        canvas.drawPath(this.rectPath, Theme.chat_docBackPaint);
                        Drawable drawable3 = Theme.chat_locationDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0];
                        BaseCell.setDrawableBounds(drawable3, this.rect.centerX() - (drawable3.getIntrinsicWidth() / 2), this.rect.centerY() - (drawable3.getIntrinsicHeight() / 2));
                        drawable3.draw(canvas);
                    }
                    CheckBoxBase checkBoxBase = this.mediaCheckBox;
                    boolean z3 = checkBoxBase != null && (this.checkBoxVisible || checkBoxBase.getProgress() != 0.0f || this.checkBoxAnimationInProgress) && this.currentMessagesGroup != null;
                    this.drawMediaCheckBox = z3;
                    if (z3 && ((this.mediaCheckBox.isChecked() || this.mediaCheckBox.getProgress() != 0.0f || this.checkBoxAnimationInProgress) && !textIsSelectionMode())) {
                        if (!this.currentMessagesGroup.isDocuments) {
                            Theme.chat_replyLinePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outBubbleSelected" : "chat_inBubbleSelected"));
                            this.rect.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
                            int[] roundRadius2 = this.photoImage.getRoundRadius();
                            this.rectPath.reset();
                            for (int i15 = 0; i15 < roundRadius2.length; i15++) {
                                float[] fArr2 = radii;
                                int i16 = i15 * 2;
                                float f14 = roundRadius2[i15];
                                fArr2[i16 + 1] = f14;
                                fArr2[i16] = f14;
                            }
                            this.rectPath.addRoundRect(this.rect, radii, Path.Direction.CW);
                            this.rectPath.close();
                            canvas.drawPath(this.rectPath, Theme.chat_replyLinePaint);
                        }
                        this.photoImage.setSideClip(AndroidUtilities.dp(14.0f) * this.mediaCheckBox.getProgress());
                        if (this.checkBoxAnimationInProgress) {
                            this.mediaCheckBox.setBackgroundAlpha(this.checkBoxAnimationProgress);
                        } else {
                            CheckBoxBase checkBoxBase2 = this.mediaCheckBox;
                            checkBoxBase2.setBackgroundAlpha(this.checkBoxVisible ? 1.0f : checkBoxBase2.getProgress());
                        }
                    } else {
                        this.photoImage.setSideClip(0.0f);
                    }
                    ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                    if (chatMessageCellDelegate == null || chatMessageCellDelegate.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) {
                        float y = getY() + this.photoImage.getImageY();
                        float imageHeight = this.photoImage.getImageHeight() + y;
                        this.photoImageOutOfBounds = false;
                        float f15 = this.parentBoundsTop;
                        if ((f15 != 0.0f || this.parentBoundsBottom != 0) && (imageHeight < f15 || y > this.parentBoundsBottom)) {
                            this.photoImageOutOfBounds = true;
                        }
                        if (!this.photoImageOutOfBounds || this.drawForBlur) {
                            this.photoImage.setSkipUpdateFrame(this.drawForBlur);
                            if (this.flipImage) {
                                canvas.save();
                                canvas.scale(-1.0f, 1.0f, this.photoImage.getCenterX(), this.photoImage.getCenterY());
                                this.imageDrawn = this.photoImage.draw(canvas);
                                canvas.restore();
                            } else {
                                this.imageDrawn = this.photoImage.draw(canvas);
                            }
                            this.photoImage.setSkipUpdateFrame(false);
                        }
                    }
                    boolean z4 = this.drawTime;
                    boolean visible = this.photoImage.getVisible();
                    boolean z5 = visible || (this.currentMessageObject.shouldDrawReactionsInLayout() && this.currentMessageObject.hasReactions());
                    this.drawTime = z5;
                    if (this.currentPosition != null && z4 != z5 && (viewGroup = (ViewGroup) getParent()) != null) {
                        if (!this.currentPosition.last) {
                            int childCount = viewGroup.getChildCount();
                            for (int i17 = 0; i17 < childCount; i17++) {
                                View childAt = viewGroup.getChildAt(i17);
                                if (childAt != this && (childAt instanceof ChatMessageCell)) {
                                    ChatMessageCell chatMessageCell = (ChatMessageCell) childAt;
                                    if (chatMessageCell.getCurrentMessagesGroup() == this.currentMessagesGroup) {
                                        MessageObject.GroupedMessagePosition currentPosition = chatMessageCell.getCurrentPosition();
                                        if (currentPosition.last && currentPosition.maxY == this.currentPosition.maxY && (chatMessageCell.timeX - AndroidUtilities.dp(4.0f)) + chatMessageCell.getLeft() < getRight()) {
                                            chatMessageCell.groupPhotoInvisible = !visible;
                                            chatMessageCell.invalidate();
                                            viewGroup.invalidate();
                                        }
                                    }
                                }
                            }
                        } else {
                            viewGroup.invalidate();
                        }
                    }
                }
            } else {
                int i18 = this.documentAttachType;
                if (i18 == 5 || i18 == 1) {
                    CheckBoxBase checkBoxBase3 = this.mediaCheckBox;
                    boolean z6 = checkBoxBase3 != null && (this.checkBoxVisible || checkBoxBase3.getProgress() != 0.0f || this.checkBoxAnimationInProgress) && this.currentMessagesGroup != null;
                    this.drawMediaCheckBox = z6;
                    if (z6) {
                        this.radialProgress.setCircleCrossfadeColor(this.currentMessageObject.isOutOwner() ? "chat_outTimeText" : "chat_inTimeText", this.checkBoxAnimationProgress, 1.0f - this.mediaCheckBox.getProgress());
                    }
                    if (this.drawMediaCheckBox && !textIsSelectionMode() && (this.mediaCheckBox.isChecked() || this.mediaCheckBox.getProgress() != 0.0f || this.checkBoxAnimationInProgress)) {
                        if (this.checkBoxAnimationInProgress) {
                            this.mediaCheckBox.setBackgroundAlpha(this.checkBoxAnimationProgress);
                            if (this.radialProgress.getMiniIcon() == 4) {
                                this.radialProgress.setMiniIconScale(this.checkBoxAnimationProgress);
                            }
                        } else {
                            CheckBoxBase checkBoxBase4 = this.mediaCheckBox;
                            checkBoxBase4.setBackgroundAlpha(this.checkBoxVisible ? 1.0f : checkBoxBase4.getProgress());
                        }
                    } else {
                        CheckBoxBase checkBoxBase5 = this.mediaCheckBox;
                        if (checkBoxBase5 != null) {
                            checkBoxBase5.setBackgroundAlpha(1.0f);
                        }
                    }
                }
            }
            str = "chat_mediaProgress";
            i = 5;
        }
        int i19 = this.documentAttachType;
        String str2 = "chat_outAudioProgress";
        if (i19 == 2) {
            if (this.photoImage.getVisible() && !this.hasGamePreview && !this.currentMessageObject.needDrawBluredPreview()) {
                int alpha = ((BitmapDrawable) Theme.chat_msgMediaMenuDrawable).getPaint().getAlpha();
                Theme.chat_msgMediaMenuDrawable.setAlpha((int) (alpha * this.controlsAlpha));
                Drawable drawable4 = Theme.chat_msgMediaMenuDrawable;
                int imageX3 = (int) ((this.photoImage.getImageX() + this.photoImage.getImageWidth()) - AndroidUtilities.dp(14.0f));
                this.otherX = imageX3;
                int imageY2 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.1f));
                this.otherY = imageY2;
                BaseCell.setDrawableBounds(drawable4, imageX3, imageY2);
                Theme.chat_msgMediaMenuDrawable.draw(canvas);
                Theme.chat_msgMediaMenuDrawable.setAlpha(alpha);
            }
        } else if (i19 == 7) {
            if (this.durationLayout != null && ((isPlayingMessage = MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) || this.roundProgressAlpha != 0.0f)) {
                if (isPlayingMessage) {
                    this.roundProgressAlpha = 1.0f;
                } else {
                    float f16 = this.roundProgressAlpha - 0.10666667f;
                    this.roundProgressAlpha = f16;
                    if (f16 < 0.0f) {
                        this.roundProgressAlpha = 0.0f;
                    } else {
                        invalidate();
                    }
                }
                drawRoundProgress(canvas);
            }
        } else if (i19 == i) {
            if (this.currentMessageObject.isOutOwner()) {
                Theme.chat_audioTitlePaint.setColor(getThemedColor("chat_outAudioTitleText"));
                Theme.chat_audioPerformerPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outAudioPerfomerSelectedText" : "chat_outAudioPerfomerText"));
                Theme.chat_audioTimePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outAudioDurationSelectedText" : "chat_outAudioDurationText"));
                this.radialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? "chat_outAudioSelectedProgress" : str2));
            } else {
                Theme.chat_audioTitlePaint.setColor(getThemedColor("chat_inAudioTitleText"));
                Theme.chat_audioPerformerPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inAudioPerfomerSelectedText" : "chat_inAudioPerfomerText"));
                Theme.chat_audioTimePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inAudioDurationSelectedText" : "chat_inAudioDurationText"));
                this.radialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? "chat_inAudioSelectedProgress" : "chat_inAudioProgress"));
            }
            this.radialProgress.setBackgroundDrawable(isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
            this.radialProgress.draw(canvas);
            canvas.save();
            canvas.translate(this.timeAudioX + this.songX, AndroidUtilities.dp(13.0f) + this.namesOffset + this.mediaOffsetY);
            this.songLayout.draw(canvas);
            canvas.restore();
            boolean isPlayingMessage2 = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
            if (isPlayingMessage2) {
                float f17 = this.toSeekBarProgress;
                if (f17 != 1.0f) {
                    float f18 = f17 + 0.16f;
                    this.toSeekBarProgress = f18;
                    if (f18 > 1.0f) {
                        this.toSeekBarProgress = 1.0f;
                    }
                    invalidate();
                    f = this.toSeekBarProgress;
                    if (f > 0.0f) {
                        if (f != 1.0f) {
                            canvas.saveLayerAlpha(this.seekBarX, this.seekBarY, i2 + this.seekBar.getWidth() + AndroidUtilities.dp(24.0f), this.seekBarY + AndroidUtilities.dp(24.0f), (int) (this.toSeekBarProgress * 255.0f), 31);
                        } else {
                            canvas.save();
                        }
                        canvas.translate(this.seekBarX, this.seekBarY);
                        this.seekBar.draw(canvas);
                        canvas.restore();
                    }
                    if (this.toSeekBarProgress < 1.0f) {
                        float f19 = this.timeAudioX + this.performerX;
                        float dp8 = AndroidUtilities.dp(35.0f) + this.namesOffset + this.mediaOffsetY;
                        if (this.toSeekBarProgress != 0.0f) {
                            f2 = dp8;
                            f3 = f19;
                            canvas.saveLayerAlpha(f19, dp8, f19 + this.performerLayout.getWidth(), dp8 + this.performerLayout.getHeight(), (int) ((1.0f - this.toSeekBarProgress) * 255.0f), 31);
                        } else {
                            f2 = dp8;
                            f3 = f19;
                            canvas.save();
                        }
                        float f20 = this.toSeekBarProgress;
                        if (f20 != 0.0f) {
                            float f21 = ((1.0f - f20) * 0.3f) + 0.7f;
                            f4 = f3;
                            canvas.scale(f21, f21, f4, f2 + (this.performerLayout.getHeight() / 2.0f));
                        } else {
                            f4 = f3;
                        }
                        canvas.translate(f4, f2);
                        this.performerLayout.draw(canvas);
                        canvas.restore();
                    }
                    canvas.save();
                    canvas.translate(this.timeAudioX, AndroidUtilities.dp(57.0f) + this.namesOffset + this.mediaOffsetY);
                    this.durationLayout.draw(canvas);
                    canvas.restore();
                    if (shouldDrawMenuDrawable()) {
                        if (this.currentMessageObject.isOutOwner()) {
                            drawable = getThemedDrawable(isDrawSelectionBackground() ? "drawableMsgOutMenuSelected" : "drawableMsgOutMenu");
                        } else {
                            drawable = isDrawSelectionBackground() ? Theme.chat_msgInMenuSelectedDrawable : Theme.chat_msgInMenuDrawable;
                        }
                        int dp9 = (((int) f5) + this.backgroundWidth) - AndroidUtilities.dp(this.currentMessageObject.type == 0 ? 58.0f : 48.0f);
                        this.otherX = dp9;
                        int dp10 = ((int) f11) - AndroidUtilities.dp(2.0f);
                        this.otherY = dp10;
                        BaseCell.setDrawableBounds(drawable, dp9, dp10);
                        TransitionParams transitionParams3 = this.transitionParams;
                        if (transitionParams3.animateChangeProgress != 1.0f && transitionParams3.animateShouldDrawMenuDrawable) {
                            drawable.setAlpha((int) (this.transitionParams.animateChangeProgress * 255.0f));
                        }
                        drawable.draw(canvas);
                        TransitionParams transitionParams4 = this.transitionParams;
                        if (transitionParams4.animateChangeProgress != 1.0f && transitionParams4.animateShouldDrawMenuDrawable) {
                            drawable.setAlpha(255);
                        }
                    }
                }
            }
            if (!isPlayingMessage2) {
                float f22 = this.toSeekBarProgress;
                if (f22 != 0.0f) {
                    float f23 = f22 - 0.16f;
                    this.toSeekBarProgress = f23;
                    if (f23 < 0.0f) {
                        this.toSeekBarProgress = 0.0f;
                    }
                    invalidate();
                }
            }
            f = this.toSeekBarProgress;
            if (f > 0.0f) {
            }
            if (this.toSeekBarProgress < 1.0f) {
            }
            canvas.save();
            canvas.translate(this.timeAudioX, AndroidUtilities.dp(57.0f) + this.namesOffset + this.mediaOffsetY);
            this.durationLayout.draw(canvas);
            canvas.restore();
            if (shouldDrawMenuDrawable()) {
            }
        } else if (i19 == 3) {
            if (this.currentMessageObject.isOutOwner()) {
                Theme.chat_audioTimePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outAudioDurationSelectedText" : "chat_outAudioDurationText"));
                this.radialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? "chat_outAudioSelectedProgress" : str2));
            } else {
                Theme.chat_audioTimePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inAudioDurationSelectedText" : "chat_inAudioDurationText"));
                this.radialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? "chat_inAudioSelectedProgress" : "chat_inAudioProgress"));
            }
            if (MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                animatedOutAudioVisualizerDrawable = Theme.getCurrentAudiVisualizerDrawable();
            } else {
                animatedOutAudioVisualizerDrawable = Theme.getAnimatedOutAudioVisualizerDrawable(this.currentMessageObject);
            }
            if (animatedOutAudioVisualizerDrawable != null) {
                animatedOutAudioVisualizerDrawable.setParentView(this);
                animatedOutAudioVisualizerDrawable.draw(canvas, f5 + AndroidUtilities.dp(22.0f), f11 + AndroidUtilities.dp(22.0f), this.currentMessageObject.isOutOwner(), this.resourcesProvider);
            }
            if (!this.enterTransitionInProgress) {
                this.radialProgress.setBackgroundDrawable(isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                this.radialProgress.draw(canvas);
            }
            int i20 = this.seekBarX;
            int i21 = this.timeAudioX;
            if (this.transitionParams.animateButton) {
                int i22 = this.buttonX;
                float f24 = this.transitionParams.animateFromButtonX;
                float f25 = this.transitionParams.animateChangeProgress;
                int i23 = i22 - ((int) ((f24 * (1.0f - f25)) + (this.buttonX * f25)));
                i20 -= i23;
                i21 -= i23;
            }
            canvas.save();
            if (this.useSeekBarWaveform) {
                canvas.translate(AndroidUtilities.dp(13.0f) + i20, this.seekBarY);
                this.seekBarWaveform.draw(canvas, this);
            } else {
                canvas.translate(i20, this.seekBarY);
                this.seekBar.draw(canvas);
            }
            canvas.restore();
            if (this.useTranscribeButton) {
                canvas.save();
                int i24 = this.backgroundWidth;
                TransitionParams transitionParams5 = this.transitionParams;
                if (transitionParams5.animateBackgroundBoundsInner && this.documentAttachType == 3) {
                    i24 = (int) ((i24 - transitionParams5.deltaLeft) + transitionParams5.deltaRight);
                }
                float dp11 = i20 + AndroidUtilities.dp(21.0f) + (i24 - AndroidUtilities.dp(((this.hasLinkPreview ? 10 : 0) + 92) + 36));
                this.transcribeX = dp11;
                float f26 = this.seekBarY;
                this.transcribeY = f26;
                canvas.translate(dp11, f26);
                if (this.transcribeButton == null) {
                    TranscribeButton transcribeButton = new TranscribeButton(this, this.seekBarWaveform);
                    this.transcribeButton = transcribeButton;
                    TLRPC$Message tLRPC$Message = this.currentMessageObject.messageOwner;
                    transcribeButton.setOpen(tLRPC$Message != null && tLRPC$Message.voiceTranscriptionOpen && tLRPC$Message.voiceTranscriptionFinal, false);
                    this.transcribeButton.setLoading(TranscribeButton.isTranscribing(this.currentMessageObject), false);
                }
                this.transcribeButton.setColor(this.currentMessageObject.isOut(), getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outReactionButtonBackground" : "chat_inReactionButtonBackground"), getThemedColor("windowBackgroundWhiteGrayText"));
                this.transcribeButton.draw(canvas);
                canvas.restore();
            }
            canvas.save();
            canvas.translate(i21, AndroidUtilities.dp(44.0f) + this.namesOffset + this.mediaOffsetY);
            this.durationLayout.draw(canvas);
            canvas.restore();
            MessageObject messageObject4 = this.currentMessageObject;
            if (messageObject4.type != 0 && messageObject4.isContentUnread()) {
                Theme.chat_docBackPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outVoiceSeekbarFill" : "chat_inVoiceSeekbarFill"));
                canvas.drawCircle(i21 + this.timeWidthAudio + AndroidUtilities.dp(6.0f), AndroidUtilities.dp(51.0f) + this.namesOffset + this.mediaOffsetY, AndroidUtilities.dp(3.0f), Theme.chat_docBackPaint);
            }
        }
        if (this.captionLayout != null) {
            updateCaptionLayout();
        }
        updateReactionLayoutPosition();
        if (shouldDrawCaptionLayout()) {
            drawCaptionLayout(canvas, false, 1.0f);
        }
        if (this.hasOldCaptionPreview) {
            MessageObject messageObject5 = this.currentMessageObject;
            int i25 = messageObject5.type;
            if (i25 != 1 && i25 != 20) {
                if (this.documentAttachType != 4 && i25 != 8) {
                    int i26 = this.backgroundDrawableLeft;
                    if (!messageObject5.isOutOwner()) {
                        f12 = 17.0f;
                    }
                    imageX = i26 + AndroidUtilities.dp(f12);
                    int i27 = imageX;
                    int dp12 = ((this.totalHeight - AndroidUtilities.dp(!this.drawPinnedTop ? 9.0f : 10.0f)) - this.linkPreviewHeight) - AndroidUtilities.dp(8.0f);
                    Theme.chat_replyLinePaint.setColor(getThemedColor(!this.currentMessageObject.isOutOwner() ? "chat_outPreviewLine" : "chat_inPreviewLine"));
                    canvas.drawRect(i27, dp12 - AndroidUtilities.dp(3.0f), AndroidUtilities.dp(2.0f) + i27, this.linkPreviewHeight + dp12, Theme.chat_replyLinePaint);
                    if (this.siteNameLayout == null) {
                        Theme.chat_replyNamePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outSiteNameText" : "chat_inSiteNameText"));
                        canvas.save();
                        if (this.siteNameRtl) {
                            dp4 = (this.backgroundWidth - this.siteNameWidth) - AndroidUtilities.dp(32.0f);
                        } else {
                            dp4 = this.hasInvoicePreview ? 0 : AndroidUtilities.dp(10.0f);
                        }
                        canvas.translate(dp4 + i27, dp12 - AndroidUtilities.dp(3.0f));
                        this.siteNameLayout.draw(canvas);
                        canvas.restore();
                        StaticLayout staticLayout5 = this.siteNameLayout;
                        i5 = dp12 + staticLayout5.getLineBottom(staticLayout5.getLineCount() - 1);
                    } else {
                        i5 = dp12;
                    }
                    if (!this.currentMessageObject.isOutOwner()) {
                        Theme.chat_replyTextPaint.setColor(getThemedColor("chat_messageTextOut"));
                    } else {
                        Theme.chat_replyTextPaint.setColor(getThemedColor("chat_messageTextIn"));
                    }
                    if (this.descriptionLayout == null) {
                        if (i5 != dp12) {
                            i5 += AndroidUtilities.dp(2.0f);
                        }
                        this.descriptionY = i5 - AndroidUtilities.dp(3.0f);
                        canvas.save();
                        canvas.translate(i27 + AndroidUtilities.dp(10.0f) + this.descriptionX, this.descriptionY);
                        this.descriptionLayout.draw(canvas);
                        i4 = 4;
                        AnimatedEmojiSpan.drawAnimatedEmojis(canvas, this.descriptionLayout, this.animatedEmojiDescriptionStack, 0.0f, null, 0.0f, 0.0f, 0.0f, 1.0f);
                        canvas.restore();
                    } else {
                        i4 = 4;
                    }
                    i3 = 1;
                    this.drawTime = true;
                }
            }
            imageX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(5.0f));
            int i272 = imageX;
            int dp122 = ((this.totalHeight - AndroidUtilities.dp(!this.drawPinnedTop ? 9.0f : 10.0f)) - this.linkPreviewHeight) - AndroidUtilities.dp(8.0f);
            Theme.chat_replyLinePaint.setColor(getThemedColor(!this.currentMessageObject.isOutOwner() ? "chat_outPreviewLine" : "chat_inPreviewLine"));
            canvas.drawRect(i272, dp122 - AndroidUtilities.dp(3.0f), AndroidUtilities.dp(2.0f) + i272, this.linkPreviewHeight + dp122, Theme.chat_replyLinePaint);
            if (this.siteNameLayout == null) {
            }
            if (!this.currentMessageObject.isOutOwner()) {
            }
            if (this.descriptionLayout == null) {
            }
            i3 = 1;
            this.drawTime = true;
        } else {
            i3 = 1;
            i4 = 4;
        }
        if (this.documentAttachType == i3) {
            if (this.currentMessageObject.isOutOwner()) {
                Theme.chat_docNamePaint.setColor(getThemedColor("chat_outFileNameText"));
                Theme.chat_infoPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outFileInfoSelectedText" : "chat_outFileInfoText"));
                Theme.chat_docBackPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outFileBackgroundSelected" : "chat_outFileBackground"));
                drawable2 = getThemedDrawable(isDrawSelectionBackground() ? "drawableMsgOutMenuSelected" : "drawableMsgOutMenu");
            } else {
                Theme.chat_docNamePaint.setColor(getThemedColor("chat_inFileNameText"));
                Theme.chat_infoPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inFileInfoSelectedText" : "chat_inFileInfoText"));
                Theme.chat_docBackPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inFileBackgroundSelected" : "chat_inFileBackground"));
                drawable2 = isDrawSelectionBackground() ? Theme.chat_msgInMenuSelectedDrawable : Theme.chat_msgInMenuDrawable;
            }
            if (this.drawPhotoImage) {
                if (this.currentMessageObject.type == 0) {
                    int imageX4 = (int) ((this.photoImage.getImageX() + this.backgroundWidth) - AndroidUtilities.dp(56.0f));
                    this.otherX = imageX4;
                    int imageY3 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(4.0f));
                    this.otherY = imageY3;
                    BaseCell.setDrawableBounds(drawable2, imageX4, imageY3);
                } else {
                    int imageX5 = (int) ((this.photoImage.getImageX() + this.backgroundWidth) - AndroidUtilities.dp(40.0f));
                    this.otherX = imageX5;
                    int imageY4 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(4.0f));
                    this.otherY = imageY4;
                    BaseCell.setDrawableBounds(drawable2, imageX5, imageY4);
                }
                dp = (int) (this.photoImage.getImageX() + this.photoImage.getImageWidth() + AndroidUtilities.dp(10.0f));
                dp2 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.0f));
                dp3 = (int) (this.photoImage.getImageY() + (this.docTitleLayout != null ? staticLayout2.getLineBottom(staticLayout2.getLineCount() - 1) + AndroidUtilities.dp(13.0f) : AndroidUtilities.dp(8.0f)));
                if (!this.imageDrawn) {
                    if (this.currentMessageObject.isOutOwner()) {
                        this.radialProgress.setColors("chat_outLoader", "chat_outLoaderSelected", "chat_outMediaIcon", "chat_outMediaIconSelected");
                        this.radialProgress.setProgressColor(getThemedColor(isDrawSelectionBackground() ? "chat_outFileProgressSelected" : "chat_outFileProgress"));
                        this.videoRadialProgress.setColors("chat_outLoader", "chat_outLoaderSelected", "chat_outMediaIcon", "chat_outMediaIconSelected");
                        this.videoRadialProgress.setProgressColor(getThemedColor(isDrawSelectionBackground() ? "chat_outFileProgressSelected" : "chat_outFileProgress"));
                    } else {
                        this.radialProgress.setColors("chat_inLoader", "chat_inLoaderSelected", "chat_inMediaIcon", "chat_inMediaIconSelected");
                        this.radialProgress.setProgressColor(getThemedColor(isDrawSelectionBackground() ? "chat_inFileProgressSelected" : "chat_inFileProgress"));
                        this.videoRadialProgress.setColors("chat_inLoader", "chat_inLoaderSelected", "chat_inMediaIcon", "chat_inMediaIconSelected");
                        this.videoRadialProgress.setProgressColor(getThemedColor(isDrawSelectionBackground() ? "chat_inFileProgressSelected" : "chat_inFileProgress"));
                    }
                    this.rect.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX() + this.photoImage.getImageWidth(), this.photoImage.getImageY() + this.photoImage.getImageHeight());
                    int[] roundRadius3 = this.photoImage.getRoundRadius();
                    this.rectPath.reset();
                    for (int i28 = 0; i28 < roundRadius3.length; i28++) {
                        float[] fArr3 = radii;
                        int i29 = i28 * 2;
                        fArr3[i29] = roundRadius3[i28];
                        fArr3[i29 + 1] = roundRadius3[i28];
                    }
                    this.rectPath.addRoundRect(this.rect, radii, Path.Direction.CW);
                    this.rectPath.close();
                    canvas.drawPath(this.rectPath, Theme.chat_docBackPaint);
                } else {
                    this.radialProgress.setColors("chat_mediaLoaderPhoto", "chat_mediaLoaderPhotoSelected", "chat_mediaLoaderPhotoIcon", "chat_mediaLoaderPhotoIconSelected");
                    this.radialProgress.setProgressColor(getThemedColor(str));
                    this.videoRadialProgress.setColors("chat_mediaLoaderPhoto", "chat_mediaLoaderPhotoSelected", "chat_mediaLoaderPhotoIcon", "chat_mediaLoaderPhotoIconSelected");
                    this.videoRadialProgress.setProgressColor(getThemedColor(str));
                    if (this.buttonState == -1 && this.radialProgress.getIcon() != i4) {
                        this.radialProgress.setIcon(i4, true, true);
                    }
                }
            } else {
                int dp13 = (((int) f5) + this.backgroundWidth) - AndroidUtilities.dp(this.currentMessageObject.type == 0 ? 58.0f : 48.0f);
                this.otherX = dp13;
                int i30 = (int) f11;
                int dp14 = i30 - AndroidUtilities.dp(2.0f);
                this.otherY = dp14;
                BaseCell.setDrawableBounds(drawable2, dp13, dp14);
                dp = f5 + AndroidUtilities.dp(53.0f);
                dp2 = AndroidUtilities.dp(4.0f) + i30;
                dp3 = i30 + AndroidUtilities.dp(27.0f);
                StaticLayout staticLayout6 = this.docTitleLayout;
                if (staticLayout6 != null && staticLayout6.getLineCount() > 1) {
                    dp3 += ((this.docTitleLayout.getLineCount() - 1) * AndroidUtilities.dp(16.0f)) + AndroidUtilities.dp(2.0f);
                }
                if (this.currentMessageObject.isOutOwner()) {
                    this.radialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? "chat_outAudioSelectedProgress" : str2));
                    RadialProgress2 radialProgress2 = this.videoRadialProgress;
                    if (isDrawSelectionBackground() || this.videoButtonPressed != 0) {
                        str2 = "chat_outAudioSelectedProgress";
                    }
                    radialProgress2.setProgressColor(getThemedColor(str2));
                } else {
                    this.radialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.buttonPressed != 0) ? "chat_inAudioSelectedProgress" : "chat_inAudioProgress"));
                    this.videoRadialProgress.setProgressColor(getThemedColor((isDrawSelectionBackground() || this.videoButtonPressed != 0) ? "chat_inAudioSelectedProgress" : "chat_inAudioProgress"));
                }
            }
            int i31 = dp2;
            float f27 = dp;
            if (shouldDrawMenuDrawable()) {
                TransitionParams transitionParams6 = this.transitionParams;
                if (transitionParams6.animateChangeProgress != 1.0f && transitionParams6.animateShouldDrawMenuDrawable) {
                    drawable2.setAlpha((int) (this.transitionParams.animateChangeProgress * 255.0f));
                }
                drawable2.draw(canvas);
                TransitionParams transitionParams7 = this.transitionParams;
                if (transitionParams7.animateChangeProgress != 1.0f && transitionParams7.animateShouldDrawMenuDrawable) {
                    drawable2.setAlpha(255);
                }
            }
            try {
                if (this.docTitleLayout != null) {
                    canvas.save();
                    canvas.translate(this.docTitleOffsetX + f27, i31);
                    this.docTitleLayout.draw(canvas);
                    canvas.restore();
                }
            } catch (Exception e) {
                FileLog.e(e);
            }
            try {
                if (this.infoLayout != null) {
                    canvas.save();
                    canvas.translate(f27, dp3);
                    if (this.buttonState == 1 && (staticLayout = this.loadingProgressLayout) != null) {
                        staticLayout.draw(canvas);
                    } else {
                        this.infoLayout.draw(canvas);
                    }
                    canvas.restore();
                }
            } catch (Exception e2) {
                FileLog.e(e2);
            }
        }
        MessageObject messageObject6 = this.currentMessageObject;
        if (messageObject6.type == i4 && !(MessageObject.getMedia(messageObject6.messageOwner) instanceof TLRPC$TL_messageMediaGeoLive) && this.currentMapProvider == 2 && this.photoImage.hasNotThumb()) {
            int intrinsicWidth = (int) (Theme.chat_redLocationIcon.getIntrinsicWidth() * 0.8f);
            int intrinsicHeight = (int) (Theme.chat_redLocationIcon.getIntrinsicHeight() * 0.8f);
            int imageX6 = (int) (this.photoImage.getImageX() + ((this.photoImage.getImageWidth() - intrinsicWidth) / 2.0f));
            int imageY5 = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() / 2.0f) - intrinsicHeight));
            Theme.chat_redLocationIcon.setAlpha((int) (this.photoImage.getCurrentAlpha() * 255.0f));
            Theme.chat_redLocationIcon.setBounds(imageX6, imageY5, intrinsicWidth + imageX6, intrinsicHeight + imageY5);
            Theme.chat_redLocationIcon.draw(canvas);
        }
        this.transitionParams.recordDrawingState();
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* JADX WARN: Code restructure failed: missing block: B:8:0x0017, code lost:
        if ((r1 & 1) != 0) goto L9;
     */
    /* JADX WARN: Removed duplicated region for block: B:71:0x0155  */
    /* JADX WARN: Removed duplicated region for block: B:75:0x0171  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void updateReactionLayoutPosition() {
        int i;
        float dp;
        ReactionsLayoutInBubble reactionsLayoutInBubble;
        ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
        int i2 = 0;
        if (!reactionsLayoutInBubble2.isEmpty) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            if (groupedMessagePosition != null) {
                int i3 = groupedMessagePosition.flags;
                if ((i3 & 8) != 0) {
                }
            }
            if (!reactionsLayoutInBubble2.isSmall) {
                MessageObject messageObject = this.currentMessageObject;
                if (messageObject.type == 19 || messageObject.isAnimatedEmoji() || this.currentMessageObject.isAnyKindOfSticker()) {
                    if (this.currentMessageObject.isOutOwner()) {
                        this.reactionsLayoutInBubble.x = (getMeasuredWidth() - this.reactionsLayoutInBubble.width) - AndroidUtilities.dp(16.0f);
                    } else {
                        this.reactionsLayoutInBubble.x = getCurrentBackgroundLeft();
                    }
                } else {
                    float f = 11.0f;
                    if (this.currentMessageObject.isOutOwner()) {
                        this.reactionsLayoutInBubble.x = getCurrentBackgroundLeft() + AndroidUtilities.dp(11.0f);
                    } else {
                        ReactionsLayoutInBubble reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
                        int currentBackgroundLeft = getCurrentBackgroundLeft();
                        if (this.mediaBackground || !this.drawPinnedBottom) {
                            f = 17.0f;
                        }
                        reactionsLayoutInBubble3.x = currentBackgroundLeft + AndroidUtilities.dp(f);
                        if (this.mediaBackground) {
                            this.reactionsLayoutInBubble.x -= AndroidUtilities.dp(9.0f);
                        }
                    }
                }
                ReactionsLayoutInBubble reactionsLayoutInBubble4 = this.reactionsLayoutInBubble;
                int backgroundDrawableBottom = getBackgroundDrawableBottom() - AndroidUtilities.dp(10.0f);
                ReactionsLayoutInBubble reactionsLayoutInBubble5 = this.reactionsLayoutInBubble;
                reactionsLayoutInBubble4.y = backgroundDrawableBottom - reactionsLayoutInBubble5.height;
                reactionsLayoutInBubble5.y -= this.drawCommentButton ? AndroidUtilities.dp(43.0f) : 0;
                if (this.hasNewLineForTime) {
                    this.reactionsLayoutInBubble.y -= AndroidUtilities.dp(16.0f);
                }
                if (this.captionLayout != null) {
                    MessageObject messageObject2 = this.currentMessageObject;
                    if ((messageObject2.type != 2 && ((!messageObject2.isOut() || !this.drawForwardedName || this.drawPhotoImage) && (this.currentMessageObject.type != 9 || !this.drawPhotoImage))) || (this.currentPosition != null && this.currentMessagesGroup != null)) {
                        this.reactionsLayoutInBubble.y -= AndroidUtilities.dp(14.0f);
                    }
                }
                ReactionsLayoutInBubble reactionsLayoutInBubble6 = this.reactionsLayoutInBubble;
                reactionsLayoutInBubble6.y += reactionsLayoutInBubble6.positionOffsetY;
            }
        }
        ReactionsLayoutInBubble reactionsLayoutInBubble7 = this.reactionsLayoutInBubble;
        if (!reactionsLayoutInBubble7.isSmall || reactionsLayoutInBubble7.isEmpty) {
            return;
        }
        if (shouldDrawTimeOnMedia()) {
            if (this.drawCommentButton) {
                i2 = AndroidUtilities.dp(41.3f);
            }
        } else if (this.currentMessageObject.isSponsored()) {
            i = -AndroidUtilities.dp(48.0f);
            if (this.hasNewLineForTime) {
                i -= AndroidUtilities.dp(16.0f);
            }
            ReactionsLayoutInBubble reactionsLayoutInBubble8 = this.reactionsLayoutInBubble;
            if (!shouldDrawTimeOnMedia()) {
                dp = ((this.photoImage.getImageY2() + this.additionalTimeOffsetY) - AndroidUtilities.dp(7.3f)) - this.timeLayout.getHeight();
            } else {
                dp = ((this.layoutHeight - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 7.5f : 6.5f)) - this.timeLayout.getHeight()) + i;
            }
            reactionsLayoutInBubble8.y = (int) dp;
            this.reactionsLayoutInBubble.y = (int) (reactionsLayoutInBubble.y + ((this.timeLayout.getHeight() / 2.0f) - AndroidUtilities.dp(7.0f)));
            this.reactionsLayoutInBubble.x = this.timeX;
        } else if (this.drawCommentButton) {
            i2 = AndroidUtilities.dp(43.0f);
        }
        i = -i2;
        ReactionsLayoutInBubble reactionsLayoutInBubble82 = this.reactionsLayoutInBubble;
        if (!shouldDrawTimeOnMedia()) {
        }
        reactionsLayoutInBubble82.y = (int) dp;
        this.reactionsLayoutInBubble.y = (int) (reactionsLayoutInBubble.y + ((this.timeLayout.getHeight() / 2.0f) - AndroidUtilities.dp(7.0f)));
        this.reactionsLayoutInBubble.x = this.timeX;
    }

    /* JADX WARN: Type inference failed for: r12v2 */
    /* JADX WARN: Type inference failed for: r12v29 */
    /* JADX WARN: Type inference failed for: r12v3, types: [boolean, int] */
    public void drawLinkPreview(Canvas canvas, float f) {
        int dp;
        int i;
        int dp2;
        int i2;
        int i3;
        int i4;
        int i5;
        ?? r12;
        int i6;
        int i7;
        int i8;
        int i9;
        Drawable drawable;
        int i10;
        int i11;
        int i12;
        boolean z;
        boolean z2;
        int i13;
        int dp3;
        Paint paint;
        if (this.currentMessageObject.isSponsored() || this.hasLinkPreview || this.hasGamePreview || this.hasInvoicePreview) {
            if (this.hasGamePreview) {
                dp = AndroidUtilities.dp(14.0f) + this.namesOffset;
                i2 = this.unmovedTextX - AndroidUtilities.dp(10.0f);
            } else {
                if (this.hasInvoicePreview) {
                    dp = AndroidUtilities.dp(14.0f) + this.namesOffset;
                    i = this.unmovedTextX;
                    dp2 = AndroidUtilities.dp(1.0f);
                } else if (this.currentMessageObject.isSponsored()) {
                    dp = (this.textY + this.currentMessageObject.textHeight) - AndroidUtilities.dp(2.0f);
                    if (this.hasNewLineForTime) {
                        dp += AndroidUtilities.dp(16.0f);
                    }
                    i = this.unmovedTextX;
                    dp2 = AndroidUtilities.dp(1.0f);
                } else {
                    dp = this.textY + this.currentMessageObject.textHeight + AndroidUtilities.dp(8.0f);
                    i = this.unmovedTextX;
                    dp2 = AndroidUtilities.dp(1.0f);
                }
                i2 = i + dp2;
            }
            int i14 = dp;
            int i15 = i2;
            if (!this.hasInvoicePreview && !this.currentMessageObject.isSponsored()) {
                Theme.chat_replyLinePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outPreviewLine" : "chat_inPreviewLine"));
                if (f != 1.0f) {
                    Theme.chat_replyLinePaint.setAlpha((int) (paint.getAlpha() * f));
                }
                canvas.drawRect(i15, i14 - AndroidUtilities.dp(3.0f), AndroidUtilities.dp(2.0f) + i15, this.linkPreviewHeight + i14 + AndroidUtilities.dp(3.0f), Theme.chat_replyLinePaint);
            }
            if (this.siteNameLayout != null) {
                int dp4 = i14 - AndroidUtilities.dp(1.0f);
                Theme.chat_replyNamePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outSiteNameText" : "chat_inSiteNameText"));
                if (f != 1.0f) {
                    Theme.chat_replyNamePaint.setAlpha((int) (Theme.chat_replyLinePaint.getAlpha() * f));
                }
                canvas.save();
                if (this.siteNameRtl) {
                    dp3 = (this.backgroundWidth - this.siteNameWidth) - AndroidUtilities.dp(32.0f);
                    if (this.isSmallImage) {
                        dp3 -= AndroidUtilities.dp(54.0f);
                    }
                } else {
                    dp3 = this.hasInvoicePreview ? 0 : AndroidUtilities.dp(10.0f);
                }
                canvas.translate(dp3 + i15, i14 - AndroidUtilities.dp(3.0f));
                this.siteNameLayout.draw(canvas);
                canvas.restore();
                StaticLayout staticLayout = this.siteNameLayout;
                i3 = staticLayout.getLineBottom(staticLayout.getLineCount() - 1) + i14;
                i4 = dp4;
            } else {
                i3 = i14;
                i4 = 0;
            }
            if ((this.hasGamePreview || this.hasInvoicePreview) && (i5 = this.currentMessageObject.textHeight) != 0) {
                i14 += i5 + AndroidUtilities.dp(4.0f);
                i3 += this.currentMessageObject.textHeight + AndroidUtilities.dp(4.0f);
            }
            if ((!this.drawPhotoImage || !this.drawInstantView || (i13 = this.drawInstantViewType) == 9 || i13 == 13 || i13 == 11 || i13 == 1) && (this.drawInstantViewType != 6 || this.imageBackgroundColor == 0)) {
                r12 = 1;
                i6 = 0;
            } else {
                if (i3 != i14) {
                    i3 += AndroidUtilities.dp(2.0f);
                }
                int i16 = i3;
                if (this.imageBackgroundSideColor != 0) {
                    int dp5 = AndroidUtilities.dp(10.0f) + i15;
                    ImageReceiver imageReceiver = this.photoImage;
                    float f2 = dp5;
                    imageReceiver.setImageCoords(((this.imageBackgroundSideWidth - imageReceiver.getImageWidth()) / 2.0f) + f2, i16, this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
                    this.rect.set(f2, this.photoImage.getImageY(), dp5 + this.imageBackgroundSideWidth, this.photoImage.getImageY2());
                    Theme.chat_instantViewPaint.setColor(ColorUtils.setAlphaComponent(this.imageBackgroundSideColor, (int) (f * 255.0f)));
                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), Theme.chat_instantViewPaint);
                } else {
                    this.photoImage.setImageCoords(AndroidUtilities.dp(10.0f) + i15, i16, this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
                }
                if (this.imageBackgroundColor != 0) {
                    this.rect.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
                    if (this.imageBackgroundGradientColor1 != 0) {
                        if (this.imageBackgroundGradientColor2 != 0) {
                            if (this.motionBackgroundDrawable == null) {
                                MotionBackgroundDrawable motionBackgroundDrawable = new MotionBackgroundDrawable(this.imageBackgroundColor, this.imageBackgroundGradientColor1, this.imageBackgroundGradientColor2, this.imageBackgroundGradientColor3, true);
                                this.motionBackgroundDrawable = motionBackgroundDrawable;
                                if (this.imageBackgroundIntensity < 0.0f) {
                                    this.photoImage.setGradientBitmap(motionBackgroundDrawable.getBitmap());
                                }
                                if (!this.photoImage.hasImageSet()) {
                                    this.motionBackgroundDrawable.setRoundRadius(AndroidUtilities.dp(4.0f));
                                }
                            }
                        } else {
                            if (this.gradientShader == null) {
                                Rect gradientPoints = BackgroundGradientDrawable.getGradientPoints(AndroidUtilities.getWallpaperRotation(this.imageBackgroundGradientRotation, false), (int) this.rect.width(), (int) this.rect.height());
                                this.gradientShader = new LinearGradient(gradientPoints.left, gradientPoints.top, gradientPoints.right, gradientPoints.bottom, new int[]{this.imageBackgroundColor, this.imageBackgroundGradientColor1}, (float[]) null, Shader.TileMode.CLAMP);
                            }
                            Theme.chat_instantViewPaint.setShader(this.gradientShader);
                            if (f != 1.0f) {
                                Theme.chat_instantViewPaint.setAlpha((int) (f * 255.0f));
                            }
                        }
                    } else {
                        Theme.chat_instantViewPaint.setShader(null);
                        Theme.chat_instantViewPaint.setColor(this.imageBackgroundColor);
                        if (f != 1.0f) {
                            Theme.chat_instantViewPaint.setAlpha((int) (f * 255.0f));
                        }
                    }
                    MotionBackgroundDrawable motionBackgroundDrawable2 = this.motionBackgroundDrawable;
                    if (motionBackgroundDrawable2 != null) {
                        RectF rectF = this.rect;
                        motionBackgroundDrawable2.setBounds((int) rectF.left, (int) rectF.top, (int) rectF.right, (int) rectF.bottom);
                        this.motionBackgroundDrawable.draw(canvas);
                        i12 = i16;
                        z2 = true;
                        i6 = 0;
                    } else if (this.imageBackgroundSideColor != 0) {
                        i12 = i16;
                        i6 = 0;
                        z2 = true;
                        canvas.drawRect(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2(), Theme.chat_instantViewPaint);
                    } else {
                        i12 = i16;
                        z2 = true;
                        i6 = 0;
                        canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), Theme.chat_instantViewPaint);
                    }
                    Theme.chat_instantViewPaint.setShader(null);
                    Theme.chat_instantViewPaint.setAlpha(255);
                    z = z2;
                } else {
                    i12 = i16;
                    z = true;
                    i6 = 0;
                }
                if (this.drawPhotoImage && this.drawInstantView) {
                    if (this.drawInstantViewType != 9) {
                        if (this.drawImageButton) {
                            int dp6 = AndroidUtilities.dp(48.0f);
                            float f3 = dp6;
                            int imageX = (int) (this.photoImage.getImageX() + ((this.photoImage.getImageWidth() - f3) / 2.0f));
                            this.buttonX = imageX;
                            this.buttonX = imageX;
                            int imageY = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - f3) / 2.0f));
                            this.buttonY = imageY;
                            this.buttonY = imageY;
                            RadialProgress2 radialProgress2 = this.radialProgress;
                            int i17 = this.buttonX;
                            radialProgress2.setProgressRect(i17, imageY, i17 + dp6, dp6 + imageY);
                        }
                        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
                        if (chatMessageCellDelegate == null || chatMessageCellDelegate.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) {
                            if (f != 1.0f) {
                                this.photoImage.setAlpha(f);
                                this.imageDrawn = this.photoImage.draw(canvas);
                                this.photoImage.setAlpha(1.0f);
                            } else {
                                this.imageDrawn = this.photoImage.draw(canvas);
                            }
                        }
                    }
                }
                i3 = (int) (i12 + this.photoImage.getImageHeight() + AndroidUtilities.dp(6.0f));
                r12 = z;
            }
            if (this.currentMessageObject.isOutOwner()) {
                int i18 = (int) (f * 255.0f);
                Theme.chat_replyNamePaint.setColor(ColorUtils.setAlphaComponent(getThemedColor("chat_messageTextOut"), i18));
                Theme.chat_replyTextPaint.setColor(ColorUtils.setAlphaComponent(getThemedColor("chat_messageTextOut"), i18));
            } else {
                int i19 = (int) (f * 255.0f);
                Theme.chat_replyNamePaint.setColor(ColorUtils.setAlphaComponent(getThemedColor("chat_messageTextIn"), i19));
                Theme.chat_replyTextPaint.setColor(ColorUtils.setAlphaComponent(getThemedColor("chat_messageTextIn"), i19));
            }
            if (this.titleLayout != null) {
                if (i3 != i14) {
                    i3 += AndroidUtilities.dp(2.0f);
                }
                if (i4 == 0) {
                    i4 = i3 - AndroidUtilities.dp(1.0f);
                }
                canvas.save();
                canvas.translate(AndroidUtilities.dp(10.0f) + i15 + this.titleX, i3 - AndroidUtilities.dp(3.0f));
                this.titleLayout.draw(canvas);
                canvas.restore();
                StaticLayout staticLayout2 = this.titleLayout;
                i3 += staticLayout2.getLineBottom(staticLayout2.getLineCount() - r12);
            }
            if (this.authorLayout != null) {
                if (i3 != i14) {
                    i3 += AndroidUtilities.dp(2.0f);
                }
                if (i4 == 0) {
                    i4 = i3 - AndroidUtilities.dp(1.0f);
                }
                canvas.save();
                canvas.translate(AndroidUtilities.dp(10.0f) + i15 + this.authorX, i3 - AndroidUtilities.dp(3.0f));
                this.authorLayout.draw(canvas);
                canvas.restore();
                StaticLayout staticLayout3 = this.authorLayout;
                i3 += staticLayout3.getLineBottom(staticLayout3.getLineCount() - r12);
            }
            if (this.descriptionLayout != null) {
                if (i3 != i14) {
                    i3 += AndroidUtilities.dp(2.0f);
                }
                int i20 = i3;
                if (i4 == 0) {
                    i4 = i20 - AndroidUtilities.dp(1.0f);
                }
                this.descriptionY = i20 - AndroidUtilities.dp(3.0f);
                canvas.save();
                canvas.translate((this.hasInvoicePreview ? 0 : AndroidUtilities.dp(10.0f)) + i15 + this.descriptionX, this.descriptionY);
                if (this.linkBlockNum == -10 && this.links.draw(canvas)) {
                    invalidate();
                }
                ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
                if (chatMessageCellDelegate2 != null && chatMessageCellDelegate2.getTextSelectionHelper() != null && getDelegate().getTextSelectionHelper().isSelected(this.currentMessageObject)) {
                    this.delegate.getTextSelectionHelper().drawDescription(this.currentMessageObject.isOutOwner(), this.descriptionLayout, canvas);
                }
                this.descriptionLayout.draw(canvas);
                i7 = i14;
                i8 = i15;
                AnimatedEmojiSpan.drawAnimatedEmojis(canvas, this.descriptionLayout, this.animatedEmojiDescriptionStack, 0.0f, null, 0.0f, 0.0f, 0.0f, 1.0f);
                canvas.restore();
                StaticLayout staticLayout4 = this.descriptionLayout;
                int lineCount = staticLayout4.getLineCount();
                int i21 = r12 == true ? 1 : 0;
                int i22 = r12 == true ? 1 : 0;
                int i23 = r12 == true ? 1 : 0;
                int i24 = r12 == true ? 1 : 0;
                i3 = i20 + staticLayout4.getLineBottom(lineCount - i21);
            } else {
                i7 = i14;
                i8 = i15;
            }
            int i25 = i4;
            if (!this.drawPhotoImage || !(!this.drawInstantView || (i11 = this.drawInstantViewType) == 9 || i11 == 11 || i11 == 13 || i11 == r12)) {
                i9 = i8;
            } else {
                if (i3 != i7) {
                    i3 += AndroidUtilities.dp(2.0f);
                }
                if (this.isSmallImage) {
                    i9 = i8;
                    this.photoImage.setImageCoords((i9 + this.backgroundWidth) - AndroidUtilities.dp(81.0f), i25, this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
                } else {
                    i9 = i8;
                    this.photoImage.setImageCoords(i9 + (this.hasInvoicePreview ? -AndroidUtilities.dp(6.3f) : AndroidUtilities.dp(10.0f)), i3, this.photoImage.getImageWidth(), this.photoImage.getImageHeight());
                    if (this.drawImageButton) {
                        int dp7 = AndroidUtilities.dp(48.0f);
                        float f4 = dp7;
                        int imageX2 = (int) (this.photoImage.getImageX() + ((this.photoImage.getImageWidth() - f4) / 2.0f));
                        this.buttonX = imageX2;
                        this.buttonX = imageX2;
                        int imageY2 = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - f4) / 2.0f));
                        this.buttonY = imageY2;
                        this.buttonY = imageY2;
                        RadialProgress2 radialProgress22 = this.radialProgress;
                        int i26 = this.buttonX;
                        radialProgress22.setProgressRect(i26, imageY2, i26 + dp7, dp7 + imageY2);
                    }
                }
                if (this.isRoundVideo && MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && MediaController.getInstance().isVideoDrawingReady() && canvas.isHardwareAccelerated()) {
                    this.imageDrawn = r12;
                    this.drawTime = r12;
                } else {
                    ChatMessageCellDelegate chatMessageCellDelegate3 = this.delegate;
                    if (chatMessageCellDelegate3 == null || chatMessageCellDelegate3.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) {
                        if (f != 1.0f) {
                            this.photoImage.setAlpha(f);
                            this.imageDrawn = this.photoImage.draw(canvas);
                            this.photoImage.setAlpha(1.0f);
                        } else {
                            this.imageDrawn = this.photoImage.draw(canvas);
                        }
                    }
                }
            }
            int i27 = this.documentAttachType;
            if (i27 == 4 || i27 == 2) {
                this.videoButtonX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(8.0f));
                int imageY3 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.0f));
                this.videoButtonY = imageY3;
                RadialProgress2 radialProgress23 = this.videoRadialProgress;
                int i28 = this.videoButtonX;
                radialProgress23.setProgressRect(i28, imageY3, AndroidUtilities.dp(24.0f) + i28, this.videoButtonY + AndroidUtilities.dp(24.0f));
            }
            Paint themedPaint = getThemedPaint("paintChatTimeBackground");
            if (this.photosCountLayout != null && this.photoImage.getVisible()) {
                int imageX3 = (int) (((this.photoImage.getImageX() + this.photoImage.getImageWidth()) - AndroidUtilities.dp(8.0f)) - this.photosCountWidth);
                int imageY4 = (int) ((this.photoImage.getImageY() + this.photoImage.getImageHeight()) - AndroidUtilities.dp(19.0f));
                this.rect.set(imageX3 - AndroidUtilities.dp(4.0f), imageY4 - AndroidUtilities.dp(1.5f), this.photosCountWidth + imageX3 + AndroidUtilities.dp(4.0f), imageY4 + AndroidUtilities.dp(14.5f));
                int alpha = themedPaint.getAlpha();
                themedPaint.setAlpha((int) (alpha * this.controlsAlpha));
                Theme.chat_durationPaint.setAlpha((int) (this.controlsAlpha * 255.0f));
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), themedPaint);
                themedPaint.setAlpha(alpha);
                canvas.save();
                canvas.translate(imageX3, imageY4);
                this.photosCountLayout.draw(canvas);
                canvas.restore();
                Theme.chat_durationPaint.setAlpha(255);
            }
            if (this.videoInfoLayout != null && ((!this.drawPhotoImage || this.photoImage.getVisible()) && this.imageBackgroundSideColor == 0)) {
                if (this.hasGamePreview || this.hasInvoicePreview || this.documentAttachType == 8) {
                    if (this.drawPhotoImage) {
                        i10 = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(8.5f));
                        i3 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(6.0f));
                        this.rect.set(i10 - AndroidUtilities.dp(4.0f), i3 - AndroidUtilities.dp(1.5f), this.durationWidth + i10 + AndroidUtilities.dp(4.0f), AndroidUtilities.dp(this.documentAttachType == 8 ? 14.5f : 16.5f) + i3);
                        canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), themedPaint);
                    } else {
                        i10 = i9;
                    }
                } else {
                    i10 = (int) (((this.photoImage.getImageX() + this.photoImage.getImageWidth()) - AndroidUtilities.dp(8.0f)) - this.durationWidth);
                    i3 = (int) ((this.photoImage.getImageY() + this.photoImage.getImageHeight()) - AndroidUtilities.dp(19.0f));
                    this.rect.set(i10 - AndroidUtilities.dp(4.0f), i3 - AndroidUtilities.dp(1.5f), this.durationWidth + i10 + AndroidUtilities.dp(4.0f), AndroidUtilities.dp(14.5f) + i3);
                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(4.0f), AndroidUtilities.dp(4.0f), getThemedPaint("paintChatTimeBackground"));
                }
                canvas.save();
                canvas.translate(i10, i3);
                if (this.hasInvoicePreview) {
                    if (this.drawPhotoImage) {
                        Theme.chat_shipmentPaint.setColor(getThemedColor("chat_previewGameText"));
                    } else if (this.currentMessageObject.isOutOwner()) {
                        Theme.chat_shipmentPaint.setColor(getThemedColor("chat_messageTextOut"));
                    } else {
                        Theme.chat_shipmentPaint.setColor(getThemedColor("chat_messageTextIn"));
                    }
                }
                this.videoInfoLayout.draw(canvas);
                canvas.restore();
            }
            if (!this.drawInstantView) {
                return;
            }
            int dp8 = i7 + this.linkPreviewHeight + AndroidUtilities.dp(10.0f);
            Paint paint2 = Theme.chat_instantViewRectPaint;
            if (this.currentMessageObject.isOutOwner()) {
                drawable = getThemedDrawable("drawableMsgOutInstant");
                Theme.chat_instantViewPaint.setColor(getThemedColor("chat_outPreviewInstantText"));
                paint2.setColor(getThemedColor("chat_outPreviewInstantText"));
            } else {
                drawable = Theme.chat_msgInInstantDrawable;
                Theme.chat_instantViewPaint.setColor(getThemedColor("chat_inPreviewInstantText"));
                paint2.setColor(getThemedColor("chat_inPreviewInstantText"));
            }
            this.instantButtonRect.set(i9, dp8, i9 + this.instantWidth, AndroidUtilities.dp(36.0f) + dp8);
            if (Build.VERSION.SDK_INT >= 21) {
                this.selectorDrawableMaskType[i6] = i6;
                this.selectorDrawable[i6].setBounds(i9, dp8, i9 + this.instantWidth, AndroidUtilities.dp(36.0f) + dp8);
                this.selectorDrawable[i6].draw(canvas);
            }
            canvas.drawRoundRect(this.instantButtonRect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), paint2);
            if (this.drawInstantViewType == 0) {
                BaseCell.setDrawableBounds(drawable, ((this.instantTextLeftX + this.instantTextX) + i9) - AndroidUtilities.dp(15.0f), AndroidUtilities.dp(11.5f) + dp8, AndroidUtilities.dp(9.0f), AndroidUtilities.dp(13.0f));
                drawable.draw(canvas);
            }
            if (this.instantViewLayout == null) {
                return;
            }
            canvas.save();
            canvas.translate(i9 + this.instantTextX, dp8 + AndroidUtilities.dp(10.5f));
            this.instantViewLayout.draw(canvas);
            canvas.restore();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean shouldDrawMenuDrawable() {
        return this.currentMessagesGroup == null || (this.currentPosition.flags & 4) != 0;
    }

    private void drawBotButtons(Canvas canvas, ArrayList<BotButton> arrayList, float f) {
        int dp;
        BotButton botButton;
        Drawable themedDrawable;
        if (this.currentMessageObject.isOutOwner()) {
            dp = (getMeasuredWidth() - this.widthForButtons) - AndroidUtilities.dp(10.0f);
        } else {
            dp = this.backgroundDrawableLeft + AndroidUtilities.dp((this.mediaBackground || this.drawPinnedBottom) ? 1.0f : 7.0f);
        }
        int i = dp;
        float f2 = 2.0f;
        float dp2 = (this.layoutHeight - AndroidUtilities.dp(2.0f)) + this.transitionParams.deltaBottom;
        float f3 = 0.0f;
        for (int i2 = 0; i2 < arrayList.size(); i2++) {
            BotButton botButton2 = arrayList.get(i2);
            float f4 = botButton2.y + botButton2.height;
            if (f4 > f3) {
                f3 = f4;
            }
        }
        this.rect.set(0.0f, dp2, getMeasuredWidth(), f3 + dp2);
        if (f != 1.0f) {
            canvas.saveLayerAlpha(this.rect, (int) (f * 255.0f), 31);
        } else {
            canvas.save();
        }
        int i3 = 0;
        while (i3 < arrayList.size()) {
            BotButton botButton3 = arrayList.get(i3);
            float dp3 = ((botButton3.y + this.layoutHeight) - AndroidUtilities.dp(f2)) + this.transitionParams.deltaBottom;
            this.rect.set(botButton3.x + i, dp3, botButton3.x + i + botButton3.width, botButton3.height + dp3);
            applyServiceShaderMatrix();
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), getThemedPaint(i3 == this.pressedBotButton ? "paintChatActionBackgroundSelected" : "paintChatActionBackground"));
            if (hasGradientService()) {
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
            }
            canvas.save();
            boolean z = true;
            canvas.translate(botButton3.x + i + AndroidUtilities.dp(5.0f), ((AndroidUtilities.dp(44.0f) - botButton3.title.getLineBottom(botButton3.title.getLineCount() - 1)) / 2) + dp3);
            botButton3.title.draw(canvas);
            canvas.restore();
            if (!(botButton3.button instanceof TLRPC$TL_keyboardButtonWebView)) {
                if (botButton3.button instanceof TLRPC$TL_keyboardButtonUrl) {
                    if (botButton3.isInviteButton) {
                        themedDrawable = getThemedDrawable("drawable_botInvite");
                    } else {
                        themedDrawable = getThemedDrawable("drawableBotLink");
                    }
                    BaseCell.setDrawableBounds(themedDrawable, (((botButton3.x + botButton3.width) - AndroidUtilities.dp(3.0f)) - themedDrawable.getIntrinsicWidth()) + i, dp3 + AndroidUtilities.dp(3.0f));
                    themedDrawable.draw(canvas);
                } else if (!(botButton3.button instanceof TLRPC$TL_keyboardButtonSwitchInline)) {
                    if ((botButton3.button instanceof TLRPC$TL_keyboardButtonCallback) || (botButton3.button instanceof TLRPC$TL_keyboardButtonRequestGeoLocation) || (botButton3.button instanceof TLRPC$TL_keyboardButtonGame) || (botButton3.button instanceof TLRPC$TL_keyboardButtonBuy) || (botButton3.button instanceof TLRPC$TL_keyboardButtonUrlAuth)) {
                        if (botButton3.button instanceof TLRPC$TL_keyboardButtonBuy) {
                            BaseCell.setDrawableBounds(Theme.chat_botCardDrawable, (((botButton3.x + botButton3.width) - AndroidUtilities.dp(5.0f)) - Theme.chat_botCardDrawable.getIntrinsicWidth()) + i, AndroidUtilities.dp(4.0f) + dp3);
                            Theme.chat_botCardDrawable.draw(canvas);
                        }
                        if (((!(botButton3.button instanceof TLRPC$TL_keyboardButtonCallback) && !(botButton3.button instanceof TLRPC$TL_keyboardButtonGame) && !(botButton3.button instanceof TLRPC$TL_keyboardButtonBuy) && !(botButton3.button instanceof TLRPC$TL_keyboardButtonUrlAuth)) || !SendMessagesHelper.getInstance(this.currentAccount).isSendingCallback(this.currentMessageObject, botButton3.button)) && (!(botButton3.button instanceof TLRPC$TL_keyboardButtonRequestGeoLocation) || !SendMessagesHelper.getInstance(this.currentAccount).isSendingCurrentLocation(this.currentMessageObject, botButton3.button))) {
                            z = false;
                        }
                        if (z || botButton3.progressAlpha != 0.0f) {
                            Theme.chat_botProgressPaint.setAlpha(Math.min(255, (int) (botButton3.progressAlpha * 255.0f)));
                            int dp4 = ((botButton3.x + botButton3.width) - AndroidUtilities.dp(12.0f)) + i;
                            if (botButton3.button instanceof TLRPC$TL_keyboardButtonBuy) {
                                dp3 += AndroidUtilities.dp(26.0f);
                            }
                            this.rect.set(dp4, AndroidUtilities.dp(4.0f) + dp3, dp4 + AndroidUtilities.dp(8.0f), dp3 + AndroidUtilities.dp(12.0f));
                            canvas.drawArc(this.rect, botButton3.angle, 220.0f, false, Theme.chat_botProgressPaint);
                            invalidate();
                            long currentTimeMillis = System.currentTimeMillis();
                            if (Math.abs(botButton3.lastUpdateTime - System.currentTimeMillis()) < 1000) {
                                long j = currentTimeMillis - botButton3.lastUpdateTime;
                                botButton = botButton3;
                                BotButton.access$2816(botButton, ((float) (360 * j)) / 2000.0f);
                                BotButton.access$2820(botButton, (botButton.angle / 360) * 360);
                                if (z) {
                                    if (botButton.progressAlpha < 1.0f) {
                                        BotButton.access$2716(botButton, ((float) j) / 200.0f);
                                        if (botButton.progressAlpha > 1.0f) {
                                            botButton.progressAlpha = 1.0f;
                                        }
                                    }
                                } else if (botButton.progressAlpha > 0.0f) {
                                    BotButton.access$2724(botButton, ((float) j) / 200.0f);
                                    if (botButton.progressAlpha < 0.0f) {
                                        botButton.progressAlpha = 0.0f;
                                    }
                                }
                            } else {
                                botButton = botButton3;
                            }
                            botButton.lastUpdateTime = currentTimeMillis;
                        }
                    }
                } else {
                    Drawable themedDrawable2 = getThemedDrawable("drawableBotInline");
                    BaseCell.setDrawableBounds(themedDrawable2, (((botButton3.x + botButton3.width) - AndroidUtilities.dp(3.0f)) - themedDrawable2.getIntrinsicWidth()) + i, dp3 + AndroidUtilities.dp(3.0f));
                    themedDrawable2.draw(canvas);
                }
            } else {
                Drawable themedDrawable3 = getThemedDrawable("drawableBotWebView");
                BaseCell.setDrawableBounds(themedDrawable3, (((botButton3.x + botButton3.width) - AndroidUtilities.dp(3.0f)) - themedDrawable3.getIntrinsicWidth()) + i, dp3 + AndroidUtilities.dp(3.0f));
                themedDrawable3.draw(canvas);
            }
            i3++;
            f2 = 2.0f;
        }
        canvas.restore();
    }

    /* JADX WARN: Removed duplicated region for block: B:33:0x0136  */
    /* JADX WARN: Removed duplicated region for block: B:48:0x0176 A[LOOP:1: B:46:0x016e->B:48:0x0176, LOOP_END] */
    /* JADX WARN: Removed duplicated region for block: B:70:0x0141  */
    /* JADX WARN: Removed duplicated region for block: B:74:0x01f4  */
    /* JADX WARN: Removed duplicated region for block: B:77:0x020b  */
    /* JADX WARN: Removed duplicated region for block: B:80:? A[RETURN, SYNTHETIC] */
    @SuppressLint({"Range"})
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawMessageText(Canvas canvas, ArrayList<MessageObject.TextLayoutBlock> arrayList, boolean z, float f, boolean z2) {
        int size;
        int i;
        int i2;
        int i3;
        int i4;
        boolean z3;
        int color;
        int i5;
        int i6;
        MessageObject.TextLayoutBlock textLayoutBlock;
        int i7;
        int i8;
        int i9;
        int i10;
        int i11;
        if (arrayList == null || arrayList.isEmpty() || f == 0.0f) {
            return;
        }
        if (z) {
            if (this.fullyDraw) {
                this.firstVisibleBlockNum = 0;
                this.lastVisibleBlockNum = arrayList.size();
            }
            i = this.firstVisibleBlockNum;
            size = this.lastVisibleBlockNum;
        } else {
            size = arrayList.size();
            i = 0;
        }
        int i12 = this.textY;
        float f2 = i12;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateText) {
            float f3 = transitionParams.animateFromTextY;
            float f4 = transitionParams.animateChangeProgress;
            f2 = (f3 * (1.0f - f4)) + (i12 * f4);
        }
        float f5 = f2;
        if (i < 0) {
            return;
        }
        if (f == 1.0f) {
            i2 = 0;
            i3 = 0;
            i4 = Integer.MIN_VALUE;
        } else if (z2) {
            int alpha = Theme.chat_msgTextPaint.getAlpha();
            int alpha2 = Color.alpha(Theme.chat_msgTextPaint.linkColor);
            Theme.chat_msgTextPaint.setAlpha((int) (alpha * f));
            TextPaint textPaint = Theme.chat_msgTextPaint;
            textPaint.linkColor = ColorUtils.setAlphaComponent(textPaint.linkColor, (int) (alpha2 * f));
            i3 = alpha;
            i2 = alpha2;
            i4 = Integer.MIN_VALUE;
            z3 = true;
            color = (this.currentMessageObject.isOut() || ChatObject.isChannelAndNotMegaGroup(this.currentMessageObject.getChatId(), this.currentAccount)) ? Theme.chat_msgTextPaint.getColor() : getThemedColor("chat_outTimeText");
            i5 = i;
            while (i5 <= size && i5 < arrayList.size()) {
                textLayoutBlock = arrayList.get(i5);
                canvas.save();
                canvas.translate(this.textX - (!textLayoutBlock.isRtl() ? (int) Math.ceil(this.currentMessageObject.textXOffset) : 0), f5 + textLayoutBlock.textYOffset + this.transitionYOffsetForDrawables);
                if (i5 == this.linkBlockNum && !z2 && this.links.draw(canvas)) {
                    invalidate();
                }
                if (i5 == this.linkSelectionBlockNum && !this.urlPathSelection.isEmpty() && !z2) {
                    for (i11 = 0; i11 < this.urlPathSelection.size(); i11++) {
                        canvas.drawPath(this.urlPathSelection.get(i11), Theme.chat_textSearchSelectionPaint);
                    }
                }
                if (this.delegate.getTextSelectionHelper() != null && this.transitionParams.animateChangeProgress == 1.0f && !z2) {
                    this.delegate.getTextSelectionHelper().draw(this.currentMessageObject, textLayoutBlock, canvas);
                }
                try {
                    Emoji.emojiDrawingYOffset = -this.transitionYOffsetForDrawables;
                    i7 = i5;
                    i8 = i2;
                    i9 = i3;
                    i10 = i4;
                } catch (Exception e) {
                    e = e;
                    i7 = i5;
                    i8 = i2;
                    i9 = i3;
                    i10 = i4;
                }
                try {
                    SpoilerEffect.renderWithRipple(this, this.invalidateSpoilersParent, color, 0, textLayoutBlock.spoilersPatchedTextLayout, textLayoutBlock.textLayout, textLayoutBlock.spoilers, canvas, false);
                    Emoji.emojiDrawingYOffset = 0.0f;
                } catch (Exception e2) {
                    e = e2;
                    FileLog.e(e);
                    canvas.restore();
                    i5 = i7 + 1;
                    i2 = i8;
                    i3 = i9;
                    i4 = i10;
                }
                canvas.restore();
                i5 = i7 + 1;
                i2 = i8;
                i3 = i9;
                i4 = i10;
            }
            int i13 = i2;
            int i14 = i3;
            i6 = i4;
            if (z3) {
                Theme.chat_msgTextPaint.setAlpha(i14);
                TextPaint textPaint2 = Theme.chat_msgTextPaint;
                textPaint2.linkColor = ColorUtils.setAlphaComponent(textPaint2.linkColor, i13);
            }
            if (i6 != Integer.MIN_VALUE) {
                return;
            }
            canvas.restoreToCount(i6);
            return;
        } else {
            Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
            if (messageDrawable != null) {
                int i15 = messageDrawable.getBounds().top;
                int i16 = this.currentBackgroundDrawable.getBounds().bottom;
                if (getY() < 0.0f) {
                    i15 = (int) (-getY());
                }
                float y = getY() + getMeasuredHeight();
                int i17 = this.parentHeight;
                if (y > i17) {
                    i16 = (int) (i17 - getY());
                }
                this.rect.set(getCurrentBackgroundLeft(), i15, this.currentBackgroundDrawable.getBounds().right, i16);
            } else {
                this.rect.set(0.0f, 0.0f, getMeasuredWidth(), getMeasuredHeight());
            }
            i4 = canvas.saveLayerAlpha(this.rect, (int) (255.0f * f), 31);
            i2 = 0;
            i3 = 0;
        }
        z3 = false;
        color = (this.currentMessageObject.isOut() || ChatObject.isChannelAndNotMegaGroup(this.currentMessageObject.getChatId(), this.currentAccount)) ? Theme.chat_msgTextPaint.getColor() : getThemedColor("chat_outTimeText");
        i5 = i;
        while (i5 <= size) {
            textLayoutBlock = arrayList.get(i5);
            canvas.save();
            canvas.translate(this.textX - (!textLayoutBlock.isRtl() ? (int) Math.ceil(this.currentMessageObject.textXOffset) : 0), f5 + textLayoutBlock.textYOffset + this.transitionYOffsetForDrawables);
            if (i5 == this.linkBlockNum) {
                invalidate();
            }
            if (i5 == this.linkSelectionBlockNum) {
                while (i11 < this.urlPathSelection.size()) {
                }
            }
            if (this.delegate.getTextSelectionHelper() != null) {
                this.delegate.getTextSelectionHelper().draw(this.currentMessageObject, textLayoutBlock, canvas);
            }
            Emoji.emojiDrawingYOffset = -this.transitionYOffsetForDrawables;
            i7 = i5;
            i8 = i2;
            i9 = i3;
            i10 = i4;
            SpoilerEffect.renderWithRipple(this, this.invalidateSpoilersParent, color, 0, textLayoutBlock.spoilersPatchedTextLayout, textLayoutBlock.textLayout, textLayoutBlock.spoilers, canvas, false);
            Emoji.emojiDrawingYOffset = 0.0f;
            canvas.restore();
            i5 = i7 + 1;
            i2 = i8;
            i3 = i9;
            i4 = i10;
        }
        int i132 = i2;
        int i142 = i3;
        i6 = i4;
        if (z3) {
        }
        if (i6 != Integer.MIN_VALUE) {
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:12:0x003a  */
    /* JADX WARN: Removed duplicated region for block: B:15:0x0045  */
    /* JADX WARN: Removed duplicated region for block: B:17:0x004a  */
    /* JADX WARN: Removed duplicated region for block: B:20:0x0052  */
    /* JADX WARN: Removed duplicated region for block: B:26:0x0063 A[LOOP:1: B:26:0x0063->B:28:0x0066, LOOP_START, PHI: r2 r5 
      PHI: (r2v1 int) = (r2v0 int), (r2v2 int) binds: [B:25:0x0061, B:28:0x0066] A[DONT_GENERATE, DONT_INLINE]
      PHI: (r5v2 int) = (r5v1 int), (r5v3 int) binds: [B:25:0x0061, B:28:0x0066] A[DONT_GENERATE, DONT_INLINE]] */
    /* JADX WARN: Removed duplicated region for block: B:32:0x0060  */
    /* JADX WARN: Removed duplicated region for block: B:33:0x004c  */
    /* JADX WARN: Removed duplicated region for block: B:34:0x0047  */
    /* JADX WARN: Removed duplicated region for block: B:8:0x0021  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public AnimatedEmojiSpan[] getAnimatedEmojiSpans() {
        AnimatedEmojiSpan[] animatedEmojiSpanArr;
        MessageObject messageObject;
        AnimatedEmojiSpan[] animatedEmojiSpanArr2;
        int i;
        MessageObject messageObject2 = this.currentMessageObject;
        AnimatedEmojiSpan[] animatedEmojiSpanArr3 = null;
        int i2 = 0;
        if (messageObject2 != null) {
            CharSequence charSequence = messageObject2.messageText;
            if (charSequence instanceof Spanned) {
                animatedEmojiSpanArr = (AnimatedEmojiSpan[]) ((Spanned) charSequence).getSpans(0, charSequence.length(), AnimatedEmojiSpan.class);
                messageObject = this.currentMessageObject;
                if (messageObject != null) {
                    CharSequence charSequence2 = messageObject.caption;
                    if (charSequence2 instanceof Spanned) {
                        animatedEmojiSpanArr2 = (AnimatedEmojiSpan[]) ((Spanned) charSequence2).getSpans(0, charSequence2.length(), AnimatedEmojiSpan.class);
                        if ((animatedEmojiSpanArr != null && animatedEmojiSpanArr.length != 0) || (animatedEmojiSpanArr2 != null && animatedEmojiSpanArr2.length != 0)) {
                            animatedEmojiSpanArr3 = new AnimatedEmojiSpan[(animatedEmojiSpanArr != null ? 0 : animatedEmojiSpanArr.length) + (animatedEmojiSpanArr2 != null ? 0 : animatedEmojiSpanArr2.length)];
                            if (animatedEmojiSpanArr == null) {
                                int i3 = 0;
                                i = 0;
                                while (i3 < animatedEmojiSpanArr.length) {
                                    animatedEmojiSpanArr3[i] = animatedEmojiSpanArr[i3];
                                    i3++;
                                    i++;
                                }
                            } else {
                                i = 0;
                            }
                            if (animatedEmojiSpanArr2 != null) {
                                while (i2 < animatedEmojiSpanArr2.length) {
                                    animatedEmojiSpanArr3[i] = animatedEmojiSpanArr2[i2];
                                    i2++;
                                    i++;
                                }
                            }
                        }
                        return animatedEmojiSpanArr3;
                    }
                }
                animatedEmojiSpanArr2 = null;
                if (animatedEmojiSpanArr != null) {
                    animatedEmojiSpanArr3 = new AnimatedEmojiSpan[(animatedEmojiSpanArr != null ? 0 : animatedEmojiSpanArr.length) + (animatedEmojiSpanArr2 != null ? 0 : animatedEmojiSpanArr2.length)];
                    if (animatedEmojiSpanArr == null) {
                    }
                    if (animatedEmojiSpanArr2 != null) {
                    }
                    return animatedEmojiSpanArr3;
                }
                animatedEmojiSpanArr3 = new AnimatedEmojiSpan[(animatedEmojiSpanArr != null ? 0 : animatedEmojiSpanArr.length) + (animatedEmojiSpanArr2 != null ? 0 : animatedEmojiSpanArr2.length)];
                if (animatedEmojiSpanArr == null) {
                }
                if (animatedEmojiSpanArr2 != null) {
                }
                return animatedEmojiSpanArr3;
            }
        }
        animatedEmojiSpanArr = null;
        messageObject = this.currentMessageObject;
        if (messageObject != null) {
        }
        animatedEmojiSpanArr2 = null;
        if (animatedEmojiSpanArr != null) {
        }
        animatedEmojiSpanArr3 = new AnimatedEmojiSpan[(animatedEmojiSpanArr != null ? 0 : animatedEmojiSpanArr.length) + (animatedEmojiSpanArr2 != null ? 0 : animatedEmojiSpanArr2.length)];
        if (animatedEmojiSpanArr == null) {
        }
        if (animatedEmojiSpanArr2 != null) {
        }
        return animatedEmojiSpanArr3;
    }

    public void updateCaptionLayout() {
        float imageX;
        float imageY;
        float imageHeight;
        MessageObject messageObject = this.currentMessageObject;
        int i = messageObject.type;
        if (i == 1 || i == 20 || this.documentAttachType == 4 || i == 8) {
            TransitionParams transitionParams = this.transitionParams;
            if (transitionParams.imageChangeBoundsTransition) {
                imageX = transitionParams.animateToImageX;
                imageY = transitionParams.animateToImageY;
                imageHeight = transitionParams.animateToImageH;
            } else {
                imageX = this.photoImage.getImageX();
                imageY = this.photoImage.getImageY();
                imageHeight = this.photoImage.getImageHeight();
            }
            this.captionX = imageX + AndroidUtilities.dp(5.0f) + this.captionOffsetX;
            this.captionY = imageY + imageHeight + AndroidUtilities.dp(6.0f);
        } else {
            float f = 41.3f;
            float f2 = 9.0f;
            float f3 = 11.0f;
            if (this.hasOldCaptionPreview) {
                int i2 = this.backgroundDrawableLeft;
                if (!messageObject.isOutOwner()) {
                    f3 = 17.0f;
                }
                this.captionX = i2 + AndroidUtilities.dp(f3) + this.captionOffsetX;
                int i3 = this.totalHeight - this.captionHeight;
                if (!this.drawPinnedTop) {
                    f2 = 10.0f;
                }
                float dp = ((i3 - AndroidUtilities.dp(f2)) - this.linkPreviewHeight) - AndroidUtilities.dp(17.0f);
                this.captionY = dp;
                if (this.drawCommentButton && this.drawSideButton != 3) {
                    if (!shouldDrawTimeOnMedia()) {
                        f = 43.0f;
                    }
                    this.captionY = dp - AndroidUtilities.dp(f);
                }
            } else {
                int i4 = this.backgroundDrawableLeft;
                if (!messageObject.isOutOwner() && !this.mediaBackground && !this.drawPinnedBottom) {
                    f3 = 17.0f;
                }
                this.captionX = i4 + AndroidUtilities.dp(f3) + this.captionOffsetX;
                int i5 = this.totalHeight - this.captionHeight;
                if (!this.drawPinnedTop) {
                    f2 = 10.0f;
                }
                float dp2 = i5 - AndroidUtilities.dp(f2);
                this.captionY = dp2;
                if (this.drawCommentButton && this.drawSideButton != 3) {
                    if (!shouldDrawTimeOnMedia()) {
                        f = 43.0f;
                    }
                    this.captionY = dp2 - AndroidUtilities.dp(f);
                }
                ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                if (!reactionsLayoutInBubble.isEmpty && !reactionsLayoutInBubble.isSmall) {
                    this.captionY -= reactionsLayoutInBubble.totalHeight;
                }
            }
        }
        this.captionX += getExtraTextX();
    }

    private boolean textIsSelectionMode() {
        return getCurrentMessagesGroup() == null && this.delegate.getTextSelectionHelper() != null && this.delegate.getTextSelectionHelper().isSelected(this.currentMessageObject);
    }

    public float getViewTop() {
        return this.viewTop;
    }

    public int getBackgroundHeight() {
        return this.backgroundHeight;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getMiniIconForCurrentState() {
        int i = this.miniButtonState;
        if (i < 0) {
            return 4;
        }
        return i == 0 ? 2 : 3;
    }

    /* JADX INFO: Access modifiers changed from: private */
    public int getIconForCurrentState() {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !messageObject.hasExtendedMedia()) {
            int i = this.documentAttachType;
            if (i == 3 || i == 5) {
                if (this.currentMessageObject.isOutOwner()) {
                    this.radialProgress.setColors("chat_outLoader", "chat_outLoaderSelected", "chat_outMediaIcon", "chat_outMediaIconSelected");
                } else {
                    this.radialProgress.setColors("chat_inLoader", "chat_inLoaderSelected", "chat_inMediaIcon", "chat_inMediaIconSelected");
                }
                int i2 = this.buttonState;
                if (i2 == 1) {
                    return 1;
                }
                if (i2 == 2) {
                    return 2;
                }
                return i2 == 4 ? 3 : 0;
            }
            if (i == 1 && !this.drawPhotoImage) {
                if (this.currentMessageObject.isOutOwner()) {
                    this.radialProgress.setColors("chat_outLoader", "chat_outLoaderSelected", "chat_outMediaIcon", "chat_outMediaIconSelected");
                } else {
                    this.radialProgress.setColors("chat_inLoader", "chat_inLoaderSelected", "chat_inMediaIcon", "chat_inMediaIconSelected");
                }
                int i3 = this.buttonState;
                if (i3 == -1) {
                    return 5;
                }
                if (i3 == 0) {
                    return 2;
                }
                if (i3 == 1) {
                    return 3;
                }
            } else {
                this.radialProgress.setColors("chat_mediaLoaderPhoto", "chat_mediaLoaderPhotoSelected", "chat_mediaLoaderPhotoIcon", "chat_mediaLoaderPhotoIconSelected");
                this.videoRadialProgress.setColors("chat_mediaLoaderPhoto", "chat_mediaLoaderPhotoSelected", "chat_mediaLoaderPhotoIcon", "chat_mediaLoaderPhotoIconSelected");
                int i4 = this.buttonState;
                if (i4 >= 0 && i4 < 4) {
                    if (i4 == 0) {
                        return 2;
                    }
                    if (i4 == 1) {
                        return 3;
                    }
                    return (i4 != 2 && this.autoPlayingMedia) ? 4 : 0;
                } else if (i4 == -1) {
                    if (this.documentAttachType == 1) {
                        if (this.drawPhotoImage && (this.currentPhotoObject != null || this.currentPhotoObjectThumb != null)) {
                            if (this.photoImage.hasBitmapImage()) {
                                return 4;
                            }
                            MessageObject messageObject2 = this.currentMessageObject;
                            if (messageObject2.mediaExists || messageObject2.attachPathExists) {
                                return 4;
                            }
                        }
                        return 5;
                    } else if (this.currentMessageObject.needDrawBluredPreview()) {
                        MessageObject messageObject3 = this.currentMessageObject;
                        if (messageObject3.messageOwner.destroyTime == 0) {
                            return 7;
                        }
                        return messageObject3.isOutOwner() ? 9 : 11;
                    } else if (this.hasEmbed) {
                        return 0;
                    }
                }
            }
            return 4;
        }
        return 4;
    }

    /* JADX WARN: Removed duplicated region for block: B:57:0x010d  */
    /* JADX WARN: Removed duplicated region for block: B:58:0x011b  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private int getMaxNameWidth() {
        int min;
        int min2;
        int dp;
        int i;
        int dp2;
        MessageObject messageObject;
        int i2;
        int parentWidth;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        int i3 = this.documentAttachType;
        if (i3 == 6 || i3 == 8 || (i2 = (messageObject = this.currentMessageObject).type) == 5) {
            if (AndroidUtilities.isTablet()) {
                if (this.isChat && !this.isThreadPost && !this.currentMessageObject.isOutOwner() && this.currentMessageObject.needDrawAvatar()) {
                    min2 = AndroidUtilities.getMinTabletSide();
                    dp = AndroidUtilities.dp(42.0f);
                    min = min2 - dp;
                    if (!this.isPlayingRound) {
                    }
                } else {
                    min = AndroidUtilities.getMinTabletSide();
                    if (!this.isPlayingRound) {
                        i = min - (this.backgroundWidth - (AndroidUtilities.roundPlayingMessageSize - AndroidUtilities.roundMessageSize));
                        dp2 = AndroidUtilities.dp(57.0f);
                    } else {
                        i = min - this.backgroundWidth;
                        dp2 = AndroidUtilities.dp(57.0f);
                    }
                }
            } else if (this.isChat && !this.isThreadPost && !this.currentMessageObject.isOutOwner() && this.currentMessageObject.needDrawAvatar()) {
                min2 = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                dp = AndroidUtilities.dp(42.0f);
                min = min2 - dp;
                if (!this.isPlayingRound) {
                }
            } else {
                min = Math.min(getParentWidth(), AndroidUtilities.displaySize.y);
                if (!this.isPlayingRound) {
                }
            }
        } else {
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            int i4 = 0;
            if (groupedMessages != null && !groupedMessages.isDocuments) {
                if (AndroidUtilities.isTablet()) {
                    parentWidth = AndroidUtilities.getMinTabletSide();
                } else {
                    parentWidth = getParentWidth();
                }
                int i5 = 0;
                for (int i6 = 0; i6 < this.currentMessagesGroup.posArray.size(); i6++) {
                    if (this.currentMessagesGroup.posArray.get(i6).minY != 0) {
                        break;
                    }
                    double d = i5;
                    double ceil = Math.ceil(((groupedMessagePosition.pw + groupedMessagePosition.leftSpanOffset) / 1000.0f) * parentWidth);
                    Double.isNaN(d);
                    i5 = (int) (d + ceil);
                }
                if (this.isAvatarVisible) {
                    i4 = 48;
                }
                return i5 - AndroidUtilities.dp(i4 + 31);
            } else if (i2 == 19) {
                int dp3 = (AndroidUtilities.displaySize.x - (messageObject.textWidth + AndroidUtilities.dp(14.0f))) - AndroidUtilities.dp(52.0f);
                if (this.isAvatarVisible) {
                    i4 = AndroidUtilities.dp(48.0f);
                }
                return dp3 - i4;
            } else {
                i = this.backgroundWidth;
                dp2 = AndroidUtilities.dp(this.mediaBackground ? 22.0f : 31.0f);
            }
        }
        return i - dp2;
    }

    /* JADX WARN: Code restructure failed: missing block: B:51:0x0121, code lost:
        if ((r9 & 2) != 0) goto L56;
     */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void updateButtonState(boolean z, boolean z2, boolean z3) {
        boolean z4;
        int i;
        boolean isLoadingVideo;
        int i2;
        int i3;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        int i4;
        int i5;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        boolean z5 = (!z2 || (!PhotoViewer.isShowingImage(messageObject) && this.attachedToWindow)) ? z2 : false;
        this.drawRadialCheckBackground = false;
        String str = null;
        MessageObject messageObject2 = this.currentMessageObject;
        int i6 = messageObject2.type;
        boolean z6 = true;
        if (i6 == 1 || i6 == 20) {
            TLRPC$PhotoSize tLRPC$PhotoSize = this.currentPhotoObject;
            if (tLRPC$PhotoSize == null) {
                this.radialProgress.setIcon(4, z, z5);
                return;
            } else {
                str = FileLoader.getAttachFileName(tLRPC$PhotoSize);
                z4 = this.currentMessageObject.mediaExists;
            }
        } else if (i6 == 8 || (i5 = this.documentAttachType) == 7 || i5 == 4 || i5 == 8 || i6 == 9 || i5 == 3 || i5 == 5) {
            if (messageObject2.useCustomPhoto) {
                this.buttonState = 1;
                this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                return;
            } else if (messageObject2.attachPathExists && !TextUtils.isEmpty(messageObject2.messageOwner.attachPath)) {
                str = this.currentMessageObject.messageOwner.attachPath;
                z4 = true;
            } else {
                if (!this.currentMessageObject.isSendError() || (i4 = this.documentAttachType) == 3 || i4 == 5) {
                    str = this.currentMessageObject.getFileName();
                    z4 = this.currentMessageObject.mediaExists;
                }
                z4 = false;
            }
        } else if (i5 != 0) {
            str = FileLoader.getAttachFileName(this.documentAttach);
            z4 = this.currentMessageObject.mediaExists;
        } else {
            TLRPC$PhotoSize tLRPC$PhotoSize2 = this.currentPhotoObject;
            if (tLRPC$PhotoSize2 != null) {
                str = FileLoader.getAttachFileName(tLRPC$PhotoSize2);
                z4 = this.currentMessageObject.mediaExists;
            }
            z4 = false;
        }
        TLRPC$Document tLRPC$Document = this.documentAttach;
        boolean canDownloadMedia = (tLRPC$Document == null || tLRPC$Document.dc_id != Integer.MIN_VALUE) ? DownloadController.getInstance(this.currentAccount).canDownloadMedia(this.currentMessageObject) : false;
        this.canStreamVideo = (this.currentMessageObject.isSent() || this.currentMessageObject.isForwarded()) && ((i = this.documentAttachType) == 4 || i == 7 || (i == 2 && canDownloadMedia)) && this.currentMessageObject.canStreamVideo() && !this.currentMessageObject.needDrawBluredPreview();
        if (SharedConfig.streamMedia && ((int) this.currentMessageObject.getDialogId()) != 0 && !this.currentMessageObject.isSecretMedia()) {
            if (this.documentAttachType != 5) {
                if (this.canStreamVideo && (groupedMessagePosition = this.currentPosition) != null) {
                    int i7 = groupedMessagePosition.flags;
                    if ((i7 & 1) != 0) {
                    }
                }
            }
            this.hasMiniProgress = z4 ? 1 : 2;
            z4 = true;
        }
        if (this.currentMessageObject.isSendError() || (TextUtils.isEmpty(str) && (this.currentMessageObject.isAnyKindOfSticker() || (!this.currentMessageObject.isSending() && !this.currentMessageObject.isEditing())))) {
            this.radialProgress.setIcon(4, z, false);
            this.radialProgress.setMiniIcon(4, z, false);
            this.videoRadialProgress.setIcon(4, z, false);
            this.videoRadialProgress.setMiniIcon(4, z, false);
            return;
        }
        HashMap<String, String> hashMap = this.currentMessageObject.messageOwner.params;
        boolean z7 = hashMap != null && hashMap.containsKey("query_id");
        int i8 = this.documentAttachType;
        float f = 0.0f;
        if (i8 == 3 || i8 == 5) {
            if ((this.currentMessageObject.isOut() && ((this.currentMessageObject.isSending() && !this.currentMessageObject.isForwarded()) || (this.currentMessageObject.isEditing() && this.currentMessageObject.isEditingMedia()))) || (this.currentMessageObject.isSendError() && z7)) {
                if (!TextUtils.isEmpty(this.currentMessageObject.messageOwner.attachPath)) {
                    DownloadController downloadController = DownloadController.getInstance(this.currentAccount);
                    MessageObject messageObject3 = this.currentMessageObject;
                    downloadController.addLoadingFileObserver(messageObject3.messageOwner.attachPath, messageObject3, this);
                    this.wasSending = true;
                    this.buttonState = 4;
                    boolean isSendingMessage = SendMessagesHelper.getInstance(this.currentAccount).isSendingMessage(this.currentMessageObject.getId());
                    if (this.currentPosition != null && isSendingMessage && this.buttonState == 4) {
                        this.drawRadialCheckBackground = true;
                        getIconForCurrentState();
                        this.radialProgress.setIcon(6, z, z5);
                    } else {
                        this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                    }
                    this.radialProgress.setMiniIcon(4, z, z5);
                    if (!z7) {
                        long[] fileProgressSizes = ImageLoader.getInstance().getFileProgressSizes(this.currentMessageObject.messageOwner.attachPath);
                        if (fileProgressSizes == null && isSendingMessage) {
                            f = 1.0f;
                        } else if (fileProgressSizes != null) {
                            f = DownloadController.getProgress(fileProgressSizes);
                        }
                        this.radialProgress.setProgress(f, false);
                    } else {
                        this.radialProgress.setProgress(0.0f, false);
                    }
                } else {
                    this.buttonState = -1;
                    getIconForCurrentState();
                    this.radialProgress.setIcon(12, z, false);
                    this.radialProgress.setProgress(0.0f, false);
                    this.radialProgress.setMiniIcon(4, z, false);
                }
            } else if (this.hasMiniProgress != 0) {
                this.radialProgress.setMiniProgressBackgroundColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outLoader" : "chat_inLoader"));
                if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || MediaController.getInstance().isMessagePaused()) {
                    this.buttonState = 0;
                } else {
                    this.buttonState = 1;
                }
                this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                if (this.hasMiniProgress == 1) {
                    DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                    this.miniButtonState = -1;
                } else {
                    DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(str, this.currentMessageObject, this);
                    if (!FileLoader.getInstance(this.currentAccount).isLoadingFile(str)) {
                        createLoadingProgressLayout(this.documentAttach);
                        this.miniButtonState = 0;
                    } else {
                        this.miniButtonState = 1;
                        long[] fileProgressSizes2 = ImageLoader.getInstance().getFileProgressSizes(str);
                        if (fileProgressSizes2 != null) {
                            this.radialProgress.setProgress(DownloadController.getProgress(fileProgressSizes2), z5);
                            createLoadingProgressLayout(fileProgressSizes2[0], fileProgressSizes2[1]);
                        } else {
                            this.radialProgress.setProgress(0.0f, z5);
                            createLoadingProgressLayout(0L, this.currentMessageObject.getSize());
                        }
                    }
                }
                this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), z, z5);
            } else if (z4) {
                DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                if (!MediaController.getInstance().isPlayingMessage(this.currentMessageObject) || MediaController.getInstance().isMessagePaused()) {
                    this.buttonState = 0;
                } else {
                    this.buttonState = 1;
                }
                this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
            } else {
                DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(str, this.currentMessageObject, this);
                if (!FileLoader.getInstance(this.currentAccount).isLoadingFile(str)) {
                    this.buttonState = 2;
                } else {
                    this.buttonState = 4;
                    long[] fileProgressSizes3 = ImageLoader.getInstance().getFileProgressSizes(str);
                    if (fileProgressSizes3 != null) {
                        this.radialProgress.setProgress(DownloadController.getProgress(fileProgressSizes3), z5);
                        createLoadingProgressLayout(fileProgressSizes3[0], fileProgressSizes3[1]);
                    } else {
                        createLoadingProgressLayout(this.documentAttach);
                        this.radialProgress.setProgress(0.0f, z5);
                    }
                }
                this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
            }
            updatePlayingMessageProgress();
        } else {
            MessageObject messageObject4 = this.currentMessageObject;
            if (messageObject4.type == 0 && i8 != 1 && i8 != 2 && i8 != 7 && i8 != 4 && i8 != 8 && i8 != 9) {
                if (this.currentPhotoObject == null || !this.drawImageButton) {
                    return;
                }
                if (!z4) {
                    DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(str, this.currentMessageObject, this);
                    if (!FileLoader.getInstance(this.currentAccount).isLoadingFile(str)) {
                        MessageObject messageObject5 = this.currentMessageObject;
                        if (!messageObject5.loadingCancelled && (((i3 = this.documentAttachType) == 0 && canDownloadMedia) || (i3 == 2 && MessageObject.isGifDocument(this.documentAttach, messageObject5.hasValidGroupId()) && canDownloadMedia))) {
                            this.buttonState = 1;
                        } else {
                            this.buttonState = 0;
                        }
                    } else {
                        this.buttonState = 1;
                        long[] fileProgressSizes4 = ImageLoader.getInstance().getFileProgressSizes(str);
                        if (fileProgressSizes4 != null) {
                            f = DownloadController.getProgress(fileProgressSizes4);
                        }
                        if (fileProgressSizes4 != null && fileProgressSizes4[0] == fileProgressSizes4[1]) {
                            createLoadingProgressLayout(fileProgressSizes4[0], fileProgressSizes4[1]);
                        } else if (this.currentMessageObject.getDocument() != null) {
                            MessageObject messageObject6 = this.currentMessageObject;
                            createLoadingProgressLayout(messageObject6.loadedFileSize, messageObject6.getSize());
                        }
                    }
                    this.radialProgress.setProgress(f, false);
                } else {
                    DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                    if (this.documentAttachType == 2 && !this.photoImage.isAllowStartAnimation()) {
                        this.buttonState = 2;
                    } else {
                        this.buttonState = -1;
                    }
                }
                this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                invalidate();
            } else if (messageObject4.isOut() && ((this.currentMessageObject.isSending() && !this.currentMessageObject.isForwarded()) || (this.currentMessageObject.isEditing() && this.currentMessageObject.isEditingMedia()))) {
                if (!TextUtils.isEmpty(this.currentMessageObject.messageOwner.attachPath)) {
                    DownloadController downloadController2 = DownloadController.getInstance(this.currentAccount);
                    MessageObject messageObject7 = this.currentMessageObject;
                    downloadController2.addLoadingFileObserver(messageObject7.messageOwner.attachPath, messageObject7, this);
                    this.wasSending = true;
                    String str2 = this.currentMessageObject.messageOwner.attachPath;
                    boolean z8 = str2 == null || !str2.startsWith("http");
                    TLRPC$Message tLRPC$Message = this.currentMessageObject.messageOwner;
                    HashMap<String, String> hashMap2 = tLRPC$Message.params;
                    if (tLRPC$Message.message != null && hashMap2 != null && (hashMap2.containsKey("url") || hashMap2.containsKey("bot"))) {
                        this.buttonState = -1;
                        z8 = false;
                    } else {
                        this.buttonState = 1;
                    }
                    boolean isSendingMessage2 = SendMessagesHelper.getInstance(this.currentAccount).isSendingMessage(this.currentMessageObject.getId());
                    if (this.currentPosition != null && isSendingMessage2 && this.buttonState == 1) {
                        this.drawRadialCheckBackground = true;
                        getIconForCurrentState();
                        this.radialProgress.setIcon(6, z, z5);
                    } else {
                        this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                    }
                    if (z8) {
                        long[] fileProgressSizes5 = ImageLoader.getInstance().getFileProgressSizes(this.currentMessageObject.messageOwner.attachPath);
                        if (fileProgressSizes5 == null && isSendingMessage2) {
                            f = 1.0f;
                        } else if (fileProgressSizes5 != null) {
                            f = DownloadController.getProgress(fileProgressSizes5);
                            createLoadingProgressLayout(fileProgressSizes5[0], fileProgressSizes5[1]);
                        }
                        this.radialProgress.setProgress(f, false);
                    } else {
                        this.radialProgress.setProgress(0.0f, false);
                    }
                    invalidate();
                } else {
                    getIconForCurrentState();
                    if (this.currentMessageObject.isSticker() || this.currentMessageObject.isAnimatedSticker() || this.currentMessageObject.isLocation() || this.currentMessageObject.isGif()) {
                        this.buttonState = -1;
                        this.radialProgress.setIcon(4, z, false);
                    } else {
                        this.buttonState = 1;
                        this.radialProgress.setIcon(12, z, false);
                    }
                    this.radialProgress.setProgress(0.0f, false);
                }
                this.videoRadialProgress.setIcon(4, z, false);
            } else {
                if (this.wasSending && !TextUtils.isEmpty(this.currentMessageObject.messageOwner.attachPath)) {
                    DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                }
                int i9 = this.documentAttachType;
                if ((i9 == 4 || i9 == 2 || i9 == 7) && this.autoPlayingMedia) {
                    isLoadingVideo = FileLoader.getInstance(this.currentAccount).isLoadingVideo(this.documentAttach, MediaController.getInstance().isPlayingMessage(this.currentMessageObject));
                    AnimatedFileDrawable animation = this.photoImage.getAnimation();
                    if (animation != null) {
                        MessageObject messageObject8 = this.currentMessageObject;
                        if (messageObject8.hadAnimationNotReadyLoading) {
                            if (animation.hasBitmap()) {
                                this.currentMessageObject.hadAnimationNotReadyLoading = false;
                            }
                        } else {
                            messageObject8.hadAnimationNotReadyLoading = isLoadingVideo && !animation.hasBitmap();
                        }
                    } else if (this.documentAttachType == 2 && !z4) {
                        this.currentMessageObject.hadAnimationNotReadyLoading = true;
                    }
                } else {
                    isLoadingVideo = false;
                }
                if (this.hasMiniProgress != 0) {
                    this.radialProgress.setMiniProgressBackgroundColor(getThemedColor("chat_inLoaderPhoto"));
                    this.buttonState = 3;
                    this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                    if (this.hasMiniProgress == 1) {
                        DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                        this.miniButtonState = -1;
                    } else {
                        DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(str, this.currentMessageObject, this);
                        if (!FileLoader.getInstance(this.currentAccount).isLoadingFile(str)) {
                            this.miniButtonState = 0;
                        } else {
                            this.miniButtonState = 1;
                            long[] fileProgressSizes6 = ImageLoader.getInstance().getFileProgressSizes(str);
                            if (fileProgressSizes6 != null) {
                                createLoadingProgressLayout(fileProgressSizes6[0], fileProgressSizes6[1]);
                                this.radialProgress.setProgress(DownloadController.getProgress(fileProgressSizes6), z5);
                            } else {
                                createLoadingProgressLayout(this.documentAttach);
                                this.radialProgress.setProgress(0.0f, z5);
                            }
                        }
                    }
                    this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), z, z5);
                } else if (z4 || (((i2 = this.documentAttachType) == 4 || i2 == 2 || i2 == 7) && this.autoPlayingMedia && !this.currentMessageObject.hadAnimationNotReadyLoading && !isLoadingVideo)) {
                    DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                    if (this.drawVideoImageButton && z5) {
                        int i10 = this.animatingDrawVideoImageButton;
                        if (i10 != 1 && this.animatingDrawVideoImageButtonProgress > 0.0f) {
                            if (i10 == 0) {
                                this.animatingDrawVideoImageButtonProgress = 1.0f;
                            }
                            this.animatingDrawVideoImageButton = 1;
                        }
                    } else if (this.animatingDrawVideoImageButton == 0) {
                        this.animatingDrawVideoImageButton = 1;
                    }
                    this.drawVideoImageButton = false;
                    this.drawVideoSize = false;
                    if (this.currentMessageObject.needDrawBluredPreview()) {
                        this.buttonState = -1;
                    } else {
                        int i11 = this.documentAttachType;
                        if (i11 == 2 && this.currentMessageObject.gifState == 1.0f) {
                            if (this.photoImage.isAnimationRunning()) {
                                this.currentMessageObject.gifState = 0.0f;
                                this.buttonState = -1;
                            } else {
                                this.buttonState = 2;
                            }
                        } else if (i11 == 4 && !this.hasEmbed) {
                            this.buttonState = 3;
                        } else {
                            this.buttonState = -1;
                        }
                    }
                    RadialProgress2 radialProgress2 = this.videoRadialProgress;
                    if (this.animatingDrawVideoImageButton == 0) {
                        z6 = false;
                    }
                    radialProgress2.setIcon(4, z, z6);
                    this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                    if (!z3 && this.photoNotSet) {
                        setMessageObject(this.currentMessageObject, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop);
                    }
                    invalidate();
                } else {
                    this.drawVideoSize = i2 == 4 || i2 == 2;
                    if ((i2 == 4 || i2 == 2 || i2 == 7) && this.canStreamVideo && !this.drawVideoImageButton && z5) {
                        int i12 = this.animatingDrawVideoImageButton;
                        if (i12 != 2 && this.animatingDrawVideoImageButtonProgress < 1.0f) {
                            if (i12 == 0) {
                                this.animatingDrawVideoImageButtonProgress = 0.0f;
                            }
                            this.animatingDrawVideoImageButton = 2;
                        }
                    } else if (this.animatingDrawVideoImageButton == 0) {
                        this.animatingDrawVideoImageButtonProgress = 1.0f;
                    }
                    DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(str, this.currentMessageObject, this);
                    if (!FileLoader.getInstance(this.currentAccount).isLoadingFile(str)) {
                        MessageObject messageObject9 = this.currentMessageObject;
                        if (!messageObject9.loadingCancelled && canDownloadMedia) {
                            this.buttonState = 1;
                        } else if (messageObject9.type == 4) {
                            this.buttonState = -1;
                        } else {
                            this.buttonState = 0;
                        }
                        int i13 = messageObject9.type;
                        boolean z9 = i13 == 3 || i13 == 8 || this.documentAttachType == 4;
                        MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
                        boolean z10 = groupedMessagePosition2 == null || (groupedMessagePosition2.flags & 3) == 3;
                        int i14 = this.documentAttachType;
                        if ((i14 == 4 || (i14 == 2 && canDownloadMedia)) && this.canStreamVideo && z9 && z10) {
                            this.drawVideoImageButton = true;
                            getIconForCurrentState();
                            this.radialProgress.setIcon(this.autoPlayingMedia ? 4 : 0, z, z5);
                            this.videoRadialProgress.setIcon(2, z, z5);
                        } else {
                            this.drawVideoImageButton = false;
                            this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                            this.videoRadialProgress.setIcon(4, z, false);
                            if (!this.drawVideoSize && this.animatingDrawVideoImageButton == 0) {
                                this.animatingDrawVideoImageButtonProgress = 0.0f;
                            }
                        }
                    } else {
                        this.buttonState = 1;
                        long[] fileProgressSizes7 = ImageLoader.getInstance().getFileProgressSizes(str);
                        if (fileProgressSizes7 != null) {
                            createLoadingProgressLayout(fileProgressSizes7[0], fileProgressSizes7[1]);
                        } else {
                            createLoadingProgressLayout(this.documentAttach);
                        }
                        MessageObject messageObject10 = this.currentMessageObject;
                        int i15 = messageObject10.type;
                        boolean z11 = i15 == 3 || i15 == 8 || this.documentAttachType == 4;
                        MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
                        boolean z12 = groupedMessagePosition3 == null || (groupedMessagePosition3.flags & 3) == 3;
                        if ((this.documentAttachType == 4 || (MessageObject.isGifDocument(this.documentAttach, messageObject10.hasValidGroupId()) && canDownloadMedia)) && this.canStreamVideo && z11 && z12) {
                            this.drawVideoImageButton = true;
                            getIconForCurrentState();
                            this.radialProgress.setIcon((this.autoPlayingMedia || this.documentAttachType == 2) ? 4 : 0, z, z5);
                            RadialProgress2 radialProgress22 = this.videoRadialProgress;
                            if (fileProgressSizes7 != null) {
                                f = DownloadController.getProgress(fileProgressSizes7);
                            }
                            radialProgress22.setProgress(f, z5);
                            this.videoRadialProgress.setIcon(14, z, z5);
                        } else {
                            this.drawVideoImageButton = false;
                            this.radialProgress.setProgress(fileProgressSizes7 != null ? DownloadController.getProgress(fileProgressSizes7) : 0.0f, z5);
                            this.radialProgress.setIcon(getIconForCurrentState(), z, z5);
                            this.videoRadialProgress.setIcon(4, z, false);
                            if (!this.drawVideoSize && this.animatingDrawVideoImageButton == 0) {
                                this.animatingDrawVideoImageButtonProgress = 0.0f;
                            }
                        }
                    }
                    invalidate();
                }
            }
        }
        if (this.hasMiniProgress != 0) {
            return;
        }
        this.radialProgress.setMiniIcon(4, false, z5);
    }

    private void didPressMiniButton(boolean z) {
        int i = this.miniButtonState;
        if (i != 0) {
            if (i != 1) {
                return;
            }
            int i2 = this.documentAttachType;
            if ((i2 == 3 || i2 == 5) && MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                MediaController.getInstance().cleanupPlayer(true, true);
            }
            this.miniButtonState = 0;
            this.currentMessageObject.loadingCancelled = true;
            FileLoader.getInstance(this.currentAccount).cancelLoadFile(this.documentAttach);
            this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), false, true);
            invalidate();
            return;
        }
        this.miniButtonState = 1;
        this.radialProgress.setProgress(0.0f, false);
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && !messageObject.isAnyKindOfSticker()) {
            this.currentMessageObject.putInDownloadsStore = true;
        }
        int i3 = this.documentAttachType;
        if (i3 == 3 || i3 == 5) {
            FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
            this.currentMessageObject.loadingCancelled = false;
        } else if (i3 == 4) {
            createLoadingProgressLayout(this.documentAttach);
            FileLoader fileLoader = FileLoader.getInstance(this.currentAccount);
            TLRPC$Document tLRPC$Document = this.documentAttach;
            MessageObject messageObject2 = this.currentMessageObject;
            fileLoader.loadFile(tLRPC$Document, messageObject2, 2, messageObject2.shouldEncryptPhotoOrVideo() ? 2 : 0);
            this.currentMessageObject.loadingCancelled = false;
        }
        this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), false, true);
        invalidate();
    }

    private void didPressButton(boolean z, boolean z2) {
        TLRPC$PhotoSize tLRPC$PhotoSize;
        String str;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && !messageObject.isAnyKindOfSticker()) {
            this.currentMessageObject.putInDownloadsStore = true;
        }
        int i = this.buttonState;
        int i2 = 2;
        if (i == 0 && (!this.drawVideoImageButton || z2)) {
            int i3 = this.documentAttachType;
            if (i3 == 3 || i3 == 5) {
                if (this.miniButtonState == 0) {
                    FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                    this.currentMessageObject.loadingCancelled = false;
                }
                if (!this.delegate.needPlayMessage(this.currentMessageObject)) {
                    return;
                }
                if (this.hasMiniProgress == 2 && this.miniButtonState != 1) {
                    this.miniButtonState = 1;
                    this.radialProgress.setProgress(0.0f, false);
                    this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), false, true);
                }
                updatePlayingMessageProgress();
                this.buttonState = 1;
                this.radialProgress.setIcon(getIconForCurrentState(), false, true);
                invalidate();
                return;
            }
            if (z2) {
                this.videoRadialProgress.setProgress(0.0f, false);
            } else {
                this.radialProgress.setProgress(0.0f, false);
            }
            if (this.currentPhotoObject != null && (this.photoImage.hasNotThumb() || this.currentPhotoObjectThumb == null)) {
                tLRPC$PhotoSize = this.currentPhotoObject;
                str = ((tLRPC$PhotoSize instanceof TLRPC$TL_photoStrippedSize) || "s".equals(tLRPC$PhotoSize.type)) ? this.currentPhotoFilterThumb : this.currentPhotoFilter;
            } else {
                tLRPC$PhotoSize = this.currentPhotoObjectThumb;
                str = this.currentPhotoFilterThumb;
            }
            String str2 = str;
            MessageObject messageObject2 = this.currentMessageObject;
            int i4 = messageObject2.type;
            if (i4 == 1 || i4 == 20) {
                this.photoImage.setForceLoading(true);
                ImageReceiver imageReceiver = this.photoImage;
                ImageLocation forObject = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                String str3 = this.currentPhotoFilter;
                ImageLocation forObject2 = ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject);
                String str4 = this.currentPhotoFilterThumb;
                BitmapDrawable bitmapDrawable = this.currentPhotoObjectThumbStripped;
                long j = this.currentPhotoObject.size;
                MessageObject messageObject3 = this.currentMessageObject;
                imageReceiver.setImage(forObject, str3, forObject2, str4, bitmapDrawable, j, null, messageObject3, messageObject3.shouldEncryptPhotoOrVideo() ? 2 : 0);
            } else if (i4 == 8) {
                FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                if (this.currentMessageObject.loadedFileSize > 0) {
                    createLoadingProgressLayout(this.documentAttach);
                }
            } else if (this.isRoundVideo) {
                if (messageObject2.isSecretMedia()) {
                    FileLoader.getInstance(this.currentAccount).loadFile(this.currentMessageObject.getDocument(), this.currentMessageObject, 2, 1);
                } else {
                    MessageObject messageObject4 = this.currentMessageObject;
                    messageObject4.gifState = 2.0f;
                    TLRPC$Document document = messageObject4.getDocument();
                    this.photoImage.setForceLoading(true);
                    this.photoImage.setImage(ImageLocation.getForDocument(document), null, ImageLocation.getForObject(tLRPC$PhotoSize, document), str2, document.size, null, this.currentMessageObject, 0);
                }
            } else if (i4 == 9) {
                FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                if (this.currentMessageObject.loadedFileSize > 0) {
                    createLoadingProgressLayout(this.documentAttach);
                }
            } else {
                int i5 = this.documentAttachType;
                if (i5 == 4) {
                    FileLoader fileLoader = FileLoader.getInstance(this.currentAccount);
                    TLRPC$Document tLRPC$Document = this.documentAttach;
                    MessageObject messageObject5 = this.currentMessageObject;
                    if (!messageObject5.shouldEncryptPhotoOrVideo()) {
                        i2 = 0;
                    }
                    fileLoader.loadFile(tLRPC$Document, messageObject5, 1, i2);
                    MessageObject messageObject6 = this.currentMessageObject;
                    if (messageObject6.loadedFileSize > 0) {
                        createLoadingProgressLayout(messageObject6.getDocument());
                    }
                } else if (i4 != 0 || i5 == 0) {
                    this.photoImage.setForceLoading(true);
                    this.photoImage.setImage(ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject), this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, 0L, null, this.currentMessageObject, 0);
                } else if (i5 == 2) {
                    this.photoImage.setForceLoading(true);
                    this.photoImage.setImage(ImageLocation.getForDocument(this.documentAttach), null, ImageLocation.getForDocument(this.currentPhotoObject, this.documentAttach), this.currentPhotoFilterThumb, this.documentAttach.size, null, this.currentMessageObject, 0);
                    MessageObject messageObject7 = this.currentMessageObject;
                    messageObject7.gifState = 2.0f;
                    if (messageObject7.loadedFileSize > 0) {
                        createLoadingProgressLayout(messageObject7.getDocument());
                    }
                } else if (i5 == 1) {
                    FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                } else if (i5 == 8) {
                    this.photoImage.setImage(ImageLocation.getForDocument(this.documentAttach), this.currentPhotoFilter, ImageLocation.getForDocument(this.currentPhotoObject, this.documentAttach), "b1", 0L, "jpg", this.currentMessageObject, 1);
                }
            }
            this.currentMessageObject.loadingCancelled = false;
            this.buttonState = 1;
            if (z2) {
                this.videoRadialProgress.setIcon(14, false, z);
            } else {
                this.radialProgress.setIcon(getIconForCurrentState(), false, z);
            }
            invalidate();
        } else if (i == 1 && (!this.drawVideoImageButton || z2)) {
            this.photoImage.setForceLoading(false);
            int i6 = this.documentAttachType;
            if (i6 == 3 || i6 == 5) {
                if (!MediaController.getInstance().lambda$startAudioAgain$7(this.currentMessageObject)) {
                    return;
                }
                this.buttonState = 0;
                this.radialProgress.setIcon(getIconForCurrentState(), false, z);
                invalidate();
            } else if (this.currentMessageObject.isOut() && !this.drawVideoImageButton && (this.currentMessageObject.isSending() || this.currentMessageObject.isEditing())) {
                if (this.radialProgress.getIcon() == 6) {
                    return;
                }
                this.delegate.didPressCancelSendButton(this);
            } else {
                MessageObject messageObject8 = this.currentMessageObject;
                messageObject8.loadingCancelled = true;
                int i7 = this.documentAttachType;
                if (i7 == 2 || i7 == 4 || i7 == 1 || i7 == 8) {
                    FileLoader.getInstance(this.currentAccount).cancelLoadFile(this.documentAttach);
                } else {
                    int i8 = messageObject8.type;
                    if (i8 == 0 || i8 == 1 || i8 == 20 || i8 == 8 || i8 == 5) {
                        ImageLoader.getInstance().cancelForceLoadingForImageReceiver(this.photoImage);
                        this.photoImage.cancelLoadImage();
                    } else if (i8 == 9) {
                        FileLoader.getInstance(this.currentAccount).cancelLoadFile(this.currentMessageObject.getDocument());
                    }
                }
                this.buttonState = 0;
                if (z2) {
                    this.videoRadialProgress.setIcon(2, false, z);
                } else {
                    this.radialProgress.setIcon(getIconForCurrentState(), false, z);
                }
                invalidate();
            }
        } else if (i == 2) {
            int i9 = this.documentAttachType;
            if (i9 == 3 || i9 == 5) {
                this.radialProgress.setProgress(0.0f, false);
                FileLoader.getInstance(this.currentAccount).loadFile(this.documentAttach, this.currentMessageObject, 2, 0);
                this.currentMessageObject.loadingCancelled = false;
                this.buttonState = 4;
                this.radialProgress.setIcon(getIconForCurrentState(), true, z);
                invalidate();
                return;
            }
            if (this.isRoundVideo) {
                MessageObject playingMessageObject = MediaController.getInstance().getPlayingMessageObject();
                if (playingMessageObject == null || !playingMessageObject.isRoundVideo()) {
                    this.photoImage.setAllowStartAnimation(true);
                    this.photoImage.startAnimation();
                }
            } else {
                this.photoImage.setAllowStartAnimation(true);
                this.photoImage.startAnimation();
            }
            this.currentMessageObject.gifState = 0.0f;
            this.buttonState = -1;
            this.radialProgress.setIcon(getIconForCurrentState(), false, z);
        } else if (i == 3 || i == 0) {
            if (this.hasMiniProgress == 2 && this.miniButtonState != 1) {
                this.miniButtonState = 1;
                this.radialProgress.setProgress(0.0f, false);
                this.radialProgress.setMiniIcon(getMiniIconForCurrentState(), false, z);
            }
            this.delegate.didPressImage(this, 0.0f, 0.0f);
        } else if (i != 4) {
        } else {
            int i10 = this.documentAttachType;
            if (i10 != 3 && i10 != 5) {
                return;
            }
            if ((this.currentMessageObject.isOut() && (this.currentMessageObject.isSending() || this.currentMessageObject.isEditing())) || this.currentMessageObject.isSendError()) {
                if (this.delegate == null || this.radialProgress.getIcon() == 6) {
                    return;
                }
                this.delegate.didPressCancelSendButton(this);
                return;
            }
            this.currentMessageObject.loadingCancelled = true;
            FileLoader.getInstance(this.currentAccount).cancelLoadFile(this.documentAttach);
            this.buttonState = 2;
            this.radialProgress.setIcon(getIconForCurrentState(), false, z);
            invalidate();
        }
    }

    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    public void onFailedDownload(String str, boolean z) {
        int i = this.documentAttachType;
        updateButtonState(true, i == 3 || i == 5, false);
    }

    /* JADX WARN: Code restructure failed: missing block: B:40:0x00b8, code lost:
        if ((r7 & 2) != 0) goto L41;
     */
    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void onSuccessDownload(String str) {
        TLRPC$Document tLRPC$Document;
        if (this.documentAttachType == 6 && this.currentMessageObject.isDice()) {
            DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
            setCurrentDiceValue(true);
            return;
        }
        int i = this.documentAttachType;
        if (i == 3 || i == 5) {
            updateButtonState(false, true, false);
            updateWaveform();
            return;
        }
        if (this.drawVideoImageButton) {
            this.videoRadialProgress.setProgress(1.0f, true);
        } else {
            this.radialProgress.setProgress(1.0f, true);
        }
        if (!this.currentMessageObject.needDrawBluredPreview() && !this.autoPlayingMedia && (tLRPC$Document = this.documentAttach) != null) {
            int i2 = this.documentAttachType;
            if (i2 == 7) {
                ImageReceiver imageReceiver = this.photoImage;
                ImageLocation forDocument = ImageLocation.getForDocument(tLRPC$Document);
                ImageLocation forObject = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                TLRPC$PhotoSize tLRPC$PhotoSize = this.currentPhotoObject;
                imageReceiver.setImage(forDocument, ImageLoader.AUTOPLAY_FILTER, forObject, ((tLRPC$PhotoSize instanceof TLRPC$TL_photoStrippedSize) || (tLRPC$PhotoSize != null && "s".equals(tLRPC$PhotoSize.type))) ? this.currentPhotoFilterThumb : this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.documentAttach.size, null, this.currentMessageObject, 0);
                this.photoImage.setAllowStartAnimation(true);
                this.photoImage.startAnimation();
                this.autoPlayingMedia = true;
            } else {
                if (SharedConfig.autoplayVideo && i2 == 4) {
                    MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                    if (groupedMessagePosition != null) {
                        int i3 = groupedMessagePosition.flags;
                        if ((i3 & 1) != 0) {
                        }
                    }
                    this.animatingNoSound = 2;
                    ImageReceiver imageReceiver2 = this.photoImage;
                    ImageLocation forDocument2 = ImageLocation.getForDocument(tLRPC$Document);
                    ImageLocation forObject2 = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                    TLRPC$PhotoSize tLRPC$PhotoSize2 = this.currentPhotoObject;
                    imageReceiver2.setImage(forDocument2, ImageLoader.AUTOPLAY_FILTER, forObject2, ((tLRPC$PhotoSize2 instanceof TLRPC$TL_photoStrippedSize) || (tLRPC$PhotoSize2 != null && "s".equals(tLRPC$PhotoSize2.type))) ? this.currentPhotoFilterThumb : this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.documentAttach.size, null, this.currentMessageObject, 0);
                    if (!PhotoViewer.isPlayingMessage(this.currentMessageObject)) {
                        this.photoImage.setAllowStartAnimation(true);
                        this.photoImage.startAnimation();
                    } else {
                        this.photoImage.setAllowStartAnimation(false);
                    }
                    this.autoPlayingMedia = true;
                }
                if (i2 == 2) {
                    ImageReceiver imageReceiver3 = this.photoImage;
                    ImageLocation forDocument3 = ImageLocation.getForDocument(tLRPC$Document);
                    ImageLocation forObject3 = ImageLocation.getForObject(this.currentPhotoObject, this.photoParentObject);
                    TLRPC$PhotoSize tLRPC$PhotoSize3 = this.currentPhotoObject;
                    imageReceiver3.setImage(forDocument3, ImageLoader.AUTOPLAY_FILTER, forObject3, ((tLRPC$PhotoSize3 instanceof TLRPC$TL_photoStrippedSize) || (tLRPC$PhotoSize3 != null && "s".equals(tLRPC$PhotoSize3.type))) ? this.currentPhotoFilterThumb : this.currentPhotoFilter, ImageLocation.getForObject(this.currentPhotoObjectThumb, this.photoParentObject), this.currentPhotoFilterThumb, this.currentPhotoObjectThumbStripped, this.documentAttach.size, null, this.currentMessageObject, 0);
                    if (SharedConfig.autoplayGifs) {
                        this.photoImage.setAllowStartAnimation(true);
                        this.photoImage.startAnimation();
                    } else {
                        this.photoImage.setAllowStartAnimation(false);
                        this.photoImage.stopAnimation();
                    }
                    this.autoPlayingMedia = true;
                }
            }
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.type == 0) {
            if (!this.autoPlayingMedia && this.documentAttachType == 2 && messageObject.gifState != 1.0f) {
                this.buttonState = 2;
                didPressButton(true, false);
                return;
            } else if (!this.photoNotSet) {
                updateButtonState(false, true, false);
                return;
            } else {
                setMessageObject(messageObject, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop);
                return;
            }
        }
        if (!this.photoNotSet) {
            updateButtonState(false, true, false);
        }
        if (!this.photoNotSet) {
            return;
        }
        setMessageObject(this.currentMessageObject, this.currentMessagesGroup, this.pinnedBottom, this.pinnedTop);
    }

    /* JADX WARN: Code restructure failed: missing block: B:17:0x0024, code lost:
        if (r3.mediaExists == false) goto L18;
     */
    @Override // org.telegram.messenger.ImageReceiver.ImageReceiverDelegate
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void didSetImage(ImageReceiver imageReceiver, boolean z, boolean z2, boolean z3) {
        int i;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !z) {
            return;
        }
        if (setCurrentDiceValue(!z3 && !messageObject.wasUnread)) {
            return;
        }
        if (z2) {
            MessageObject messageObject2 = this.currentMessageObject;
            if (messageObject2.type == 20) {
            }
        }
        if (z2) {
            return;
        }
        MessageObject messageObject3 = this.currentMessageObject;
        if (messageObject3.mediaExists || messageObject3.attachPathExists) {
            return;
        }
        int i2 = messageObject3.type;
        if ((i2 != 0 || ((i = this.documentAttachType) != 8 && i != 0 && i != 6)) && i2 != 1) {
            return;
        }
        this.currentMessageObject.mediaExists = true;
        updateButtonState(false, true, false);
    }

    public boolean setCurrentDiceValue(boolean z) {
        MessagesController.DiceFrameSuccess diceFrameSuccess;
        if (this.currentMessageObject.isDice()) {
            Drawable drawable = this.photoImage.getDrawable();
            if (drawable instanceof RLottieDrawable) {
                RLottieDrawable rLottieDrawable = (RLottieDrawable) drawable;
                String diceEmoji = this.currentMessageObject.getDiceEmoji();
                TLRPC$TL_messages_stickerSet stickerSetByEmojiOrName = MediaDataController.getInstance(this.currentAccount).getStickerSetByEmojiOrName(diceEmoji);
                if (stickerSetByEmojiOrName != null) {
                    int diceValue = this.currentMessageObject.getDiceValue();
                    if ("🎰".equals(this.currentMessageObject.getDiceEmoji())) {
                        if (diceValue >= 0 && diceValue <= 64) {
                            ((SlotsDrawable) rLottieDrawable).setDiceNumber(this, diceValue, stickerSetByEmojiOrName, z);
                            if (this.currentMessageObject.isOut()) {
                                rLottieDrawable.setOnFinishCallback(this.diceFinishCallback, ConnectionsManager.DEFAULT_DATACENTER_ID);
                            }
                            this.currentMessageObject.wasUnread = false;
                        }
                        if (!rLottieDrawable.hasBaseDice() && stickerSetByEmojiOrName.documents.size() > 0) {
                            ((SlotsDrawable) rLottieDrawable).setBaseDice(this, stickerSetByEmojiOrName);
                        }
                    } else {
                        if (!rLottieDrawable.hasBaseDice() && stickerSetByEmojiOrName.documents.size() > 0) {
                            TLRPC$Document tLRPC$Document = stickerSetByEmojiOrName.documents.get(0);
                            if (rLottieDrawable.setBaseDice(FileLoader.getInstance(this.currentAccount).getPathToAttach(tLRPC$Document, true))) {
                                DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                            } else {
                                DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(FileLoader.getAttachFileName(tLRPC$Document), this.currentMessageObject, this);
                                FileLoader.getInstance(this.currentAccount).loadFile(tLRPC$Document, stickerSetByEmojiOrName, 1, 1);
                            }
                        }
                        if (diceValue >= 0 && diceValue < stickerSetByEmojiOrName.documents.size()) {
                            if (!z && this.currentMessageObject.isOut() && (diceFrameSuccess = MessagesController.getInstance(this.currentAccount).diceSuccess.get(diceEmoji)) != null && diceFrameSuccess.num == diceValue) {
                                rLottieDrawable.setOnFinishCallback(this.diceFinishCallback, diceFrameSuccess.frame);
                            }
                            TLRPC$Document tLRPC$Document2 = stickerSetByEmojiOrName.documents.get(Math.max(diceValue, 0));
                            if (rLottieDrawable.setDiceNumber(FileLoader.getInstance(this.currentAccount).getPathToAttach(tLRPC$Document2, true), z)) {
                                DownloadController.getInstance(this.currentAccount).removeLoadingFileObserver(this);
                            } else {
                                DownloadController.getInstance(this.currentAccount).addLoadingFileObserver(FileLoader.getAttachFileName(tLRPC$Document2), this.currentMessageObject, this);
                                FileLoader.getInstance(this.currentAccount).loadFile(tLRPC$Document2, stickerSetByEmojiOrName, 1, 1);
                            }
                            this.currentMessageObject.wasUnread = false;
                        }
                    }
                } else {
                    MediaDataController.getInstance(this.currentAccount).loadStickersByEmojiOrName(diceEmoji, true, true);
                }
            }
            return true;
        }
        return false;
    }

    @Override // org.telegram.messenger.ImageReceiver.ImageReceiverDelegate
    public void onAnimationReady(ImageReceiver imageReceiver) {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || imageReceiver != this.photoImage || !messageObject.isAnimatedSticker()) {
            return;
        }
        this.delegate.setShouldNotRepeatSticker(this.currentMessageObject);
    }

    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    public void onProgressDownload(String str, long j, long j2) {
        float min = j2 == 0 ? 0.0f : Math.min(1.0f, ((float) j) / ((float) j2));
        this.currentMessageObject.loadedFileSize = j;
        createLoadingProgressLayout(j, j2);
        if (this.drawVideoImageButton) {
            this.videoRadialProgress.setProgress(min, true);
        } else {
            this.radialProgress.setProgress(min, true);
        }
        int i = this.documentAttachType;
        if (i == 3 || i == 5) {
            if (this.hasMiniProgress != 0) {
                if (this.miniButtonState == 1) {
                    return;
                }
                updateButtonState(false, false, false);
            } else if (this.buttonState == 4) {
            } else {
                updateButtonState(false, false, false);
            }
        } else if (this.hasMiniProgress != 0) {
            if (this.miniButtonState == 1) {
                return;
            }
            updateButtonState(false, false, false);
        } else if (this.buttonState == 1) {
        } else {
            updateButtonState(false, false, false);
        }
    }

    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    public void onProgressUpload(String str, long j, long j2, boolean z) {
        int i;
        float min = j2 == 0 ? 0.0f : Math.min(1.0f, ((float) j) / ((float) j2));
        this.currentMessageObject.loadedFileSize = j;
        this.radialProgress.setProgress(min, true);
        if (j == j2 && this.currentPosition != null && SendMessagesHelper.getInstance(this.currentAccount).isSendingMessage(this.currentMessageObject.getId()) && ((i = this.buttonState) == 1 || (i == 4 && this.documentAttachType == 5))) {
            this.drawRadialCheckBackground = true;
            getIconForCurrentState();
            this.radialProgress.setIcon(6, false, true);
        }
        createLoadingProgressLayout(j, j2);
    }

    private void createLoadingProgressLayout(TLRPC$Document tLRPC$Document) {
        if (tLRPC$Document == null) {
            return;
        }
        long[] fileProgressSizes = ImageLoader.getInstance().getFileProgressSizes(FileLoader.getDocumentFileName(tLRPC$Document));
        if (fileProgressSizes != null) {
            createLoadingProgressLayout(fileProgressSizes[0], fileProgressSizes[1]);
        } else {
            createLoadingProgressLayout(this.currentMessageObject.loadedFileSize, tLRPC$Document.size);
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:11:0x004b  */
    /* JADX WARN: Removed duplicated region for block: B:28:0x006a  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void createLoadingProgressLayout(long j, long j2) {
        boolean z;
        String format;
        int ceil;
        String str;
        int i;
        long j3 = j2;
        if (j3 <= 0 || this.documentAttach == null) {
            this.loadingProgressLayout = null;
            return;
        }
        long j4 = this.lastLoadingSizeTotal;
        if (j4 == 0) {
            this.lastLoadingSizeTotal = j3;
        } else if (j > j4) {
            j3 = j4;
            String formatFileSize = AndroidUtilities.formatFileSize(j3);
            int ceil2 = (int) Math.ceil(Theme.chat_infoPaint.measureText(String.format("000.0 mm / %s", formatFileSize)));
            String str2 = "100%";
            if (this.documentAttachType != 1) {
                format = ceil2 <= Math.max(this.infoWidth, this.docTitleWidth) ? String.format("%s / %s", AndroidUtilities.formatFileSize(j4), formatFileSize) : AndroidUtilities.formatFileSize(j4);
                z = true;
            } else {
                MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                z = groupedMessagePosition == null || (groupedMessagePosition.flags & 3) == 3;
                if (!z) {
                    int min = (int) (Math.min(1.0f, ((float) j4) / ((float) j3)) * 100.0f);
                    format = min >= 100 ? str2 : String.format(Locale.US, "%2d%%", Integer.valueOf(min));
                } else {
                    format = String.format("%s / %s", AndroidUtilities.formatFileSize(j4), formatFileSize);
                }
            }
            ceil = (int) Math.ceil(Theme.chat_infoPaint.measureText(format));
            if (z || ceil <= this.backgroundWidth - AndroidUtilities.dp(48.0f)) {
                str = format;
                i = ceil;
            } else {
                int min2 = (int) (Math.min(1.0f, ((float) j4) / ((float) j3)) * 100.0f);
                if (min2 < 100) {
                    str2 = String.format(Locale.US, "%2d%%", Integer.valueOf(min2));
                }
                i = (int) Math.ceil(Theme.chat_infoPaint.measureText(str2));
                str = str2;
            }
            this.loadingProgressLayout = new StaticLayout(str, Theme.chat_infoPaint, i, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
        } else {
            j3 = j4;
        }
        j4 = j;
        String formatFileSize2 = AndroidUtilities.formatFileSize(j3);
        int ceil22 = (int) Math.ceil(Theme.chat_infoPaint.measureText(String.format("000.0 mm / %s", formatFileSize2)));
        String str22 = "100%";
        if (this.documentAttachType != 1) {
        }
        ceil = (int) Math.ceil(Theme.chat_infoPaint.measureText(format));
        if (z) {
        }
        str = format;
        i = ceil;
        this.loadingProgressLayout = new StaticLayout(str, Theme.chat_infoPaint, i, Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
    }

    @Override // android.view.View
    public void onProvideStructure(ViewStructure viewStructure) {
        super.onProvideStructure(viewStructure);
        if (!this.allowAssistant || Build.VERSION.SDK_INT < 23) {
            return;
        }
        CharSequence charSequence = this.currentMessageObject.messageText;
        if (charSequence != null && charSequence.length() > 0) {
            viewStructure.setText(this.currentMessageObject.messageText);
            return;
        }
        CharSequence charSequence2 = this.currentMessageObject.caption;
        if (charSequence2 == null || charSequence2.length() <= 0) {
            return;
        }
        viewStructure.setText(this.currentMessageObject.caption);
    }

    public void setDelegate(ChatMessageCellDelegate chatMessageCellDelegate) {
        this.delegate = chatMessageCellDelegate;
    }

    public ChatMessageCellDelegate getDelegate() {
        return this.delegate;
    }

    public void setAllowAssistant(boolean z) {
        this.allowAssistant = z;
    }

    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:115:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:118:0x0217  */
    /* JADX WARN: Removed duplicated region for block: B:119:0x0194  */
    /* JADX WARN: Removed duplicated region for block: B:137:0x00c6  */
    /* JADX WARN: Removed duplicated region for block: B:43:0x0173  */
    /* JADX WARN: Removed duplicated region for block: B:48:0x018b  */
    /* JADX WARN: Removed duplicated region for block: B:50:0x01e7  */
    /* JADX WARN: Removed duplicated region for block: B:57:0x0231  */
    /* JADX WARN: Removed duplicated region for block: B:62:0x024c  */
    /* JADX WARN: Removed duplicated region for block: B:65:0x0287  */
    /* JADX WARN: Removed duplicated region for block: B:6:0x00b7  */
    /* JADX WARN: Removed duplicated region for block: B:71:0x02e0  */
    /* JADX WARN: Removed duplicated region for block: B:79:0x0324  */
    /* JADX WARN: Removed duplicated region for block: B:82:0x033a  */
    /* JADX WARN: Removed duplicated region for block: B:94:0x0373  */
    /* JADX WARN: Removed duplicated region for block: B:96:0x0385  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void measureTime(MessageObject messageObject) {
        TLRPC$User user;
        String replace;
        String str;
        String str2;
        int ceil;
        MessageObject messageObject2;
        TLRPC$Message tLRPC$Message;
        ReactionsLayoutInBubble reactionsLayoutInBubble;
        int i;
        int dp;
        String format;
        String format2;
        TLRPC$Message tLRPC$Message2;
        MessageObject.GroupedMessages groupedMessages;
        long fromChatId = messageObject.getFromChatId();
        CharSequence charSequence = "";
        if (!messageObject.scheduled) {
            TLRPC$Message tLRPC$Message3 = messageObject.messageOwner;
            if (tLRPC$Message3.post_author != null) {
                if (!this.isMegagroup || messageObject.getFromChatId() != messageObject.getDialogId()) {
                    replace = messageObject.messageOwner.post_author.replace("\n", charSequence);
                }
            } else {
                TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader = tLRPC$Message3.fwd_from;
                if (tLRPC$MessageFwdHeader != null && (str = tLRPC$MessageFwdHeader.post_author) != null) {
                    replace = str.replace("\n", charSequence);
                } else if (tLRPC$MessageFwdHeader != null && tLRPC$MessageFwdHeader.imported) {
                    replace = tLRPC$MessageFwdHeader.date == tLRPC$Message3.date ? LocaleController.getString("ImportedMessage", R.string.ImportedMessage) : LocaleController.formatImportedDate(messageObject.messageOwner.fwd_from.date) + " " + LocaleController.getString("ImportedMessage", R.string.ImportedMessage);
                } else if (!messageObject.isOutOwner() && fromChatId > 0 && messageObject.messageOwner.post && (user = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(fromChatId))) != null) {
                    replace = ContactsController.formatName(user.first_name, user.last_name).replace('\n', ' ');
                }
            }
            TLRPC$User user2 = !this.currentMessageObject.isFromUser() ? MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(fromChatId)) : null;
            boolean hasReplies = messageObject.hasReplies();
            if (!messageObject.scheduled && !messageObject.isLiveLocation() && !messageObject.messageOwner.edit_hide && messageObject.getDialogId() != 777000) {
                tLRPC$Message2 = messageObject.messageOwner;
                if (tLRPC$Message2.via_bot_id == 0 && tLRPC$Message2.via_bot_name == null && (user2 == null || !user2.bot)) {
                    if (this.currentPosition != null || (groupedMessages = this.currentMessagesGroup) == null || groupedMessages.messages.isEmpty()) {
                        this.edited = (messageObject.messageOwner.flags & 32768) == 0 || messageObject.isEditing();
                    } else {
                        this.edited = false;
                        hasReplies = this.currentMessagesGroup.messages.get(0).hasReplies();
                        if (!this.currentMessagesGroup.messages.get(0).messageOwner.edit_hide) {
                            int size = this.currentMessagesGroup.messages.size();
                            for (int i2 = 0; i2 < size; i2++) {
                                MessageObject messageObject3 = this.currentMessagesGroup.messages.get(i2);
                                if ((messageObject3.messageOwner.flags & 32768) != 0 || messageObject3.isEditing()) {
                                    this.edited = true;
                                    break;
                                }
                            }
                        }
                    }
                    this.edited = !this.edited && !this.currentMessageObject.isVoiceTranscriptionOpen();
                    if (!this.currentMessageObject.isSponsored()) {
                        str2 = LocaleController.getString("SponsoredMessage", R.string.SponsoredMessage);
                    } else {
                        MessageObject messageObject4 = this.currentMessageObject;
                        if (messageObject4.scheduled && messageObject4.messageOwner.date == 2147483646) {
                            str2 = charSequence;
                        } else if (this.edited) {
                            str2 = LocaleController.getString("EditedMessage", R.string.EditedMessage) + " " + LocaleController.getInstance().formatterDay.format(messageObject.messageOwner.date * 1000);
                        } else {
                            str2 = LocaleController.getInstance().formatterDay.format(messageObject.messageOwner.date * 1000);
                        }
                    }
                    if (replace == null) {
                        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader2 = messageObject.messageOwner.fwd_from;
                        if (tLRPC$MessageFwdHeader2 != null && tLRPC$MessageFwdHeader2.imported) {
                            this.currentTimeString = " " + str2;
                        } else {
                            this.currentTimeString = ", " + str2;
                        }
                    } else {
                        this.currentTimeString = str2;
                    }
                    ceil = (int) Math.ceil(Theme.chat_timePaint.measureText(this.currentTimeString));
                    this.timeWidth = ceil;
                    this.timeTextWidth = ceil;
                    messageObject2 = this.currentMessageObject;
                    if (messageObject2.scheduled && messageObject2.messageOwner.date == 2147483646) {
                        this.timeWidth = ceil - AndroidUtilities.dp(8.0f);
                    }
                    tLRPC$Message = messageObject.messageOwner;
                    if ((tLRPC$Message.flags & 1024) != 0) {
                        this.currentViewsString = String.format("%s", LocaleController.formatShortNumber(Math.max(1, tLRPC$Message.views), null));
                        int ceil2 = (int) Math.ceil(Theme.chat_timePaint.measureText(format2));
                        this.viewsTextWidth = ceil2;
                        this.timeWidth += ceil2 + Theme.chat_msgInViewsDrawable.getIntrinsicWidth() + AndroidUtilities.dp(10.0f);
                    }
                    if (messageObject.type == 20) {
                        int i3 = R.string.PaymentCheckoutPay;
                        LocaleController localeController = LocaleController.getInstance();
                        TLRPC$MessageMedia tLRPC$MessageMedia = messageObject.messageOwner.media;
                        String formatString = LocaleController.formatString(i3, localeController.formatCurrencyString(tLRPC$MessageMedia.total_amount, tLRPC$MessageMedia.currency));
                        if (formatString.length() >= 2) {
                            StringBuilder sb = new StringBuilder();
                            String substring = formatString.substring(0, 1);
                            Locale locale = Locale.ROOT;
                            sb.append(substring.toUpperCase(locale));
                            sb.append(formatString.substring(1).toLowerCase(locale));
                            formatString = sb.toString();
                        }
                        this.currentUnlockString = formatString;
                        this.unlockTextWidth = (int) Math.ceil(Theme.chat_unlockExtendedMediaTextPaint.measureText(formatString));
                    }
                    if (!this.isChat && this.isMegagroup && !this.isThreadChat && hasReplies) {
                        this.currentRepliesString = String.format("%s", LocaleController.formatShortNumber(getRepliesCount(), null));
                        int ceil3 = (int) Math.ceil(Theme.chat_timePaint.measureText(format));
                        this.repliesTextWidth = ceil3;
                        this.timeWidth += ceil3 + Theme.chat_msgInRepliesDrawable.getIntrinsicWidth() + AndroidUtilities.dp(10.0f);
                    } else {
                        this.currentRepliesString = null;
                    }
                    if (this.isPinned) {
                        this.timeWidth += Theme.chat_msgInPinnedDrawable.getIntrinsicWidth() + AndroidUtilities.dp(3.0f);
                    }
                    if (messageObject.scheduled) {
                        if (messageObject.isSendError()) {
                            this.timeWidth += AndroidUtilities.dp(18.0f);
                        } else if (messageObject.isSending() && messageObject.messageOwner.peer_id.channel_id != 0 && !messageObject.isSupergroup()) {
                            this.timeWidth += AndroidUtilities.dp(18.0f);
                        }
                    }
                    reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                    if (reactionsLayoutInBubble.isSmall) {
                        reactionsLayoutInBubble.measure(ConnectionsManager.DEFAULT_DATACENTER_ID, 3);
                        this.timeWidth += this.reactionsLayoutInBubble.width;
                    }
                    if (replace != null) {
                        return;
                    }
                    if (this.availableTimeWidth == 0) {
                        this.availableTimeWidth = AndroidUtilities.dp(1000.0f);
                    }
                    int i4 = this.availableTimeWidth - this.timeWidth;
                    if (messageObject.isOutOwner()) {
                        if (messageObject.type == 5) {
                            dp = AndroidUtilities.dp(20.0f);
                        } else {
                            dp = AndroidUtilities.dp(96.0f);
                        }
                        i4 -= dp;
                    }
                    int ceil4 = (int) Math.ceil(Theme.chat_timePaint.measureText((CharSequence) replace, 0, replace.length()));
                    if (ceil4 <= i4) {
                        i = ceil4;
                        charSequence = replace;
                    } else if (i4 <= 0) {
                        i = 0;
                    } else {
                        charSequence = TextUtils.ellipsize(replace, Theme.chat_timePaint, i4, TextUtils.TruncateAt.END);
                        i = i4;
                    }
                    this.currentTimeString = ((Object) charSequence) + this.currentTimeString;
                    this.timeTextWidth = this.timeTextWidth + i;
                    this.timeWidth = this.timeWidth + i;
                    return;
                }
            }
            this.edited = false;
            this.edited = !this.edited && !this.currentMessageObject.isVoiceTranscriptionOpen();
            if (!this.currentMessageObject.isSponsored()) {
            }
            if (replace == null) {
            }
            ceil = (int) Math.ceil(Theme.chat_timePaint.measureText(this.currentTimeString));
            this.timeWidth = ceil;
            this.timeTextWidth = ceil;
            messageObject2 = this.currentMessageObject;
            if (messageObject2.scheduled) {
                this.timeWidth = ceil - AndroidUtilities.dp(8.0f);
            }
            tLRPC$Message = messageObject.messageOwner;
            if ((tLRPC$Message.flags & 1024) != 0) {
            }
            if (messageObject.type == 20) {
            }
            if (!this.isChat) {
            }
            this.currentRepliesString = null;
            if (this.isPinned) {
            }
            if (messageObject.scheduled) {
            }
            reactionsLayoutInBubble = this.reactionsLayoutInBubble;
            if (reactionsLayoutInBubble.isSmall) {
            }
            if (replace != null) {
            }
        }
        replace = null;
        if (!this.currentMessageObject.isFromUser()) {
        }
        boolean hasReplies2 = messageObject.hasReplies();
        if (!messageObject.scheduled) {
            tLRPC$Message2 = messageObject.messageOwner;
            if (tLRPC$Message2.via_bot_id == 0) {
                if (this.currentPosition != null) {
                }
                this.edited = (messageObject.messageOwner.flags & 32768) == 0 || messageObject.isEditing();
                this.edited = !this.edited && !this.currentMessageObject.isVoiceTranscriptionOpen();
                if (!this.currentMessageObject.isSponsored()) {
                }
                if (replace == null) {
                }
                ceil = (int) Math.ceil(Theme.chat_timePaint.measureText(this.currentTimeString));
                this.timeWidth = ceil;
                this.timeTextWidth = ceil;
                messageObject2 = this.currentMessageObject;
                if (messageObject2.scheduled) {
                }
                tLRPC$Message = messageObject.messageOwner;
                if ((tLRPC$Message.flags & 1024) != 0) {
                }
                if (messageObject.type == 20) {
                }
                if (!this.isChat) {
                }
                this.currentRepliesString = null;
                if (this.isPinned) {
                }
                if (messageObject.scheduled) {
                }
                reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                if (reactionsLayoutInBubble.isSmall) {
                }
                if (replace != null) {
                }
            }
        }
        this.edited = false;
        this.edited = !this.edited && !this.currentMessageObject.isVoiceTranscriptionOpen();
        if (!this.currentMessageObject.isSponsored()) {
        }
        if (replace == null) {
        }
        ceil = (int) Math.ceil(Theme.chat_timePaint.measureText(this.currentTimeString));
        this.timeWidth = ceil;
        this.timeTextWidth = ceil;
        messageObject2 = this.currentMessageObject;
        if (messageObject2.scheduled) {
        }
        tLRPC$Message = messageObject.messageOwner;
        if ((tLRPC$Message.flags & 1024) != 0) {
        }
        if (messageObject.type == 20) {
        }
        if (!this.isChat) {
        }
        this.currentRepliesString = null;
        if (this.isPinned) {
        }
        if (messageObject.scheduled) {
        }
        reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        if (reactionsLayoutInBubble.isSmall) {
        }
        if (replace != null) {
        }
    }

    private boolean shouldDrawSelectionOverlay() {
        return hasSelectionOverlay() && ((isPressed() && this.isCheckPressed) || ((!this.isCheckPressed && this.isPressed) || this.isHighlighted || this.isHighlightedAnimated)) && !textIsSelectionMode() && ((this.currentMessagesGroup == null || this.drawSelectionBackground) && this.currentBackgroundDrawable != null);
    }

    private Integer getSelectionOverlayColor() {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        if (resourcesProvider == null) {
            return null;
        }
        MessageObject messageObject = this.currentMessageObject;
        return resourcesProvider.getColor((messageObject == null || !messageObject.isOut()) ? "chat_inBubbleSelectedOverlay" : "chat_outBubbleSelectedOverlay");
    }

    private boolean hasSelectionOverlay() {
        Integer selectionOverlayColor = getSelectionOverlayColor();
        return (selectionOverlayColor == null || selectionOverlayColor.intValue() == -65536) ? false : true;
    }

    private boolean isDrawSelectionBackground() {
        return ((isPressed() && this.isCheckPressed) || ((!this.isCheckPressed && this.isPressed) || this.isHighlighted)) && !textIsSelectionMode() && !hasSelectionOverlay();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public boolean isOpenChatByShare(MessageObject messageObject) {
        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader = messageObject.messageOwner.fwd_from;
        return (tLRPC$MessageFwdHeader == null || tLRPC$MessageFwdHeader.saved_from_peer == null) ? false : true;
    }

    private boolean checkNeedDrawShareButton(MessageObject messageObject) {
        MessageObject messageObject2 = this.currentMessageObject;
        if (messageObject2.deleted || messageObject2.isSponsored()) {
            return false;
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null && !this.currentMessagesGroup.isDocuments && !groupedMessagePosition.last) {
            return false;
        }
        return messageObject.needDrawShareButton();
    }

    public boolean isInsideBackground(float f, float f2) {
        if (this.currentBackgroundDrawable != null) {
            int i = this.backgroundDrawableLeft;
            if (f >= i && f <= i + this.backgroundDrawableRight) {
                return true;
            }
        }
        return false;
    }

    private void updateCurrentUserAndChat() {
        TLRPC$Peer tLRPC$Peer;
        MessagesController messagesController = MessagesController.getInstance(this.currentAccount);
        TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader = this.currentMessageObject.messageOwner.fwd_from;
        long clientUserId = UserConfig.getInstance(this.currentAccount).getClientUserId();
        if (tLRPC$MessageFwdHeader != null && (tLRPC$MessageFwdHeader.from_id instanceof TLRPC$TL_peerChannel) && this.currentMessageObject.getDialogId() == clientUserId) {
            this.currentChat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(tLRPC$MessageFwdHeader.from_id.channel_id));
        } else if (tLRPC$MessageFwdHeader != null && (tLRPC$Peer = tLRPC$MessageFwdHeader.saved_from_peer) != null) {
            long j = tLRPC$Peer.user_id;
            if (j != 0) {
                TLRPC$Peer tLRPC$Peer2 = tLRPC$MessageFwdHeader.from_id;
                if (tLRPC$Peer2 instanceof TLRPC$TL_peerUser) {
                    this.currentUser = messagesController.getUser(Long.valueOf(tLRPC$Peer2.user_id));
                } else {
                    this.currentUser = messagesController.getUser(Long.valueOf(j));
                }
            } else if (tLRPC$Peer.channel_id != 0) {
                if (this.currentMessageObject.isSavedFromMegagroup()) {
                    TLRPC$Peer tLRPC$Peer3 = tLRPC$MessageFwdHeader.from_id;
                    if (tLRPC$Peer3 instanceof TLRPC$TL_peerUser) {
                        this.currentUser = messagesController.getUser(Long.valueOf(tLRPC$Peer3.user_id));
                        return;
                    }
                }
                this.currentChat = messagesController.getChat(Long.valueOf(tLRPC$MessageFwdHeader.saved_from_peer.channel_id));
            } else {
                long j2 = tLRPC$Peer.chat_id;
                if (j2 == 0) {
                    return;
                }
                TLRPC$Peer tLRPC$Peer4 = tLRPC$MessageFwdHeader.from_id;
                if (tLRPC$Peer4 instanceof TLRPC$TL_peerUser) {
                    this.currentUser = messagesController.getUser(Long.valueOf(tLRPC$Peer4.user_id));
                } else {
                    this.currentChat = messagesController.getChat(Long.valueOf(j2));
                }
            }
        } else if (tLRPC$MessageFwdHeader != null && (tLRPC$MessageFwdHeader.from_id instanceof TLRPC$TL_peerUser) && (tLRPC$MessageFwdHeader.imported || this.currentMessageObject.getDialogId() == clientUserId)) {
            this.currentUser = messagesController.getUser(Long.valueOf(tLRPC$MessageFwdHeader.from_id.user_id));
        } else if (tLRPC$MessageFwdHeader != null && !TextUtils.isEmpty(tLRPC$MessageFwdHeader.from_name) && (tLRPC$MessageFwdHeader.imported || this.currentMessageObject.getDialogId() == clientUserId)) {
            TLRPC$TL_user tLRPC$TL_user = new TLRPC$TL_user();
            this.currentUser = tLRPC$TL_user;
            tLRPC$TL_user.first_name = tLRPC$MessageFwdHeader.from_name;
        } else {
            long fromChatId = this.currentMessageObject.getFromChatId();
            if (DialogObject.isUserDialog(fromChatId) && !this.currentMessageObject.messageOwner.post) {
                this.currentUser = messagesController.getUser(Long.valueOf(fromChatId));
            } else if (DialogObject.isChatDialog(fromChatId)) {
                this.currentChat = messagesController.getChat(Long.valueOf(-fromChatId));
            } else {
                TLRPC$Message tLRPC$Message = this.currentMessageObject.messageOwner;
                if (!tLRPC$Message.post) {
                    return;
                }
                this.currentChat = messagesController.getChat(Long.valueOf(tLRPC$Message.peer_id.channel_id));
            }
        }
    }

    /* JADX WARN: Can't wrap try/catch for region: R(28:21|(1:23)|24|(1:446)(2:30|(23:32|33|34|(1:36)(1:(1:420)(1:421))|37|(1:39)(1:418)|40|(7:42|(1:44)|45|(1:47)(3:53|(1:55)(1:57)|56)|48|(1:50)(1:52)|51)|58|59|60|61|62|(3:64|(1:66)|67)(1:413)|68|(1:70)|(1:72)(1:412)|73|(3:75|(1:77)(1:79)|78)|80|(1:82)(2:406|(1:408)(2:409|(1:411)))|83|(1:85)))|422|(2:429|(22:445|34|(0)(0)|37|(0)(0)|40|(0)|58|59|60|61|62|(0)(0)|68|(0)|(0)(0)|73|(0)|80|(0)(0)|83|(0))(3:441|(1:443)|444))(1:428)|33|34|(0)(0)|37|(0)(0)|40|(0)|58|59|60|61|62|(0)(0)|68|(0)|(0)(0)|73|(0)|80|(0)(0)|83|(0)) */
    /* JADX WARN: Code restructure failed: missing block: B:414:0x039c, code lost:
        r0 = move-exception;
     */
    /* JADX WARN: Code restructure failed: missing block: B:415:0x039d, code lost:
        org.telegram.messenger.FileLog.e(r0);
     */
    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:36:0x01df  */
    /* JADX WARN: Removed duplicated region for block: B:39:0x0205  */
    /* JADX WARN: Removed duplicated region for block: B:406:0x03cc  */
    /* JADX WARN: Removed duplicated region for block: B:412:0x0398 A[Catch: Exception -> 0x039c, TRY_LEAVE, TryCatch #1 {Exception -> 0x039c, blocks: (B:62:0x030b, B:64:0x032c, B:66:0x0342, B:67:0x034d, B:68:0x035a, B:70:0x035e, B:72:0x036b, B:412:0x0398, B:413:0x0356), top: B:61:0x030b }] */
    /* JADX WARN: Removed duplicated region for block: B:413:0x0356 A[Catch: Exception -> 0x039c, TryCatch #1 {Exception -> 0x039c, blocks: (B:62:0x030b, B:64:0x032c, B:66:0x0342, B:67:0x034d, B:68:0x035a, B:70:0x035e, B:72:0x036b, B:412:0x0398, B:413:0x0356), top: B:61:0x030b }] */
    /* JADX WARN: Removed duplicated region for block: B:418:0x0208  */
    /* JADX WARN: Removed duplicated region for block: B:419:0x01e2  */
    /* JADX WARN: Removed duplicated region for block: B:42:0x0213  */
    /* JADX WARN: Removed duplicated region for block: B:64:0x032c A[Catch: Exception -> 0x039c, TryCatch #1 {Exception -> 0x039c, blocks: (B:62:0x030b, B:64:0x032c, B:66:0x0342, B:67:0x034d, B:68:0x035a, B:70:0x035e, B:72:0x036b, B:412:0x0398, B:413:0x0356), top: B:61:0x030b }] */
    /* JADX WARN: Removed duplicated region for block: B:70:0x035e A[Catch: Exception -> 0x039c, TryCatch #1 {Exception -> 0x039c, blocks: (B:62:0x030b, B:64:0x032c, B:66:0x0342, B:67:0x034d, B:68:0x035a, B:70:0x035e, B:72:0x036b, B:412:0x0398, B:413:0x0356), top: B:61:0x030b }] */
    /* JADX WARN: Removed duplicated region for block: B:72:0x036b A[Catch: Exception -> 0x039c, TryCatch #1 {Exception -> 0x039c, blocks: (B:62:0x030b, B:64:0x032c, B:66:0x0342, B:67:0x034d, B:68:0x035a, B:70:0x035e, B:72:0x036b, B:412:0x0398, B:413:0x0356), top: B:61:0x030b }] */
    /* JADX WARN: Removed duplicated region for block: B:75:0x03a4  */
    /* JADX WARN: Removed duplicated region for block: B:82:0x03c5  */
    /* JADX WARN: Removed duplicated region for block: B:85:0x03f0  */
    /* JADX WARN: Type inference failed for: r0v18, types: [android.text.StaticLayout[]] */
    /* JADX WARN: Type inference failed for: r0v38, types: [android.text.SpannableStringBuilder, java.lang.CharSequence] */
    /* JADX WARN: Type inference failed for: r0v39 */
    /* JADX WARN: Type inference failed for: r0v56, types: [java.lang.CharSequence] */
    /* JADX WARN: Type inference failed for: r15v0, types: [java.lang.CharSequence, java.lang.String] */
    /* JADX WARN: Type inference failed for: r15v1, types: [java.lang.CharSequence] */
    /* JADX WARN: Type inference failed for: r15v3 */
    /* JADX WARN: Type inference failed for: r15v4, types: [java.lang.CharSequence] */
    /* JADX WARN: Type inference failed for: r15v5, types: [java.lang.CharSequence] */
    /* JADX WARN: Type inference failed for: r4v1 */
    /* JADX WARN: Type inference failed for: r4v129 */
    /* JADX WARN: Type inference failed for: r4v174, types: [java.lang.String] */
    /* JADX WARN: Type inference failed for: r4v176 */
    /* JADX WARN: Type inference failed for: r4v2, types: [org.telegram.tgnet.TLRPC$Chat, org.telegram.tgnet.TLRPC$User, java.lang.String] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void setMessageObjectInternal(MessageObject messageObject) {
        String str;
        SpannableStringBuilder replaceTags;
        String str2;
        ?? r4;
        TLRPC$PhotoSize tLRPC$PhotoSize;
        int i;
        int i2;
        String str3;
        CharSequence charSequence;
        MessageObject messageObject2;
        TLRPC$Message tLRPC$Message;
        int i3;
        CharSequence charSequence2;
        String str4;
        int i4;
        TextStyleSpan[] textStyleSpanArr;
        MessageObject messageObject3;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        String charSequence3;
        SpannableStringBuilder spannableStringBuilder;
        Object obj;
        int i5;
        String str5;
        ChatMessageCellDelegate chatMessageCellDelegate;
        String adminRank;
        String str6;
        Object obj2;
        StaticLayout staticLayout;
        int themedColor;
        SpannableStringBuilder spannableStringBuilder2;
        TLRPC$Chat tLRPC$Chat;
        TLRPC$Message tLRPC$Message2 = messageObject.messageOwner;
        if ((tLRPC$Message2.flags & 1024) != 0 || tLRPC$Message2.replies != null) {
            MessageObject messageObject4 = this.currentMessageObject;
            if (!messageObject4.scheduled && !messageObject4.isSponsored() && !this.currentMessageObject.viewsReloaded) {
                MessagesController.getInstance(this.currentAccount).addToViewsQueue(this.currentMessageObject);
                this.currentMessageObject.viewsReloaded = true;
            }
        }
        updateCurrentUserAndChat();
        setAvatar(messageObject);
        measureTime(messageObject);
        this.namesOffset = 0;
        TLRPC$Message tLRPC$Message3 = messageObject.messageOwner;
        if (tLRPC$Message3.via_bot_id != 0) {
            TLRPC$User user = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(messageObject.messageOwner.via_bot_id));
            if (user != null && !TextUtils.isEmpty(user.username)) {
                str = "@" + user.username;
                replaceTags = AndroidUtilities.replaceTags(String.format(" %s <b>%s</b>", LocaleController.getString("ViaBot", R.string.ViaBot), str));
                this.viaWidth = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(replaceTags, 0, replaceTags.length()));
                this.currentViaBotUser = user;
            }
            str = null;
            replaceTags = null;
        } else {
            if (!TextUtils.isEmpty(tLRPC$Message3.via_bot_name)) {
                str = "@" + messageObject.messageOwner.via_bot_name;
                replaceTags = AndroidUtilities.replaceTags(String.format(" %s <b>%s</b>", LocaleController.getString("ViaBot", R.string.ViaBot), str));
                this.viaWidth = (int) Math.ceil(Theme.chat_replyNamePaint.measureText(replaceTags, 0, replaceTags.length()));
            }
            str = null;
            replaceTags = null;
        }
        boolean isNeedAuthorName = isNeedAuthorName();
        boolean z = (messageObject.messageOwner.fwd_from == null || messageObject.type == 14) && str != null;
        ?? r15 = "";
        if (!this.hasPsaHint && (isNeedAuthorName || z)) {
            this.drawNameLayout = true;
            int maxNameWidth = getMaxNameWidth();
            this.nameWidth = maxNameWidth;
            if (maxNameWidth < 0) {
                this.nameWidth = AndroidUtilities.dp(100.0f);
            }
            if (!this.isMegagroup || (tLRPC$Chat = this.currentChat) == null || messageObject.messageOwner.post_author == null) {
                str2 = str;
            } else {
                str2 = str;
                if (tLRPC$Chat.id == (-this.currentMessageObject.getFromChatId())) {
                    adminRank = messageObject.messageOwner.post_author.replace("\n", r15);
                    i5 = (int) Math.ceil(Theme.chat_adminPaint.measureText(adminRank));
                    this.nameWidth -= i5;
                    str5 = adminRank;
                    obj = null;
                    this.currentNameStatus = obj;
                    str6 = messageObject.customName;
                    if (str6 != null) {
                        this.currentNameString = str6;
                    } else if (isNeedAuthorName) {
                        this.currentNameString = getAuthorName();
                        this.currentNameStatus = getAuthorStatus();
                    } else {
                        this.currentNameString = r15;
                    }
                    CharSequence ellipsize = TextUtils.ellipsize(this.currentNameString.replace('\n', ' ').replace((char) 8207, ' '), Theme.chat_namePaint, this.nameWidth - (z ? this.viaWidth : 0), TextUtils.TruncateAt.END);
                    if (z) {
                        int ceil = (int) Math.ceil(Theme.chat_namePaint.measureText(ellipsize, 0, ellipsize.length()));
                        this.viaNameWidth = ceil;
                        if (ceil != 0) {
                            this.viaNameWidth = ceil + AndroidUtilities.dp(4.0f);
                        }
                        if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                            themedColor = getThemedColor("chat_stickerViaBotNameText");
                        } else {
                            themedColor = getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outViaBotNameText" : "chat_inViaBotNameText");
                        }
                        String string = LocaleController.getString("ViaBot", R.string.ViaBot);
                        if (this.currentNameString.length() > 0) {
                            SpannableStringBuilder spannableStringBuilder3 = new SpannableStringBuilder(String.format("%s %s %s", ellipsize, string, str2));
                            TypefaceSpan typefaceSpan = new TypefaceSpan(Typeface.DEFAULT, 0, themedColor);
                            this.viaSpan1 = typefaceSpan;
                            spannableStringBuilder3.setSpan(typefaceSpan, ellipsize.length() + 1, ellipsize.length() + 1 + string.length(), 33);
                            TypefaceSpan typefaceSpan2 = new TypefaceSpan(AndroidUtilities.getTypeface(AndroidUtilities.TYPEFACE_ROBOTO_MEDIUM), 0, themedColor);
                            this.viaSpan2 = typefaceSpan2;
                            spannableStringBuilder3.setSpan(typefaceSpan2, ellipsize.length() + 2 + string.length(), spannableStringBuilder3.length(), 33);
                            spannableStringBuilder2 = spannableStringBuilder3;
                        } else {
                            SpannableStringBuilder spannableStringBuilder4 = new SpannableStringBuilder(String.format("%s %s", string, str2));
                            TypefaceSpan typefaceSpan3 = new TypefaceSpan(Typeface.DEFAULT, 0, themedColor);
                            this.viaSpan1 = typefaceSpan3;
                            spannableStringBuilder4.setSpan(typefaceSpan3, 0, string.length() + 1, 33);
                            TypefaceSpan typefaceSpan4 = new TypefaceSpan(AndroidUtilities.getTypeface(AndroidUtilities.TYPEFACE_ROBOTO_MEDIUM), 0, themedColor);
                            this.viaSpan2 = typefaceSpan4;
                            spannableStringBuilder4.setSpan(typefaceSpan4, string.length() + 1, spannableStringBuilder4.length(), 33);
                            spannableStringBuilder2 = spannableStringBuilder4;
                        }
                        ellipsize = TextUtils.ellipsize(spannableStringBuilder2, Theme.chat_namePaint, this.nameWidth, TextUtils.TruncateAt.END);
                    }
                    ellipsize = Emoji.replaceEmoji(ellipsize, Theme.chat_namePaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
                    staticLayout = new StaticLayout(ellipsize, Theme.chat_namePaint, this.nameWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                    this.nameLayout = staticLayout;
                    if (staticLayout.getLineCount() > 0) {
                        int ceil2 = (int) Math.ceil(this.nameLayout.getLineWidth(0));
                        this.nameLayoutWidth = ceil2;
                        this.nameWidth = ceil2;
                        if (!messageObject.isAnyKindOfSticker()) {
                            this.namesOffset += AndroidUtilities.dp(19.0f);
                        }
                        this.nameOffsetX = this.nameLayout.getLineLeft(0);
                    } else {
                        this.nameLayoutWidth = 0;
                        this.nameWidth = 0;
                    }
                    if (this.currentNameStatus != null) {
                        this.nameWidth += AndroidUtilities.dp(20.0f);
                    }
                    if (str5 != null) {
                        StaticLayout staticLayout2 = new StaticLayout(str5, Theme.chat_adminPaint, i5 + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        this.adminLayout = staticLayout2;
                        this.nameWidth = (int) (this.nameWidth + staticLayout2.getLineWidth(0) + AndroidUtilities.dp(8.0f));
                    } else {
                        this.adminLayout = null;
                    }
                    if (this.currentNameStatusDrawable == null) {
                        this.currentNameStatusDrawable = new AnimatedEmojiDrawable.SwapAnimatedEmojiDrawable(getParent() instanceof View ? (View) getParent() : null, AndroidUtilities.dp(20.0f));
                    }
                    obj2 = this.currentNameStatus;
                    if (obj2 == null) {
                        this.currentNameStatusDrawable.set((Drawable) null, false);
                    } else if (obj2 instanceof Long) {
                        this.currentNameStatusDrawable.set(((Long) obj2).longValue(), false);
                    } else if (obj2 instanceof Drawable) {
                        this.currentNameStatusDrawable.set((Drawable) obj2, false);
                    }
                    r4 = 0;
                    r4 = 0;
                    if (this.currentNameString.length() == 0) {
                        this.currentNameString = null;
                    }
                }
            }
            if (this.isMegagroup && this.currentChat != null && this.currentMessageObject.isForwardedChannelPost()) {
                adminRank = LocaleController.getString("DiscussChannel", R.string.DiscussChannel);
                i5 = (int) Math.ceil(Theme.chat_adminPaint.measureText(adminRank));
                this.nameWidth -= i5;
            } else if (this.currentUser != null && !this.currentMessageObject.isOutOwner() && !this.currentMessageObject.isAnyKindOfSticker() && this.currentMessageObject.type != 5 && (chatMessageCellDelegate = this.delegate) != null && (adminRank = chatMessageCellDelegate.getAdminRank(this.currentUser.id)) != null) {
                if (adminRank.length() == 0) {
                    adminRank = LocaleController.getString("ChatAdmin", R.string.ChatAdmin);
                }
                i5 = (int) Math.ceil(Theme.chat_adminPaint.measureText(adminRank));
                this.nameWidth -= i5;
            } else {
                obj = null;
                i5 = 0;
                str5 = null;
                this.currentNameStatus = obj;
                str6 = messageObject.customName;
                if (str6 != null) {
                }
                CharSequence ellipsize2 = TextUtils.ellipsize(this.currentNameString.replace('\n', ' ').replace((char) 8207, ' '), Theme.chat_namePaint, this.nameWidth - (z ? this.viaWidth : 0), TextUtils.TruncateAt.END);
                if (z) {
                }
                ellipsize2 = Emoji.replaceEmoji(ellipsize2, Theme.chat_namePaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
                staticLayout = new StaticLayout(ellipsize2, Theme.chat_namePaint, this.nameWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                this.nameLayout = staticLayout;
                if (staticLayout.getLineCount() > 0) {
                }
                if (this.currentNameStatus != null) {
                }
                if (str5 != null) {
                }
                if (this.currentNameStatusDrawable == null) {
                }
                obj2 = this.currentNameStatus;
                if (obj2 == null) {
                }
                r4 = 0;
                r4 = 0;
                if (this.currentNameString.length() == 0) {
                }
            }
            str5 = adminRank;
            obj = null;
            this.currentNameStatus = obj;
            str6 = messageObject.customName;
            if (str6 != null) {
            }
            CharSequence ellipsize22 = TextUtils.ellipsize(this.currentNameString.replace('\n', ' ').replace((char) 8207, ' '), Theme.chat_namePaint, this.nameWidth - (z ? this.viaWidth : 0), TextUtils.TruncateAt.END);
            if (z) {
            }
            ellipsize22 = Emoji.replaceEmoji(ellipsize22, Theme.chat_namePaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
            staticLayout = new StaticLayout(ellipsize22, Theme.chat_namePaint, this.nameWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            this.nameLayout = staticLayout;
            if (staticLayout.getLineCount() > 0) {
            }
            if (this.currentNameStatus != null) {
            }
            if (str5 != null) {
            }
            if (this.currentNameStatusDrawable == null) {
            }
            obj2 = this.currentNameStatus;
            if (obj2 == null) {
            }
            r4 = 0;
            r4 = 0;
            if (this.currentNameString.length() == 0) {
            }
        } else {
            str2 = str;
            r4 = 0;
            this.currentNameString = null;
            this.nameLayout = null;
            this.nameWidth = 0;
        }
        this.currentForwardUser = r4;
        this.currentForwardNameString = r4;
        this.currentForwardChannel = r4;
        this.currentForwardName = r4;
        ?? r0 = this.forwardedNameLayout;
        r0[0] = r4;
        r0[1] = r4;
        this.replyPanelIsForward = false;
        this.forwardedNameWidth = 0;
        if (messageObject.isForwarded()) {
            TLRPC$Peer tLRPC$Peer = messageObject.messageOwner.fwd_from.from_id;
            if (tLRPC$Peer instanceof TLRPC$TL_peerChannel) {
                this.currentForwardChannel = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(messageObject.messageOwner.fwd_from.from_id.channel_id));
            } else if (tLRPC$Peer instanceof TLRPC$TL_peerChat) {
                this.currentForwardChannel = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(messageObject.messageOwner.fwd_from.from_id.chat_id));
            } else if (tLRPC$Peer instanceof TLRPC$TL_peerUser) {
                this.currentForwardUser = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(messageObject.messageOwner.fwd_from.from_id.user_id));
            }
        }
        if (this.drawForwardedName && messageObject.needDrawForwarded() && ((groupedMessagePosition = this.currentPosition) == null || groupedMessagePosition.minY == 0)) {
            TLRPC$MessageFwdHeader tLRPC$MessageFwdHeader = messageObject.messageOwner.fwd_from;
            String str7 = tLRPC$MessageFwdHeader.from_name;
            if (str7 != null) {
                this.currentForwardName = str7;
            }
            TLRPC$User tLRPC$User = this.currentForwardUser;
            if (tLRPC$User != null || this.currentForwardChannel != null || this.currentForwardName != null) {
                TLRPC$Chat tLRPC$Chat2 = this.currentForwardChannel;
                if (tLRPC$Chat2 != null) {
                    if (tLRPC$User != null) {
                        this.currentForwardNameString = String.format("%s (%s)", tLRPC$Chat2.title, UserObject.getUserName(tLRPC$User));
                    } else if (!TextUtils.isEmpty(tLRPC$MessageFwdHeader.post_author)) {
                        this.currentForwardNameString = String.format("%s (%s)", this.currentForwardChannel.title, messageObject.messageOwner.fwd_from.post_author);
                    } else {
                        this.currentForwardNameString = this.currentForwardChannel.title;
                    }
                } else if (tLRPC$User != null) {
                    this.currentForwardNameString = UserObject.getUserName(tLRPC$User);
                } else {
                    this.currentForwardNameString = this.currentForwardName;
                }
                this.forwardedNameWidth = getMaxNameWidth();
                String forwardedMessageText = getForwardedMessageText(messageObject);
                if (this.hasPsaHint) {
                    this.forwardedNameWidth -= AndroidUtilities.dp(36.0f);
                }
                String string2 = LocaleController.getString("From", R.string.From);
                String string3 = LocaleController.getString("FromFormatted", R.string.FromFormatted);
                int indexOf = string3.indexOf("%1$s");
                TextPaint textPaint = Theme.chat_forwardNamePaint;
                int ceil3 = (int) Math.ceil(textPaint.measureText(string2 + " "));
                CharSequence ellipsize3 = TextUtils.ellipsize(this.currentForwardNameString.replace('\n', ' '), Theme.chat_replyNamePaint, (float) ((this.forwardedNameWidth - ceil3) - this.viaWidth), TextUtils.TruncateAt.END);
                try {
                    charSequence3 = String.format(string3, ellipsize3);
                } catch (Exception unused) {
                    charSequence3 = ellipsize3.toString();
                }
                if (replaceTags != null) {
                    spannableStringBuilder = new SpannableStringBuilder(String.format("%s %s %s", charSequence3, LocaleController.getString("ViaBot", R.string.ViaBot), str2));
                    this.viaNameWidth = (int) Math.ceil(Theme.chat_forwardNamePaint.measureText(charSequence3));
                    spannableStringBuilder.setSpan(new TypefaceSpan(AndroidUtilities.getTypeface(AndroidUtilities.TYPEFACE_ROBOTO_MEDIUM)), (spannableStringBuilder.length() - str2.length()) - 1, spannableStringBuilder.length(), 33);
                } else {
                    spannableStringBuilder = new SpannableStringBuilder(String.format(string3, ellipsize3));
                }
                this.forwardNameCenterX = ceil3 + (((int) Math.ceil(Theme.chat_forwardNamePaint.measureText(ellipsize3, 0, ellipsize3.length()))) / 2);
                if (indexOf >= 0 && (this.currentForwardName == null || messageObject.messageOwner.fwd_from.from_id != null)) {
                    spannableStringBuilder.setSpan(new TypefaceSpan(AndroidUtilities.getTypeface(AndroidUtilities.TYPEFACE_ROBOTO_MEDIUM)), indexOf, ellipsize3.length() + indexOf, 33);
                }
                CharSequence ellipsize4 = TextUtils.ellipsize(spannableStringBuilder, Theme.chat_forwardNamePaint, this.forwardedNameWidth, TextUtils.TruncateAt.END);
                try {
                    ellipsize4 = Emoji.replaceEmoji(ellipsize4, Theme.chat_forwardNamePaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
                } catch (Exception unused2) {
                }
                try {
                    this.forwardedNameLayout[1] = new StaticLayout(ellipsize4, Theme.chat_forwardNamePaint, this.forwardedNameWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                    this.forwardedNameLayout[0] = new StaticLayout(TextUtils.ellipsize(AndroidUtilities.replaceTags(forwardedMessageText), Theme.chat_forwardNamePaint, this.forwardedNameWidth, TextUtils.TruncateAt.END), Theme.chat_forwardNamePaint, this.forwardedNameWidth + AndroidUtilities.dp(2.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                    int max = Math.max((int) Math.ceil(this.forwardedNameLayout[0].getLineWidth(0)), (int) Math.ceil(this.forwardedNameLayout[1].getLineWidth(0)));
                    this.forwardedNameWidth = max;
                    if (this.hasPsaHint) {
                        this.forwardedNameWidth = max + AndroidUtilities.dp(36.0f);
                    }
                    this.forwardNameOffsetX[0] = this.forwardedNameLayout[0].getLineLeft(0);
                    this.forwardNameOffsetX[1] = this.forwardedNameLayout[1].getLineLeft(0);
                    if (messageObject.type != 5 && !messageObject.isAnyKindOfSticker()) {
                        this.namesOffset += AndroidUtilities.dp(36.0f);
                    }
                } catch (Exception e) {
                    FileLog.e(e);
                }
            }
        }
        if (((!this.isThreadChat || messageObject.getReplyTopMsgId() != 0) && messageObject.hasValidReplyMessageObject()) || (messageObject.messageOwner.fwd_from != null && messageObject.isDice())) {
            MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
            if (groupedMessagePosition2 == null || groupedMessagePosition2.minY == 0) {
                if (!messageObject.isAnyKindOfSticker() && messageObject.type != 5) {
                    int dp = this.namesOffset + AndroidUtilities.dp(42.0f);
                    this.namesOffset = dp;
                    if (messageObject.type != 0) {
                        this.namesOffset = dp + AndroidUtilities.dp(5.0f);
                    }
                }
                int maxNameWidth2 = getMaxNameWidth();
                if (!messageObject.shouldDrawWithoutBackground()) {
                    maxNameWidth2 -= AndroidUtilities.dp(10.0f);
                } else if (messageObject.type == 5) {
                    maxNameWidth2 += AndroidUtilities.dp(13.0f);
                }
                if ((!this.isThreadChat || messageObject.getReplyTopMsgId() != 0) && messageObject.hasValidReplyMessageObject()) {
                    MessageObject messageObject5 = messageObject.replyMessageObject;
                    this.lastReplyMessage = messageObject5.messageOwner;
                    TLRPC$PhotoSize closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(messageObject5.photoThumbs2, 320);
                    TLRPC$PhotoSize closestPhotoSizeWithSize2 = FileLoader.getClosestPhotoSizeWithSize(messageObject.replyMessageObject.photoThumbs2, 40);
                    MessageObject messageObject6 = messageObject.replyMessageObject;
                    TLObject tLObject = messageObject6.photoThumbsObject2;
                    if (closestPhotoSizeWithSize == null) {
                        if (messageObject6.mediaExists) {
                            closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(messageObject6.photoThumbs, AndroidUtilities.getPhotoSize());
                            i = closestPhotoSizeWithSize != null ? closestPhotoSizeWithSize.size : 0;
                            i4 = 0;
                        } else {
                            closestPhotoSizeWithSize = FileLoader.getClosestPhotoSizeWithSize(messageObject6.photoThumbs, 320);
                            i = 0;
                            i4 = 1;
                        }
                        i2 = i4;
                        tLRPC$PhotoSize = FileLoader.getClosestPhotoSizeWithSize(messageObject.replyMessageObject.photoThumbs, 40);
                        tLObject = messageObject.replyMessageObject.photoThumbsObject;
                    } else {
                        tLRPC$PhotoSize = closestPhotoSizeWithSize2;
                        i = 0;
                        i2 = 1;
                    }
                    if (tLRPC$PhotoSize == closestPhotoSizeWithSize) {
                        tLRPC$PhotoSize = null;
                    }
                    if (closestPhotoSizeWithSize == null || messageObject.replyMessageObject.isAnyKindOfSticker() || ((messageObject.isAnyKindOfSticker() && !AndroidUtilities.isTablet()) || messageObject.replyMessageObject.isSecretMedia() || messageObject.replyMessageObject.isWebpageDocument())) {
                        this.replyImageReceiver.setImageBitmap((Drawable) null);
                        this.needReplyImage = false;
                    } else {
                        if (messageObject.replyMessageObject.isRoundVideo()) {
                            this.replyImageReceiver.setRoundRadius(AndroidUtilities.dp(22.0f));
                        } else {
                            this.replyImageReceiver.setRoundRadius(AndroidUtilities.dp(2.0f));
                        }
                        this.currentReplyPhoto = closestPhotoSizeWithSize;
                        this.replyImageReceiver.setImage(ImageLocation.getForObject(closestPhotoSizeWithSize, tLObject), "50_50", ImageLocation.getForObject(tLRPC$PhotoSize, tLObject), "50_50_b", i, null, messageObject.replyMessageObject, i2);
                        this.needReplyImage = true;
                        maxNameWidth2 -= AndroidUtilities.dp(44.0f);
                    }
                    if (messageObject.hideSendersName) {
                        TLRPC$Peer tLRPC$Peer2 = messageObject.sendAsPeer;
                        if (tLRPC$Peer2 != null) {
                            if (tLRPC$Peer2.channel_id != 0) {
                                TLRPC$Chat chat = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(messageObject.sendAsPeer.channel_id));
                                str3 = chat != null ? chat.title : null;
                            } else {
                                str3 = UserObject.getUserName(MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(messageObject.sendAsPeer.user_id)));
                            }
                        } else {
                            str3 = UserObject.getUserName(AccountInstance.getInstance(this.currentAccount).getUserConfig().getCurrentUser());
                        }
                    } else {
                        str3 = messageObject.customReplyName;
                        if (str3 == null && (str3 = messageObject.replyMessageObject.getForwardedName()) == null) {
                            long fromChatId = messageObject.replyMessageObject.getFromChatId();
                            if (fromChatId > 0) {
                                TLRPC$User user2 = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(fromChatId));
                                if (user2 != null) {
                                    str3 = UserObject.getUserName(user2);
                                }
                            } else if (fromChatId < 0) {
                                TLRPC$Chat chat2 = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(-fromChatId));
                                if (chat2 != null) {
                                    str3 = chat2.title;
                                }
                            } else {
                                TLRPC$Chat chat3 = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(messageObject.replyMessageObject.messageOwner.peer_id.channel_id));
                                if (chat3 != null) {
                                    str3 = chat3.title;
                                }
                            }
                        }
                    }
                    if (str3 == null) {
                        str3 = LocaleController.getString("Loading", R.string.Loading);
                    }
                    if (MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC$TL_messageMediaGame) {
                        charSequence = TextUtils.ellipsize(Emoji.replaceEmoji(MessageObject.getMedia(messageObject.messageOwner).game.title, Theme.chat_replyTextPaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false), Theme.chat_replyTextPaint, maxNameWidth2, TextUtils.TruncateAt.END);
                    } else if (MessageObject.getMedia(messageObject.messageOwner) instanceof TLRPC$TL_messageMediaInvoice) {
                        charSequence = TextUtils.ellipsize(Emoji.replaceEmoji(MessageObject.getMedia(messageObject.messageOwner).title, Theme.chat_replyTextPaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false), Theme.chat_replyTextPaint, maxNameWidth2, TextUtils.TruncateAt.END);
                    } else if (!TextUtils.isEmpty(messageObject.replyMessageObject.caption)) {
                        String charSequence4 = messageObject.replyMessageObject.caption.toString();
                        if (charSequence4.length() > 150) {
                            charSequence4 = charSequence4.substring(0, ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                        }
                        CharSequence replaceEmoji = Emoji.replaceEmoji(charSequence4.replace('\n', ' '), Theme.chat_replyTextPaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
                        TLRPC$Message tLRPC$Message4 = messageObject.replyMessageObject.messageOwner;
                        if (tLRPC$Message4 != null) {
                            replaceEmoji = MessageObject.replaceAnimatedEmoji(replaceEmoji, tLRPC$Message4.entities, Theme.chat_replyTextPaint.getFontMetricsInt());
                        }
                        charSequence = TextUtils.ellipsize(replaceEmoji, Theme.chat_replyTextPaint, maxNameWidth2, TextUtils.TruncateAt.END);
                        if ((charSequence instanceof Spannable) && (tLRPC$Message = (messageObject2 = messageObject.replyMessageObject).messageOwner) != null) {
                            MediaDataController.addTextStyleRuns(tLRPC$Message.entities, messageObject2.caption, (Spannable) charSequence);
                        }
                    } else {
                        CharSequence charSequence5 = messageObject.replyMessageObject.messageText;
                        if (charSequence5 == null || charSequence5.length() <= 0) {
                            charSequence = null;
                        } else {
                            String charSequence6 = messageObject.replyMessageObject.messageText.toString();
                            if (charSequence6.length() > 150) {
                                charSequence6 = charSequence6.substring(0, ImageReceiver.DEFAULT_CROSSFADE_DURATION);
                            }
                            CharSequence replaceEmoji2 = Emoji.replaceEmoji(charSequence6.replace('\n', ' '), Theme.chat_replyTextPaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
                            TLRPC$Message tLRPC$Message5 = messageObject.replyMessageObject.messageOwner;
                            if (tLRPC$Message5 != null) {
                                replaceEmoji2 = MessageObject.replaceAnimatedEmoji(replaceEmoji2, tLRPC$Message5.entities, Theme.chat_replyTextPaint.getFontMetricsInt());
                            }
                            charSequence = TextUtils.ellipsize(replaceEmoji2, Theme.chat_replyTextPaint, maxNameWidth2, TextUtils.TruncateAt.END);
                            if (charSequence instanceof Spannable) {
                                MediaDataController.addTextStyleRuns(messageObject.replyMessageObject, (Spannable) charSequence);
                            }
                        }
                    }
                    i3 = maxNameWidth2;
                    charSequence2 = charSequence;
                    str4 = str3;
                } else {
                    charSequence2 = null;
                    this.replyImageReceiver.setImageBitmap((Drawable) null);
                    this.needReplyImage = false;
                    this.replyPanelIsForward = true;
                    TLRPC$Peer tLRPC$Peer3 = messageObject.messageOwner.fwd_from.from_id;
                    if (tLRPC$Peer3 instanceof TLRPC$TL_peerChannel) {
                        this.currentForwardChannel = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(messageObject.messageOwner.fwd_from.from_id.channel_id));
                    } else if (tLRPC$Peer3 instanceof TLRPC$TL_peerChat) {
                        this.currentForwardChannel = MessagesController.getInstance(this.currentAccount).getChat(Long.valueOf(messageObject.messageOwner.fwd_from.from_id.chat_id));
                    } else if (tLRPC$Peer3 instanceof TLRPC$TL_peerUser) {
                        this.currentForwardUser = MessagesController.getInstance(this.currentAccount).getUser(Long.valueOf(messageObject.messageOwner.fwd_from.from_id.user_id));
                    }
                    String str8 = messageObject.messageOwner.fwd_from.from_name;
                    if (str8 != null) {
                        this.currentForwardName = str8;
                    }
                    TLRPC$User tLRPC$User2 = this.currentForwardUser;
                    if (tLRPC$User2 == null && this.currentForwardChannel == null && this.currentForwardName == null) {
                        i3 = maxNameWidth2;
                        str4 = null;
                    } else {
                        TLRPC$Chat tLRPC$Chat3 = this.currentForwardChannel;
                        if (tLRPC$Chat3 != null) {
                            if (tLRPC$User2 != null) {
                                this.currentForwardNameString = String.format("%s (%s)", tLRPC$Chat3.title, UserObject.getUserName(tLRPC$User2));
                            } else {
                                this.currentForwardNameString = tLRPC$Chat3.title;
                            }
                        } else if (tLRPC$User2 != null) {
                            this.currentForwardNameString = UserObject.getUserName(tLRPC$User2);
                        } else {
                            this.currentForwardNameString = this.currentForwardName;
                        }
                        str4 = getForwardedMessageText(messageObject);
                        String string4 = LocaleController.getString("From", R.string.From);
                        String string5 = LocaleController.getString("FromFormatted", R.string.FromFormatted);
                        int indexOf2 = string5.indexOf("%1$s");
                        TextPaint textPaint2 = Theme.chat_replyNamePaint;
                        int ceil4 = (int) Math.ceil(textPaint2.measureText(string4 + " "));
                        String str9 = this.currentForwardNameString;
                        CharSequence ellipsize5 = TextUtils.ellipsize(str9 == null ? r15 : str9.replace('\n', ' '), Theme.chat_replyNamePaint, maxNameWidth2 - ceil4, TextUtils.TruncateAt.END);
                        SpannableStringBuilder spannableStringBuilder5 = new SpannableStringBuilder(String.format(string5, ellipsize5));
                        if (indexOf2 >= 0 && (this.currentForwardName == null || messageObject.messageOwner.fwd_from.from_id != null)) {
                            spannableStringBuilder5.setSpan(new TypefaceSpan(AndroidUtilities.getTypeface(AndroidUtilities.TYPEFACE_ROBOTO_MEDIUM)), indexOf2, ellipsize5.length() + indexOf2, 33);
                        }
                        CharSequence ellipsize6 = TextUtils.ellipsize(spannableStringBuilder5, Theme.chat_replyTextPaint, maxNameWidth2, TextUtils.TruncateAt.END);
                        this.forwardNameCenterX = ceil4 + (((int) Math.ceil(Theme.chat_replyNamePaint.measureText(ellipsize5, 0, ellipsize5.length()))) / 2);
                        charSequence2 = ellipsize6;
                        i3 = maxNameWidth2;
                    }
                }
                if (str4 != null) {
                    r15 = TextUtils.ellipsize(str4.replace('\n', ' '), Theme.chat_replyNamePaint, i3, TextUtils.TruncateAt.END);
                }
                try {
                    r15 = Emoji.replaceEmoji(r15, Theme.chat_replyNamePaint.getFontMetricsInt(), AndroidUtilities.dp(14.0f), false);
                } catch (Exception unused3) {
                }
                CharSequence charSequence7 = r15;
                try {
                    this.replyNameWidth = AndroidUtilities.dp((this.needReplyImage ? 44 : 0) + 4);
                    if (charSequence7 != null) {
                        StaticLayout staticLayout3 = new StaticLayout(charSequence7, Theme.chat_replyNamePaint, i3 + AndroidUtilities.dp(6.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        this.replyNameLayout = staticLayout3;
                        if (staticLayout3.getLineCount() > 0) {
                            this.replyNameWidth += ((int) Math.ceil(this.replyNameLayout.getLineWidth(0))) + AndroidUtilities.dp(8.0f);
                            this.replyNameOffset = (int) this.replyNameLayout.getLineLeft(0);
                        }
                    }
                } catch (Exception e2) {
                    FileLog.e(e2);
                }
                try {
                    this.replyTextWidth = AndroidUtilities.dp((this.needReplyImage ? 44 : 0) + 4);
                    if (charSequence2 != null) {
                        ?? spannableStringBuilder6 = new SpannableStringBuilder(charSequence2);
                        boolean z2 = false;
                        for (TextStyleSpan textStyleSpan : (TextStyleSpan[]) spannableStringBuilder6.getSpans(0, spannableStringBuilder6.length(), TextStyleSpan.class)) {
                            if ((textStyleSpan.getTextStyleRun().flags & 4) != 0) {
                                spannableStringBuilder6.removeSpan(textStyleSpan);
                                z2 = true;
                            }
                        }
                        if (z2) {
                            spannableStringBuilder6 = TextUtils.ellipsize(spannableStringBuilder6, Theme.chat_replyTextPaint, i3, TextUtils.TruncateAt.END);
                        }
                        StaticLayout staticLayout4 = new StaticLayout(spannableStringBuilder6, Theme.chat_replyTextPaint, i3 + AndroidUtilities.dp(10.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                        this.replyTextLayout = staticLayout4;
                        if (staticLayout4.getLineCount() > 0) {
                            this.replyTextWidth += ((int) Math.ceil(this.replyTextLayout.getLineWidth(0))) + AndroidUtilities.dp(8.0f);
                            this.replyTextOffset = (int) this.replyTextLayout.getLineLeft(0);
                        }
                        this.replySpoilers.clear();
                        if (getMessageObject().replyMessageObject != null && !getMessageObject().replyMessageObject.isSpoilersRevealed) {
                            SpoilerEffect.addSpoilers(this, this.replyTextLayout, this.replySpoilersPool, this.replySpoilers);
                        }
                        this.animatedEmojiReplyStack = AnimatedEmojiSpan.update(0, (View) this, false, this.animatedEmojiReplyStack, this.replyTextLayout);
                    }
                } catch (Exception e3) {
                    FileLog.e(e3);
                }
            }
        } else if (!this.isThreadChat && messageObject.getReplyMsgId() != 0 && ((messageObject3 = messageObject.replyMessageObject) == null || !(messageObject3.messageOwner instanceof TLRPC$TL_messageEmpty))) {
            if (!messageObject.isAnyKindOfSticker() && messageObject.type != 5) {
                int dp2 = this.namesOffset + AndroidUtilities.dp(42.0f);
                this.namesOffset = dp2;
                if (messageObject.type != 0) {
                    this.namesOffset = dp2 + AndroidUtilities.dp(5.0f);
                }
            }
            this.needReplyImage = false;
            int maxNameWidth3 = getMaxNameWidth();
            if (!messageObject.shouldDrawWithoutBackground()) {
                maxNameWidth3 -= AndroidUtilities.dp(10.0f);
            } else if (messageObject.type == 5) {
                maxNameWidth3 += AndroidUtilities.dp(13.0f);
            }
            StaticLayout staticLayout5 = new StaticLayout(LocaleController.getString("Loading", R.string.Loading), Theme.chat_replyNamePaint, maxNameWidth3 + AndroidUtilities.dp(6.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
            this.replyNameLayout = staticLayout5;
            if (staticLayout5.getLineCount() > 0) {
                this.replyNameWidth += ((int) Math.ceil(this.replyNameLayout.getLineWidth(0))) + AndroidUtilities.dp(8.0f);
                this.replyNameOffset = (int) this.replyNameLayout.getLineLeft(0);
            }
        }
        requestLayout();
    }

    private boolean isNeedAuthorName() {
        return (this.isPinnedChat && this.currentMessageObject.type == 0) || ((!this.pinnedTop || (ChatObject.isChannel(this.currentChat) && !this.currentChat.megagroup)) && this.drawName && this.isChat && (!this.currentMessageObject.isOutOwner() || (this.currentMessageObject.isSupergroup() && this.currentMessageObject.isFromGroup()))) || (this.currentMessageObject.isImportedForward() && this.currentMessageObject.messageOwner.fwd_from.from_id == null);
    }

    private String getAuthorName() {
        TLRPC$Chat tLRPC$Chat;
        String str;
        String str2;
        TLRPC$User tLRPC$User = this.currentUser;
        if (tLRPC$User != null) {
            return UserObject.getUserName(tLRPC$User);
        }
        TLRPC$Chat tLRPC$Chat2 = this.currentChat;
        if (tLRPC$Chat2 != null) {
            return tLRPC$Chat2.title;
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || !messageObject.isSponsored()) {
            return "DELETED";
        }
        TLRPC$ChatInvite tLRPC$ChatInvite = this.currentMessageObject.sponsoredChatInvite;
        return (tLRPC$ChatInvite == null || (str2 = tLRPC$ChatInvite.title) == null) ? (tLRPC$ChatInvite == null || (tLRPC$Chat = tLRPC$ChatInvite.chat) == null || (str = tLRPC$Chat.title) == null) ? "" : str : str2;
    }

    private Object getAuthorStatus() {
        TLRPC$User tLRPC$User = this.currentUser;
        if (tLRPC$User != null) {
            TLRPC$EmojiStatus tLRPC$EmojiStatus = tLRPC$User.emoji_status;
            if ((tLRPC$EmojiStatus instanceof TLRPC$TL_emojiStatusUntil) && ((TLRPC$TL_emojiStatusUntil) tLRPC$EmojiStatus).until > ((int) (System.currentTimeMillis() / 1000))) {
                return Long.valueOf(((TLRPC$TL_emojiStatusUntil) this.currentUser.emoji_status).document_id);
            }
            TLRPC$User tLRPC$User2 = this.currentUser;
            TLRPC$EmojiStatus tLRPC$EmojiStatus2 = tLRPC$User2.emoji_status;
            if (tLRPC$EmojiStatus2 instanceof TLRPC$TL_emojiStatus) {
                return Long.valueOf(((TLRPC$TL_emojiStatus) tLRPC$EmojiStatus2).document_id);
            }
            if (!tLRPC$User2.premium) {
                return null;
            }
            return ContextCompat.getDrawable(ApplicationLoader.applicationContext, R.drawable.msg_premium_liststar).mutate();
        }
        return null;
    }

    private String getForwardedMessageText(MessageObject messageObject) {
        if (this.hasPsaHint) {
            String string = LocaleController.getString("PsaMessage_" + messageObject.messageOwner.fwd_from.psa_type);
            return string == null ? LocaleController.getString("PsaMessageDefault", R.string.PsaMessageDefault) : string;
        }
        return LocaleController.getString("ForwardedMessage", R.string.ForwardedMessage);
    }

    public int getExtraInsetHeight() {
        int i = this.addedCaptionHeight;
        if (this.drawCommentButton) {
            i += AndroidUtilities.dp(shouldDrawTimeOnMedia() ? 41.3f : 43.0f);
        }
        return (this.reactionsLayoutInBubble.isEmpty || !this.currentMessageObject.shouldDrawReactionsInLayout()) ? i : i + this.reactionsLayoutInBubble.totalHeight;
    }

    public ImageReceiver getAvatarImage() {
        if (this.isAvatarVisible) {
            return this.avatarImage;
        }
        return null;
    }

    public float getCheckBoxTranslation() {
        return this.checkBoxTranslation;
    }

    public boolean shouldDrawAlphaLayer() {
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        return (groupedMessages == null || !groupedMessages.transitionParams.backgroundChangeBounds) && getAlpha() != 1.0f;
    }

    public float getCaptionX() {
        return this.captionX;
    }

    public boolean isDrawPinnedBottom() {
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        return this.mediaBackground || this.drawPinnedBottom || (groupedMessagePosition != null && (groupedMessagePosition.flags & 8) == 0 && this.currentMessagesGroup.isDocuments);
    }

    public void drawCheckBox(Canvas canvas) {
        float f;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.isSending() || this.currentMessageObject.isSendError() || this.checkBox == null) {
            return;
        }
        if (!this.checkBoxVisible && !this.checkBoxAnimationInProgress) {
            return;
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        if (groupedMessagePosition != null) {
            int i = groupedMessagePosition.flags;
            if ((i & 8) == 0 || (i & 1) == 0) {
                return;
            }
        }
        canvas.save();
        float y = getY();
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null && groupedMessages.messages.size() > 1) {
            f = (getTop() + this.currentMessagesGroup.transitionParams.offsetTop) - getTranslationY();
        } else {
            f = y + this.transitionParams.deltaTop;
        }
        canvas.translate(0.0f, f + this.transitionYOffsetForDrawables);
        this.checkBox.draw(canvas);
        canvas.restore();
    }

    /* JADX WARN: Removed duplicated region for block: B:20:0x0041  */
    /* JADX WARN: Removed duplicated region for block: B:30:0x0046  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void setBackgroundTopY(boolean z) {
        int i;
        int i2;
        int i3 = 0;
        while (i3 < 2) {
            if (i3 == 1 && !z) {
                return;
            }
            Theme.MessageDrawable messageDrawable = i3 == 0 ? this.currentBackgroundDrawable : this.currentBackgroundSelectedDrawable;
            if (messageDrawable != null) {
                int i4 = this.parentWidth;
                int i5 = this.parentHeight;
                if (i5 == 0) {
                    i4 = getParentWidth();
                    i5 = AndroidUtilities.displaySize.y;
                    if (getParent() instanceof View) {
                        View view = (View) getParent();
                        int measuredWidth = view.getMeasuredWidth();
                        i2 = view.getMeasuredHeight();
                        i = measuredWidth;
                        float y = !z ? getY() : getTop();
                        float f = this.parentViewTopOffset;
                        messageDrawable.setTop((int) (y + f), i, i2, (int) f, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, !this.pinnedBottom || this.transitionParams.changePinnedBottomProgress != 1.0f);
                    }
                }
                i = i4;
                i2 = i5;
                if (!z) {
                }
                float f2 = this.parentViewTopOffset;
                messageDrawable.setTop((int) (y + f2), i, i2, (int) f2, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, !this.pinnedBottom || this.transitionParams.changePinnedBottomProgress != 1.0f);
            }
            i3++;
        }
    }

    public void setBackgroundTopY(int i) {
        int i2;
        int i3;
        Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
        int i4 = this.parentWidth;
        int i5 = this.parentHeight;
        if (i5 == 0) {
            i4 = getParentWidth();
            i5 = AndroidUtilities.displaySize.y;
            if (getParent() instanceof View) {
                View view = (View) getParent();
                i3 = view.getMeasuredWidth();
                i2 = view.getMeasuredHeight();
                float f = this.parentViewTopOffset;
                messageDrawable.setTop((int) (i + f), i3, i2, (int) f, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, !this.pinnedBottom || this.transitionParams.changePinnedBottomProgress != 1.0f);
            }
        }
        i2 = i5;
        i3 = i4;
        float f2 = this.parentViewTopOffset;
        messageDrawable.setTop((int) (i + f2), i3, i2, (int) f2, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, !this.pinnedBottom || this.transitionParams.changePinnedBottomProgress != 1.0f);
    }

    public void setDrawableBoundsInner(Drawable drawable, int i, int i2, int i3, int i4) {
        if (drawable != null) {
            float f = i4 + i2;
            TransitionParams transitionParams = this.transitionParams;
            float f2 = transitionParams.deltaBottom;
            this.transitionYOffsetForDrawables = (f + f2) - ((int) (f + f2));
            drawable.setBounds((int) (i + transitionParams.deltaLeft), (int) (i2 + transitionParams.deltaTop), (int) (i + i3 + transitionParams.deltaRight), (int) (f + f2));
        }
    }

    @Override // android.view.View
    @SuppressLint({"WrongCall"})
    protected void onDraw(Canvas canvas) {
        int i;
        boolean z;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        Theme.MessageDrawable messageDrawable;
        int i2;
        int i3;
        int i4;
        int i5;
        if (this.currentMessageObject == null) {
            return;
        }
        if (!this.wasLayout) {
            onLayout(false, getLeft(), getTop(), getRight(), getBottom());
        }
        if (this.enterTransitionInProgress && this.currentMessageObject.isAnimatedEmojiStickers()) {
            return;
        }
        if (this.currentMessageObject.isOutOwner()) {
            Theme.chat_msgTextPaint.setColor(getThemedColor("chat_messageTextOut"));
            Theme.chat_msgGameTextPaint.setColor(getThemedColor("chat_messageTextOut"));
            Theme.chat_msgGameTextPaint.linkColor = getThemedColor("chat_messageLinkOut");
            Theme.chat_replyTextPaint.linkColor = getThemedColor("chat_messageLinkOut");
            Theme.chat_msgTextPaint.linkColor = getThemedColor("chat_messageLinkOut");
        } else {
            Theme.chat_msgTextPaint.setColor(getThemedColor("chat_messageTextIn"));
            Theme.chat_msgGameTextPaint.setColor(getThemedColor("chat_messageTextIn"));
            Theme.chat_msgGameTextPaint.linkColor = getThemedColor("chat_messageLinkIn");
            Theme.chat_replyTextPaint.linkColor = getThemedColor("chat_messageLinkIn");
            Theme.chat_msgTextPaint.linkColor = getThemedColor("chat_messageLinkIn");
        }
        if (this.documentAttach != null) {
            int i6 = this.documentAttachType;
            if (i6 == 3) {
                if (this.currentMessageObject.isOutOwner()) {
                    this.seekBarWaveform.setColors(getThemedColor("chat_outVoiceSeekbar"), getThemedColor("chat_outVoiceSeekbarFill"), getThemedColor("chat_outVoiceSeekbarSelected"));
                    this.seekBar.setColors(getThemedColor("chat_outAudioSeekbar"), getThemedColor("chat_outAudioCacheSeekbar"), getThemedColor("chat_outAudioSeekbarFill"), getThemedColor("chat_outAudioSeekbarFill"), getThemedColor("chat_outAudioSeekbarSelected"));
                } else {
                    this.seekBarWaveform.setColors(getThemedColor("chat_inVoiceSeekbar"), getThemedColor("chat_inVoiceSeekbarFill"), getThemedColor("chat_inVoiceSeekbarSelected"));
                    this.seekBar.setColors(getThemedColor("chat_inAudioSeekbar"), getThemedColor("chat_inAudioCacheSeekbar"), getThemedColor("chat_inAudioSeekbarFill"), getThemedColor("chat_inAudioSeekbarFill"), getThemedColor("chat_inAudioSeekbarSelected"));
                }
            } else if (i6 == 5) {
                if (this.currentMessageObject.isOutOwner()) {
                    this.seekBar.setColors(getThemedColor("chat_outAudioSeekbar"), getThemedColor("chat_outAudioCacheSeekbar"), getThemedColor("chat_outAudioSeekbarFill"), getThemedColor("chat_outAudioSeekbarFill"), getThemedColor("chat_outAudioSeekbarSelected"));
                } else {
                    this.seekBar.setColors(getThemedColor("chat_inAudioSeekbar"), getThemedColor("chat_inAudioCacheSeekbar"), getThemedColor("chat_inAudioSeekbarFill"), getThemedColor("chat_inAudioSeekbarFill"), getThemedColor("chat_inAudioSeekbarSelected"));
                }
            }
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject.type == 5) {
            Theme.chat_timePaint.setColor(getThemedColor("chat_serviceText"));
        } else if (this.mediaBackground) {
            if (messageObject.shouldDrawWithoutBackground()) {
                Theme.chat_timePaint.setColor(getThemedColor("chat_serviceText"));
            } else {
                Theme.chat_timePaint.setColor(getThemedColor("chat_mediaTimeText"));
            }
        } else if (messageObject.isOutOwner()) {
            Theme.chat_timePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outTimeSelectedText" : "chat_outTimeText"));
        } else {
            Theme.chat_timePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inTimeSelectedText" : "chat_inTimeText"));
        }
        drawBackgroundInternal(canvas, false);
        long j = 17;
        if (this.isHighlightedAnimated) {
            long currentTimeMillis = System.currentTimeMillis();
            long abs = Math.abs(currentTimeMillis - this.lastHighlightProgressTime);
            if (abs > 17) {
                abs = 17;
            }
            int i7 = (int) (this.highlightProgress - abs);
            this.highlightProgress = i7;
            this.lastHighlightProgressTime = currentTimeMillis;
            if (i7 <= 0) {
                this.highlightProgress = 0;
                this.isHighlightedAnimated = false;
            }
            invalidate();
            if (getParent() != null) {
                ((View) getParent()).invalidate();
            }
        }
        if (this.alphaInternal != 1.0f) {
            int measuredHeight = getMeasuredHeight();
            int measuredWidth = getMeasuredWidth();
            Theme.MessageDrawable messageDrawable2 = this.currentBackgroundDrawable;
            if (messageDrawable2 != null) {
                i5 = messageDrawable2.getBounds().top;
                i4 = this.currentBackgroundDrawable.getBounds().bottom;
                i3 = this.currentBackgroundDrawable.getBounds().left;
                i2 = this.currentBackgroundDrawable.getBounds().right;
            } else {
                i2 = measuredWidth;
                i3 = 0;
                i4 = measuredHeight;
                i5 = 0;
            }
            if (this.drawSideButton != 0) {
                if (this.currentMessageObject.isOutOwner()) {
                    i3 -= AndroidUtilities.dp(40.0f);
                } else {
                    i2 += AndroidUtilities.dp(40.0f);
                }
            }
            if (getY() < 0.0f) {
                i5 = (int) (-getY());
            }
            float y = getY() + getMeasuredHeight();
            int i8 = this.parentHeight;
            if (y > i8) {
                i4 = (int) (i8 - getY());
            }
            this.rect.set(i3, i5, i2, i4);
            i = canvas.saveLayerAlpha(this.rect, (int) (this.alphaInternal * 255.0f), 31);
        } else {
            i = Integer.MIN_VALUE;
        }
        if (!this.transitionParams.animateBackgroundBoundsInner || (messageDrawable = this.currentBackgroundDrawable) == null || this.isRoundVideo) {
            z = false;
        } else {
            Rect bounds = messageDrawable.getBounds();
            canvas.save();
            canvas.clipRect(bounds.left + AndroidUtilities.dp(4.0f), bounds.top + AndroidUtilities.dp(4.0f), bounds.right - AndroidUtilities.dp(4.0f), bounds.bottom - AndroidUtilities.dp(4.0f));
            z = true;
        }
        drawContent(canvas);
        if (z) {
            canvas.restore();
        }
        ChatMessageCellDelegate chatMessageCellDelegate = this.delegate;
        if (chatMessageCellDelegate == null || chatMessageCellDelegate.canDrawOutboundsContent() || this.transitionParams.messageEntering || getAlpha() != 1.0f) {
            drawOutboundsContent(canvas);
        }
        if (this.replyNameLayout != null) {
            float f = 12.0f;
            if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                if (this.currentMessageObject.isOutOwner()) {
                    int dp = AndroidUtilities.dp(23.0f);
                    this.replyStartX = dp;
                    if (this.isPlayingRound) {
                        this.replyStartX = dp - (AndroidUtilities.roundPlayingMessageSize - AndroidUtilities.roundMessageSize);
                    }
                } else if (this.currentMessageObject.type == 5) {
                    this.replyStartX = this.backgroundDrawableLeft + this.backgroundDrawableRight + AndroidUtilities.dp(4.0f);
                } else {
                    this.replyStartX = this.backgroundDrawableLeft + this.backgroundDrawableRight + AndroidUtilities.dp(17.0f);
                }
                if (this.drawForwardedName) {
                    this.replyStartY = this.forwardNameY + AndroidUtilities.dp(38.0f);
                } else {
                    this.replyStartY = AndroidUtilities.dp(12.0f);
                }
            } else {
                if (this.currentMessageObject.isOutOwner()) {
                    this.replyStartX = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                } else if (this.mediaBackground) {
                    this.replyStartX = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f) + getExtraTextX();
                } else {
                    int i9 = this.backgroundDrawableLeft;
                    if (!this.drawPinnedBottom) {
                        f = 18.0f;
                    }
                    this.replyStartX = i9 + AndroidUtilities.dp(f) + getExtraTextX();
                }
                this.replyStartY = AndroidUtilities.dp(12 + ((!this.drawForwardedName || this.forwardedNameLayout[0] == null) ? 0 : 36) + ((!this.drawNameLayout || this.nameLayout == null) ? 0 : 20));
            }
        }
        if (this.currentPosition == null && !this.transitionParams.animateBackgroundBoundsInner && (!this.enterTransitionInProgress || this.currentMessageObject.isVoice())) {
            drawNamesLayout(canvas, 1.0f);
        }
        if ((!this.autoPlayingMedia || !MediaController.getInstance().isPlayingMessageAndReadyToDraw(this.currentMessageObject) || this.isRoundVideo) && !this.transitionParams.animateBackgroundBoundsInner) {
            drawOverlays(canvas);
        }
        if ((this.drawTime || !this.mediaBackground) && !this.forceNotDrawTime && !this.transitionParams.animateBackgroundBoundsInner && (!this.enterTransitionInProgress || this.currentMessageObject.isVoice())) {
            drawTime(canvas, 1.0f, false);
        }
        if ((this.controlsAlpha != 1.0f || this.timeAlpha != 1.0f) && this.currentMessageObject.type != 5) {
            long currentTimeMillis2 = System.currentTimeMillis();
            long abs2 = Math.abs(this.lastControlsAlphaChangeTime - currentTimeMillis2);
            if (abs2 <= 17) {
                j = abs2;
            }
            long j2 = this.totalChangeTime + j;
            this.totalChangeTime = j2;
            if (j2 > 200) {
                this.totalChangeTime = 200L;
            }
            this.lastControlsAlphaChangeTime = currentTimeMillis2;
            if (this.controlsAlpha != 1.0f) {
                this.controlsAlpha = AndroidUtilities.decelerateInterpolator.getInterpolation(((float) this.totalChangeTime) / 200.0f);
            }
            if (this.timeAlpha != 1.0f) {
                this.timeAlpha = AndroidUtilities.decelerateInterpolator.getInterpolation(((float) this.totalChangeTime) / 200.0f);
            }
            invalidate();
            if (this.forceNotDrawTime && (groupedMessagePosition = this.currentPosition) != null && groupedMessagePosition.last && getParent() != null) {
                ((View) getParent()).invalidate();
            }
        }
        if (this.drawBackground && shouldDrawSelectionOverlay() && this.currentMessagesGroup == null) {
            if (this.selectionOverlayPaint == null) {
                this.selectionOverlayPaint = new Paint(1);
            }
            this.selectionOverlayPaint.setColor(getSelectionOverlayColor().intValue());
            int alpha = this.selectionOverlayPaint.getAlpha();
            this.selectionOverlayPaint.setAlpha((int) (alpha * getHighlightAlpha() * getAlpha()));
            if (this.selectionOverlayPaint.getAlpha() > 0) {
                canvas.save();
                canvas.clipRect(0, 0, getMeasuredWidth(), getMeasuredHeight());
                this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams, this.selectionOverlayPaint);
                canvas.restore();
            }
            this.selectionOverlayPaint.setAlpha(alpha);
        }
        if (i != Integer.MIN_VALUE) {
            canvas.restoreToCount(i);
        }
        updateSelectionTextPosition();
    }

    @SuppressLint({"WrongCall"})
    public void drawBackgroundInternal(Canvas canvas, boolean z) {
        float f;
        Drawable shadowDrawable;
        int i;
        int i2;
        int dp;
        Drawable drawable;
        int i3;
        boolean z2;
        MessageObject.GroupedMessages groupedMessages;
        Theme.MessageDrawable messageDrawable;
        int i4;
        int i5;
        int i6;
        int dp2;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        Drawable shadowDrawable2;
        int i7;
        int i8;
        int i9;
        int dp3;
        if (this.currentMessageObject == null) {
            return;
        }
        boolean z3 = this.wasLayout;
        if (!z3 && !this.animationRunning) {
            forceLayout();
            return;
        }
        if (!z3) {
            onLayout(false, getLeft(), getTop(), getRight(), getBottom());
        }
        MessageObject.GroupedMessagePosition groupedMessagePosition2 = this.currentPosition;
        boolean z4 = groupedMessagePosition2 != null && (groupedMessagePosition2.flags & 8) == 0 && this.currentMessagesGroup.isDocuments && !this.drawPinnedBottom;
        if (this.currentMessageObject.isOutOwner()) {
            if (this.transitionParams.changePinnedBottomProgress >= 1.0f && !this.mediaBackground && !this.drawPinnedBottom && !z4) {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOut");
                this.currentBackgroundSelectedDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOutSelected");
                this.transitionParams.drawPinnedBottomBackground = false;
            } else {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOutMedia");
                this.currentBackgroundSelectedDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOutMediaSelected");
                this.transitionParams.drawPinnedBottomBackground = true;
            }
            setBackgroundTopY(true);
            if (isDrawSelectionBackground() && (this.currentPosition == null || getBackground() != null)) {
                shadowDrawable2 = this.currentBackgroundSelectedDrawable.getShadowDrawable();
            } else {
                shadowDrawable2 = this.currentBackgroundDrawable.getShadowDrawable();
            }
            Drawable drawable2 = shadowDrawable2;
            this.backgroundDrawableLeft = (this.layoutWidth - this.backgroundWidth) - (!this.mediaBackground ? 0 : AndroidUtilities.dp(9.0f));
            int dp4 = this.backgroundWidth - (this.mediaBackground ? 0 : AndroidUtilities.dp(3.0f));
            this.backgroundDrawableRight = dp4;
            MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
            if (groupedMessages2 != null && !groupedMessages2.isDocuments && !this.currentPosition.edge) {
                this.backgroundDrawableRight = dp4 + AndroidUtilities.dp(10.0f);
            }
            int i10 = this.backgroundDrawableLeft;
            if (!z4 && this.transitionParams.changePinnedBottomProgress != 1.0f) {
                if (!this.mediaBackground) {
                    this.backgroundDrawableRight -= AndroidUtilities.dp(6.0f);
                }
            } else if (!this.mediaBackground && this.drawPinnedBottom) {
                this.backgroundDrawableRight -= AndroidUtilities.dp(6.0f);
            }
            MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
            if (groupedMessagePosition3 != null) {
                if ((groupedMessagePosition3.flags & 2) == 0) {
                    this.backgroundDrawableRight += AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                }
                if ((this.currentPosition.flags & 1) == 0) {
                    i10 -= AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                    this.backgroundDrawableRight += AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                }
                if ((this.currentPosition.flags & 4) == 0) {
                    i8 = 0 - AndroidUtilities.dp(SharedConfig.bubbleRadius + 3);
                    i9 = AndroidUtilities.dp(SharedConfig.bubbleRadius + 3) + 0;
                } else {
                    i8 = 0;
                    i9 = 0;
                }
                if ((this.currentPosition.flags & 8) == 0) {
                    i9 += AndroidUtilities.dp(SharedConfig.bubbleRadius + 3);
                }
                i7 = i10;
            } else {
                i7 = i10;
                i8 = 0;
                i9 = 0;
            }
            boolean z5 = this.drawPinnedBottom;
            if (z5 && this.drawPinnedTop) {
                dp3 = 0;
            } else if (z5) {
                dp3 = AndroidUtilities.dp(1.0f);
            } else {
                dp3 = AndroidUtilities.dp(2.0f);
            }
            int dp5 = i8 + (this.drawPinnedTop ? 0 : AndroidUtilities.dp(1.0f));
            this.backgroundDrawableTop = dp5;
            int i11 = (this.layoutHeight - dp3) + i9;
            if (z4) {
                setDrawableBoundsInner(this.currentBackgroundDrawable, i7, dp5 - i8, this.backgroundDrawableRight, (i11 - i9) + 10);
                setDrawableBoundsInner(this.currentBackgroundSelectedDrawable, this.backgroundDrawableLeft, this.backgroundDrawableTop, this.backgroundDrawableRight - AndroidUtilities.dp(6.0f), i11);
            } else {
                int i12 = i7;
                setDrawableBoundsInner(this.currentBackgroundDrawable, i12, dp5, this.backgroundDrawableRight, i11);
                setDrawableBoundsInner(this.currentBackgroundSelectedDrawable, i12, this.backgroundDrawableTop, this.backgroundDrawableRight, i11);
            }
            setDrawableBoundsInner(drawable2, i7, this.backgroundDrawableTop, this.backgroundDrawableRight, i11);
            drawable = drawable2;
            f = 1.0f;
        } else {
            f = 1.0f;
            if (this.transitionParams.changePinnedBottomProgress >= 1.0f && !this.mediaBackground && !this.drawPinnedBottom && !z4) {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgIn");
                this.currentBackgroundSelectedDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgInSelected");
                this.transitionParams.drawPinnedBottomBackground = false;
            } else {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgInMedia");
                this.currentBackgroundSelectedDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgInMediaSelected");
                this.transitionParams.drawPinnedBottomBackground = true;
            }
            setBackgroundTopY(true);
            if (isDrawSelectionBackground() && (this.currentPosition == null || getBackground() != null)) {
                shadowDrawable = this.currentBackgroundSelectedDrawable.getShadowDrawable();
            } else {
                shadowDrawable = this.currentBackgroundDrawable.getShadowDrawable();
            }
            Drawable drawable3 = shadowDrawable;
            this.backgroundDrawableLeft = AndroidUtilities.dp(((!this.isChat || !this.isAvatarVisible) ? 0 : 48) + (!this.mediaBackground ? 3 : 9));
            this.backgroundDrawableRight = this.backgroundWidth - (this.mediaBackground ? 0 : AndroidUtilities.dp(3.0f));
            MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
            if (groupedMessages3 != null && !groupedMessages3.isDocuments) {
                if (!this.currentPosition.edge) {
                    this.backgroundDrawableLeft -= AndroidUtilities.dp(10.0f);
                    this.backgroundDrawableRight += AndroidUtilities.dp(10.0f);
                }
                if (this.currentPosition.leftSpanOffset != 0) {
                    this.backgroundDrawableLeft += (int) Math.ceil((i3 / 1000.0f) * getGroupPhotosWidth());
                }
            }
            boolean z6 = this.mediaBackground;
            if ((!z6 && this.drawPinnedBottom) || (!z4 && this.transitionParams.changePinnedBottomProgress != 1.0f)) {
                if (this.drawPinnedBottom || !z6) {
                    this.backgroundDrawableRight -= AndroidUtilities.dp(6.0f);
                }
                if (!this.mediaBackground) {
                    this.backgroundDrawableLeft += AndroidUtilities.dp(6.0f);
                }
            }
            MessageObject.GroupedMessagePosition groupedMessagePosition4 = this.currentPosition;
            if (groupedMessagePosition4 != null) {
                if ((groupedMessagePosition4.flags & 2) == 0) {
                    this.backgroundDrawableRight += AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                }
                if ((this.currentPosition.flags & 1) == 0) {
                    this.backgroundDrawableLeft -= AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                    this.backgroundDrawableRight += AndroidUtilities.dp(SharedConfig.bubbleRadius + 2);
                }
                if ((this.currentPosition.flags & 4) == 0) {
                    i = 0 - AndroidUtilities.dp(SharedConfig.bubbleRadius + 3);
                    i2 = AndroidUtilities.dp(SharedConfig.bubbleRadius + 3) + 0;
                } else {
                    i = 0;
                    i2 = 0;
                }
                if ((this.currentPosition.flags & 8) == 0) {
                    i2 += AndroidUtilities.dp(SharedConfig.bubbleRadius + 4);
                }
            } else {
                i = 0;
                i2 = 0;
            }
            boolean z7 = this.drawPinnedBottom;
            if (z7 && this.drawPinnedTop) {
                dp = 0;
            } else if (z7) {
                dp = AndroidUtilities.dp(1.0f);
            } else {
                dp = AndroidUtilities.dp(2.0f);
            }
            int dp6 = (this.drawPinnedTop ? 0 : AndroidUtilities.dp(1.0f)) + i;
            this.backgroundDrawableTop = dp6;
            int i13 = (this.layoutHeight - dp) + i2;
            setDrawableBoundsInner(this.currentBackgroundDrawable, this.backgroundDrawableLeft, dp6, this.backgroundDrawableRight, i13);
            if (z4) {
                setDrawableBoundsInner(this.currentBackgroundSelectedDrawable, AndroidUtilities.dp(6.0f) + this.backgroundDrawableLeft, this.backgroundDrawableTop, this.backgroundDrawableRight - AndroidUtilities.dp(6.0f), i13);
            } else {
                setDrawableBoundsInner(this.currentBackgroundSelectedDrawable, this.backgroundDrawableLeft, this.backgroundDrawableTop, this.backgroundDrawableRight, i13);
            }
            setDrawableBoundsInner(drawable3, this.backgroundDrawableLeft, this.backgroundDrawableTop, this.backgroundDrawableRight, i13);
            drawable = drawable3;
        }
        if (!this.currentMessageObject.isOutOwner() && this.transitionParams.changePinnedBottomProgress != f && !this.mediaBackground && !this.drawPinnedBottom) {
            this.backgroundDrawableLeft -= AndroidUtilities.dp(6.0f);
            this.backgroundDrawableRight += AndroidUtilities.dp(6.0f);
        }
        if (this.hasPsaHint) {
            MessageObject.GroupedMessagePosition groupedMessagePosition5 = this.currentPosition;
            if (groupedMessagePosition5 == null || (groupedMessagePosition5.flags & 2) != 0) {
                i6 = this.currentBackgroundDrawable.getBounds().right;
            } else {
                int groupPhotosWidth = getGroupPhotosWidth();
                i6 = 0;
                for (int i14 = 0; i14 < this.currentMessagesGroup.posArray.size(); i14++) {
                    if (this.currentMessagesGroup.posArray.get(i14).minY != 0) {
                        break;
                    }
                    double d = i6;
                    double ceil = Math.ceil(((groupedMessagePosition.pw + groupedMessagePosition.leftSpanOffset) / 1000.0f) * groupPhotosWidth);
                    Double.isNaN(d);
                    i6 = (int) (d + ceil);
                }
            }
            Drawable drawable4 = Theme.chat_psaHelpDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0];
            if (this.currentMessageObject.type == 5) {
                dp2 = AndroidUtilities.dp(12.0f);
            } else {
                dp2 = AndroidUtilities.dp((this.drawNameLayout ? 19 : 0) + 10);
            }
            this.psaHelpX = (i6 - drawable4.getIntrinsicWidth()) - AndroidUtilities.dp(this.currentMessageObject.isOutOwner() ? 20.0f : 14.0f);
            this.psaHelpY = dp2 + AndroidUtilities.dp(4.0f);
        }
        boolean z8 = this.checkBoxVisible;
        if (z8 || this.checkBoxAnimationInProgress) {
            if ((z8 && this.checkBoxAnimationProgress == f) || (!z8 && this.checkBoxAnimationProgress == 0.0f)) {
                this.checkBoxAnimationInProgress = false;
            }
            this.checkBoxTranslation = (int) Math.ceil((z8 ? CubicBezierInterpolator.EASE_OUT : CubicBezierInterpolator.EASE_IN).getInterpolation(this.checkBoxAnimationProgress) * AndroidUtilities.dp(35.0f));
            if (!this.currentMessageObject.isOutOwner()) {
                updateTranslation();
            }
            int dp7 = AndroidUtilities.dp(21.0f);
            this.checkBox.setBounds(AndroidUtilities.dp(-27.0f) + this.checkBoxTranslation, (this.currentBackgroundDrawable.getBounds().bottom - AndroidUtilities.dp(8.0f)) - dp7, dp7, dp7);
            if (this.checkBoxAnimationInProgress) {
                long elapsedRealtime = SystemClock.elapsedRealtime();
                long j = elapsedRealtime - this.lastCheckBoxAnimationTime;
                this.lastCheckBoxAnimationTime = elapsedRealtime;
                if (this.checkBoxVisible) {
                    float f2 = this.checkBoxAnimationProgress + (((float) j) / 200.0f);
                    this.checkBoxAnimationProgress = f2;
                    if (f2 > f) {
                        this.checkBoxAnimationProgress = f;
                    }
                } else {
                    float f3 = this.checkBoxAnimationProgress - (((float) j) / 200.0f);
                    this.checkBoxAnimationProgress = f3;
                    if (f3 <= 0.0f) {
                        this.checkBoxAnimationProgress = 0.0f;
                    }
                }
                invalidate();
                ((View) getParent()).invalidate();
            }
        }
        if (!z && drawBackgroundInParent()) {
            return;
        }
        if (this.transitionYOffsetForDrawables != 0.0f) {
            canvas.save();
            canvas.translate(0.0f, this.transitionYOffsetForDrawables);
            z2 = true;
        } else {
            z2 = false;
        }
        if (this.drawBackground && this.currentBackgroundDrawable != null && ((this.currentPosition == null || (isDrawSelectionBackground() && (this.currentMessageObject.isMusic() || this.currentMessageObject.isDocument()))) && (!this.enterTransitionInProgress || this.currentMessageObject.isVoice()))) {
            float f4 = this.alphaInternal;
            if (z) {
                f4 *= getAlpha();
            }
            if (hasSelectionOverlay()) {
                this.currentSelectedBackgroundAlpha = 0.0f;
                int i15 = (int) (f4 * 255.0f);
                this.currentBackgroundDrawable.setAlpha(i15);
                this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                if (drawable != null && this.currentPosition == null) {
                    drawable.setAlpha(i15);
                    drawable.draw(canvas);
                }
            } else {
                if (this.isHighlightedAnimated) {
                    this.currentBackgroundDrawable.setAlpha((int) (f4 * 255.0f));
                    this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                    float highlightAlpha = getHighlightAlpha();
                    this.currentSelectedBackgroundAlpha = highlightAlpha;
                    if (this.currentPosition == null) {
                        this.currentBackgroundSelectedDrawable.setAlpha((int) (highlightAlpha * f4 * 255.0f));
                        this.currentBackgroundSelectedDrawable.drawCached(canvas, this.backgroundCacheParams);
                    }
                } else if (this.selectedBackgroundProgress != 0.0f && ((groupedMessages = this.currentMessagesGroup) == null || !groupedMessages.isDocuments)) {
                    this.currentBackgroundDrawable.setAlpha((int) (f4 * 255.0f));
                    this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                    float f5 = this.selectedBackgroundProgress;
                    this.currentSelectedBackgroundAlpha = f5;
                    this.currentBackgroundSelectedDrawable.setAlpha((int) (f5 * f4 * 255.0f));
                    this.currentBackgroundSelectedDrawable.drawCached(canvas, this.backgroundCacheParams);
                    if (this.currentBackgroundDrawable.getGradientShader() == null) {
                        drawable = null;
                    }
                } else if (isDrawSelectionBackground() && (this.currentPosition == null || this.currentMessageObject.isMusic() || this.currentMessageObject.isDocument() || getBackground() != null)) {
                    if (this.currentPosition != null) {
                        canvas.save();
                        canvas.clipRect(0, 0, getMeasuredWidth(), getMeasuredHeight());
                    }
                    this.currentSelectedBackgroundAlpha = f;
                    this.currentBackgroundSelectedDrawable.setAlpha((int) (f4 * 255.0f));
                    this.currentBackgroundSelectedDrawable.drawCached(canvas, this.backgroundCacheParams);
                    if (this.currentPosition != null) {
                        canvas.restore();
                    }
                } else {
                    this.currentSelectedBackgroundAlpha = 0.0f;
                    this.currentBackgroundDrawable.setAlpha((int) (f4 * 255.0f));
                    this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                }
                if (drawable != null && this.currentPosition == null) {
                    drawable.setAlpha((int) (f4 * 255.0f));
                    drawable.draw(canvas);
                }
                if (this.transitionParams.changePinnedBottomProgress != f && this.currentPosition == null) {
                    if (this.currentMessageObject.isOutOwner()) {
                        Theme.MessageDrawable messageDrawable2 = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOut");
                        Rect bounds = this.currentBackgroundDrawable.getBounds();
                        messageDrawable2.setBounds(bounds.left, bounds.top, bounds.right + AndroidUtilities.dp(6.0f), bounds.bottom);
                        canvas.save();
                        canvas.clipRect(bounds.right - AndroidUtilities.dp(12.0f), bounds.bottom - AndroidUtilities.dp(16.0f), bounds.right + AndroidUtilities.dp(12.0f), bounds.bottom);
                        int i16 = this.parentWidth;
                        int i17 = this.parentHeight;
                        if (i17 == 0) {
                            i16 = getParentWidth();
                            i17 = AndroidUtilities.displaySize.y;
                            if (getParent() instanceof View) {
                                View view = (View) getParent();
                                int measuredWidth = view.getMeasuredWidth();
                                i5 = view.getMeasuredHeight();
                                i4 = measuredWidth;
                                float y = getY();
                                float f6 = this.parentViewTopOffset;
                                messageDrawable2.setTop((int) (y + f6), i4, i5, (int) f6, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, this.pinnedBottom);
                                messageDrawable2.setAlpha((int) (((!this.mediaBackground || this.pinnedBottom) ? f - this.transitionParams.changePinnedBottomProgress : this.transitionParams.changePinnedBottomProgress) * 255.0f));
                                messageDrawable2.draw(canvas);
                                messageDrawable2.setAlpha(255);
                                canvas.restore();
                            }
                        }
                        i4 = i16;
                        i5 = i17;
                        float y2 = getY();
                        float f62 = this.parentViewTopOffset;
                        messageDrawable2.setTop((int) (y2 + f62), i4, i5, (int) f62, this.blurredViewTopOffset, this.blurredViewBottomOffset, this.pinnedTop, this.pinnedBottom);
                        messageDrawable2.setAlpha((int) (((!this.mediaBackground || this.pinnedBottom) ? f - this.transitionParams.changePinnedBottomProgress : this.transitionParams.changePinnedBottomProgress) * 255.0f));
                        messageDrawable2.draw(canvas);
                        messageDrawable2.setAlpha(255);
                        canvas.restore();
                    } else {
                        if (this.transitionParams.drawPinnedBottomBackground) {
                            messageDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgIn");
                        } else {
                            messageDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgInMedia");
                        }
                        messageDrawable.setAlpha((int) (((this.mediaBackground || this.pinnedBottom) ? f - this.transitionParams.changePinnedBottomProgress : this.transitionParams.changePinnedBottomProgress) * 255.0f));
                        Rect bounds2 = this.currentBackgroundDrawable.getBounds();
                        messageDrawable.setBounds(bounds2.left - AndroidUtilities.dp(6.0f), bounds2.top, bounds2.right, bounds2.bottom);
                        canvas.save();
                        canvas.clipRect(bounds2.left - AndroidUtilities.dp(6.0f), bounds2.bottom - AndroidUtilities.dp(16.0f), bounds2.left + AndroidUtilities.dp(6.0f), bounds2.bottom);
                        messageDrawable.draw(canvas);
                        messageDrawable.setAlpha(255);
                        canvas.restore();
                    }
                }
            }
        }
        if (!z2) {
            return;
        }
        canvas.restore();
    }

    public boolean drawBackgroundInParent() {
        MessageObject messageObject;
        if (!this.canDrawBackgroundInParent || (messageObject = this.currentMessageObject) == null || !messageObject.isOutOwner()) {
            return false;
        }
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        return resourcesProvider != null ? resourcesProvider.getCurrentColor("chat_outBubbleGradient") != null : Theme.getColorOrNull("chat_outBubbleGradient") != null;
    }

    public void drawCommentButton(Canvas canvas, float f) {
        if (this.drawSideButton != 3) {
            return;
        }
        int dp = AndroidUtilities.dp(32.0f);
        if (this.commentLayout != null) {
            this.sideStartY -= AndroidUtilities.dp(18.0f);
            dp += AndroidUtilities.dp(18.0f);
        }
        RectF rectF = this.rect;
        float f2 = this.sideStartX;
        rectF.set(f2, this.sideStartY, AndroidUtilities.dp(32.0f) + f2, this.sideStartY + dp);
        applyServiceShaderMatrix();
        String str = "paintChatActionBackground";
        if (f != 1.0f) {
            int alpha = getThemedPaint(str).getAlpha();
            getThemedPaint(str).setAlpha((int) (alpha * f));
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), getThemedPaint(str));
            getThemedPaint(str).setAlpha(alpha);
        } else {
            RectF rectF2 = this.rect;
            float dp2 = AndroidUtilities.dp(16.0f);
            float dp3 = AndroidUtilities.dp(16.0f);
            if (this.sideButtonPressed) {
                str = "paintChatActionBackgroundSelected";
            }
            canvas.drawRoundRect(rectF2, dp2, dp3, getThemedPaint(str));
        }
        if (hasGradientService()) {
            if (f != 1.0f) {
                int alpha2 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha2 * f));
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha2);
            } else {
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
            }
        }
        Drawable themeDrawable = Theme.getThemeDrawable("drawableCommentSticker");
        BaseCell.setDrawableBounds(themeDrawable, this.sideStartX + AndroidUtilities.dp(4.0f), this.sideStartY + AndroidUtilities.dp(4.0f));
        if (f != 1.0f) {
            themeDrawable.setAlpha((int) (f * 255.0f));
            themeDrawable.draw(canvas);
            themeDrawable.setAlpha(255);
        } else {
            themeDrawable.draw(canvas);
        }
        if (this.commentLayout == null) {
            return;
        }
        Theme.chat_stickerCommentCountPaint.setColor(getThemedColor("chat_stickerReplyNameText"));
        Theme.chat_stickerCommentCountPaint.setAlpha((int) (f * 255.0f));
        if (this.transitionParams.animateComments) {
            if (this.transitionParams.animateCommentsLayout != null) {
                canvas.save();
                TextPaint textPaint = Theme.chat_stickerCommentCountPaint;
                double d = this.transitionParams.animateChangeProgress;
                Double.isNaN(d);
                double d2 = f;
                Double.isNaN(d2);
                textPaint.setAlpha((int) ((1.0d - d) * 255.0d * d2));
                canvas.translate(this.sideStartX + ((AndroidUtilities.dp(32.0f) - this.transitionParams.animateTotalCommentWidth) / 2), this.sideStartY + AndroidUtilities.dp(30.0f));
                this.transitionParams.animateCommentsLayout.draw(canvas);
                canvas.restore();
            }
            Theme.chat_stickerCommentCountPaint.setAlpha((int) (this.transitionParams.animateChangeProgress * 255.0f));
        }
        canvas.save();
        canvas.translate(this.sideStartX + ((AndroidUtilities.dp(32.0f) - this.totalCommentWidth) / 2), this.sideStartY + AndroidUtilities.dp(30.0f));
        this.commentLayout.draw(canvas);
        canvas.restore();
    }

    public void applyServiceShaderMatrix() {
        applyServiceShaderMatrix(getMeasuredWidth(), this.backgroundHeight, getX(), this.viewTop);
    }

    private void applyServiceShaderMatrix(int i, int i2, float f, float f2) {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        if (resourcesProvider != null) {
            resourcesProvider.applyServiceShaderMatrix(i, i2, f, f2);
        } else {
            Theme.applyServiceShaderMatrix(i, i2, f, f2);
        }
    }

    public boolean hasOutboundsContent() {
        AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans;
        if (getAlpha() != 1.0f) {
            return false;
        }
        if ((this.transitionParams.transitionBotButtons.isEmpty() || !this.transitionParams.animateBotButtonsChanged) && this.botButtons.isEmpty() && this.drawSideButton == 0 && ((!this.drawNameLayout || this.nameLayout == null || this.currentNameStatus == null) && ((emojiGroupedSpans = this.animatedEmojiStack) == null || emojiGroupedSpans.holders.isEmpty()))) {
            if (this.currentMessagesGroup != null) {
                return false;
            }
            TransitionParams transitionParams = this.transitionParams;
            if (((!transitionParams.animateReplaceCaptionLayout || transitionParams.animateChangeProgress == 1.0f) && (transitionParams.animateChangeProgress == 1.0f || !transitionParams.animateMessageText)) || transitionParams.animateOutAnimateEmoji == null || this.transitionParams.animateOutAnimateEmoji.holders.isEmpty()) {
                return false;
            }
        }
        return true;
    }

    public void drawOutboundsContent(Canvas canvas) {
        int themedColor;
        float f;
        float f2 = 1.0f;
        if (!this.enterTransitionInProgress) {
            drawAnimatedEmojis(canvas, 1.0f);
        }
        if (this.currentNameStatus != null && this.currentNameStatusDrawable != null && this.drawNameLayout && this.nameLayout != null) {
            if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                themedColor = getThemedColor("chat_stickerNameText");
                if (this.currentMessageObject.isOutOwner()) {
                    this.nameX = AndroidUtilities.dp(28.0f);
                } else {
                    this.nameX = this.backgroundDrawableLeft + this.transitionParams.deltaLeft + this.backgroundDrawableRight + AndroidUtilities.dp(22.0f);
                }
                this.nameY = this.layoutHeight - AndroidUtilities.dp(38.0f);
                this.nameX -= this.nameOffsetX;
            } else {
                float f3 = 11.0f;
                if (this.mediaBackground || this.currentMessageObject.isOutOwner()) {
                    this.nameX = (((this.backgroundDrawableLeft + this.transitionParams.deltaLeft) + AndroidUtilities.dp(11.0f)) - this.nameOffsetX) + getExtraTextX();
                } else {
                    float f4 = this.backgroundDrawableLeft + this.transitionParams.deltaLeft;
                    if (this.mediaBackground || !this.drawPinnedBottom) {
                        f3 = 17.0f;
                    }
                    this.nameX = ((f4 + AndroidUtilities.dp(f3)) - this.nameOffsetX) + getExtraTextX();
                }
                if (this.currentUser != null) {
                    Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
                    if (messageDrawable != null && messageDrawable.hasGradient()) {
                        themedColor = getThemedColor("chat_messageTextOut");
                    } else {
                        themedColor = getThemedColor(AvatarDrawable.getNameColorNameForId(this.currentUser.id));
                    }
                } else if (this.currentChat != null) {
                    if (this.currentMessageObject.isOutOwner() && ChatObject.isChannel(this.currentChat)) {
                        Theme.MessageDrawable messageDrawable2 = this.currentBackgroundDrawable;
                        if (messageDrawable2 != null && messageDrawable2.hasGradient()) {
                            themedColor = getThemedColor("chat_messageTextOut");
                        } else {
                            themedColor = getThemedColor("chat_outForwardedNameText");
                        }
                    } else if (ChatObject.isChannel(this.currentChat) && !this.currentChat.megagroup) {
                        themedColor = Theme.changeColorAccent(getThemedColor(AvatarDrawable.getNameColorNameForId(5L)));
                    } else if (this.currentMessageObject.isOutOwner()) {
                        themedColor = getThemedColor("chat_outForwardedNameText");
                    } else {
                        themedColor = getThemedColor(AvatarDrawable.getNameColorNameForId(this.currentChat.id));
                    }
                } else {
                    themedColor = getThemedColor(AvatarDrawable.getNameColorNameForId(0L));
                }
                this.nameY = AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f);
            }
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            if (groupedMessages != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams = groupedMessages.transitionParams;
                if (transitionParams.backgroundChangeBounds) {
                    this.nameX += transitionParams.offsetLeft;
                    this.nameY += transitionParams.offsetTop - getTranslationY();
                }
            }
            this.nameX += this.animationOffsetX;
            float f5 = this.nameY;
            TransitionParams transitionParams2 = this.transitionParams;
            this.nameY = f5 + transitionParams2.deltaTop;
            if (!transitionParams2.animateSign) {
                f = this.nameX;
            } else {
                f = this.transitionParams.animateNameX + ((this.nameX - this.transitionParams.animateNameX) * this.transitionParams.animateChangeProgress);
            }
            this.currentNameStatusDrawable.setBounds((int) (Math.abs(f) + this.nameLayoutWidth + AndroidUtilities.dp(2.0f)), (((int) this.nameY) + (this.nameLayout.getHeight() / 2)) - AndroidUtilities.dp(10.0f), (int) (Math.abs(f) + this.nameLayoutWidth + AndroidUtilities.dp(22.0f)), (int) (this.nameY + (this.nameLayout.getHeight() / 2) + AndroidUtilities.dp(10.0f)));
            this.currentNameStatusDrawable.setColor(Integer.valueOf(ColorUtils.setAlphaComponent(themedColor, 115)));
            this.currentNameStatusDrawable.draw(canvas);
        }
        if (!this.transitionParams.transitionBotButtons.isEmpty()) {
            TransitionParams transitionParams3 = this.transitionParams;
            if (transitionParams3.animateBotButtonsChanged) {
                drawBotButtons(canvas, transitionParams3.transitionBotButtons, 1.0f - this.transitionParams.animateChangeProgress);
            }
        }
        if (!this.botButtons.isEmpty()) {
            ArrayList<BotButton> arrayList = this.botButtons;
            TransitionParams transitionParams4 = this.transitionParams;
            if (transitionParams4.animateBotButtonsChanged) {
                f2 = transitionParams4.animateChangeProgress;
            }
            drawBotButtons(canvas, arrayList, f2);
        }
        drawSideButton(canvas);
    }

    public void drawAnimatedEmojis(Canvas canvas, float f) {
        drawAnimatedEmojiMessageText(canvas, f);
    }

    private void drawAnimatedEmojiMessageText(Canvas canvas, float f) {
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateChangeProgress != 1.0f && transitionParams.animateMessageText) {
            canvas.save();
            Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
            if (messageDrawable != null) {
                Rect bounds = messageDrawable.getBounds();
                if (this.currentMessageObject.isOutOwner() && !this.mediaBackground && !this.pinnedBottom) {
                    canvas.clipRect(bounds.left + AndroidUtilities.dp(4.0f), bounds.top + AndroidUtilities.dp(4.0f), bounds.right - AndroidUtilities.dp(10.0f), bounds.bottom - AndroidUtilities.dp(4.0f));
                } else {
                    canvas.clipRect(bounds.left + AndroidUtilities.dp(4.0f), bounds.top + AndroidUtilities.dp(4.0f), bounds.right - AndroidUtilities.dp(4.0f), bounds.bottom - AndroidUtilities.dp(4.0f));
                }
            }
            drawAnimatedEmojiMessageText(canvas, this.transitionParams.animateOutTextBlocks, this.transitionParams.animateOutAnimateEmoji, false, f * (1.0f - this.transitionParams.animateChangeProgress));
            drawAnimatedEmojiMessageText(canvas, this.currentMessageObject.textLayoutBlocks, this.animatedEmojiStack, true, f * this.transitionParams.animateChangeProgress);
            canvas.restore();
            return;
        }
        drawAnimatedEmojiMessageText(canvas, this.currentMessageObject.textLayoutBlocks, this.animatedEmojiStack, true, f);
    }

    private void drawAnimatedEmojiMessageText(Canvas canvas, ArrayList<MessageObject.TextLayoutBlock> arrayList, AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans, boolean z, float f) {
        int size;
        int i;
        if (arrayList == null || arrayList.isEmpty() || f == 0.0f) {
            return;
        }
        if (z) {
            if (this.fullyDraw) {
                this.firstVisibleBlockNum = 0;
                this.lastVisibleBlockNum = arrayList.size();
            }
            i = this.firstVisibleBlockNum;
            size = this.lastVisibleBlockNum;
        } else {
            size = arrayList.size();
            i = 0;
        }
        int i2 = this.textY;
        float f2 = i2;
        TransitionParams transitionParams = this.transitionParams;
        if (transitionParams.animateText) {
            float f3 = transitionParams.animateFromTextY;
            float f4 = transitionParams.animateChangeProgress;
            f2 = (f3 * (1.0f - f4)) + (i2 * f4);
        }
        float f5 = f2;
        for (int i3 = i; i3 <= size && i3 < arrayList.size(); i3++) {
            if (i3 >= 0) {
                MessageObject.TextLayoutBlock textLayoutBlock = arrayList.get(i3);
                canvas.save();
                canvas.translate(this.textX - (textLayoutBlock.isRtl() ? (int) Math.ceil(this.currentMessageObject.textXOffset) : 0), textLayoutBlock.textYOffset + f5 + this.transitionYOffsetForDrawables);
                float f6 = textLayoutBlock.textYOffset + f5 + this.transitionYOffsetForDrawables;
                boolean z2 = this.transitionParams.messageEntering;
                AnimatedEmojiSpan.drawAnimatedEmojis(canvas, textLayoutBlock.textLayout, emojiGroupedSpans, 0.0f, textLayoutBlock.spoilers, 0.0f, 0.0f, f6, f);
                canvas.restore();
            }
        }
    }

    public void drawAnimatedEmojiCaption(Canvas canvas, float f) {
        TransitionParams transitionParams = this.transitionParams;
        if (!transitionParams.animateReplaceCaptionLayout || transitionParams.animateChangeProgress == 1.0f) {
            drawAnimatedEmojiCaption(canvas, this.captionLayout, this.animatedEmojiStack, f);
            return;
        }
        drawAnimatedEmojiCaption(canvas, transitionParams.animateOutCaptionLayout, this.transitionParams.animateOutAnimateEmoji, (1.0f - this.transitionParams.animateChangeProgress) * f);
        drawAnimatedEmojiCaption(canvas, this.captionLayout, this.animatedEmojiStack, f * this.transitionParams.animateChangeProgress);
    }

    /* JADX WARN: Can't wrap try/catch for region: R(8:16|(3:18|(1:20)(2:22|(6:24|25|26|27|28|29)(2:33|(1:37)))|21)|38|25|26|27|28|29) */
    /* JADX WARN: Code restructure failed: missing block: B:31:0x008a, code lost:
        r12 = move-exception;
     */
    /* JADX WARN: Code restructure failed: missing block: B:32:0x008b, code lost:
        org.telegram.messenger.FileLog.e(r12);
     */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawAnimatedEmojiCaption(Canvas canvas, Layout layout, AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans, float f) {
        float f2;
        float f3;
        if (layout != null) {
            if ((this.currentMessageObject.deleted && this.currentPosition != null) || f <= 0.0f) {
                return;
            }
            canvas.save();
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            if (groupedMessages != null) {
                f *= groupedMessages.transitionParams.captionEnterProgress;
            }
            float f4 = f;
            if (f4 == 0.0f) {
                return;
            }
            float f5 = this.captionY;
            float f6 = this.captionX;
            TransitionParams transitionParams = this.transitionParams;
            if (transitionParams.animateBackgroundBoundsInner) {
                if (transitionParams.transformGroupToSingleMessage) {
                    f5 -= getTranslationY();
                    f3 = this.transitionParams.deltaLeft;
                } else if (transitionParams.moveCaption) {
                    float f7 = this.captionX;
                    TransitionParams transitionParams2 = this.transitionParams;
                    float f8 = transitionParams2.animateChangeProgress;
                    float f9 = (f7 * f8) + (transitionParams2.captionFromX * (1.0f - f8));
                    float f10 = (this.captionY * f8) + (transitionParams2.captionFromY * (1.0f - f8));
                    f6 = f9;
                    f2 = f10;
                    canvas.translate(f6, f2);
                    AnimatedEmojiSpan.drawAnimatedEmojis(canvas, layout, emojiGroupedSpans, 0.0f, this.captionSpoilers, 0.0f, 0.0f, f2, f4);
                    canvas.restore();
                } else if (!this.currentMessageObject.isVoice() || !TextUtils.isEmpty(this.currentMessageObject.caption)) {
                    f3 = this.transitionParams.deltaLeft;
                }
                f6 += f3;
            }
            f2 = f5;
            canvas.translate(f6, f2);
            AnimatedEmojiSpan.drawAnimatedEmojis(canvas, layout, emojiGroupedSpans, 0.0f, this.captionSpoilers, 0.0f, 0.0f, f2, f4);
            canvas.restore();
        }
    }

    private void drawSideButton(Canvas canvas) {
        if (this.drawSideButton != 0) {
            if (this.currentMessageObject.isOutOwner()) {
                float dp = this.transitionParams.lastBackgroundLeft - AndroidUtilities.dp(40.0f);
                this.sideStartX = dp;
                MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
                if (groupedMessages != null) {
                    this.sideStartX = dp + (groupedMessages.transitionParams.offsetLeft - this.animationOffsetX);
                }
            } else {
                float dp2 = this.transitionParams.lastBackgroundRight + AndroidUtilities.dp(8.0f);
                this.sideStartX = dp2;
                MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
                if (groupedMessages2 != null) {
                    this.sideStartX = dp2 + (groupedMessages2.transitionParams.offsetRight - this.animationOffsetX);
                }
            }
            float dp3 = (this.layoutHeight - AndroidUtilities.dp(41.0f)) + this.transitionParams.deltaBottom;
            this.sideStartY = dp3;
            MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
            if (groupedMessages3 != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams = groupedMessages3.transitionParams;
                float f = dp3 + transitionParams.offsetBottom;
                this.sideStartY = f;
                if (transitionParams.backgroundChangeBounds) {
                    this.sideStartY = f - getTranslationY();
                }
            }
            ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
            if (!reactionsLayoutInBubble.isSmall && reactionsLayoutInBubble.drawServiceShaderBackground) {
                this.sideStartY -= reactionsLayoutInBubble.getCurrentTotalHeight(this.transitionParams.animateChangeProgress);
            }
            if (!this.currentMessageObject.isOutOwner() && this.isRoundVideo && this.isAvatarVisible) {
                float f2 = (AndroidUtilities.roundPlayingMessageSize - AndroidUtilities.roundMessageSize) * 0.7f;
                boolean z = this.isPlayingRound;
                float f3 = z ? f2 : 0.0f;
                TransitionParams transitionParams2 = this.transitionParams;
                if (transitionParams2.animatePlayingRound) {
                    f3 = (z ? transitionParams2.animateChangeProgress : 1.0f - transitionParams2.animateChangeProgress) * f2;
                }
                this.sideStartX -= f3;
            }
            if (this.drawSideButton == 3) {
                if (this.enterTransitionInProgress && !this.currentMessageObject.isVoice()) {
                    return;
                }
                drawCommentButton(canvas, 1.0f);
                return;
            }
            RectF rectF = this.rect;
            float f4 = this.sideStartX;
            rectF.set(f4, this.sideStartY, AndroidUtilities.dp(32.0f) + f4, this.sideStartY + AndroidUtilities.dp(32.0f));
            applyServiceShaderMatrix();
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), getThemedPaint(this.sideButtonPressed ? "paintChatActionBackgroundSelected" : "paintChatActionBackground"));
            if (hasGradientService()) {
                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(16.0f), AndroidUtilities.dp(16.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
            }
            if (this.drawSideButton == 2) {
                Drawable themedDrawable = getThemedDrawable("drawableGoIcon");
                if (this.currentMessageObject.isOutOwner()) {
                    BaseCell.setDrawableBounds(themedDrawable, this.sideStartX + AndroidUtilities.dp(10.0f), this.sideStartY + AndroidUtilities.dp(9.0f));
                    canvas.save();
                    canvas.scale(-1.0f, 1.0f, themedDrawable.getBounds().centerX(), themedDrawable.getBounds().centerY());
                } else {
                    BaseCell.setDrawableBounds(themedDrawable, this.sideStartX + AndroidUtilities.dp(12.0f), this.sideStartY + AndroidUtilities.dp(9.0f));
                }
                themedDrawable.draw(canvas);
                if (!this.currentMessageObject.isOutOwner()) {
                    return;
                }
                canvas.restore();
                return;
            }
            Drawable themedDrawable2 = getThemedDrawable("drawableShareIcon");
            BaseCell.setDrawableBounds(themedDrawable2, this.sideStartX + AndroidUtilities.dp(8.0f), this.sideStartY + AndroidUtilities.dp(9.0f));
            themedDrawable2.draw(canvas);
        }
    }

    public void setTimeAlpha(float f) {
        this.timeAlpha = f;
    }

    public float getTimeAlpha() {
        return this.timeAlpha;
    }

    public int getBackgroundDrawableLeft() {
        int i;
        int i2 = 0;
        if (this.currentMessageObject.isOutOwner()) {
            int i3 = this.layoutWidth - this.backgroundWidth;
            if (this.mediaBackground) {
                i2 = AndroidUtilities.dp(9.0f);
            }
            return i3 - i2;
        }
        if (this.isChat && this.isAvatarVisible) {
            i2 = 48;
        }
        int dp = AndroidUtilities.dp(i2 + (!this.mediaBackground ? 3 : 9));
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null && !groupedMessages.isDocuments && (i = this.currentPosition.leftSpanOffset) != 0) {
            dp += (int) Math.ceil((i / 1000.0f) * getGroupPhotosWidth());
        }
        return (this.mediaBackground || !this.drawPinnedBottom) ? dp : dp + AndroidUtilities.dp(6.0f);
    }

    public int getBackgroundDrawableRight() {
        int dp = this.backgroundWidth - (this.mediaBackground ? 0 : AndroidUtilities.dp(3.0f));
        if (!this.mediaBackground && this.drawPinnedBottom && this.currentMessageObject.isOutOwner()) {
            dp -= AndroidUtilities.dp(6.0f);
        }
        if (!this.mediaBackground && this.drawPinnedBottom && !this.currentMessageObject.isOutOwner()) {
            dp -= AndroidUtilities.dp(6.0f);
        }
        return getBackgroundDrawableLeft() + dp;
    }

    public int getBackgroundDrawableTop() {
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        int i = 0;
        int dp = (groupedMessagePosition == null || (groupedMessagePosition.flags & 4) != 0) ? 0 : 0 - AndroidUtilities.dp(3.0f);
        if (!this.drawPinnedTop) {
            i = AndroidUtilities.dp(1.0f);
        }
        return dp + i;
    }

    public int getBackgroundDrawableBottom() {
        int i;
        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
        int i2 = 0;
        if (groupedMessagePosition != null) {
            int i3 = 4;
            i = (groupedMessagePosition.flags & 4) == 0 ? AndroidUtilities.dp(3.0f) + 0 : 0;
            if ((this.currentPosition.flags & 8) == 0) {
                if (this.currentMessageObject.isOutOwner()) {
                    i3 = 3;
                }
                i += AndroidUtilities.dp(i3);
            }
        } else {
            i = 0;
        }
        boolean z = this.drawPinnedBottom;
        if (!z || !this.drawPinnedTop) {
            if (z) {
                i2 = AndroidUtilities.dp(1.0f);
            } else {
                i2 = AndroidUtilities.dp(2.0f);
            }
        }
        return ((getBackgroundDrawableTop() + this.layoutHeight) - i2) + i;
    }

    /* JADX WARN: Removed duplicated region for block: B:16:0x008b  */
    /* JADX WARN: Removed duplicated region for block: B:22:? A[RETURN, SYNTHETIC] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawBackground(Canvas canvas, int i, int i2, int i3, int i4, boolean z, boolean z2, boolean z3, int i5) {
        int i6;
        int i7;
        Theme.MessageDrawable messageDrawable;
        if (this.currentMessageObject.isOutOwner()) {
            if (!this.mediaBackground && !z2) {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable(z3 ? "drawableMsgOutSelected" : "drawableMsgOut");
            } else {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable(z3 ? "drawableMsgOutMediaSelected" : "drawableMsgOutMedia");
            }
        } else if (!this.mediaBackground && !z2) {
            this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable(z3 ? "drawableMsgInSelected" : "drawableMsgIn");
        } else {
            this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable(z3 ? "drawableMsgInMediaSelected" : "drawableMsgInMedia");
        }
        int i8 = this.parentWidth;
        int i9 = this.parentHeight;
        if (i9 == 0) {
            i8 = getParentWidth();
            i9 = AndroidUtilities.displaySize.y;
            if (getParent() instanceof View) {
                View view = (View) getParent();
                int measuredWidth = view.getMeasuredWidth();
                i7 = view.getMeasuredHeight();
                i6 = measuredWidth;
                messageDrawable = this.currentBackgroundDrawable;
                if (messageDrawable != null) {
                    return;
                }
                messageDrawable.setTop(i5, i6, i7, (int) this.parentViewTopOffset, this.blurredViewTopOffset, this.blurredViewBottomOffset, z, z2);
                Drawable shadowDrawable = this.currentBackgroundDrawable.getShadowDrawable();
                if (shadowDrawable != null) {
                    shadowDrawable.setAlpha((int) (getAlpha() * 255.0f));
                    shadowDrawable.setBounds(i, i2, i3, i4);
                    shadowDrawable.draw(canvas);
                    shadowDrawable.setAlpha(255);
                }
                this.currentBackgroundDrawable.setAlpha((int) (getAlpha() * 255.0f));
                this.currentBackgroundDrawable.setBounds(i, i2, i3, i4);
                this.currentBackgroundDrawable.drawCached(canvas, this.backgroundCacheParams);
                this.currentBackgroundDrawable.setAlpha(255);
                return;
            }
        }
        i6 = i8;
        i7 = i9;
        messageDrawable = this.currentBackgroundDrawable;
        if (messageDrawable != null) {
        }
    }

    public boolean hasNameLayout() {
        if (!this.drawNameLayout || this.nameLayout == null) {
            if (this.drawForwardedName) {
                StaticLayout[] staticLayoutArr = this.forwardedNameLayout;
                if (staticLayoutArr[0] != null && staticLayoutArr[1] != null) {
                    MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                    if (groupedMessagePosition == null) {
                        return true;
                    }
                    if (groupedMessagePosition.minY == 0 && groupedMessagePosition.minX == 0) {
                        return true;
                    }
                }
            }
            return this.replyNameLayout != null;
        }
        return true;
    }

    public boolean isDrawNameLayout() {
        return this.drawNameLayout && this.nameLayout != null;
    }

    public boolean isAdminLayoutChanged() {
        return !TextUtils.equals(this.lastPostAuthor, this.currentMessageObject.messageOwner.post_author);
    }

    /* JADX WARN: Removed duplicated region for block: B:136:0x07bb  */
    /* JADX WARN: Removed duplicated region for block: B:147:0x0813  */
    /* JADX WARN: Removed duplicated region for block: B:150:0x081a  */
    /* JADX WARN: Removed duplicated region for block: B:162:0x08fd  */
    /* JADX WARN: Removed duplicated region for block: B:250:0x0c1c  */
    /* JADX WARN: Removed duplicated region for block: B:252:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:338:0x04f6  */
    /* JADX WARN: Removed duplicated region for block: B:339:0x04ce  */
    /* JADX WARN: Removed duplicated region for block: B:77:0x04aa  */
    /* JADX WARN: Removed duplicated region for block: B:81:0x04cc  */
    /* JADX WARN: Removed duplicated region for block: B:84:0x04d9  */
    /* JADX WARN: Removed duplicated region for block: B:89:0x04fc  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawNamesLayout(Canvas canvas, float f) {
        int i;
        int i2;
        boolean z;
        boolean z2;
        float f2;
        String str;
        boolean z3;
        int i3;
        float f3;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        float f4;
        float f5;
        int i4;
        float f6;
        boolean z4;
        int i5;
        float f7;
        float f8;
        int themedColor;
        float dp;
        float lineWidth;
        float dp2;
        float lineWidth2;
        MessageObject.GroupedMessagePosition groupedMessagePosition2;
        MessageObject.GroupedMessages groupedMessages;
        long elapsedRealtime = SystemClock.elapsedRealtime();
        long j = elapsedRealtime - this.lastNamesAnimationTime;
        if (j > 17) {
            j = 17;
        }
        this.lastNamesAnimationTime = elapsedRealtime;
        if (!this.currentMessageObject.deleted || (groupedMessages = this.currentMessagesGroup) == null || groupedMessages.messages.size() < 1) {
            if (f != 1.0f) {
                this.rect.set(0.0f, 0.0f, getMaxNameWidth(), getMeasuredHeight());
                i = canvas.saveLayerAlpha(this.rect, (int) (255.0f * f), 31);
            } else {
                i = Integer.MIN_VALUE;
            }
            float max = Math.max(0.0f, Math.min(1.0f, this.currentMessageObject.type == 5 ? 1.0f - ((this.photoImage.getImageWidth() - AndroidUtilities.roundMessageSize) / (AndroidUtilities.roundPlayingMessageSize - AndroidUtilities.roundMessageSize)) : 1.0f));
            float f9 = 17.0f;
            if (this.drawNameLayout && this.nameLayout != null) {
                canvas.save();
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    Theme.chat_namePaint.setColor(getThemedColor("chat_stickerNameText"));
                    if (this.currentMessageObject.isOutOwner()) {
                        this.nameX = AndroidUtilities.dp(28.0f);
                    } else {
                        this.nameX = this.backgroundDrawableLeft + this.transitionParams.deltaLeft + this.backgroundDrawableRight + AndroidUtilities.dp(22.0f);
                    }
                    this.nameY = this.layoutHeight - AndroidUtilities.dp(38.0f);
                    float f10 = (!this.currentMessageObject.isOut() || (!this.checkBoxVisible && !this.checkBoxAnimationInProgress)) ? 1.0f : 1.0f - this.checkBoxAnimationProgress;
                    this.rect.set(((int) this.nameX) - AndroidUtilities.dp(12.0f), ((int) this.nameY) - AndroidUtilities.dp(5.0f), ((int) this.nameX) + AndroidUtilities.dp(12.0f) + this.nameWidth, ((int) this.nameY) + AndroidUtilities.dp(22.0f));
                    int alpha = getThemedPaint("paintChatActionBackground").getAlpha();
                    getThemedPaint("paintChatActionBackground").setAlpha((int) (alpha * f10 * max));
                    applyServiceShaderMatrix();
                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), getThemedPaint("paintChatActionBackground"));
                    if (hasGradientService()) {
                        int alpha2 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                        Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha2 * this.timeAlpha * max));
                        canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                        Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha2);
                    }
                    if (this.viaSpan1 != null || this.viaSpan2 != null) {
                        int alpha3 = (((int) (Color.alpha(getThemedColor("chat_stickerViaBotNameText")) * f10)) << 24) | (getThemedColor("chat_stickerViaBotNameText") & 16777215);
                        TypefaceSpan typefaceSpan = this.viaSpan1;
                        if (typefaceSpan != null) {
                            typefaceSpan.setColor(alpha3);
                        }
                        TypefaceSpan typefaceSpan2 = this.viaSpan2;
                        if (typefaceSpan2 != null) {
                            typefaceSpan2.setColor(alpha3);
                        }
                    }
                    this.nameX -= this.nameOffsetX;
                    getThemedPaint("paintChatActionBackground").setAlpha(alpha);
                } else {
                    if (this.mediaBackground || this.currentMessageObject.isOutOwner()) {
                        this.nameX = (((this.backgroundDrawableLeft + this.transitionParams.deltaLeft) + AndroidUtilities.dp(11.0f)) - this.nameOffsetX) + getExtraTextX();
                    } else {
                        this.nameX = (((this.backgroundDrawableLeft + this.transitionParams.deltaLeft) + AndroidUtilities.dp((this.mediaBackground || !this.drawPinnedBottom) ? 17.0f : 11.0f)) - this.nameOffsetX) + getExtraTextX();
                    }
                    if (this.currentUser != null) {
                        Theme.MessageDrawable messageDrawable = this.currentBackgroundDrawable;
                        if (messageDrawable != null && messageDrawable.hasGradient()) {
                            Theme.chat_namePaint.setColor(getThemedColor("chat_messageTextOut"));
                        } else {
                            Theme.chat_namePaint.setColor(getThemedColor(AvatarDrawable.getNameColorNameForId(this.currentUser.id)));
                        }
                    } else if (this.currentChat != null) {
                        if (this.currentMessageObject.isOutOwner() && ChatObject.isChannel(this.currentChat)) {
                            Theme.MessageDrawable messageDrawable2 = this.currentBackgroundDrawable;
                            if (messageDrawable2 != null && messageDrawable2.hasGradient()) {
                                Theme.chat_namePaint.setColor(getThemedColor("chat_messageTextOut"));
                            } else {
                                Theme.chat_namePaint.setColor(getThemedColor("chat_outForwardedNameText"));
                            }
                        } else if (ChatObject.isChannel(this.currentChat) && !this.currentChat.megagroup) {
                            Theme.chat_namePaint.setColor(Theme.changeColorAccent(getThemedColor(AvatarDrawable.getNameColorNameForId(5L))));
                        } else if (this.currentMessageObject.isOutOwner()) {
                            Theme.chat_namePaint.setColor(getThemedColor("chat_outForwardedNameText"));
                        } else {
                            Theme.chat_namePaint.setColor(getThemedColor(AvatarDrawable.getNameColorNameForId(this.currentChat.id)));
                        }
                    } else {
                        Theme.chat_namePaint.setColor(getThemedColor(AvatarDrawable.getNameColorNameForId(0L)));
                    }
                    this.nameY = AndroidUtilities.dp(this.drawPinnedTop ? 9.0f : 10.0f);
                    if (this.viaSpan1 != null || this.viaSpan2 != null) {
                        int themedColor2 = getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outViaBotNameText" : "chat_inViaBotNameText");
                        TypefaceSpan typefaceSpan3 = this.viaSpan1;
                        if (typefaceSpan3 != null) {
                            typefaceSpan3.setColor(themedColor2);
                        }
                        TypefaceSpan typefaceSpan4 = this.viaSpan2;
                        if (typefaceSpan4 != null) {
                            typefaceSpan4.setColor(themedColor2);
                        }
                    }
                }
                MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
                if (groupedMessages2 != null) {
                    MessageObject.GroupedMessages.TransitionParams transitionParams = groupedMessages2.transitionParams;
                    if (transitionParams.backgroundChangeBounds) {
                        this.nameX += transitionParams.offsetLeft;
                        this.nameY += transitionParams.offsetTop - getTranslationY();
                    }
                }
                this.nameX += this.animationOffsetX;
                float f11 = this.nameY;
                TransitionParams transitionParams2 = this.transitionParams;
                this.nameY = f11 + transitionParams2.deltaTop;
                if (!transitionParams2.animateSign) {
                    f8 = this.nameX;
                } else {
                    f8 = this.transitionParams.animateNameX + ((this.nameX - this.transitionParams.animateNameX) * this.transitionParams.animateChangeProgress);
                }
                canvas.translate(f8, this.nameY);
                this.nameLayout.draw(canvas);
                canvas.restore();
                if (this.adminLayout != null) {
                    if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                        themedColor = getThemedColor("chat_stickerReplyNameText");
                    } else if (this.currentMessageObject.isOutOwner()) {
                        themedColor = getThemedColor(isDrawSelectionBackground() ? "chat_outAdminSelectedText" : "chat_outAdminText");
                    } else {
                        themedColor = getThemedColor(isDrawSelectionBackground() ? "chat_adminSelectedText" : "chat_adminText");
                    }
                    Theme.chat_adminPaint.setColor(themedColor);
                    canvas.save();
                    MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
                    if (groupedMessages3 != null && !groupedMessages3.isDocuments) {
                        int groupPhotosWidth = getGroupPhotosWidth();
                        int i6 = 0;
                        int i7 = 0;
                        while (i6 < this.currentMessagesGroup.posArray.size()) {
                            if (this.currentMessagesGroup.posArray.get(i6).minY != 0) {
                                break;
                            }
                            double d = i7;
                            int i8 = i;
                            double ceil = Math.ceil(((groupedMessagePosition2.pw + groupedMessagePosition2.leftSpanOffset) / 1000.0f) * groupPhotosWidth);
                            Double.isNaN(d);
                            i7 = (int) (d + ceil);
                            i6++;
                            i = i8;
                        }
                        i2 = i;
                        if (!this.mediaBackground && this.currentMessageObject.isOutOwner()) {
                            dp2 = (this.backgroundDrawableLeft + i7) - AndroidUtilities.dp(17.0f);
                            lineWidth2 = this.adminLayout.getLineWidth(0);
                        } else {
                            dp2 = (this.backgroundDrawableLeft + i7) - AndroidUtilities.dp(11.0f);
                            lineWidth2 = this.adminLayout.getLineWidth(0);
                        }
                        dp = (dp2 - lineWidth2) - (getExtraTextX() + AndroidUtilities.dp(8.0f));
                        if (!this.currentMessageObject.isOutOwner()) {
                            lineWidth = AndroidUtilities.dp(48.0f);
                        }
                        canvas.translate(dp, this.nameY + AndroidUtilities.dp(0.5f));
                        if (this.transitionParams.animateSign) {
                            Theme.chat_adminPaint.setAlpha((int) (Color.alpha(themedColor) * this.transitionParams.animateChangeProgress));
                        }
                        this.adminLayout.draw(canvas);
                        canvas.restore();
                        z = this.drawForwardedName;
                        z2 = this.replyNameLayout != null;
                        StaticLayout[] staticLayoutArr = this.forwardedNameLayout;
                        int i9 = this.forwardedNameWidth;
                        if (!this.transitionParams.animateForwardedLayout) {
                            f2 = 1.0f;
                        } else if (!this.currentMessageObject.needDrawForwarded()) {
                            TransitionParams transitionParams3 = this.transitionParams;
                            staticLayoutArr = transitionParams3.animatingForwardedNameLayout;
                            f2 = 1.0f - transitionParams3.animateChangeProgress;
                            i9 = transitionParams3.animateForwardNameWidth;
                            z = true;
                        } else {
                            f2 = this.transitionParams.animateChangeProgress;
                        }
                        if (z || staticLayoutArr[0] == null || staticLayoutArr[1] == null || !((groupedMessagePosition = this.currentPosition) == null || (groupedMessagePosition.minY == 0 && groupedMessagePosition.minX == 0))) {
                            str = "chat_stickerReplyNameText";
                            z3 = true;
                        } else {
                            MessageObject messageObject = this.currentMessageObject;
                            if (messageObject.type == 5 || messageObject.isAnyKindOfSticker()) {
                                Theme.chat_forwardNamePaint.setColor(getThemedColor("chat_stickerReplyNameText"));
                                if (this.currentMessageObject.needDrawForwarded()) {
                                    if (this.currentMessageObject.isOutOwner()) {
                                        f4 = AndroidUtilities.dp(23.0f);
                                        this.forwardNameX = f4;
                                    } else {
                                        f4 = this.backgroundDrawableLeft + this.backgroundDrawableRight + AndroidUtilities.dp(17.0f);
                                        this.forwardNameX = f4;
                                    }
                                } else {
                                    f4 = this.transitionParams.animateForwardNameX;
                                }
                                if ((this.currentMessageObject.isOutOwner() && this.currentMessageObject.type == 5 && this.transitionParams.animatePlayingRound) || this.isPlayingRound) {
                                    f4 -= AndroidUtilities.dp(78.0f) * (this.isPlayingRound ? this.transitionParams.animateChangeProgress : 1.0f - this.transitionParams.animateChangeProgress);
                                }
                                this.forwardNameY = AndroidUtilities.dp(12.0f);
                                int dp3 = i9 + AndroidUtilities.dp(14.0f);
                                if (z2) {
                                    int i10 = (int) f4;
                                    str = "chat_stickerReplyNameText";
                                    this.rect.set(i10 - AndroidUtilities.dp(7.0f), this.forwardNameY - AndroidUtilities.dp(6.0f), (i10 - AndroidUtilities.dp(7.0f)) + Math.max(dp3, Math.max(this.replyNameWidth, this.replyTextWidth) + AndroidUtilities.dp(14.0f)), this.forwardNameY + AndroidUtilities.dp(38.0f) + AndroidUtilities.dp(41.0f));
                                    z3 = false;
                                } else {
                                    str = "chat_stickerReplyNameText";
                                    int i11 = (int) f4;
                                    this.rect.set(i11 - AndroidUtilities.dp(7.0f), this.forwardNameY - AndroidUtilities.dp(6.0f), (i11 - AndroidUtilities.dp(7.0f)) + dp3, this.forwardNameY + AndroidUtilities.dp(38.0f));
                                    z3 = true;
                                }
                                applyServiceShaderMatrix();
                                int i12 = -1;
                                if (f2 != 1.0f || max != 1.0f) {
                                    i12 = getThemedPaint("paintChatActionBackground").getAlpha();
                                    getThemedPaint("paintChatActionBackground").setAlpha((int) (i12 * f2 * max));
                                }
                                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), getThemedPaint("paintChatActionBackground"));
                                if (hasGradientService()) {
                                    if (f2 == 1.0f && max == 1.0f) {
                                        i4 = -1;
                                    } else {
                                        i4 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                                        Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (i4 * f2 * max));
                                    }
                                    f5 = f4;
                                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                                } else {
                                    f5 = f4;
                                    i4 = -1;
                                }
                                if (i12 >= 0) {
                                    getThemedPaint("paintChatActionBackground").setAlpha(i12);
                                }
                                if (i4 >= 0) {
                                    Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(i4);
                                }
                                f6 = f5;
                            } else {
                                this.forwardNameY = AndroidUtilities.dp((this.drawNameLayout ? 19 : 0) + 10);
                                if (this.currentMessageObject.isOutOwner()) {
                                    if (this.hasPsaHint) {
                                        Theme.chat_forwardNamePaint.setColor(getThemedColor("chat_outPsaNameText"));
                                    } else {
                                        Theme.chat_forwardNamePaint.setColor(getThemedColor("chat_outForwardedNameText"));
                                    }
                                    if (this.currentMessageObject.needDrawForwarded()) {
                                        float dp4 = this.backgroundDrawableLeft + AndroidUtilities.dp(11.0f) + getExtraTextX();
                                        this.forwardNameX = dp4;
                                        f6 = dp4 + this.transitionParams.deltaLeft;
                                    } else {
                                        f6 = this.transitionParams.animateForwardNameX;
                                    }
                                } else {
                                    if (this.hasPsaHint) {
                                        Theme.chat_forwardNamePaint.setColor(getThemedColor("chat_inPsaNameText"));
                                    } else {
                                        Theme.chat_forwardNamePaint.setColor(getThemedColor("chat_inForwardedNameText"));
                                    }
                                    if (this.currentMessageObject.needDrawForwarded()) {
                                        if (this.mediaBackground) {
                                            f6 = this.backgroundDrawableLeft + AndroidUtilities.dp(11.0f) + getExtraTextX();
                                            this.forwardNameX = f6;
                                        } else {
                                            int i13 = this.backgroundDrawableLeft;
                                            if (this.drawPinnedBottom) {
                                                f9 = 11.0f;
                                            }
                                            f6 = i13 + AndroidUtilities.dp(f9) + getExtraTextX();
                                            this.forwardNameX = f6;
                                        }
                                    } else {
                                        f6 = this.transitionParams.animateForwardNameX;
                                    }
                                }
                                str = "chat_stickerReplyNameText";
                                z3 = true;
                            }
                            if (this.transitionParams.animateForwardedLayout && this.currentBackgroundDrawable != null && this.currentMessagesGroup == null) {
                                MessageObject messageObject2 = this.currentMessageObject;
                                if (messageObject2.type != 5 && !messageObject2.isAnyKindOfSticker()) {
                                    Rect bounds = this.currentBackgroundDrawable.getBounds();
                                    canvas.save();
                                    if (this.currentMessageObject.isOutOwner() && !this.mediaBackground && !this.pinnedBottom) {
                                        canvas.clipRect(bounds.left + AndroidUtilities.dp(4.0f), bounds.top + AndroidUtilities.dp(4.0f), bounds.right - AndroidUtilities.dp(10.0f), bounds.bottom - AndroidUtilities.dp(4.0f));
                                    } else {
                                        canvas.clipRect(bounds.left + AndroidUtilities.dp(4.0f), bounds.top + AndroidUtilities.dp(4.0f), bounds.right - AndroidUtilities.dp(4.0f), bounds.bottom - AndroidUtilities.dp(4.0f));
                                    }
                                    z4 = true;
                                    for (i5 = 0; i5 < 2; i5++) {
                                        canvas.save();
                                        canvas.translate(f6 - this.forwardNameOffsetX[i5], this.forwardNameY + (AndroidUtilities.dp(16.0f) * i5));
                                        if (f2 != 1.0f || max != 1.0f) {
                                            int alpha4 = staticLayoutArr[i5].getPaint().getAlpha();
                                            staticLayoutArr[i5].getPaint().setAlpha((int) (alpha4 * f2 * max));
                                            staticLayoutArr[i5].draw(canvas);
                                            staticLayoutArr[i5].getPaint().setAlpha(alpha4);
                                        } else {
                                            staticLayoutArr[i5].draw(canvas);
                                        }
                                        canvas.restore();
                                    }
                                    if (z4) {
                                        canvas.restore();
                                    }
                                    if (this.hasPsaHint) {
                                        if (this.psaButtonVisible || this.psaButtonProgress > 0.0f) {
                                            Drawable drawable = Theme.chat_psaHelpDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0];
                                            int intrinsicWidth = this.psaHelpX + (drawable.getIntrinsicWidth() / 2);
                                            int intrinsicHeight = this.psaHelpY + (drawable.getIntrinsicHeight() / 2);
                                            if (this.psaButtonVisible) {
                                                float f12 = this.psaButtonProgress;
                                                if (f12 < 1.0f) {
                                                    f7 = AnimationProperties.overshootInterpolator.getInterpolation(f12);
                                                    int intrinsicWidth2 = ((int) (drawable.getIntrinsicWidth() * f7)) / 2;
                                                    int intrinsicHeight2 = ((int) (drawable.getIntrinsicHeight() * f7)) / 2;
                                                    drawable.setBounds(intrinsicWidth - intrinsicWidth2, intrinsicHeight - intrinsicHeight2, intrinsicWidth + intrinsicWidth2, intrinsicHeight + intrinsicHeight2);
                                                    drawable.draw(canvas);
                                                    if (Build.VERSION.SDK_INT >= 21 && this.selectorDrawable[0] != null && this.selectorDrawableMaskType[0] == 3) {
                                                        canvas.save();
                                                        float f13 = this.psaButtonProgress;
                                                        canvas.scale(f13, f13, this.selectorDrawable[0].getBounds().centerX(), this.selectorDrawable[0].getBounds().centerY());
                                                        this.selectorDrawable[0].draw(canvas);
                                                        canvas.restore();
                                                    }
                                                }
                                            }
                                            f7 = this.psaButtonProgress;
                                            int intrinsicWidth22 = ((int) (drawable.getIntrinsicWidth() * f7)) / 2;
                                            int intrinsicHeight22 = ((int) (drawable.getIntrinsicHeight() * f7)) / 2;
                                            drawable.setBounds(intrinsicWidth - intrinsicWidth22, intrinsicHeight - intrinsicHeight22, intrinsicWidth + intrinsicWidth22, intrinsicHeight + intrinsicHeight22);
                                            drawable.draw(canvas);
                                            if (Build.VERSION.SDK_INT >= 21) {
                                                canvas.save();
                                                float f132 = this.psaButtonProgress;
                                                canvas.scale(f132, f132, this.selectorDrawable[0].getBounds().centerX(), this.selectorDrawable[0].getBounds().centerY());
                                                this.selectorDrawable[0].draw(canvas);
                                                canvas.restore();
                                            }
                                        }
                                        boolean z5 = this.psaButtonVisible;
                                        if (z5) {
                                            float f14 = this.psaButtonProgress;
                                            if (f14 < 1.0f) {
                                                this.psaButtonProgress = f14 + (((float) j) / 180.0f);
                                                invalidate();
                                                if (this.psaButtonProgress > 1.0f) {
                                                    this.psaButtonProgress = 1.0f;
                                                    setInvalidatesParent(false);
                                                }
                                            }
                                        }
                                        if (!z5) {
                                            float f15 = this.psaButtonProgress;
                                            if (f15 > 0.0f) {
                                                this.psaButtonProgress = f15 - (((float) j) / 180.0f);
                                                invalidate();
                                                if (this.psaButtonProgress < 0.0f) {
                                                    this.psaButtonProgress = 0.0f;
                                                    setInvalidatesParent(false);
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            z4 = false;
                            while (i5 < 2) {
                            }
                            if (z4) {
                            }
                            if (this.hasPsaHint) {
                            }
                        }
                        if (z2) {
                            float f16 = this.replyStartX;
                            int i14 = this.replyStartY;
                            float f17 = i14;
                            MessageObject.GroupedMessages groupedMessages4 = this.currentMessagesGroup;
                            if (groupedMessages4 != null) {
                                MessageObject.GroupedMessages.TransitionParams transitionParams4 = groupedMessages4.transitionParams;
                                if (transitionParams4.backgroundChangeBounds) {
                                    f16 += transitionParams4.offsetLeft;
                                }
                            }
                            TransitionParams transitionParams5 = this.transitionParams;
                            if (transitionParams5.animateBackgroundBoundsInner) {
                                if (this.isRoundVideo) {
                                    f3 = transitionParams5.deltaLeft + transitionParams5.deltaRight;
                                } else {
                                    f3 = transitionParams5.deltaLeft;
                                }
                                f16 += f3;
                                float f18 = transitionParams5.animateChangeProgress;
                                f17 = (i14 * f18) + (transitionParams5.animateFromReplyY * (1.0f - f18));
                            }
                            if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                                Theme.chat_replyLinePaint.setColor(getThemedColor("chat_stickerReplyLine"));
                                Theme.chat_replyLinePaint.setAlpha((int) (Theme.chat_replyLinePaint.getAlpha() * this.timeAlpha * max));
                                Theme.chat_replyNamePaint.setColor(getThemedColor(str));
                                Theme.chat_replyNamePaint.setAlpha((int) (Theme.chat_replyNamePaint.getAlpha() * this.timeAlpha * max));
                                Theme.chat_replyTextPaint.setColor(getThemedColor("chat_stickerReplyMessageText"));
                                Theme.chat_replyTextPaint.setAlpha((int) (Theme.chat_replyTextPaint.getAlpha() * this.timeAlpha * max));
                                if (z3) {
                                    int i15 = (int) f16;
                                    this.rect.set(i15 - AndroidUtilities.dp(7.0f), f17 - AndroidUtilities.dp(6.0f), (i15 - AndroidUtilities.dp(7.0f)) + Math.max(this.replyNameWidth, this.replyTextWidth) + AndroidUtilities.dp(14.0f), AndroidUtilities.dp(41.0f) + f17);
                                    applyServiceShaderMatrix();
                                    int alpha5 = getThemedPaint("paintChatActionBackground").getAlpha();
                                    getThemedPaint("paintChatActionBackground").setAlpha((int) (alpha5 * this.timeAlpha * max));
                                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), getThemedPaint("paintChatActionBackground"));
                                    getThemedPaint("paintChatActionBackground").setAlpha(alpha5);
                                    if (hasGradientService()) {
                                        int alpha6 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                                        Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha6 * this.timeAlpha * max));
                                        canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                                        Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha6);
                                    }
                                }
                            } else if (this.currentMessageObject.isOutOwner()) {
                                Theme.chat_replyLinePaint.setColor(getThemedColor("chat_outReplyLine"));
                                Theme.chat_replyNamePaint.setColor(getThemedColor("chat_outReplyNameText"));
                                if (this.currentMessageObject.hasValidReplyMessageObject()) {
                                    MessageObject messageObject3 = this.currentMessageObject.replyMessageObject;
                                    if ((messageObject3.type == 0 || !TextUtils.isEmpty(messageObject3.caption)) && !(MessageObject.getMedia(this.currentMessageObject.replyMessageObject.messageOwner) instanceof TLRPC$TL_messageMediaGame) && !(MessageObject.getMedia(this.currentMessageObject.replyMessageObject.messageOwner) instanceof TLRPC$TL_messageMediaInvoice)) {
                                        Theme.chat_replyTextPaint.setColor(getThemedColor("chat_outReplyMessageText"));
                                    }
                                }
                                Theme.chat_replyTextPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outReplyMediaMessageSelectedText" : "chat_outReplyMediaMessageText"));
                            } else {
                                Theme.chat_replyLinePaint.setColor(getThemedColor("chat_inReplyLine"));
                                Theme.chat_replyNamePaint.setColor(getThemedColor("chat_inReplyNameText"));
                                if (this.currentMessageObject.hasValidReplyMessageObject()) {
                                    MessageObject messageObject4 = this.currentMessageObject.replyMessageObject;
                                    if ((messageObject4.type == 0 || !TextUtils.isEmpty(messageObject4.caption)) && !(MessageObject.getMedia(this.currentMessageObject.replyMessageObject.messageOwner) instanceof TLRPC$TL_messageMediaGame) && !(MessageObject.getMedia(this.currentMessageObject.replyMessageObject.messageOwner) instanceof TLRPC$TL_messageMediaInvoice)) {
                                        Theme.chat_replyTextPaint.setColor(getThemedColor("chat_inReplyMessageText"));
                                    }
                                }
                                Theme.chat_replyTextPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inReplyMediaMessageSelectedText" : "chat_inReplyMediaMessageText"));
                            }
                            this.forwardNameX = (f16 - this.replyTextOffset) + AndroidUtilities.dp((this.needReplyImage ? 44 : 0) + 10);
                            MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
                            if ((groupedMessagePosition3 == null || (groupedMessagePosition3.minY == 0 && groupedMessagePosition3.minX == 0)) && (!this.enterTransitionInProgress || this.currentMessageObject.isVoice())) {
                                RectF rectF = AndroidUtilities.rectTmp;
                                rectF.set(f16, f17, AndroidUtilities.dp(2.0f) + f16, AndroidUtilities.dp(35.0f) + f17);
                                canvas.drawRoundRect(rectF, AndroidUtilities.dp(1.0f), AndroidUtilities.dp(1.0f), Theme.chat_replyLinePaint);
                                if (this.needReplyImage) {
                                    this.replyImageReceiver.setAlpha(max);
                                    this.replyImageReceiver.setImageCoords(AndroidUtilities.dp(10.0f) + f16, f17, AndroidUtilities.dp(35.0f), AndroidUtilities.dp(35.0f));
                                    this.replyImageReceiver.draw(canvas);
                                }
                                if (this.replyNameLayout != null) {
                                    canvas.save();
                                    canvas.translate((f16 - this.replyNameOffset) + AndroidUtilities.dp((this.needReplyImage ? 44 : 0) + 10), f17);
                                    this.replyNameLayout.draw(canvas);
                                    canvas.restore();
                                }
                                if (this.replyTextLayout != null) {
                                    canvas.save();
                                    canvas.translate(this.forwardNameX, f17 + AndroidUtilities.dp(19.0f));
                                    SpoilerEffect.renderWithRipple(this, this.invalidateSpoilersParent, (!this.currentMessageObject.isOut() || ChatObject.isChannelAndNotMegaGroup(this.currentMessageObject.getChatId(), this.currentAccount)) ? this.replyTextLayout.getPaint().getColor() : getThemedColor("chat_outTimeText"), -AndroidUtilities.dp(2.0f), this.spoilersPatchedReplyTextLayout, this.replyTextLayout, this.replySpoilers, canvas, false);
                                    AnimatedEmojiSpan.drawAnimatedEmojis(canvas, this.replyTextLayout, this.animatedEmojiReplyStack, 0.0f, this.replySpoilers, 0.0f, 0.0f, 0.0f, f);
                                    canvas.restore();
                                }
                            }
                        }
                        i3 = i2;
                        if (i3 == Integer.MIN_VALUE) {
                            return;
                        }
                        canvas.restoreToCount(i3);
                        return;
                    }
                    i2 = i;
                    if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                        if (this.currentMessageObject.isOutOwner()) {
                            dp = AndroidUtilities.dp(28.0f) + this.nameWidth;
                            lineWidth = this.adminLayout.getLineWidth(0);
                        } else {
                            dp = this.backgroundDrawableLeft + this.transitionParams.deltaLeft + this.backgroundDrawableRight + AndroidUtilities.dp(22.0f) + this.nameWidth;
                            lineWidth = this.adminLayout.getLineWidth(0);
                        }
                    } else if (!this.mediaBackground && this.currentMessageObject.isOutOwner()) {
                        dp = (this.backgroundDrawableLeft + this.backgroundDrawableRight) - AndroidUtilities.dp(17.0f);
                        lineWidth = this.adminLayout.getLineWidth(0);
                    } else {
                        dp = (this.backgroundDrawableLeft + this.backgroundDrawableRight) - AndroidUtilities.dp(11.0f);
                        lineWidth = this.adminLayout.getLineWidth(0);
                    }
                    dp -= lineWidth;
                    canvas.translate(dp, this.nameY + AndroidUtilities.dp(0.5f));
                    if (this.transitionParams.animateSign) {
                    }
                    this.adminLayout.draw(canvas);
                    canvas.restore();
                    z = this.drawForwardedName;
                    if (this.replyNameLayout != null) {
                    }
                    StaticLayout[] staticLayoutArr2 = this.forwardedNameLayout;
                    int i92 = this.forwardedNameWidth;
                    if (!this.transitionParams.animateForwardedLayout) {
                    }
                    if (z) {
                    }
                    str = "chat_stickerReplyNameText";
                    z3 = true;
                    if (z2) {
                    }
                    i3 = i2;
                    if (i3 == Integer.MIN_VALUE) {
                    }
                }
            }
            i2 = i;
            z = this.drawForwardedName;
            if (this.replyNameLayout != null) {
            }
            StaticLayout[] staticLayoutArr22 = this.forwardedNameLayout;
            int i922 = this.forwardedNameWidth;
            if (!this.transitionParams.animateForwardedLayout) {
            }
            if (z) {
            }
            str = "chat_stickerReplyNameText";
            z3 = true;
            if (z2) {
            }
            i3 = i2;
            if (i3 == Integer.MIN_VALUE) {
            }
        }
    }

    public boolean hasCaptionLayout() {
        return this.captionLayout != null;
    }

    public boolean hasCommentLayout() {
        return this.drawCommentButton;
    }

    public StaticLayout getCaptionLayout() {
        return this.captionLayout;
    }

    public void setDrawSelectionBackground(boolean z) {
        if (this.drawSelectionBackground != z) {
            this.drawSelectionBackground = z;
            invalidate();
        }
    }

    public boolean isDrawingSelectionBackground() {
        return this.drawSelectionBackground || this.isHighlightedAnimated || this.isHighlighted;
    }

    public float getHighlightAlpha() {
        int i;
        if (this.drawSelectionBackground || !this.isHighlightedAnimated || (i = this.highlightProgress) >= 300) {
            return 1.0f;
        }
        return i / 300.0f;
    }

    public void setCheckBoxVisible(boolean z, boolean z2) {
        MessageObject.GroupedMessages groupedMessages;
        MessageObject.GroupedMessages groupedMessages2;
        if (z && this.checkBox == null) {
            CheckBoxBase checkBoxBase = new CheckBoxBase(this, 21, this.resourcesProvider);
            this.checkBox = checkBoxBase;
            if (this.attachedToWindow) {
                checkBoxBase.onAttachedToWindow();
            }
        }
        if (z && this.mediaCheckBox == null && (((groupedMessages = this.currentMessagesGroup) != null && groupedMessages.messages.size() > 1) || ((groupedMessages2 = this.groupedMessagesToSet) != null && groupedMessages2.messages.size() > 1))) {
            CheckBoxBase checkBoxBase2 = new CheckBoxBase(this, 21, this.resourcesProvider);
            this.mediaCheckBox = checkBoxBase2;
            checkBoxBase2.setUseDefaultCheck(true);
            if (this.attachedToWindow) {
                this.mediaCheckBox.onAttachedToWindow();
            }
        }
        float f = 1.0f;
        if (this.checkBoxVisible == z) {
            if (z2 == this.checkBoxAnimationInProgress || z2) {
                return;
            }
            if (!z) {
                f = 0.0f;
            }
            this.checkBoxAnimationProgress = f;
            invalidate();
            return;
        }
        this.checkBoxAnimationInProgress = z2;
        this.checkBoxVisible = z;
        if (z2) {
            this.lastCheckBoxAnimationTime = SystemClock.elapsedRealtime();
        } else {
            if (!z) {
                f = 0.0f;
            }
            this.checkBoxAnimationProgress = f;
        }
        invalidate();
    }

    public void setChecked(boolean z, boolean z2, boolean z3) {
        CheckBoxBase checkBoxBase = this.checkBox;
        if (checkBoxBase != null) {
            checkBoxBase.setChecked(z2, z3);
        }
        CheckBoxBase checkBoxBase2 = this.mediaCheckBox;
        if (checkBoxBase2 != null) {
            checkBoxBase2.setChecked(z, z3);
        }
        this.backgroundDrawable.setSelected(z2, z3);
    }

    public void setLastTouchCoords(float f, float f2) {
        this.lastTouchX = f;
        this.lastTouchY = f2;
        this.backgroundDrawable.setTouchCoords(f + getTranslationX(), this.lastTouchY);
    }

    public MessageBackgroundDrawable getBackgroundDrawable() {
        return this.backgroundDrawable;
    }

    public Theme.MessageDrawable getCurrentBackgroundDrawable(boolean z) {
        if (z) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            boolean z2 = groupedMessagePosition != null && (groupedMessagePosition.flags & 8) == 0 && this.currentMessagesGroup.isDocuments && !this.drawPinnedBottom;
            if (this.currentMessageObject.isOutOwner()) {
                if (!this.mediaBackground && !this.drawPinnedBottom && !z2) {
                    this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOut");
                } else {
                    this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgOutMedia");
                }
            } else if (!this.mediaBackground && !this.drawPinnedBottom && !z2) {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgIn");
            } else {
                this.currentBackgroundDrawable = (Theme.MessageDrawable) getThemedDrawable("drawableMsgInMedia");
            }
        }
        this.currentBackgroundDrawable.getBackgroundDrawable();
        return this.currentBackgroundDrawable;
    }

    private boolean shouldDrawCaptionLayout() {
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        MessageObject.GroupedMessages groupedMessages;
        MessageObject messageObject = this.currentMessageObject;
        return !messageObject.preview && ((groupedMessagePosition = this.currentPosition) == null || ((groupedMessages = this.currentMessagesGroup) != null && groupedMessages.isDocuments && (groupedMessagePosition.flags & 8) == 0)) && !this.transitionParams.animateBackgroundBoundsInner && (!this.enterTransitionInProgress || !messageObject.isVoice());
    }

    public void drawCaptionLayout(Canvas canvas, boolean z, float f) {
        if (this.animatedEmojiStack != null && (this.captionLayout != null || this.transitionParams.animateOutCaptionLayout != null)) {
            this.animatedEmojiStack.clearPositions();
        }
        TransitionParams transitionParams = this.transitionParams;
        float f2 = 1.0f;
        if (!transitionParams.animateReplaceCaptionLayout || transitionParams.animateChangeProgress == 1.0f) {
            drawCaptionLayout(canvas, this.captionLayout, z, f);
        } else {
            drawCaptionLayout(canvas, transitionParams.animateOutCaptionLayout, z, (1.0f - this.transitionParams.animateChangeProgress) * f);
            drawCaptionLayout(canvas, this.captionLayout, z, this.transitionParams.animateChangeProgress * f);
        }
        if (!z) {
            drawAnimatedEmojiCaption(canvas, f);
        }
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && messageObject.messageOwner != null && messageObject.isVoiceTranscriptionOpen()) {
            MessageObject messageObject2 = this.currentMessageObject;
            if (!messageObject2.messageOwner.voiceTranscriptionFinal && TranscribeButton.isTranscribing(messageObject2)) {
                invalidate();
            }
        }
        if (!z) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            if (groupedMessagePosition != null) {
                int i = groupedMessagePosition.flags;
                if ((i & 8) == 0 || (i & 1) == 0) {
                    return;
                }
            }
            ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
            if (reactionsLayoutInBubble.isSmall) {
                return;
            }
            if (reactionsLayoutInBubble.drawServiceShaderBackground) {
                applyServiceShaderMatrix();
            }
            ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
            if (reactionsLayoutInBubble2.drawServiceShaderBackground || !this.transitionParams.animateBackgroundBoundsInner || this.currentPosition != null) {
                TransitionParams transitionParams2 = this.transitionParams;
                if (transitionParams2.animateChange) {
                    f2 = transitionParams2.animateChangeProgress;
                }
                reactionsLayoutInBubble2.draw(canvas, f2, null);
                return;
            }
            canvas.save();
            canvas.clipRect(0.0f, 0.0f, getMeasuredWidth(), getBackgroundDrawableBottom() + this.transitionParams.deltaBottom);
            ReactionsLayoutInBubble reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
            TransitionParams transitionParams3 = this.transitionParams;
            if (transitionParams3.animateChange) {
                f2 = transitionParams3.animateChangeProgress;
            }
            reactionsLayoutInBubble3.draw(canvas, f2, null);
            canvas.restore();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:155:0x04f0  */
    /* JADX WARN: Removed duplicated region for block: B:165:0x053e  */
    /* JADX WARN: Removed duplicated region for block: B:168:0x0567  */
    /* JADX WARN: Removed duplicated region for block: B:171:0x0586  */
    /* JADX WARN: Removed duplicated region for block: B:173:0x0589  */
    /* JADX WARN: Removed duplicated region for block: B:186:0x0645  */
    /* JADX WARN: Removed duplicated region for block: B:291:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:296:0x05a0  */
    /* JADX WARN: Removed duplicated region for block: B:301:0x056c  */
    /* JADX WARN: Removed duplicated region for block: B:302:0x0558  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawCaptionLayout(Canvas canvas, StaticLayout staticLayout, boolean z, float f) {
        int i;
        Rect rect;
        float f2;
        int dp;
        int extraTextX;
        int i2;
        int dp2;
        int i3;
        int i4;
        float f3;
        int i5;
        boolean z2;
        int i6;
        int i7;
        int i8;
        boolean shouldDrawThreadProgress;
        long j;
        float f4;
        InfiniteProgress infiniteProgress;
        int i9;
        int i10;
        int themedColor;
        int i11;
        int i12;
        MessageObject.GroupedMessagePosition groupedMessagePosition;
        MessageObject.GroupedMessagePosition groupedMessagePosition2;
        int i13 = 1;
        if (this.currentBackgroundDrawable != null && this.drawCommentButton && this.timeLayout != null) {
            float f5 = 18.0f;
            float dp3 = ((this.layoutHeight + this.transitionParams.deltaBottom) - AndroidUtilities.dp(18.0f)) - this.timeLayout.getHeight();
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            if (groupedMessages != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams = groupedMessages.transitionParams;
                dp3 += transitionParams.offsetBottom;
                if (transitionParams.backgroundChangeBounds) {
                    dp3 -= getTranslationY();
                }
            }
            float f6 = dp3;
            if (this.mediaBackground) {
                dp = this.backgroundDrawableLeft + AndroidUtilities.dp(12.0f);
                extraTextX = getExtraTextX();
            } else {
                int i14 = this.backgroundDrawableLeft;
                if (this.drawPinnedBottom) {
                    f5 = 12.0f;
                }
                dp = i14 + AndroidUtilities.dp(f5);
                extraTextX = getExtraTextX();
            }
            int i15 = dp + extraTextX;
            int extraTextX2 = i15 - getExtraTextX();
            if (this.currentMessagesGroup == null || this.currentMessageObject.isMusic() || this.currentMessageObject.isDocument()) {
                i2 = i15;
                dp2 = extraTextX2 + (this.backgroundWidth - (this.mediaBackground ? 0 : AndroidUtilities.dp(9.0f)));
            } else {
                int groupPhotosWidth = getGroupPhotosWidth();
                float f7 = 1000.0f;
                if ((this.currentPosition.flags & 1) == 0) {
                    double d = extraTextX2;
                    double ceil = Math.ceil((groupedMessagePosition.pw / 1000.0f) * groupPhotosWidth);
                    Double.isNaN(d);
                    dp2 = (int) (d + ceil);
                    i2 = i15;
                } else {
                    int i16 = 0;
                    int i17 = 0;
                    while (i16 < this.currentMessagesGroup.posArray.size()) {
                        if (this.currentMessagesGroup.posArray.get(i16).minY != 0) {
                            break;
                        }
                        double d2 = i17;
                        double ceil2 = Math.ceil(((groupedMessagePosition2.pw + groupedMessagePosition2.leftSpanOffset) / f7) * groupPhotosWidth);
                        Double.isNaN(d2);
                        i17 = (int) (d2 + ceil2);
                        i16++;
                        i15 = i15;
                        f7 = 1000.0f;
                    }
                    i2 = i15;
                    dp2 = extraTextX2 + (i17 - AndroidUtilities.dp(9.0f));
                }
            }
            if (this.pinnedBottom) {
                i3 = 2;
                i4 = 3;
            } else if (this.pinnedTop) {
                i3 = 4;
                i4 = 1;
            } else {
                i3 = 3;
                i4 = 0;
            }
            int currentBackgroundLeft = getCurrentBackgroundLeft() + AndroidUtilities.dp((this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 2.0f : 8.0f);
            float dp4 = this.layoutHeight - AndroidUtilities.dp(45.1f - i4);
            MessageObject.GroupedMessagePosition groupedMessagePosition3 = this.currentPosition;
            if (groupedMessagePosition3 != null && (groupedMessagePosition3.flags & 1) == 0 && !this.currentMessagesGroup.hasSibling) {
                dp2 += AndroidUtilities.dp(14.0f);
                currentBackgroundLeft -= AndroidUtilities.dp(10.0f);
            }
            this.commentButtonRect.set(currentBackgroundLeft, (int) dp4, dp2 - AndroidUtilities.dp(14.0f), this.layoutHeight - AndroidUtilities.dp(i3));
            Drawable[] drawableArr = this.selectorDrawable;
            if (drawableArr[1] != null && this.selectorDrawableMaskType[1] == 2) {
                drawableArr[1].setBounds(this.commentButtonRect);
                this.selectorDrawable[1].draw(canvas);
            }
            MessageObject.GroupedMessagePosition groupedMessagePosition4 = this.currentPosition;
            if (groupedMessagePosition4 == null || ((groupedMessagePosition4.flags & 1) != 0 && groupedMessagePosition4.minX == 0 && groupedMessagePosition4.maxX == 0)) {
                String str = "chat_inPreviewInstantText";
                Theme.chat_instantViewPaint.setColor(getThemedColor(str));
                if (this.commentAvatarImages != null) {
                    int dp5 = AndroidUtilities.dp(17.0f);
                    int extraTextX3 = getExtraTextX() + i2;
                    int length = this.commentAvatarImages.length - 1;
                    int i18 = 2;
                    z2 = false;
                    while (length >= 0) {
                        if (this.commentAvatarImagesVisible[length] && this.commentAvatarImages[length].hasImageSet()) {
                            this.commentAvatarImages[length].setImageX((dp5 * length) + extraTextX3);
                            this.commentAvatarImages[length].setImageY((f6 - AndroidUtilities.dp(4.0f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0));
                            ImageReceiver[] imageReceiverArr = this.commentAvatarImages;
                            if (length != imageReceiverArr.length - i13) {
                                canvas.drawCircle(imageReceiverArr[length].getCenterX(), this.commentAvatarImages[length].getCenterY(), AndroidUtilities.dp(13.0f), this.currentBackgroundDrawable.getPaint());
                            }
                            this.commentAvatarImages[length].draw(canvas);
                            if (length != 0) {
                                i18 += 17;
                            }
                            z2 = true;
                        }
                        length--;
                        i13 = 1;
                    }
                    i5 = i18;
                } else {
                    i5 = 2;
                    z2 = false;
                }
                if (this.mediaBackground && staticLayout == null) {
                    ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
                    if (reactionsLayoutInBubble.isEmpty || reactionsLayoutInBubble.isSmall) {
                        i7 = i2;
                        if (this.commentLayout == null && this.drawSideButton != 3) {
                            TextPaint textPaint = Theme.chat_replyNamePaint;
                            if (this.currentMessageObject.isOutOwner()) {
                                str = "chat_outPreviewInstantText";
                            }
                            textPaint.setColor(getThemedColor(str));
                            float f8 = i5 + 33;
                            int dp6 = i7 + AndroidUtilities.dp(f8);
                            this.commentX = dp6;
                            if (this.drawCommentNumber) {
                                this.commentX = dp6 + this.commentNumberWidth + AndroidUtilities.dp(4.0f);
                            }
                            int alpha = Theme.chat_replyNamePaint.getAlpha();
                            if (!this.transitionParams.animateComments || this.transitionParams.animateCommentsLayout == null) {
                                i9 = alpha;
                            } else {
                                canvas.save();
                                TextPaint textPaint2 = Theme.chat_replyNamePaint;
                                double d3 = alpha;
                                i9 = alpha;
                                double d4 = this.transitionParams.animateChangeProgress;
                                Double.isNaN(d4);
                                Double.isNaN(d3);
                                textPaint2.setAlpha((int) (d3 * (1.0d - d4)));
                                canvas.translate(this.transitionParams.animateCommentX + ((this.commentX - this.transitionParams.animateCommentX) * this.transitionParams.animateChangeProgress), (f6 - AndroidUtilities.dp(0.1f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0));
                                this.transitionParams.animateCommentsLayout.draw(canvas);
                                canvas.restore();
                            }
                            canvas.save();
                            canvas.translate(AndroidUtilities.dp(f8) + i7, (f6 - AndroidUtilities.dp(0.1f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0));
                            if (!this.currentMessageObject.isSent()) {
                                Theme.chat_replyNamePaint.setAlpha(127);
                                Theme.chat_commentArrowDrawable.setAlpha(127);
                                Theme.chat_commentDrawable.setAlpha(127);
                            } else {
                                Theme.chat_commentArrowDrawable.setAlpha(255);
                                Theme.chat_commentDrawable.setAlpha(255);
                            }
                            if (this.drawCommentNumber || (this.transitionParams.animateComments && this.transitionParams.animateDrawCommentNumber)) {
                                if (!this.drawCommentNumber || !this.transitionParams.animateComments) {
                                    i10 = i9;
                                } else if (this.transitionParams.animateDrawCommentNumber) {
                                    i10 = i9;
                                    Theme.chat_replyNamePaint.setAlpha(i10);
                                } else {
                                    i10 = i9;
                                    Theme.chat_replyNamePaint.setAlpha((int) (i10 * this.transitionParams.animateChangeProgress));
                                }
                                this.commentNumberLayout.draw(canvas);
                                if (this.drawCommentNumber) {
                                    canvas.translate(this.commentNumberWidth + AndroidUtilities.dp(4.0f), 0.0f);
                                }
                            } else {
                                i10 = i9;
                            }
                            if (this.transitionParams.animateComments && this.transitionParams.animateCommentsLayout != null) {
                                Theme.chat_replyNamePaint.setAlpha((int) (i10 * this.transitionParams.animateChangeProgress));
                            } else {
                                Theme.chat_replyNamePaint.setAlpha((int) (i10 * f));
                            }
                            this.commentLayout.draw(canvas);
                            canvas.restore();
                            int dp7 = i7 + this.commentWidth + AndroidUtilities.dp(f8) + AndroidUtilities.dp(9.0f);
                            this.commentUnreadX = dp7;
                            if (this.drawCommentNumber) {
                                this.commentUnreadX = dp7 + this.commentNumberWidth + AndroidUtilities.dp(4.0f);
                            }
                            TLRPC$MessageReplies tLRPC$MessageReplies = null;
                            MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
                            if (groupedMessages2 != null && !groupedMessages2.messages.isEmpty()) {
                                MessageObject messageObject = this.currentMessagesGroup.messages.get(0);
                                if (messageObject.hasReplies()) {
                                    tLRPC$MessageReplies = messageObject.messageOwner.replies;
                                }
                            } else if (this.currentMessageObject.hasReplies()) {
                                tLRPC$MessageReplies = this.currentMessageObject.messageOwner.replies;
                            }
                            boolean z3 = (tLRPC$MessageReplies == null || (i12 = tLRPC$MessageReplies.read_max_id) == 0 || i12 >= tLRPC$MessageReplies.max_id) ? false : true;
                            this.commentDrawUnread = z3;
                            if (z3) {
                                Theme.chat_docBackPaint.setColor(getThemedColor("chat_inInstant"));
                                if (!this.transitionParams.animateComments) {
                                    i11 = this.commentUnreadX;
                                } else {
                                    if (!this.transitionParams.animateCommentDrawUnread) {
                                        Theme.chat_docBackPaint.setAlpha((int) (Color.alpha(themedColor) * this.transitionParams.animateChangeProgress));
                                    }
                                    i11 = (int) (this.transitionParams.animateCommentUnreadX + ((this.commentUnreadX - this.transitionParams.animateCommentUnreadX) * this.transitionParams.animateChangeProgress));
                                }
                                canvas.drawCircle(i11, f6 + AndroidUtilities.dp(8.0f) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0), AndroidUtilities.dp(2.5f), Theme.chat_docBackPaint);
                            }
                        }
                        if (!z2) {
                            BaseCell.setDrawableBounds(Theme.chat_commentDrawable, i7, (f6 - AndroidUtilities.dp(4.0f)) + (this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0));
                            if (f != 1.0f) {
                                Theme.chat_commentDrawable.setAlpha((int) (f * 255.0f));
                                Theme.chat_commentDrawable.draw(canvas);
                                Theme.chat_commentDrawable.setAlpha(255);
                            } else {
                                Theme.chat_commentDrawable.draw(canvas);
                            }
                        }
                        this.commentArrowX = dp2 - AndroidUtilities.dp(44.0f);
                        if (this.transitionParams.animateComments) {
                            i8 = this.commentArrowX;
                        } else {
                            i8 = (int) (this.transitionParams.animateCommentArrowX + ((this.commentArrowX - this.transitionParams.animateCommentArrowX) * this.transitionParams.animateChangeProgress));
                        }
                        float dp8 = (f6 - AndroidUtilities.dp(4.0f)) + (!this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0);
                        shouldDrawThreadProgress = this.delegate.shouldDrawThreadProgress(this);
                        long elapsedRealtime = SystemClock.elapsedRealtime();
                        j = elapsedRealtime - this.commentProgressLastUpadteTime;
                        this.commentProgressLastUpadteTime = elapsedRealtime;
                        if (j > 17) {
                            j = 17;
                        }
                        if (!shouldDrawThreadProgress) {
                            float f9 = this.commentProgressAlpha;
                            if (f9 < 1.0f) {
                                float f10 = f9 + (((float) j) / 180.0f);
                                this.commentProgressAlpha = f10;
                                if (f10 > 1.0f) {
                                    this.commentProgressAlpha = 1.0f;
                                }
                            }
                            f4 = 0.0f;
                        } else {
                            float f11 = this.commentProgressAlpha;
                            f4 = 0.0f;
                            if (f11 > 0.0f) {
                                float f12 = f11 - (((float) j) / 180.0f);
                                this.commentProgressAlpha = f12;
                                if (f12 < 0.0f) {
                                    this.commentProgressAlpha = 0.0f;
                                }
                            }
                        }
                        if ((!shouldDrawThreadProgress || this.commentProgressAlpha > f4) && (infiniteProgress = this.commentProgress) != null) {
                            infiniteProgress.setColor(getThemedColor("chat_inInstant"));
                            this.commentProgress.setAlpha(this.commentProgressAlpha);
                            this.commentProgress.draw(canvas, AndroidUtilities.dp(11.0f) + i8, dp8 + AndroidUtilities.dp(12.0f), this.commentProgressAlpha);
                            invalidate();
                        }
                        if (shouldDrawThreadProgress || this.commentProgressAlpha < 1.0f) {
                            int intrinsicWidth = Theme.chat_commentArrowDrawable.getIntrinsicWidth() / 2;
                            float f13 = i8 + intrinsicWidth;
                            float intrinsicHeight = Theme.chat_commentArrowDrawable.getIntrinsicHeight() / 2;
                            float f14 = dp8 + intrinsicHeight;
                            Drawable drawable = Theme.chat_commentArrowDrawable;
                            float f15 = intrinsicWidth;
                            float f16 = this.commentProgressAlpha;
                            drawable.setBounds((int) (f13 - ((1.0f - f16) * f15)), (int) (f14 - ((1.0f - f16) * intrinsicHeight)), (int) (f13 + (f15 * (1.0f - f16))), (int) (f14 + (intrinsicHeight * (1.0f - f16))));
                            Theme.chat_commentArrowDrawable.setAlpha((int) ((1.0f - this.commentProgressAlpha) * 255.0f * f));
                            Theme.chat_commentArrowDrawable.draw(canvas);
                        }
                        if (staticLayout == null) {
                            return;
                        }
                        if (z && this.links.isEmpty()) {
                            return;
                        }
                        MessageObject messageObject2 = this.currentMessageObject;
                        if ((messageObject2.deleted && this.currentPosition != null) || f == 0.0f) {
                            return;
                        }
                        if (messageObject2.isOutOwner()) {
                            Theme.chat_msgTextPaint.setColor(getThemedColor("chat_messageTextOut"));
                            Theme.chat_msgTextPaint.linkColor = getThemedColor("chat_messageLinkOut");
                        } else {
                            Theme.chat_msgTextPaint.setColor(getThemedColor("chat_messageTextIn"));
                            Theme.chat_msgTextPaint.linkColor = getThemedColor("chat_messageLinkIn");
                        }
                        canvas.save();
                        MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
                        float f17 = groupedMessages3 != null ? groupedMessages3.transitionParams.captionEnterProgress * f : f;
                        if (f17 == 0.0f) {
                            return;
                        }
                        float f18 = this.captionY;
                        float f19 = this.captionX;
                        TransitionParams transitionParams2 = this.transitionParams;
                        if (transitionParams2.animateBackgroundBoundsInner) {
                            if (transitionParams2.transformGroupToSingleMessage) {
                                f18 -= getTranslationY();
                                f2 = this.transitionParams.deltaLeft;
                            } else if (transitionParams2.moveCaption) {
                                float f20 = this.captionX;
                                TransitionParams transitionParams3 = this.transitionParams;
                                float f21 = transitionParams3.animateChangeProgress;
                                float f22 = (f20 * f21) + (transitionParams3.captionFromX * (1.0f - f21));
                                float f23 = (transitionParams3.captionFromY * (1.0f - f21)) + (this.captionY * f21);
                                f19 = f22;
                                f18 = f23;
                            } else if (!this.currentMessageObject.isVoice() || !TextUtils.isEmpty(this.currentMessageObject.caption)) {
                                f2 = this.transitionParams.deltaLeft;
                            }
                            f19 += f2;
                        }
                        if (f17 != 1.0f) {
                            this.rect.set(f19, f18, staticLayout.getWidth() + f19, staticLayout.getHeight() + f18);
                            i = canvas.saveLayerAlpha(this.rect, (int) (f17 * 255.0f), 31);
                        } else {
                            i = Integer.MIN_VALUE;
                        }
                        if (this.transitionParams.animateBackgroundBoundsInner && this.currentBackgroundDrawable != null && this.currentMessagesGroup == null) {
                            int height = (!this.drawCommentButton || (rect = this.commentButtonRect) == null) ? 0 : rect.height();
                            ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
                            int i19 = height + ((reactionsLayoutInBubble2 == null || reactionsLayoutInBubble2.isSmall) ? 0 : reactionsLayoutInBubble2.height);
                            if (this.currentMessageObject.isOutOwner() && !this.mediaBackground && !this.pinnedBottom) {
                                canvas.clipRect(getBackgroundDrawableLeft() + this.transitionParams.deltaLeft + AndroidUtilities.dp(4.0f), getBackgroundDrawableTop() + this.transitionParams.deltaTop + AndroidUtilities.dp(4.0f), (getBackgroundDrawableRight() + this.transitionParams.deltaRight) - AndroidUtilities.dp(10.0f), ((getBackgroundDrawableBottom() + this.transitionParams.deltaBottom) - AndroidUtilities.dp(4.0f)) - i19);
                            } else {
                                canvas.clipRect(getBackgroundDrawableLeft() + this.transitionParams.deltaLeft + AndroidUtilities.dp(4.0f), getBackgroundDrawableTop() + this.transitionParams.deltaTop + AndroidUtilities.dp(4.0f), (getBackgroundDrawableRight() + this.transitionParams.deltaRight) - AndroidUtilities.dp(4.0f), ((getBackgroundDrawableBottom() + this.transitionParams.deltaBottom) - AndroidUtilities.dp(4.0f)) - i19);
                            }
                        }
                        canvas.translate(f19, f18);
                        if (this.links.draw(canvas)) {
                            invalidate();
                        }
                        if (!this.urlPathSelection.isEmpty()) {
                            for (int i20 = 0; i20 < this.urlPathSelection.size(); i20++) {
                                canvas.drawPath(this.urlPathSelection.get(i20), Theme.chat_textSearchSelectionPaint);
                            }
                        }
                        if (!z) {
                            try {
                                if (getDelegate() != null && getDelegate().getTextSelectionHelper() != null && getDelegate().getTextSelectionHelper().isSelected(this.currentMessageObject)) {
                                    getDelegate().getTextSelectionHelper().drawCaption(this.currentMessageObject.isOutOwner(), staticLayout, canvas);
                                }
                                getY();
                                getY();
                                Emoji.emojiDrawingYOffset = -this.transitionYOffsetForDrawables;
                                SpoilerEffect.renderWithRipple(this, this.invalidateSpoilersParent, (!this.currentMessageObject.isOut() || ChatObject.isChannelAndNotMegaGroup(this.currentMessageObject.getChatId(), this.currentAccount)) ? staticLayout.getPaint().getColor() : getThemedColor("chat_outTimeText"), 0, this.captionPatchedSpoilersLayout, staticLayout, this.captionSpoilers, canvas, this.currentMessagesGroup != null);
                                Emoji.emojiDrawingYOffset = 0.0f;
                            } catch (Exception e) {
                                FileLog.e(e);
                            }
                        }
                        if (i != Integer.MIN_VALUE) {
                            canvas.restoreToCount(i);
                        }
                        canvas.restore();
                        return;
                    }
                }
                if (isDrawSelectionBackground()) {
                    Theme.chat_replyLinePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outVoiceSeekbarSelected" : "chat_inVoiceSeekbarSelected"));
                } else {
                    Theme.chat_replyLinePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outVoiceSeekbar" : "chat_inVoiceSeekbar"));
                }
                TransitionParams transitionParams4 = this.transitionParams;
                float dp9 = (this.layoutHeight - AndroidUtilities.dp(f3)) + transitionParams4.deltaBottom;
                MessageObject.GroupedMessages groupedMessages4 = this.currentMessagesGroup;
                if (groupedMessages4 != null) {
                    MessageObject.GroupedMessages.TransitionParams transitionParams5 = groupedMessages4.transitionParams;
                    dp9 += transitionParams5.offsetBottom;
                    if (transitionParams5.backgroundChangeBounds) {
                        dp9 -= getTranslationY();
                    }
                } else {
                    dp2 = (i2 + ((int) ((this.backgroundWidth - transitionParams4.deltaLeft) + transitionParams4.deltaRight))) - AndroidUtilities.dp(12.0f);
                }
                float f24 = dp9;
                int i21 = i2;
                i7 = i21;
                canvas.drawLine(i21, f24, i6 - AndroidUtilities.dp(14.0f), f24, Theme.chat_replyLinePaint);
                dp2 = dp2;
                if (this.commentLayout == null) {
                }
                if (!z2) {
                }
                this.commentArrowX = dp2 - AndroidUtilities.dp(44.0f);
                if (this.transitionParams.animateComments) {
                }
                float dp82 = (f6 - AndroidUtilities.dp(4.0f)) + (!this.pinnedBottom ? AndroidUtilities.dp(2.0f) : 0);
                shouldDrawThreadProgress = this.delegate.shouldDrawThreadProgress(this);
                long elapsedRealtime2 = SystemClock.elapsedRealtime();
                j = elapsedRealtime2 - this.commentProgressLastUpadteTime;
                this.commentProgressLastUpadteTime = elapsedRealtime2;
                if (j > 17) {
                }
                if (!shouldDrawThreadProgress) {
                }
                if (!shouldDrawThreadProgress) {
                }
                infiniteProgress.setColor(getThemedColor("chat_inInstant"));
                this.commentProgress.setAlpha(this.commentProgressAlpha);
                this.commentProgress.draw(canvas, AndroidUtilities.dp(11.0f) + i8, dp82 + AndroidUtilities.dp(12.0f), this.commentProgressAlpha);
                invalidate();
                if (shouldDrawThreadProgress) {
                }
                int intrinsicWidth2 = Theme.chat_commentArrowDrawable.getIntrinsicWidth() / 2;
                float f132 = i8 + intrinsicWidth2;
                float intrinsicHeight2 = Theme.chat_commentArrowDrawable.getIntrinsicHeight() / 2;
                float f142 = dp82 + intrinsicHeight2;
                Drawable drawable2 = Theme.chat_commentArrowDrawable;
                float f152 = intrinsicWidth2;
                float f162 = this.commentProgressAlpha;
                drawable2.setBounds((int) (f132 - ((1.0f - f162) * f152)), (int) (f142 - ((1.0f - f162) * intrinsicHeight2)), (int) (f132 + (f152 * (1.0f - f162))), (int) (f142 + (intrinsicHeight2 * (1.0f - f162))));
                Theme.chat_commentArrowDrawable.setAlpha((int) ((1.0f - this.commentProgressAlpha) * 255.0f * f));
                Theme.chat_commentArrowDrawable.draw(canvas);
                if (staticLayout == null) {
                }
            }
        }
        if (staticLayout == null) {
        }
    }

    public boolean needDrawTime() {
        return !this.forceNotDrawTime;
    }

    public boolean shouldDrawTimeOnMedia() {
        int i = this.overideShouldDrawTimeOnMedia;
        if (i != 0) {
            return i == 1;
        } else if (!this.mediaBackground || this.captionLayout != null) {
            return false;
        } else {
            ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
            return reactionsLayoutInBubble.isEmpty || reactionsLayoutInBubble.isSmall || this.currentMessageObject.isAnyKindOfSticker() || this.currentMessageObject.isRoundVideo();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:58:0x0102  */
    /* JADX WARN: Removed duplicated region for block: B:61:0x0126  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawTime(Canvas canvas, float f, boolean z) {
        float f2;
        float f3;
        TransitionParams transitionParams;
        float f4;
        float f5;
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.drawFromPinchToZoom || (chatMessageCellDelegate = this.delegate) == null || chatMessageCellDelegate.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this) || !shouldDrawTimeOnMedia()) {
            int i = 0;
            while (i < 2) {
                if (i != 0 || !isDrawSelectionBackground() || this.currentSelectedBackgroundAlpha != 1.0f || shouldDrawTimeOnMedia()) {
                    if (i == 1 && ((!isDrawSelectionBackground() && this.currentSelectedBackgroundAlpha == 0.0f) || shouldDrawTimeOnMedia())) {
                        break;
                    }
                    boolean z2 = i == 1;
                    if (i == 1) {
                        f3 = this.currentSelectedBackgroundAlpha;
                    } else if (!shouldDrawTimeOnMedia()) {
                        f3 = 1.0f - this.currentSelectedBackgroundAlpha;
                    } else {
                        f2 = f;
                        if (!this.transitionParams.animateShouldDrawTimeOnMedia && this.transitionParams.animateChangeProgress != 1.0f) {
                            if (shouldDrawTimeOnMedia()) {
                                this.overideShouldDrawTimeOnMedia = 1;
                                boolean z3 = z2;
                                drawTimeInternal(canvas, f2 * this.transitionParams.animateChangeProgress, z, this.timeX, this.timeLayout, this.timeWidth, z3);
                                this.overideShouldDrawTimeOnMedia = 2;
                                TransitionParams transitionParams2 = this.transitionParams;
                                drawTimeInternal(canvas, f2 * (1.0f - transitionParams2.animateChangeProgress), z, transitionParams2.animateFromTimeX, transitionParams2.animateTimeLayout, this.transitionParams.animateTimeWidth, z3);
                            } else {
                                this.overideShouldDrawTimeOnMedia = 2;
                                boolean z4 = z2;
                                drawTimeInternal(canvas, f2 * this.transitionParams.animateChangeProgress, z, this.timeX, this.timeLayout, this.timeWidth, z4);
                                this.overideShouldDrawTimeOnMedia = 1;
                                TransitionParams transitionParams3 = this.transitionParams;
                                drawTimeInternal(canvas, f2 * (1.0f - transitionParams3.animateChangeProgress), z, transitionParams3.animateFromTimeX, transitionParams3.animateTimeLayout, this.transitionParams.animateTimeWidth, z4);
                            }
                            this.overideShouldDrawTimeOnMedia = 0;
                        } else {
                            transitionParams = this.transitionParams;
                            if (!transitionParams.shouldAnimateTimeX) {
                                float f6 = transitionParams.animateChangeProgress;
                                f5 = (this.timeX * f6) + (transitionParams.animateFromTimeX * (1.0f - f6));
                                f4 = (this.timeWidth * f6) + (transitionParams.animateTimeWidth * (1.0f - this.transitionParams.animateChangeProgress));
                            } else {
                                float f7 = this.timeX + transitionParams.deltaRight;
                                f4 = this.timeWidth;
                                f5 = f7;
                            }
                            drawTimeInternal(canvas, f2, z, f5, this.timeLayout, f4, z2);
                        }
                    }
                    f2 = f3 * f;
                    if (!this.transitionParams.animateShouldDrawTimeOnMedia) {
                    }
                    transitionParams = this.transitionParams;
                    if (!transitionParams.shouldAnimateTimeX) {
                    }
                    drawTimeInternal(canvas, f2, z, f5, this.timeLayout, f4, z2);
                }
                i++;
            }
            if (!this.transitionParams.animateBackgroundBoundsInner) {
                return;
            }
            drawOverlays(canvas);
        }
    }

    private void drawTimeInternal(Canvas canvas, float f, boolean z, float f2, StaticLayout staticLayout, float f3, boolean z2) {
        int i;
        float f4;
        float f5;
        String str;
        int i2;
        int i3;
        boolean z3;
        float f6;
        char c;
        int color;
        float dp;
        boolean z4;
        Paint themedPaint;
        int dp2;
        boolean z5;
        String str2;
        int i4;
        int i5;
        float currentWidth;
        TextPaint textPaint;
        if (((!this.drawTime || this.groupPhotoInvisible) && shouldDrawTimeOnMedia()) || staticLayout == null) {
            return;
        }
        MessageObject messageObject = this.currentMessageObject;
        if ((messageObject.deleted && this.currentPosition != null) || (i = messageObject.type) == 16) {
            return;
        }
        if (i == 5) {
            Theme.chat_timePaint.setColor(getThemedColor("chat_serviceText"));
        } else if (shouldDrawTimeOnMedia()) {
            if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                Theme.chat_timePaint.setColor(getThemedColor("chat_serviceText"));
            } else {
                Theme.chat_timePaint.setColor(getThemedColor("chat_mediaTimeText"));
            }
        } else if (this.currentMessageObject.isOutOwner()) {
            Theme.chat_timePaint.setColor(getThemedColor(z2 ? "chat_outTimeSelectedText" : "chat_outTimeText"));
        } else {
            Theme.chat_timePaint.setColor(getThemedColor(z2 ? "chat_inTimeSelectedText" : "chat_inTimeText"));
        }
        float f7 = getTransitionParams().animateDrawingTimeAlpha ? getTransitionParams().animateChangeProgress * f : f;
        if (f7 != 1.0f) {
            Theme.chat_timePaint.setAlpha((int) (textPaint.getAlpha() * f7));
        }
        canvas.save();
        float f8 = 2.0f;
        if (this.drawPinnedBottom && !shouldDrawTimeOnMedia()) {
            canvas.translate(0.0f, AndroidUtilities.dp(2.0f));
        }
        TransitionParams transitionParams = this.transitionParams;
        float f9 = this.layoutHeight + transitionParams.deltaBottom;
        if (transitionParams.shouldAnimateTimeX) {
            float f10 = transitionParams.animateChangeProgress;
            f4 = (transitionParams.animateFromTimeX * (1.0f - f10)) + (this.timeX * f10);
        } else {
            f4 = f2;
        }
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages == null || !groupedMessages.transitionParams.backgroundChangeBounds) {
            f5 = f2;
        } else {
            f9 -= getTranslationY();
            float f11 = this.currentMessagesGroup.transitionParams.offsetRight;
            f5 = f2 + f11;
            f4 += f11;
        }
        if (this.drawPinnedBottom && shouldDrawTimeOnMedia()) {
            f9 += AndroidUtilities.dp(1.0f);
        }
        float f12 = f9;
        TransitionParams transitionParams2 = this.transitionParams;
        boolean z6 = transitionParams2.animateBackgroundBoundsInner;
        if (z6) {
            float f13 = this.animationOffsetX;
            f5 += f13;
            f4 += f13;
        }
        float f14 = f5;
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        if (reactionsLayoutInBubble.isSmall) {
            if (z6 && transitionParams2.deltaRight != 0.0f) {
                currentWidth = reactionsLayoutInBubble.getCurrentWidth(1.0f);
            } else {
                currentWidth = reactionsLayoutInBubble.getCurrentWidth(transitionParams2.animateChangeProgress);
            }
            f4 += currentWidth;
        }
        if (this.transitionParams.animateEditedEnter) {
            f4 -= this.transitionParams.animateEditedWidthDiff * (1.0f - this.transitionParams.animateChangeProgress);
        }
        float f15 = f4;
        boolean z7 = true;
        if (shouldDrawTimeOnMedia()) {
            int i6 = -(this.drawCommentButton ? AndroidUtilities.dp(41.3f) : 0);
            if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                themedPaint = getThemedPaint("paintChatActionBackground");
            } else {
                themedPaint = getThemedPaint("paintChatTimeBackground");
            }
            int alpha = themedPaint.getAlpha();
            themedPaint.setAlpha((int) (alpha * this.timeAlpha * f7));
            Theme.chat_timePaint.setAlpha((int) (this.timeAlpha * 255.0f * f7));
            int i7 = this.documentAttachType;
            if (i7 != 7 && i7 != 6 && this.currentMessageObject.type != 19) {
                int[] roundRadius = this.photoImage.getRoundRadius();
                dp2 = Math.min(AndroidUtilities.dp(8.0f), Math.max(roundRadius[2], roundRadius[3]));
                z5 = SharedConfig.bubbleRadius >= 10;
            } else {
                dp2 = AndroidUtilities.dp(4.0f);
                z5 = false;
            }
            float dp3 = f14 - AndroidUtilities.dp(z5 ? 6.0f : 4.0f);
            float imageY2 = this.additionalTimeOffsetY + this.photoImage.getImageY2();
            float dp4 = imageY2 - AndroidUtilities.dp(23.0f);
            RectF rectF = this.rect;
            float f16 = dp3 + f3;
            int i8 = z5 ? 12 : 8;
            if (this.currentMessageObject.isOutOwner()) {
                str2 = "paintChatTimeBackground";
                i4 = (this.currentMessageObject.type == 19 ? 4 : 0) + 20;
            } else {
                str2 = "paintChatTimeBackground";
                i4 = 0;
            }
            rectF.set(dp3, dp4, f16 + AndroidUtilities.dp(i8 + i4), AndroidUtilities.dp(17.0f) + dp4);
            applyServiceShaderMatrix();
            float f17 = dp2;
            canvas.drawRoundRect(this.rect, f17, f17, themedPaint);
            if (themedPaint == getThemedPaint("paintChatActionBackground") && hasGradientService()) {
                int alpha2 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha2 * this.timeAlpha * f7));
                canvas.drawRoundRect(this.rect, f17, f17, Theme.chat_actionBackgroundGradientDarkenPaint);
                Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha2);
            }
            themedPaint.setAlpha(alpha);
            float f18 = -staticLayout.getLineLeft(0);
            if (this.reactionsLayoutInBubble.isSmall) {
                updateReactionLayoutPosition();
                this.reactionsLayoutInBubble.draw(canvas, this.transitionParams.animateChangeProgress, null);
            }
            if ((!ChatObject.isChannel(this.currentChat) || this.currentChat.megagroup) && (this.currentMessageObject.messageOwner.flags & 1024) == 0 && this.repliesLayout == null && !this.isPinned) {
                z3 = z5;
                str = str2;
                i5 = i6;
            } else {
                float lineWidth = f18 + (this.timeWidth - staticLayout.getLineWidth(0));
                ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
                if (reactionsLayoutInBubble2.isSmall && !reactionsLayoutInBubble2.isEmpty) {
                    lineWidth -= reactionsLayoutInBubble2.width;
                }
                float f19 = lineWidth;
                int createStatusDrawableParams = this.transitionParams.createStatusDrawableParams();
                int i9 = this.transitionParams.lastStatusDrawableParams;
                if (i9 >= 0 && i9 != createStatusDrawableParams && !this.statusDrawableAnimationInProgress) {
                    createStatusDrawableAnimator(i9, createStatusDrawableParams, z);
                }
                boolean z8 = this.statusDrawableAnimationInProgress;
                if (z8) {
                    createStatusDrawableParams = this.animateToStatusDrawableParams;
                }
                boolean z9 = (createStatusDrawableParams & 4) != 0;
                boolean z10 = (createStatusDrawableParams & 8) != 0;
                if (z8) {
                    int i10 = this.animateFromStatusDrawableParams;
                    boolean z11 = (i10 & 4) != 0;
                    boolean z12 = (i10 & 8) != 0;
                    float f20 = i6;
                    float f21 = f7;
                    z3 = z5;
                    i5 = i6;
                    str = str2;
                    drawClockOrErrorLayout(canvas, z11, z12, f12, f21, f20, f14, 1.0f - this.statusDrawableProgress, z2);
                    drawClockOrErrorLayout(canvas, z9, z10, f12, f21, f20, f14, this.statusDrawableProgress, z2);
                    if (!this.currentMessageObject.isOutOwner()) {
                        if (!z11 && !z12) {
                            drawViewsAndRepliesLayout(canvas, f12, f7, f20, f14, 1.0f - this.statusDrawableProgress, z2);
                        }
                        if (!z9 && !z10) {
                            drawViewsAndRepliesLayout(canvas, f12, f7, f20, f14, this.statusDrawableProgress, z2);
                        }
                    }
                } else {
                    z3 = z5;
                    str = str2;
                    i5 = i6;
                    if (!this.currentMessageObject.isOutOwner() && !z9 && !z10) {
                        drawViewsAndRepliesLayout(canvas, f12, f7, i5, f14, 1.0f, z2);
                    }
                    drawClockOrErrorLayout(canvas, z9, z10, f12, f7, i5, f14, 1.0f, z2);
                }
                if (this.currentMessageObject.isOutOwner()) {
                    drawViewsAndRepliesLayout(canvas, f12, f7, i5, f14, 1.0f, z2);
                }
                TransitionParams transitionParams3 = this.transitionParams;
                transitionParams3.lastStatusDrawableParams = transitionParams3.createStatusDrawableParams();
                if (z9 && z && getParent() != null) {
                    ((View) getParent()).invalidate();
                }
                f18 = f19;
            }
            canvas.save();
            float f22 = f15 + f18;
            this.drawTimeX = f22;
            float dp5 = (imageY2 - AndroidUtilities.dp(7.3f)) - staticLayout.getHeight();
            this.drawTimeY = dp5;
            canvas.translate(f22, dp5);
            staticLayout.draw(canvas);
            canvas.restore();
            Theme.chat_timePaint.setAlpha(255);
            i3 = i5;
        } else {
            str = "paintChatTimeBackground";
            if (this.currentMessageObject.isSponsored()) {
                i2 = -AndroidUtilities.dp(48.0f);
                if (this.hasNewLineForTime) {
                    i2 -= AndroidUtilities.dp(16.0f);
                }
            } else {
                i2 = -(this.drawCommentButton ? AndroidUtilities.dp(43.0f) : 0);
            }
            int i11 = i2;
            float f23 = -staticLayout.getLineLeft(0);
            if (this.reactionsLayoutInBubble.isSmall) {
                updateReactionLayoutPosition();
                this.reactionsLayoutInBubble.draw(canvas, this.transitionParams.animateChangeProgress, null);
            }
            if ((ChatObject.isChannel(this.currentChat) && !this.currentChat.megagroup) || (this.currentMessageObject.messageOwner.flags & 1024) != 0 || this.repliesLayout != null || this.transitionParams.animateReplies || this.isPinned || this.transitionParams.animatePinned) {
                float lineWidth2 = f23 + (this.timeWidth - staticLayout.getLineWidth(0));
                ReactionsLayoutInBubble reactionsLayoutInBubble3 = this.reactionsLayoutInBubble;
                if (reactionsLayoutInBubble3.isSmall && !reactionsLayoutInBubble3.isEmpty) {
                    lineWidth2 -= reactionsLayoutInBubble3.width;
                }
                float f24 = lineWidth2;
                int createStatusDrawableParams2 = this.transitionParams.createStatusDrawableParams();
                int i12 = this.transitionParams.lastStatusDrawableParams;
                if (i12 >= 0 && i12 != createStatusDrawableParams2 && !this.statusDrawableAnimationInProgress) {
                    createStatusDrawableAnimator(i12, createStatusDrawableParams2, z);
                }
                boolean z13 = this.statusDrawableAnimationInProgress;
                if (z13) {
                    createStatusDrawableParams2 = this.animateToStatusDrawableParams;
                }
                boolean z14 = (createStatusDrawableParams2 & 4) != 0;
                boolean z15 = (createStatusDrawableParams2 & 8) != 0;
                if (z13) {
                    int i13 = this.animateFromStatusDrawableParams;
                    boolean z16 = (i13 & 4) != 0;
                    boolean z17 = (i13 & 8) != 0;
                    float f25 = i11;
                    float f26 = f7;
                    drawClockOrErrorLayout(canvas, z16, z17, f12, f26, f25, f14, 1.0f - this.statusDrawableProgress, z2);
                    drawClockOrErrorLayout(canvas, z14, z15, f12, f26, f25, f14, this.statusDrawableProgress, z2);
                    if (!this.currentMessageObject.isOutOwner()) {
                        if (!z16 && !z17) {
                            drawViewsAndRepliesLayout(canvas, f12, f7, f25, f14, 1.0f - this.statusDrawableProgress, z2);
                        }
                        if (!z14 && !z15) {
                            drawViewsAndRepliesLayout(canvas, f12, f7, f25, f14, this.statusDrawableProgress, z2);
                        }
                    }
                } else {
                    if (!this.currentMessageObject.isOutOwner() && !z14 && !z15) {
                        drawViewsAndRepliesLayout(canvas, f12, f7, i11, f14, 1.0f, z2);
                    }
                    drawClockOrErrorLayout(canvas, z14, z15, f12, f7, i11, f14, 1.0f, z2);
                }
                if (this.currentMessageObject.isOutOwner()) {
                    drawViewsAndRepliesLayout(canvas, f12, f7, i11, f14, 1.0f, z2);
                }
                TransitionParams transitionParams4 = this.transitionParams;
                transitionParams4.lastStatusDrawableParams = transitionParams4.createStatusDrawableParams();
                if (z14 && z && getParent() != null) {
                    ((View) getParent()).invalidate();
                }
                f23 = f24;
            }
            canvas.save();
            float f27 = 6.5f;
            if (this.transitionParams.animateEditedEnter) {
                TransitionParams transitionParams5 = this.transitionParams;
                if (transitionParams5.animateChangeProgress != 1.0f) {
                    if (transitionParams5.animateEditedLayout != null) {
                        float f28 = f15 + f23;
                        if (this.pinnedBottom || this.pinnedTop) {
                            f27 = 7.5f;
                        }
                        canvas.translate(f28, ((f12 - AndroidUtilities.dp(f27)) - staticLayout.getHeight()) + i11);
                        int alpha3 = Theme.chat_timePaint.getAlpha();
                        Theme.chat_timePaint.setAlpha((int) (alpha3 * this.transitionParams.animateChangeProgress));
                        this.transitionParams.animateEditedLayout.draw(canvas);
                        Theme.chat_timePaint.setAlpha(alpha3);
                        this.transitionParams.animateTimeLayout.draw(canvas);
                    } else {
                        int alpha4 = Theme.chat_timePaint.getAlpha();
                        canvas.save();
                        float f29 = i11;
                        canvas.translate(this.transitionParams.animateFromTimeX + f23, ((f12 - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 7.5f : 6.5f)) - staticLayout.getHeight()) + f29);
                        float f30 = alpha4;
                        Theme.chat_timePaint.setAlpha((int) ((1.0f - this.transitionParams.animateChangeProgress) * f30));
                        this.transitionParams.animateTimeLayout.draw(canvas);
                        canvas.restore();
                        float f31 = f15 + f23;
                        if (this.pinnedBottom || this.pinnedTop) {
                            f27 = 7.5f;
                        }
                        canvas.translate(f31, ((f12 - AndroidUtilities.dp(f27)) - staticLayout.getHeight()) + f29);
                        Theme.chat_timePaint.setAlpha((int) (f30 * this.transitionParams.animateChangeProgress));
                        staticLayout.draw(canvas);
                        Theme.chat_timePaint.setAlpha(alpha4);
                    }
                    canvas.restore();
                    i3 = i11;
                    z3 = false;
                }
            }
            float f32 = f15 + f23;
            this.drawTimeX = f32;
            if (this.pinnedBottom || this.pinnedTop) {
                f27 = 7.5f;
            }
            float dp6 = ((f12 - AndroidUtilities.dp(f27)) - staticLayout.getHeight()) + i11;
            this.drawTimeY = dp6;
            canvas.translate(f32, dp6);
            staticLayout.draw(canvas);
            canvas.restore();
            i3 = i11;
            z3 = false;
        }
        if (this.currentMessageObject.isOutOwner()) {
            int createStatusDrawableParams3 = this.transitionParams.createStatusDrawableParams();
            int i14 = this.transitionParams.lastStatusDrawableParams;
            if (i14 >= 0 && i14 != createStatusDrawableParams3 && !this.statusDrawableAnimationInProgress) {
                createStatusDrawableAnimator(i14, createStatusDrawableParams3, z);
            }
            if (this.statusDrawableAnimationInProgress) {
                createStatusDrawableParams3 = this.animateToStatusDrawableParams;
            }
            boolean z18 = (createStatusDrawableParams3 & 1) != 0;
            boolean z19 = (createStatusDrawableParams3 & 2) != 0;
            boolean z20 = (createStatusDrawableParams3 & 4) != 0;
            boolean z21 = (createStatusDrawableParams3 & 8) != 0;
            if (this.transitionYOffsetForDrawables != 0.0f) {
                canvas.save();
                canvas.translate(0.0f, this.transitionYOffsetForDrawables);
                z4 = true;
            } else {
                z4 = false;
            }
            if (this.statusDrawableAnimationInProgress) {
                int i15 = this.animateFromStatusDrawableParams;
                boolean z22 = (i15 & 1) != 0;
                boolean z23 = (i15 & 2) != 0;
                boolean z24 = (i15 & 4) != 0;
                boolean z25 = (i15 & 8) != 0;
                if (!z24 && z23 && z19 && !z22 && z18) {
                    f6 = 0.0f;
                    c = 5;
                    drawStatusDrawable(canvas, z18, z19, z20, z21, f7, z3, i3, f12, this.statusDrawableProgress, true, z2);
                } else {
                    f6 = 0.0f;
                    c = 5;
                    float f33 = i3;
                    boolean z26 = z25;
                    float f34 = f7;
                    boolean z27 = z3;
                    drawStatusDrawable(canvas, z22, z23, z24, z26, f34, z27, f33, f12, 1.0f - this.statusDrawableProgress, false, z2);
                    drawStatusDrawable(canvas, z18, z19, z20, z21, f34, z27, f33, f12, this.statusDrawableProgress, false, z2);
                }
            } else {
                f6 = 0.0f;
                c = 5;
                drawStatusDrawable(canvas, z18, z19, z20, z21, f7, z3, i3, f12, 1.0f, false, z2);
            }
            if (z4) {
                canvas.restore();
            }
            TransitionParams transitionParams6 = this.transitionParams;
            transitionParams6.lastStatusDrawableParams = transitionParams6.createStatusDrawableParams();
            if (z && z20 && getParent() != null) {
                ((View) getParent()).invalidate();
            }
        } else {
            f6 = 0.0f;
            c = 5;
        }
        canvas.restore();
        if (this.unlockLayout == null) {
            return;
        }
        if (this.unlockX == f6 || this.unlockY == f6) {
            calculateUnlockXY();
        }
        this.unlockSpoilerPath.rewind();
        RectF rectF2 = AndroidUtilities.rectTmp;
        rectF2.set(this.photoImage.getImageX(), this.photoImage.getImageY(), this.photoImage.getImageX2(), this.photoImage.getImageY2());
        int[] roundRadius2 = this.photoImage.getRoundRadius();
        float[] fArr = this.unlockSpoilerRadii;
        float f35 = roundRadius2[0];
        fArr[1] = f35;
        fArr[0] = f35;
        float f36 = roundRadius2[1];
        fArr[3] = f36;
        fArr[2] = f36;
        float f37 = roundRadius2[2];
        fArr[c] = f37;
        fArr[4] = f37;
        float f38 = roundRadius2[3];
        fArr[7] = f38;
        fArr[6] = f38;
        this.unlockSpoilerPath.addRoundRect(rectF2, fArr, Path.Direction.CW);
        canvas.save();
        canvas.clipPath(this.unlockSpoilerPath);
        this.unlockSpoilerPath.rewind();
        rectF2.set(this.unlockX - AndroidUtilities.dp(12.0f), this.unlockY - AndroidUtilities.dp(8.0f), this.unlockX + Theme.chat_msgUnlockDrawable.getIntrinsicWidth() + AndroidUtilities.dp(14.0f) + this.unlockLayout.getWidth() + AndroidUtilities.dp(12.0f), this.unlockY + this.unlockLayout.getHeight() + AndroidUtilities.dp(8.0f));
        this.unlockSpoilerPath.addRoundRect(rectF2, AndroidUtilities.dp(32.0f), AndroidUtilities.dp(32.0f), Path.Direction.CW);
        canvas.clipPath(this.unlockSpoilerPath, Region.Op.DIFFERENCE);
        this.unlockSpoilerEffect.setColor(ColorUtils.setAlphaComponent(Theme.getColor("windowBackgroundWhite"), (int) (Color.alpha(color) * 0.325f)));
        this.unlockSpoilerEffect.setBounds((int) this.photoImage.getImageX(), (int) this.photoImage.getImageY(), (int) this.photoImage.getImageX2(), (int) this.photoImage.getImageY2());
        this.unlockSpoilerEffect.draw(canvas);
        invalidate();
        canvas.restore();
        canvas.saveLayerAlpha(0.0f, 0.0f, getWidth(), getHeight(), (int) (this.unlockAlpha * 255.0f), 31);
        int alpha5 = Theme.chat_timeBackgroundPaint.getAlpha();
        Theme.chat_timeBackgroundPaint.setAlpha((int) (alpha5 * 0.7f));
        canvas.drawRoundRect(rectF2, AndroidUtilities.dp(32.0f), AndroidUtilities.dp(32.0f), Theme.chat_timeBackgroundPaint);
        Theme.chat_timeBackgroundPaint.setAlpha(alpha5);
        canvas.translate(this.unlockX + AndroidUtilities.dp(4.0f), this.unlockY);
        Drawable drawable = Theme.chat_msgUnlockDrawable;
        drawable.setBounds(0, 0, drawable.getIntrinsicWidth(), Theme.chat_msgUnlockDrawable.getIntrinsicHeight());
        Theme.chat_msgUnlockDrawable.draw(canvas);
        canvas.translate(AndroidUtilities.dp(6.0f) + Theme.chat_msgUnlockDrawable.getIntrinsicWidth(), 0.0f);
        this.unlockLayout.draw(canvas);
        canvas.restore();
        if (this.videoInfoLayout == null || !this.photoImage.getVisible() || this.imageBackgroundSideColor != 0) {
            return;
        }
        int i16 = SharedConfig.bubbleRadius;
        if (i16 > 2) {
            dp = AndroidUtilities.dp(i16 - 2);
            if (SharedConfig.bubbleRadius < 10) {
                z7 = false;
            }
            z3 = z7;
        } else {
            dp = AndroidUtilities.dp(i16);
        }
        int imageX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(9.0f));
        int imageY = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(6.0f));
        RectF rectF3 = this.rect;
        float dp7 = imageX - AndroidUtilities.dp(4.0f);
        float dp8 = imageY - AndroidUtilities.dp(1.5f);
        int dp9 = this.durationWidth + imageX + AndroidUtilities.dp(4.0f);
        if (!z3) {
            f8 = 0.0f;
        }
        rectF3.set(dp7, dp8, dp9 + AndroidUtilities.dp(f8), this.videoInfoLayout.getHeight() + imageY + AndroidUtilities.dp(1.5f));
        canvas.drawRoundRect(this.rect, dp, dp, getThemedPaint(str));
        canvas.save();
        canvas.translate(imageX + (z3 ? 2 : 0), imageY);
        this.videoInfoLayout.draw(canvas);
        canvas.restore();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void createStatusDrawableAnimator(int i, int i2, final boolean z) {
        boolean z2 = false;
        boolean z3 = (i2 & 1) != 0;
        boolean z4 = (i2 & 2) != 0;
        boolean z5 = (i & 1) != 0;
        boolean z6 = (i & 2) != 0;
        if (!((i & 4) != 0) && z6 && z4 && !z5 && z3) {
            z2 = true;
        }
        if (!this.transitionParams.messageEntering || z2) {
            this.statusDrawableProgress = 0.0f;
            ValueAnimator ofFloat = ValueAnimator.ofFloat(0.0f, 1.0f);
            this.statusDrawableAnimator = ofFloat;
            if (z2) {
                ofFloat.setDuration(220L);
            } else {
                ofFloat.setDuration(150L);
            }
            this.statusDrawableAnimator.setInterpolator(CubicBezierInterpolator.DEFAULT);
            this.animateFromStatusDrawableParams = i;
            this.animateToStatusDrawableParams = i2;
            this.statusDrawableAnimator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() { // from class: org.telegram.ui.Cells.ChatMessageCell$$ExternalSyntheticLambda0
                @Override // android.animation.ValueAnimator.AnimatorUpdateListener
                public final void onAnimationUpdate(ValueAnimator valueAnimator) {
                    ChatMessageCell.this.lambda$createStatusDrawableAnimator$6(z, valueAnimator);
                }
            });
            this.statusDrawableAnimator.addListener(new AnimatorListenerAdapter() { // from class: org.telegram.ui.Cells.ChatMessageCell.6
                @Override // android.animation.AnimatorListenerAdapter, android.animation.Animator.AnimatorListener
                public void onAnimationEnd(Animator animator) {
                    int createStatusDrawableParams = ChatMessageCell.this.transitionParams.createStatusDrawableParams();
                    if (ChatMessageCell.this.animateToStatusDrawableParams == createStatusDrawableParams) {
                        ChatMessageCell.this.statusDrawableAnimationInProgress = false;
                        ChatMessageCell.this.transitionParams.lastStatusDrawableParams = ChatMessageCell.this.animateToStatusDrawableParams;
                        return;
                    }
                    ChatMessageCell chatMessageCell = ChatMessageCell.this;
                    chatMessageCell.createStatusDrawableAnimator(chatMessageCell.animateToStatusDrawableParams, createStatusDrawableParams, z);
                }
            });
            this.statusDrawableAnimationInProgress = true;
            this.statusDrawableAnimator.start();
        }
    }

    /* JADX INFO: Access modifiers changed from: private */
    public /* synthetic */ void lambda$createStatusDrawableAnimator$6(boolean z, ValueAnimator valueAnimator) {
        this.statusDrawableProgress = ((Float) valueAnimator.getAnimatedValue()).floatValue();
        invalidate();
        if (!z || getParent() == null) {
            return;
        }
        ((View) getParent()).invalidate();
    }

    private void drawClockOrErrorLayout(Canvas canvas, boolean z, boolean z2, float f, float f2, float f3, float f4, float f5, boolean z3) {
        float dp;
        int themedColor;
        float dp2;
        int i = 0;
        boolean z4 = f5 != 1.0f;
        float f6 = (f5 * 0.5f) + 0.5f;
        float f7 = f2 * f5;
        if (z) {
            if (this.currentMessageObject.isOutOwner()) {
                return;
            }
            MsgClockDrawable msgClockDrawable = Theme.chat_msgClockDrawable;
            String str = "chat_mediaSentClock";
            if (shouldDrawTimeOnMedia()) {
                themedColor = getThemedColor(str);
            } else {
                if (z3) {
                    str = "chat_outSentClockSelected";
                }
                themedColor = getThemedColor(str);
            }
            msgClockDrawable.setColor(themedColor);
            if (shouldDrawTimeOnMedia()) {
                dp2 = (this.photoImage.getImageY2() + this.additionalTimeOffsetY) - AndroidUtilities.dp(9.0f);
            } else {
                dp2 = (f - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 9.5f : 8.5f)) + f3;
            }
            if (!this.currentMessageObject.scheduled) {
                i = AndroidUtilities.dp(11.0f);
            }
            BaseCell.setDrawableBounds(msgClockDrawable, f4 + i, dp2 - msgClockDrawable.getIntrinsicHeight());
            msgClockDrawable.setAlpha((int) (f7 * 255.0f));
            if (z4) {
                canvas.save();
                canvas.scale(f6, f6, msgClockDrawable.getBounds().centerX(), msgClockDrawable.getBounds().centerY());
            }
            msgClockDrawable.draw(canvas);
            msgClockDrawable.setAlpha(255);
            invalidate();
            if (!z4) {
                return;
            }
            canvas.restore();
        } else if (!z2 || this.currentMessageObject.isOutOwner()) {
        } else {
            if (!this.currentMessageObject.scheduled) {
                i = AndroidUtilities.dp(11.0f);
            }
            float f8 = f4 + i;
            float f9 = 21.5f;
            if (shouldDrawTimeOnMedia()) {
                dp = (this.photoImage.getImageY2() + this.additionalTimeOffsetY) - AndroidUtilities.dp(21.5f);
            } else {
                if (!this.pinnedBottom && !this.pinnedTop) {
                    f9 = 20.5f;
                }
                dp = (f - AndroidUtilities.dp(f9)) + f3;
            }
            this.rect.set(f8, dp, AndroidUtilities.dp(14.0f) + f8, AndroidUtilities.dp(14.0f) + dp);
            int alpha = Theme.chat_msgErrorPaint.getAlpha();
            int i2 = (int) (f7 * 255.0f);
            Theme.chat_msgErrorPaint.setAlpha(i2);
            if (z4) {
                canvas.save();
                canvas.scale(f6, f6, this.rect.centerX(), this.rect.centerY());
            }
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(1.0f), AndroidUtilities.dp(1.0f), Theme.chat_msgErrorPaint);
            Theme.chat_msgErrorPaint.setAlpha(alpha);
            Drawable themedDrawable = getThemedDrawable("drawableMsgError");
            BaseCell.setDrawableBounds(themedDrawable, f8 + AndroidUtilities.dp(6.0f), dp + AndroidUtilities.dp(2.0f));
            themedDrawable.setAlpha(i2);
            themedDrawable.draw(canvas);
            themedDrawable.setAlpha(255);
            if (!z4) {
                return;
            }
            canvas.restore();
        }
    }

    /* JADX WARN: Removed duplicated region for block: B:184:0x0152  */
    /* JADX WARN: Removed duplicated region for block: B:187:0x0180  */
    /* JADX WARN: Removed duplicated region for block: B:192:0x01df  */
    /* JADX WARN: Removed duplicated region for block: B:195:0x01fb  */
    /* JADX WARN: Removed duplicated region for block: B:197:0x020d  */
    /* JADX WARN: Removed duplicated region for block: B:200:0x0218  */
    /* JADX WARN: Removed duplicated region for block: B:202:0x01e3  */
    /* JADX WARN: Removed duplicated region for block: B:206:0x01c7  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private void drawViewsAndRepliesLayout(Canvas canvas, float f, float f2, float f3, float f4, float f5, boolean z) {
        float dp;
        float f6;
        Drawable themedDrawable;
        float f7;
        float f8;
        boolean z2;
        StaticLayout staticLayout;
        float f9;
        Drawable themedDrawable2;
        float f10;
        Drawable themedDrawable3;
        float dp2;
        boolean z3 = f5 != 1.0f;
        float f11 = (f5 * 0.5f) + 0.5f;
        float f12 = f2 * f5;
        ReactionsLayoutInBubble reactionsLayoutInBubble = this.reactionsLayoutInBubble;
        float currentWidth = reactionsLayoutInBubble.isSmall ? reactionsLayoutInBubble.getCurrentWidth(1.0f) : 0.0f;
        int alpha = Theme.chat_timePaint.getAlpha();
        if (shouldDrawTimeOnMedia()) {
            dp = ((this.photoImage.getImageY2() + this.additionalTimeOffsetY) - AndroidUtilities.dp(7.3f)) - this.timeLayout.getHeight();
        } else {
            dp = ((f - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 7.5f : 6.5f)) - this.timeLayout.getHeight()) + f3;
        }
        if (this.repliesLayout != null || this.transitionParams.animateReplies) {
            TransitionParams transitionParams = this.transitionParams;
            float f13 = (transitionParams.shouldAnimateTimeX ? this.timeX : f4) + currentWidth;
            boolean z4 = transitionParams.animateReplies && this.transitionParams.animateRepliesLayout == null && this.repliesLayout != null;
            boolean z5 = this.transitionParams.animateReplies && this.transitionParams.animateRepliesLayout != null && this.repliesLayout == null;
            boolean z6 = (!this.transitionParams.animateReplies || this.transitionParams.animateRepliesLayout == null || this.repliesLayout == null) ? false : true;
            TransitionParams transitionParams2 = this.transitionParams;
            if (!transitionParams2.shouldAnimateTimeX || z4) {
                f6 = transitionParams2.deltaRight + f13;
            } else if (z5) {
                f6 = transitionParams2.animateFromTimeXReplies;
            } else {
                float f14 = transitionParams2.animateFromTimeXReplies;
                float f15 = this.transitionParams.animateChangeProgress;
                f6 = (f14 * (1.0f - f15)) + (f13 * f15);
            }
            MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
            if (groupedMessages != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams3 = groupedMessages.transitionParams;
                if (transitionParams3.backgroundChangeBounds) {
                    f6 += transitionParams3.offsetRight;
                }
            }
            if (this.transitionParams.animateBackgroundBoundsInner) {
                f6 += this.animationOffsetX;
            }
            if (shouldDrawTimeOnMedia()) {
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    themedDrawable = getThemedDrawable("drawableMsgStickerReplies");
                } else {
                    themedDrawable = Theme.chat_msgMediaRepliesDrawable;
                }
            } else if (!this.currentMessageObject.isOutOwner()) {
                themedDrawable = z ? Theme.chat_msgInRepliesSelectedDrawable : Theme.chat_msgInRepliesDrawable;
            } else {
                themedDrawable = getThemedDrawable("drawableMsgOutReplies");
            }
            BaseCell.setDrawableBounds(themedDrawable, f6, dp);
            if (z4) {
                f8 = this.transitionParams.animateChangeProgress;
            } else if (z5) {
                f8 = 1.0f - this.transitionParams.animateChangeProgress;
            } else {
                f7 = f12;
                themedDrawable.setAlpha((int) (f7 * 255.0f));
                if (z3) {
                    canvas.save();
                    canvas.scale(f11, f11, (((themedDrawable.getIntrinsicWidth() + AndroidUtilities.dp(3.0f)) + this.repliesTextWidth) / 2.0f) + f6, themedDrawable.getBounds().centerY());
                }
                themedDrawable.draw(canvas);
                themedDrawable.setAlpha(255);
                if (!this.transitionParams.animateReplies) {
                    if (z6) {
                        canvas.save();
                        TextPaint textPaint = Theme.chat_timePaint;
                        double d = alpha;
                        z2 = z3;
                        double d2 = this.transitionParams.animateChangeProgress;
                        Double.isNaN(d2);
                        Double.isNaN(d);
                        textPaint.setAlpha((int) (d * (1.0d - d2)));
                        canvas.translate(themedDrawable.getIntrinsicWidth() + f6 + AndroidUtilities.dp(3.0f), dp);
                        this.transitionParams.animateRepliesLayout.draw(canvas);
                        canvas.restore();
                    } else {
                        z2 = z3;
                    }
                    Theme.chat_timePaint.setAlpha((int) (alpha * f7));
                } else {
                    z2 = z3;
                }
                canvas.save();
                canvas.translate(themedDrawable.getIntrinsicWidth() + f6 + AndroidUtilities.dp(3.0f), dp);
                staticLayout = this.repliesLayout;
                if (staticLayout == null) {
                    staticLayout.draw(canvas);
                } else if (this.transitionParams.animateRepliesLayout != null) {
                    this.transitionParams.animateRepliesLayout.draw(canvas);
                }
                canvas.restore();
                if (this.repliesLayout != null) {
                    currentWidth += themedDrawable.getIntrinsicWidth() + this.repliesTextWidth + AndroidUtilities.dp(10.0f);
                }
                if (z2) {
                    canvas.restore();
                }
                if (this.transitionParams.animateReplies) {
                    Theme.chat_timePaint.setAlpha(alpha);
                }
                this.transitionParams.lastTimeXReplies = f6;
            }
            f7 = f8 * f12;
            themedDrawable.setAlpha((int) (f7 * 255.0f));
            if (z3) {
            }
            themedDrawable.draw(canvas);
            themedDrawable.setAlpha(255);
            if (!this.transitionParams.animateReplies) {
            }
            canvas.save();
            canvas.translate(themedDrawable.getIntrinsicWidth() + f6 + AndroidUtilities.dp(3.0f), dp);
            staticLayout = this.repliesLayout;
            if (staticLayout == null) {
            }
            canvas.restore();
            if (this.repliesLayout != null) {
            }
            if (z2) {
            }
            if (this.transitionParams.animateReplies) {
            }
            this.transitionParams.lastTimeXReplies = f6;
        } else {
            z2 = z3;
        }
        if (this.viewsLayout != null) {
            TransitionParams transitionParams4 = this.transitionParams;
            boolean z7 = transitionParams4.shouldAnimateTimeX;
            float f16 = (z7 ? this.timeX : f4) + currentWidth;
            if (!z7) {
                f10 = transitionParams4.deltaRight + f16;
            } else {
                float f17 = transitionParams4.animateFromTimeXViews;
                float f18 = this.transitionParams.animateChangeProgress;
                f10 = (f17 * (1.0f - f18)) + (f16 * f18);
            }
            MessageObject.GroupedMessages groupedMessages2 = this.currentMessagesGroup;
            if (groupedMessages2 != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams5 = groupedMessages2.transitionParams;
                if (transitionParams5.backgroundChangeBounds) {
                    f10 += transitionParams5.offsetRight;
                }
            }
            if (this.transitionParams.animateBackgroundBoundsInner) {
                f10 += this.animationOffsetX;
            }
            if (shouldDrawTimeOnMedia()) {
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    themedDrawable3 = getThemedDrawable("drawableMsgStickerViews");
                } else {
                    themedDrawable3 = Theme.chat_msgMediaViewsDrawable;
                }
            } else if (!this.currentMessageObject.isOutOwner()) {
                themedDrawable3 = z ? Theme.chat_msgInViewsSelectedDrawable : Theme.chat_msgInViewsDrawable;
            } else {
                themedDrawable3 = getThemedDrawable(z ? "drawableMsgOutViewsSelected" : "drawableMsgOutViews");
            }
            float f19 = 5.5f;
            if (shouldDrawTimeOnMedia()) {
                dp2 = ((this.photoImage.getImageY2() + this.additionalTimeOffsetY) - AndroidUtilities.dp(5.5f)) - this.timeLayout.getHeight();
            } else {
                if (!this.pinnedBottom && !this.pinnedTop) {
                    f19 = 4.5f;
                }
                dp2 = ((f - AndroidUtilities.dp(f19)) - this.timeLayout.getHeight()) + f3;
            }
            BaseCell.setDrawableBounds(themedDrawable3, f10, dp2);
            if (z2) {
                canvas.save();
                canvas.scale(f11, f11, (((themedDrawable3.getIntrinsicWidth() + AndroidUtilities.dp(3.0f)) + this.viewsTextWidth) / 2.0f) + f10, themedDrawable3.getBounds().centerY());
            }
            themedDrawable3.setAlpha((int) (f12 * 255.0f));
            themedDrawable3.draw(canvas);
            themedDrawable3.setAlpha(255);
            if (this.transitionParams.animateViewsLayout != null) {
                canvas.save();
                TextPaint textPaint2 = Theme.chat_timePaint;
                double d3 = alpha;
                double d4 = this.transitionParams.animateChangeProgress;
                Double.isNaN(d4);
                Double.isNaN(d3);
                textPaint2.setAlpha((int) (d3 * (1.0d - d4)));
                canvas.translate(themedDrawable3.getIntrinsicWidth() + f10 + AndroidUtilities.dp(3.0f), dp);
                this.transitionParams.animateViewsLayout.draw(canvas);
                canvas.restore();
                Theme.chat_timePaint.setAlpha((int) (alpha * this.transitionParams.animateChangeProgress));
            }
            canvas.save();
            canvas.translate(themedDrawable3.getIntrinsicWidth() + f10 + AndroidUtilities.dp(3.0f), dp);
            this.viewsLayout.draw(canvas);
            canvas.restore();
            if (z2) {
                canvas.restore();
            }
            currentWidth += this.viewsTextWidth + Theme.chat_msgInViewsDrawable.getIntrinsicWidth() + AndroidUtilities.dp(10.0f);
            if (this.transitionParams.animateViewsLayout != null) {
                Theme.chat_timePaint.setAlpha(alpha);
            }
            this.transitionParams.lastTimeXViews = f10;
        }
        if (this.isPinned || this.transitionParams.animatePinned) {
            TransitionParams transitionParams6 = this.transitionParams;
            float f20 = (transitionParams6.shouldAnimateTimeX ? this.timeX : f4) + currentWidth;
            boolean z8 = transitionParams6.animatePinned && this.isPinned;
            boolean z9 = this.transitionParams.animatePinned && !this.isPinned;
            TransitionParams transitionParams7 = this.transitionParams;
            if (!transitionParams7.shouldAnimateTimeX || z8) {
                f9 = transitionParams7.deltaRight + f20;
            } else if (z9) {
                f9 = transitionParams7.animateFromTimeXPinned;
            } else {
                float f21 = transitionParams7.animateFromTimeXPinned;
                float f22 = transitionParams7.animateChangeProgress;
                f9 = (f21 * (1.0f - f22)) + (f20 * f22);
            }
            MessageObject.GroupedMessages groupedMessages3 = this.currentMessagesGroup;
            if (groupedMessages3 != null) {
                MessageObject.GroupedMessages.TransitionParams transitionParams8 = groupedMessages3.transitionParams;
                if (transitionParams8.backgroundChangeBounds) {
                    f9 += transitionParams8.offsetRight;
                }
            }
            if (transitionParams7.animateBackgroundBoundsInner) {
                f9 += this.animationOffsetX;
            }
            if (shouldDrawTimeOnMedia()) {
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    themedDrawable2 = getThemedDrawable("drawableMsgStickerPinned");
                } else {
                    themedDrawable2 = Theme.chat_msgMediaPinnedDrawable;
                }
            } else if (!this.currentMessageObject.isOutOwner()) {
                themedDrawable2 = z ? Theme.chat_msgInPinnedSelectedDrawable : Theme.chat_msgInPinnedDrawable;
            } else {
                themedDrawable2 = getThemedDrawable(z ? "drawableMsgOutPinnedSelected" : "drawableMsgOutPinned");
            }
            if (this.transitionParams.animatePinned) {
                if (this.isPinned) {
                    themedDrawable2.setAlpha((int) (f12 * 255.0f * this.transitionParams.animateChangeProgress));
                    BaseCell.setDrawableBounds(themedDrawable2, f9, dp);
                } else {
                    themedDrawable2.setAlpha((int) (f12 * 255.0f * (1.0f - this.transitionParams.animateChangeProgress)));
                    BaseCell.setDrawableBounds(themedDrawable2, f9, dp);
                }
            } else {
                themedDrawable2.setAlpha((int) (f12 * 255.0f));
                BaseCell.setDrawableBounds(themedDrawable2, f9, dp);
            }
            if (z2) {
                canvas.save();
                canvas.scale(f11, f11, (themedDrawable2.getIntrinsicWidth() / 2.0f) + f9, themedDrawable2.getBounds().centerY());
            }
            themedDrawable2.draw(canvas);
            themedDrawable2.setAlpha(255);
            if (z2) {
                canvas.restore();
            }
            this.transitionParams.lastTimeXPinned = f9;
        }
    }

    private void drawStatusDrawable(Canvas canvas, boolean z, boolean z2, boolean z3, boolean z4, float f, boolean z5, float f2, float f3, float f4, boolean z6, boolean z7) {
        int dp;
        int dp2;
        Drawable themedDrawable;
        Drawable drawable;
        int i;
        boolean z8 = f4 != 1.0f && !z6;
        float f5 = (f4 * 0.5f) + 0.5f;
        float f6 = z8 ? f * f4 : f;
        float imageY2 = (this.photoImage.getImageY2() + this.additionalTimeOffsetY) - AndroidUtilities.dp(8.5f);
        if (z3) {
            MsgClockDrawable msgClockDrawable = Theme.chat_msgClockDrawable;
            if (shouldDrawTimeOnMedia()) {
                float f7 = 24.0f;
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    i = getThemedColor("chat_serviceText");
                    int i2 = this.layoutWidth;
                    if (!z5) {
                        f7 = 22.0f;
                    }
                    BaseCell.setDrawableBounds(msgClockDrawable, (i2 - AndroidUtilities.dp(f7)) - msgClockDrawable.getIntrinsicWidth(), (imageY2 - msgClockDrawable.getIntrinsicHeight()) + f2);
                    msgClockDrawable.setAlpha((int) (this.timeAlpha * 255.0f * f6));
                } else {
                    i = getThemedColor("chat_mediaSentClock");
                    int i3 = this.layoutWidth;
                    if (!z5) {
                        f7 = 22.0f;
                    }
                    BaseCell.setDrawableBounds(msgClockDrawable, (i3 - AndroidUtilities.dp(f7)) - msgClockDrawable.getIntrinsicWidth(), (imageY2 - msgClockDrawable.getIntrinsicHeight()) + f2);
                    msgClockDrawable.setAlpha((int) (f6 * 255.0f));
                }
            } else {
                int themedColor = getThemedColor("chat_outSentClock");
                BaseCell.setDrawableBounds(msgClockDrawable, (this.layoutWidth - AndroidUtilities.dp(18.5f)) - msgClockDrawable.getIntrinsicWidth(), ((f3 - AndroidUtilities.dp(8.5f)) - msgClockDrawable.getIntrinsicHeight()) + f2);
                msgClockDrawable.setAlpha((int) (f6 * 255.0f));
                i = themedColor;
            }
            msgClockDrawable.setColor(i);
            if (z8) {
                canvas.save();
                canvas.scale(f5, f5, msgClockDrawable.getBounds().centerX(), msgClockDrawable.getBounds().centerY());
            }
            msgClockDrawable.draw(canvas);
            msgClockDrawable.setAlpha(255);
            if (z8) {
                canvas.restore();
            }
            invalidate();
        }
        float f8 = 23.5f;
        float f9 = 9.0f;
        if (z2) {
            if (shouldDrawTimeOnMedia()) {
                if (z6) {
                    canvas.save();
                }
                float f10 = 28.3f;
                if (this.currentMessageObject.shouldDrawWithoutBackground()) {
                    drawable = getThemedDrawable("drawableMsgStickerCheck");
                    if (z) {
                        if (z6) {
                            canvas.translate(AndroidUtilities.dp(4.8f) * (1.0f - f4), 0.0f);
                        }
                        int i4 = this.layoutWidth;
                        if (!z5) {
                            f10 = 26.3f;
                        }
                        BaseCell.setDrawableBounds(drawable, (i4 - AndroidUtilities.dp(f10)) - drawable.getIntrinsicWidth(), (imageY2 - drawable.getIntrinsicHeight()) + f2);
                    } else {
                        BaseCell.setDrawableBounds(drawable, (this.layoutWidth - AndroidUtilities.dp(z5 ? 23.5f : 21.5f)) - drawable.getIntrinsicWidth(), (imageY2 - drawable.getIntrinsicHeight()) + f2);
                    }
                    drawable.setAlpha((int) (this.timeAlpha * 255.0f * f6));
                } else {
                    if (z) {
                        if (z6) {
                            canvas.translate(AndroidUtilities.dp(4.8f) * (1.0f - f4), 0.0f);
                        }
                        Drawable drawable2 = Theme.chat_msgMediaCheckDrawable;
                        int i5 = this.layoutWidth;
                        if (!z5) {
                            f10 = 26.3f;
                        }
                        BaseCell.setDrawableBounds(drawable2, (i5 - AndroidUtilities.dp(f10)) - Theme.chat_msgMediaCheckDrawable.getIntrinsicWidth(), (imageY2 - Theme.chat_msgMediaCheckDrawable.getIntrinsicHeight()) + f2);
                    } else {
                        BaseCell.setDrawableBounds(Theme.chat_msgMediaCheckDrawable, (this.layoutWidth - AndroidUtilities.dp(z5 ? 23.5f : 21.5f)) - Theme.chat_msgMediaCheckDrawable.getIntrinsicWidth(), (imageY2 - Theme.chat_msgMediaCheckDrawable.getIntrinsicHeight()) + f2);
                    }
                    Theme.chat_msgMediaCheckDrawable.setAlpha((int) (this.timeAlpha * 255.0f * f6));
                    drawable = Theme.chat_msgMediaCheckDrawable;
                }
                if (z8) {
                    canvas.save();
                    canvas.scale(f5, f5, drawable.getBounds().centerX(), drawable.getBounds().centerY());
                }
                drawable.draw(canvas);
                if (z8) {
                    canvas.restore();
                }
                if (z6) {
                    canvas.restore();
                }
                drawable.setAlpha(255);
            } else {
                if (z6) {
                    canvas.save();
                }
                if (z) {
                    if (z6) {
                        canvas.translate(AndroidUtilities.dp(4.0f) * (1.0f - f4), 0.0f);
                    }
                    themedDrawable = getThemedDrawable(z7 ? "drawableMsgOutCheckReadSelected" : "drawableMsgOutCheckRead");
                    BaseCell.setDrawableBounds(themedDrawable, (this.layoutWidth - AndroidUtilities.dp(22.5f)) - themedDrawable.getIntrinsicWidth(), ((f3 - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 9.0f : 8.0f)) - themedDrawable.getIntrinsicHeight()) + f2);
                } else {
                    themedDrawable = getThemedDrawable(z7 ? "drawableMsgOutCheckSelected" : "drawableMsgOutCheck");
                    BaseCell.setDrawableBounds(themedDrawable, (this.layoutWidth - AndroidUtilities.dp(18.5f)) - themedDrawable.getIntrinsicWidth(), ((f3 - AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 9.0f : 8.0f)) - themedDrawable.getIntrinsicHeight()) + f2);
                }
                themedDrawable.setAlpha((int) (f6 * 255.0f));
                if (z8) {
                    canvas.save();
                    canvas.scale(f5, f5, themedDrawable.getBounds().centerX(), themedDrawable.getBounds().centerY());
                }
                themedDrawable.draw(canvas);
                if (z8) {
                    canvas.restore();
                }
                if (z6) {
                    canvas.restore();
                }
                themedDrawable.setAlpha(255);
            }
        }
        if (z) {
            if (shouldDrawTimeOnMedia()) {
                Drawable themedDrawable2 = this.currentMessageObject.shouldDrawWithoutBackground() ? getThemedDrawable("drawableMsgStickerHalfCheck") : Theme.chat_msgMediaHalfCheckDrawable;
                int i6 = this.layoutWidth;
                if (!z5) {
                    f8 = 21.5f;
                }
                BaseCell.setDrawableBounds(themedDrawable2, (i6 - AndroidUtilities.dp(f8)) - themedDrawable2.getIntrinsicWidth(), (imageY2 - themedDrawable2.getIntrinsicHeight()) + f2);
                themedDrawable2.setAlpha((int) (this.timeAlpha * 255.0f * f6));
                if (z8 || z6) {
                    canvas.save();
                    canvas.scale(f5, f5, themedDrawable2.getBounds().centerX(), themedDrawable2.getBounds().centerY());
                }
                themedDrawable2.draw(canvas);
                if (z8 || z6) {
                    canvas.restore();
                }
                themedDrawable2.setAlpha(255);
            } else {
                Drawable themedDrawable3 = getThemedDrawable(z7 ? "drawableMsgOutHalfCheckSelected" : "drawableMsgOutHalfCheck");
                float dp3 = (this.layoutWidth - AndroidUtilities.dp(18.0f)) - themedDrawable3.getIntrinsicWidth();
                if (!this.pinnedBottom && !this.pinnedTop) {
                    f9 = 8.0f;
                }
                BaseCell.setDrawableBounds(themedDrawable3, dp3, ((f3 - AndroidUtilities.dp(f9)) - themedDrawable3.getIntrinsicHeight()) + f2);
                themedDrawable3.setAlpha((int) (f6 * 255.0f));
                if (z8 || z6) {
                    canvas.save();
                    canvas.scale(f5, f5, themedDrawable3.getBounds().centerX(), themedDrawable3.getBounds().centerY());
                }
                themedDrawable3.draw(canvas);
                if (z8 || z6) {
                    canvas.restore();
                }
                themedDrawable3.setAlpha(255);
            }
        }
        if (z4) {
            if (shouldDrawTimeOnMedia()) {
                dp = this.layoutWidth - AndroidUtilities.dp(34.5f);
                dp2 = AndroidUtilities.dp(26.5f);
            } else {
                dp = this.layoutWidth - AndroidUtilities.dp(32.0f);
                dp2 = AndroidUtilities.dp((this.pinnedBottom || this.pinnedTop) ? 22.0f : 21.0f);
            }
            float f11 = (f3 - dp2) + f2;
            this.rect.set(dp, f11, AndroidUtilities.dp(14.0f) + dp, AndroidUtilities.dp(14.0f) + f11);
            int alpha = Theme.chat_msgErrorPaint.getAlpha();
            Theme.chat_msgErrorPaint.setAlpha((int) (alpha * f6));
            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(1.0f), AndroidUtilities.dp(1.0f), Theme.chat_msgErrorPaint);
            Theme.chat_msgErrorPaint.setAlpha(alpha);
            BaseCell.setDrawableBounds(Theme.chat_msgErrorDrawable, dp + AndroidUtilities.dp(6.0f), f11 + AndroidUtilities.dp(2.0f));
            Theme.chat_msgErrorDrawable.setAlpha((int) (f6 * 255.0f));
            if (z8) {
                canvas.save();
                canvas.scale(f5, f5, Theme.chat_msgErrorDrawable.getBounds().centerX(), Theme.chat_msgErrorDrawable.getBounds().centerY());
            }
            Theme.chat_msgErrorDrawable.draw(canvas);
            Theme.chat_msgErrorDrawable.setAlpha(255);
            if (!z8) {
                return;
            }
            canvas.restore();
        }
    }

    /* JADX WARN: Code restructure failed: missing block: B:322:0x09dd, code lost:
        if (r1[0] == 3) goto L323;
     */
    /* JADX WARN: Code restructure failed: missing block: B:602:0x1136, code lost:
        if (r3 == 2) goto L654;
     */
    /* JADX WARN: Multi-variable type inference failed */
    /* JADX WARN: Removed duplicated region for block: B:372:0x0dda  */
    /* JADX WARN: Removed duplicated region for block: B:375:0x0de3 A[SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:606:0x1426  */
    /* JADX WARN: Removed duplicated region for block: B:612:0x1460  */
    /* JADX WARN: Removed duplicated region for block: B:629:0x14b5  */
    /* JADX WARN: Removed duplicated region for block: B:633:0x14c6  */
    /* JADX WARN: Removed duplicated region for block: B:642:0x1477  */
    /* JADX WARN: Removed duplicated region for block: B:648:0x143f  */
    /* JADX WARN: Removed duplicated region for block: B:843:0x15db  */
    /* JADX WARN: Removed duplicated region for block: B:847:0x15fd  */
    /* JADX WARN: Removed duplicated region for block: B:872:0x16c9  */
    /* JADX WARN: Removed duplicated region for block: B:908:0x1812  */
    /* JADX WARN: Removed duplicated region for block: B:915:0x1831  */
    /* JADX WARN: Removed duplicated region for block: B:918:0x1885  */
    /* JADX WARN: Removed duplicated region for block: B:950:? A[RETURN, SYNTHETIC] */
    /* JADX WARN: Removed duplicated region for block: B:962:0x16c2  */
    /* JADX WARN: Removed duplicated region for block: B:967:0x15ef  */
    /* JADX WARN: Type inference failed for: r10v1 */
    /* JADX WARN: Type inference failed for: r10v2, types: [org.telegram.ui.ActionBar.Theme$MessageDrawable, java.lang.String] */
    /* JADX WARN: Type inference failed for: r10v45 */
    /* JADX WARN: Type inference failed for: r2v449, types: [boolean] */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    public void drawOverlays(Canvas canvas) {
        Object obj;
        ?? r10;
        float f;
        float dp;
        float dp2;
        float f2;
        ReactionsLayoutInBubble reactionsLayoutInBubble;
        Object obj2;
        Object obj3;
        int i;
        boolean z;
        float f3;
        boolean z2;
        float f4;
        int i2;
        int i3;
        boolean z3;
        StaticLayout staticLayout;
        int i4;
        int i5;
        long j;
        int i6;
        float f5;
        float f6;
        int i7;
        Drawable drawable;
        int themedColor;
        int themedColor2;
        int dp3;
        float f7;
        String format;
        Drawable drawable2;
        String str;
        float f8;
        float f9;
        String formatDurationNoHours;
        int i8;
        int i9;
        int dp4;
        int i10;
        int i11;
        float f10;
        float f11;
        float f12;
        int dp5;
        Drawable drawable3;
        Drawable drawable4;
        StaticLayout staticLayout2;
        float abs;
        float f13;
        String formatLocationLeftTime;
        int imageX;
        int imageY;
        int i12;
        AnimatedFileDrawable animation;
        ChatMessageCellDelegate chatMessageCellDelegate;
        if (this.drawFromPinchToZoom || (chatMessageCellDelegate = this.delegate) == null || chatMessageCellDelegate.getPinchToZoomHelper() == null || !this.delegate.getPinchToZoomHelper().isInOverlayModeFor(this)) {
            long elapsedRealtime = SystemClock.elapsedRealtime();
            long j2 = elapsedRealtime - this.lastAnimationTime;
            if (j2 > 17) {
                j2 = 17;
            }
            this.lastAnimationTime = elapsedRealtime;
            if (this.currentMessageObject.hadAnimationNotReadyLoading && this.photoImage.getVisible() && !this.currentMessageObject.needDrawBluredPreview() && (((i12 = this.documentAttachType) == 7 || i12 == 4 || i12 == 2) && (animation = this.photoImage.getAnimation()) != null && animation.hasBitmap())) {
                this.currentMessageObject.hadAnimationNotReadyLoading = false;
                updateButtonState(false, true, false);
            }
            if (!this.hasGamePreview) {
                MessageObject messageObject = this.currentMessageObject;
                int i13 = messageObject.type;
                long j3 = j2;
                if (i13 == 3 || i13 == 1 || i13 == 20 || (i7 = this.documentAttachType) == 4 || i7 == 2) {
                    if (this.photoImage.getVisible()) {
                        if (!this.currentMessageObject.needDrawBluredPreview() && this.documentAttachType == 4) {
                            int alpha = ((BitmapDrawable) Theme.chat_msgMediaMenuDrawable).getPaint().getAlpha();
                            if (this.drawMediaCheckBox) {
                                Theme.chat_msgMediaMenuDrawable.setAlpha((int) (alpha * this.controlsAlpha * (1.0f - this.checkBoxAnimationProgress)));
                            } else {
                                Theme.chat_msgMediaMenuDrawable.setAlpha((int) (alpha * this.controlsAlpha));
                            }
                            Drawable drawable5 = Theme.chat_msgMediaMenuDrawable;
                            int imageX2 = (int) ((this.photoImage.getImageX() + this.photoImage.getImageWidth()) - AndroidUtilities.dp(14.0f));
                            this.otherX = imageX2;
                            int imageY2 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.1f));
                            this.otherY = imageY2;
                            BaseCell.setDrawableBounds(drawable5, imageX2, imageY2);
                            Theme.chat_msgMediaMenuDrawable.draw(canvas);
                            Theme.chat_msgMediaMenuDrawable.setAlpha(alpha);
                        }
                        boolean isPlayingMessage = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
                        if (this.animatingNoSoundPlaying != isPlayingMessage) {
                            this.animatingNoSoundPlaying = isPlayingMessage;
                            this.animatingNoSound = isPlayingMessage ? 1 : 2;
                            this.animatingNoSoundProgress = isPlayingMessage ? 1.0f : 0.0f;
                        }
                        MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
                        boolean z4 = groupedMessagePosition == null || (groupedMessagePosition.flags & 3) == 3;
                        int i14 = this.documentAttachType;
                        int i15 = i14 != 4 ? 2 : 2;
                        int i16 = this.buttonState;
                        if (i16 == 1 || i16 == i15 || i16 == 0 || i16 == 3 || i16 == -1 || this.currentMessageObject.needDrawBluredPreview()) {
                            if (this.autoPlayingMedia) {
                                updatePlayingMessageProgress();
                            }
                            if ((this.infoLayout != null || this.loadingProgressLayout != null) && (!this.forceNotDrawTime || this.autoPlayingMedia || this.drawVideoImageButton || this.animatingLoadingProgressProgress != 0.0f || ((z4 && this.docTitleLayout != null) || (this.loadingProgressLayout != null && this.currentPosition != null && ((i4 = this.buttonState) == 1 || (i4 == 3 && this.miniButtonState == 1)))))) {
                                if (!z4) {
                                    f4 = this.animatingLoadingProgressProgress;
                                    z2 = true;
                                    z = false;
                                    f3 = 0.0f;
                                } else {
                                    boolean z5 = (this.buttonState == 1 || this.miniButtonState == 1 || this.animatingLoadingProgressProgress != 0.0f) && !this.currentMessageObject.isSecretMedia() && ((i = this.documentAttachType) == 4 || i == 2 || i == 1);
                                    MessageObject messageObject2 = this.currentMessageObject;
                                    int i17 = messageObject2.type;
                                    float f14 = ((i17 == 3 || i17 == 8 || this.documentAttachType == 4) && (!messageObject2.needDrawBluredPreview() || this.docTitleLayout != null)) ? this.animatingDrawVideoImageButtonProgress : 0.0f;
                                    z = f14 > 0.0f && this.docTitleLayout != null;
                                    if (z || (!z5 && this.infoLayout != null)) {
                                        f3 = f14;
                                        z2 = z5;
                                        f4 = 1.0f;
                                    } else {
                                        float f15 = f14;
                                        z2 = z5;
                                        f4 = this.animatingLoadingProgressProgress;
                                        f3 = f15;
                                    }
                                }
                                int i18 = this.documentAttachType;
                                boolean z6 = (i18 == 7 || i18 == 6 || this.currentMessageObject.type == 19 || SharedConfig.bubbleRadius < 10) ? false : true;
                                Theme.chat_infoPaint.setColor(getThemedColor("chat_mediaInfoText"));
                                int imageX3 = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(4.0f));
                                int imageY3 = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(4.0f));
                                int intrinsicWidth = (!this.autoPlayingMedia || (isPlayingMessage && this.animatingNoSound == 0)) ? 0 : (int) ((Theme.chat_msgNoSoundDrawable.getIntrinsicWidth() + AndroidUtilities.dp(4.0f)) * this.animatingNoSoundProgress);
                                if (z2 && (staticLayout = this.loadingProgressLayout) != null) {
                                    i3 = (int) staticLayout.getLineWidth(0);
                                    i2 = 0;
                                } else {
                                    i2 = intrinsicWidth;
                                    i3 = this.infoWidth;
                                }
                                int ceil = (int) Math.ceil(AndroidUtilities.dp(z6 ? 12.0f : 8.0f) + i3 + i2 + ((((Math.max((this.infoWidth == i3 ? i2 : 0) + i3, this.docTitleWidth) + (this.canStreamVideo ? AndroidUtilities.dp(32.0f) : 0)) - i3) - i2) * f3));
                                if (f3 != 0.0f && this.docTitleLayout == null) {
                                    f3 = 0.0f;
                                }
                                canvas.save();
                                float f16 = imageX3;
                                float f17 = imageY3;
                                canvas.scale(f4, f4, f16, f17);
                                int alpha2 = getThemedPaint("paintChatTimeBackground").getAlpha();
                                z3 = z4;
                                getThemedPaint("paintChatTimeBackground").setAlpha((int) (alpha2 * this.controlsAlpha * f4));
                                if (z || ((z2 && this.loadingProgressLayout != null) || (!z2 && this.infoLayout != null))) {
                                    this.rect.set(f16, f17, imageX3 + ceil, imageY3 + AndroidUtilities.dp((15.5f * f3) + 16.5f));
                                    int[] roundRadius = this.photoImage.getRoundRadius();
                                    float min = Math.min(AndroidUtilities.dp(8.0f), Math.max(roundRadius[0], roundRadius[1]));
                                    canvas.drawRoundRect(this.rect, min, min, getThemedPaint("paintChatTimeBackground"));
                                }
                                Theme.chat_infoPaint.setAlpha((int) (this.controlsAlpha * 255.0f * f4));
                                int imageX4 = (int) (this.photoImage.getImageX() + AndroidUtilities.dp((z6 ? 10 : 8) + (this.canStreamVideo ? 30.0f * f3 : 0.0f)));
                                this.noSoundCenterX = imageX4;
                                canvas.translate(imageX4, this.photoImage.getImageY() + AndroidUtilities.dp((0.2f * f3) + 5.5f));
                                StaticLayout staticLayout3 = this.infoLayout;
                                if (staticLayout3 != null && (!z2 || z)) {
                                    staticLayout3.draw(canvas);
                                }
                                if (i2 != 0 && (!z2 || z)) {
                                    canvas.save();
                                    Drawable drawable6 = Theme.chat_msgNoSoundDrawable;
                                    float f18 = this.animatingNoSoundProgress;
                                    drawable6.setAlpha((int) (f18 * 255.0f * f18 * this.controlsAlpha));
                                    int dp6 = AndroidUtilities.dp(this.animatingNoSoundProgress * 14.0f);
                                    int dp7 = (AndroidUtilities.dp(14.0f) - dp6) / 2;
                                    int dp8 = this.infoWidth + AndroidUtilities.dp(4.0f);
                                    canvas.translate(dp8, 0.0f);
                                    Theme.chat_msgNoSoundDrawable.setBounds(0, dp7, dp6, dp7 + dp6);
                                    Theme.chat_msgNoSoundDrawable.draw(canvas);
                                    this.noSoundCenterX += dp8 + (dp6 / 2);
                                    canvas.restore();
                                }
                                if (z2 && this.loadingProgressLayout != null) {
                                    canvas.save();
                                    if (z) {
                                        Theme.chat_infoPaint.setAlpha((int) (this.controlsAlpha * 255.0f * f3));
                                        canvas.translate(0.0f, AndroidUtilities.dp(f3 * 14.3f));
                                    }
                                    this.loadingProgressLayout.draw(canvas);
                                    canvas.restore();
                                } else if (z) {
                                    Theme.chat_infoPaint.setAlpha((int) (this.controlsAlpha * 255.0f * f3));
                                    canvas.translate(0.0f, AndroidUtilities.dp(f3 * 14.3f));
                                    this.docTitleLayout.draw(canvas);
                                }
                                canvas.restore();
                                Theme.chat_infoPaint.setAlpha(255);
                                getThemedPaint("paintChatTimeBackground").setAlpha(alpha2);
                                i5 = this.animatingDrawVideoImageButton;
                                if (i5 != 1) {
                                    j = j3;
                                    float f19 = this.animatingDrawVideoImageButtonProgress - (((float) j) / 160.0f);
                                    this.animatingDrawVideoImageButtonProgress = f19;
                                    if (f19 <= 0.0f) {
                                        this.animatingDrawVideoImageButtonProgress = 0.0f;
                                        this.animatingDrawVideoImageButton = 0;
                                    }
                                    invalidate();
                                } else {
                                    j = j3;
                                    if (i5 == 2) {
                                        float f20 = this.animatingDrawVideoImageButtonProgress + (((float) j) / 160.0f);
                                        this.animatingDrawVideoImageButtonProgress = f20;
                                        if (f20 >= 1.0f) {
                                            this.animatingDrawVideoImageButtonProgress = 1.0f;
                                            this.animatingDrawVideoImageButton = 0;
                                        }
                                        invalidate();
                                    }
                                }
                                i6 = this.animatingNoSound;
                                if (i6 != 1) {
                                    float f21 = this.animatingNoSoundProgress - (((float) j) / 180.0f);
                                    this.animatingNoSoundProgress = f21;
                                    if (f21 <= 0.0f) {
                                        this.animatingNoSoundProgress = 0.0f;
                                        this.animatingNoSound = 0;
                                    }
                                    invalidate();
                                } else if (i6 == 2) {
                                    float f22 = this.animatingNoSoundProgress + (((float) j) / 180.0f);
                                    this.animatingNoSoundProgress = f22;
                                    if (f22 >= 1.0f) {
                                        this.animatingNoSoundProgress = 1.0f;
                                        this.animatingNoSound = 0;
                                    }
                                    invalidate();
                                }
                                f5 = ((this.buttonState != 1 || this.miniButtonState == 1) && this.loadingProgressLayout != null) ? 1.0f : 0.0f;
                                if (f5 == 0.0f && this.infoLayout != null && z3) {
                                    this.animatingLoadingProgressProgress = 0.0f;
                                }
                                f6 = this.animatingLoadingProgressProgress;
                                if (f6 >= f5) {
                                    float f23 = f6 + (((float) j) / 160.0f);
                                    this.animatingLoadingProgressProgress = f23;
                                    if (f23 > f5) {
                                        this.animatingLoadingProgressProgress = f5;
                                    }
                                    invalidate();
                                } else if (f6 != f5) {
                                    float f24 = f6 - (((float) j) / 160.0f);
                                    this.animatingLoadingProgressProgress = f24;
                                    if (f24 < f5) {
                                        this.animatingLoadingProgressProgress = f5;
                                    }
                                    invalidate();
                                }
                            }
                        }
                        z3 = z4;
                        i5 = this.animatingDrawVideoImageButton;
                        if (i5 != 1) {
                        }
                        i6 = this.animatingNoSound;
                        if (i6 != 1) {
                        }
                        if (this.buttonState != 1) {
                        }
                        if (f5 == 0.0f) {
                            this.animatingLoadingProgressProgress = 0.0f;
                        }
                        f6 = this.animatingLoadingProgressProgress;
                        if (f6 >= f5) {
                        }
                    }
                } else if (i13 == 4) {
                    if (this.docTitleLayout != null) {
                        if (messageObject.isOutOwner()) {
                            Theme.chat_locationTitlePaint.setColor(getThemedColor("chat_messageTextOut"));
                            Theme.chat_locationAddressPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outVenueInfoSelectedText" : "chat_outVenueInfoText"));
                        } else {
                            Theme.chat_locationTitlePaint.setColor(getThemedColor("chat_messageTextIn"));
                            Theme.chat_locationAddressPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inVenueInfoSelectedText" : "chat_inVenueInfoText"));
                        }
                        if (MessageObject.getMedia(this.currentMessageObject.messageOwner) instanceof TLRPC$TL_messageMediaGeoLive) {
                            int imageY22 = (int) (this.photoImage.getImageY2() + AndroidUtilities.dp(30.0f));
                            if (this.locationExpired) {
                                TransitionParams transitionParams = this.transitionParams;
                                if (!transitionParams.animateLocationIsExpired) {
                                    transitionParams.lastDrawLocationExpireText = null;
                                    transitionParams.lastDrawDocTitleLayout = null;
                                    transitionParams.lastDrawInfoLayout = null;
                                    BaseCell.setDrawableBounds(Theme.chat_msgAvatarLiveLocationDrawable, (int) ((this.photoImage.getImageX() + (this.photoImage.getImageWidth() / 2.0f)) - AndroidUtilities.dp(31.0f)), (int) ((this.photoImage.getImageY() + (this.photoImage.getImageHeight() / 2.0f)) - AndroidUtilities.dp(38.0f)));
                                    Theme.chat_msgAvatarLiveLocationDrawable.draw(canvas);
                                    this.locationImageReceiver.setImageCoords(imageX + AndroidUtilities.dp(5.0f), imageY + AndroidUtilities.dp(5.0f), AndroidUtilities.dp(52.0f), AndroidUtilities.dp(52.0f));
                                    this.locationImageReceiver.draw(canvas);
                                }
                            }
                            this.forceNotDrawTime = true;
                            StaticLayout staticLayout4 = this.docTitleLayout;
                            StaticLayout staticLayout5 = this.infoLayout;
                            TransitionParams transitionParams2 = this.transitionParams;
                            if (transitionParams2.animateLocationIsExpired) {
                                float f25 = transitionParams2.lastDrawLocationExpireProgress;
                                String str2 = transitionParams2.lastDrawLocationExpireText;
                                staticLayout2 = transitionParams2.lastDrawDocTitleLayout;
                                StaticLayout staticLayout6 = transitionParams2.lastDrawInfoLayout;
                                f13 = 1.0f - transitionParams2.animateChangeProgress;
                                formatLocationLeftTime = str2;
                                staticLayout5 = staticLayout6;
                                abs = f25;
                            } else {
                                staticLayout2 = staticLayout4;
                                abs = 1.0f - (Math.abs(ConnectionsManager.getInstance(this.currentAccount).getCurrentTime() - this.currentMessageObject.messageOwner.date) / MessageObject.getMedia(this.currentMessageObject.messageOwner).period);
                                f13 = 1.0f;
                                formatLocationLeftTime = LocaleController.formatLocationLeftTime(Math.abs(MessageObject.getMedia(this.currentMessageObject.messageOwner).period - (ConnectionsManager.getInstance(this.currentAccount).getCurrentTime() - this.currentMessageObject.messageOwner.date)));
                            }
                            this.rect.set(this.photoImage.getImageX2() - AndroidUtilities.dp(43.0f), imageY22 - AndroidUtilities.dp(15.0f), this.photoImage.getImageX2() - AndroidUtilities.dp(13.0f), AndroidUtilities.dp(15.0f) + imageY22);
                            if (this.currentMessageObject.isOutOwner()) {
                                Theme.chat_radialProgress2Paint.setColor(getThemedColor("chat_outInstant"));
                                Theme.chat_livePaint.setColor(getThemedColor("chat_outInstant"));
                            } else {
                                Theme.chat_radialProgress2Paint.setColor(getThemedColor("chat_inInstant"));
                                Theme.chat_livePaint.setColor(getThemedColor("chat_inInstant"));
                            }
                            int alpha3 = Theme.chat_locationTitlePaint.getAlpha();
                            int alpha4 = Theme.chat_locationAddressPaint.getAlpha();
                            int alpha5 = Theme.chat_livePaint.getAlpha();
                            if (f13 != 1.0f) {
                                Theme.chat_locationTitlePaint.setAlpha((int) (alpha3 * f13));
                                Theme.chat_locationAddressPaint.setAlpha((int) (alpha4 * f13));
                                Theme.chat_livePaint.setAlpha((int) (alpha5 * f13));
                                canvas.save();
                                canvas.translate(0.0f, (-AndroidUtilities.dp(50.0f)) * this.transitionParams.animateChangeProgress);
                            }
                            Theme.chat_radialProgress2Paint.setAlpha((int) (50.0f * f13));
                            canvas.drawCircle(this.rect.centerX(), this.rect.centerY(), AndroidUtilities.dp(15.0f), Theme.chat_radialProgress2Paint);
                            Theme.chat_radialProgress2Paint.setAlpha((int) (f13 * 255.0f));
                            StaticLayout staticLayout7 = staticLayout5;
                            String str3 = formatLocationLeftTime;
                            StaticLayout staticLayout8 = staticLayout2;
                            float f26 = abs;
                            canvas.drawArc(this.rect, -90.0f, abs * (-360.0f), false, Theme.chat_radialProgress2Paint);
                            canvas.drawText(str3, this.rect.centerX() - (Theme.chat_livePaint.measureText(str3) / 2.0f), imageY22 + AndroidUtilities.dp(4.0f), Theme.chat_livePaint);
                            if (staticLayout8 != null && staticLayout7 != null) {
                                canvas.save();
                                canvas.translate(this.photoImage.getImageX() + AndroidUtilities.dp(10.0f), this.photoImage.getImageY2() + AndroidUtilities.dp(10.0f));
                                staticLayout8.draw(canvas);
                                canvas.translate(0.0f, AndroidUtilities.dp(23.0f));
                                staticLayout7.draw(canvas);
                                canvas.restore();
                            }
                            if (f13 != 1.0f) {
                                Theme.chat_locationTitlePaint.setAlpha(alpha3);
                                Theme.chat_locationAddressPaint.setAlpha(alpha4);
                                Theme.chat_livePaint.setAlpha(alpha5);
                                canvas.restore();
                            }
                            TransitionParams transitionParams3 = this.transitionParams;
                            transitionParams3.lastDrawLocationExpireProgress = f26;
                            transitionParams3.lastDrawLocationExpireText = str3;
                            transitionParams3.lastDrawDocTitleLayout = staticLayout8;
                            transitionParams3.lastDrawInfoLayout = staticLayout7;
                            BaseCell.setDrawableBounds(Theme.chat_msgAvatarLiveLocationDrawable, (int) ((this.photoImage.getImageX() + (this.photoImage.getImageWidth() / 2.0f)) - AndroidUtilities.dp(31.0f)), (int) ((this.photoImage.getImageY() + (this.photoImage.getImageHeight() / 2.0f)) - AndroidUtilities.dp(38.0f)));
                            Theme.chat_msgAvatarLiveLocationDrawable.draw(canvas);
                            this.locationImageReceiver.setImageCoords(imageX + AndroidUtilities.dp(5.0f), imageY + AndroidUtilities.dp(5.0f), AndroidUtilities.dp(52.0f), AndroidUtilities.dp(52.0f));
                            this.locationImageReceiver.draw(canvas);
                        } else {
                            canvas.save();
                            canvas.translate(this.photoImage.getImageX() + AndroidUtilities.dp(6.0f), this.photoImage.getImageY2() + AndroidUtilities.dp(8.0f));
                            this.docTitleLayout.draw(canvas);
                            if (this.infoLayout != null) {
                                canvas.translate(0.0f, AndroidUtilities.dp(21.0f));
                                this.infoLayout.draw(canvas);
                            }
                            canvas.restore();
                        }
                    }
                } else if (i13 == 16) {
                    if (messageObject.isOutOwner()) {
                        Theme.chat_audioTitlePaint.setColor(getThemedColor("chat_messageTextOut"));
                        Theme.chat_contactPhonePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outTimeSelectedText" : "chat_outTimeText"));
                    } else {
                        Theme.chat_audioTitlePaint.setColor(getThemedColor("chat_messageTextIn"));
                        Theme.chat_contactPhonePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inTimeSelectedText" : "chat_inTimeText"));
                    }
                    this.forceNotDrawTime = true;
                    if (this.currentMessageObject.isOutOwner()) {
                        dp5 = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(16.0f);
                    } else if (this.isChat && !this.isThreadPost && this.currentMessageObject.needDrawAvatar()) {
                        dp5 = AndroidUtilities.dp(74.0f);
                    } else {
                        dp5 = AndroidUtilities.dp(25.0f);
                    }
                    this.otherX = dp5;
                    if (this.titleLayout != null) {
                        canvas.save();
                        canvas.translate(dp5, AndroidUtilities.dp(12.0f) + this.namesOffset);
                        this.titleLayout.draw(canvas);
                        canvas.restore();
                    }
                    if (this.docTitleLayout != null) {
                        canvas.save();
                        canvas.translate(AndroidUtilities.dp(19.0f) + dp5, AndroidUtilities.dp(37.0f) + this.namesOffset);
                        this.docTitleLayout.draw(canvas);
                        canvas.restore();
                    }
                    ?? isVideoCall = this.currentMessageObject.isVideoCall();
                    if (this.currentMessageObject.isOutOwner()) {
                        drawable3 = Theme.chat_msgCallUpGreenDrawable;
                        if (this.currentMessageObject.isVideoCall()) {
                            isDrawSelectionBackground();
                            drawable4 = getThemedDrawable("drawableMsgOutCallVideo");
                        } else {
                            drawable4 = getThemedDrawable(isDrawSelectionBackground() ? "drawableMsgOutCallAudioSelected" : "drawableMsgOutCallAudio");
                        }
                    } else {
                        TLRPC$PhoneCallDiscardReason tLRPC$PhoneCallDiscardReason = this.currentMessageObject.messageOwner.action.reason;
                        if ((tLRPC$PhoneCallDiscardReason instanceof TLRPC$TL_phoneCallDiscardReasonMissed) || (tLRPC$PhoneCallDiscardReason instanceof TLRPC$TL_phoneCallDiscardReasonBusy)) {
                            drawable3 = Theme.chat_msgCallDownRedDrawable;
                        } else {
                            drawable3 = Theme.chat_msgCallDownGreenDrawable;
                        }
                        drawable4 = isDrawSelectionBackground() ? Theme.chat_msgInCallSelectedDrawable[isVideoCall] : Theme.chat_msgInCallDrawable[isVideoCall == true ? 1 : 0];
                    }
                    BaseCell.setDrawableBounds(drawable3, dp5 - AndroidUtilities.dp(1.0f), AndroidUtilities.dp(37.0f) + this.namesOffset);
                    drawable3.draw(canvas);
                    if (Build.VERSION.SDK_INT >= 21) {
                        Drawable[] drawableArr = this.selectorDrawable;
                        if (drawableArr[0] != null && this.selectorDrawableMaskType[0] == 4) {
                            drawableArr[0].draw(canvas);
                        }
                    }
                    boolean z7 = this.pinnedBottom;
                    if (!z7 && !this.pinnedTop) {
                        this.otherY = AndroidUtilities.dp(18.5f);
                    } else if (z7 && this.pinnedTop) {
                        this.otherY = AndroidUtilities.dp(18.0f);
                    } else if (!z7) {
                        this.otherY = AndroidUtilities.dp(17.0f);
                    } else {
                        this.otherY = AndroidUtilities.dp(19.0f);
                    }
                    BaseCell.setDrawableBounds(drawable4, dp5 + AndroidUtilities.dp(isVideoCall == 0 ? 201.0f : 200.0f), this.otherY);
                    drawable4.draw(canvas);
                } else if (i13 == 17) {
                    long currentTimeMillis = System.currentTimeMillis();
                    long j4 = currentTimeMillis - this.voteLastUpdateTime;
                    if (j4 > 17) {
                        j4 = 17;
                    }
                    this.voteLastUpdateTime = currentTimeMillis;
                    if (this.currentMessageObject.isOutOwner()) {
                        themedColor = getThemedColor("chat_messageTextOut");
                        themedColor2 = getThemedColor(isDrawSelectionBackground() ? "chat_outTimeSelectedText" : "chat_outTimeText");
                    } else {
                        themedColor = getThemedColor("chat_messageTextIn");
                        themedColor2 = getThemedColor(isDrawSelectionBackground() ? "chat_inTimeSelectedText" : "chat_inTimeText");
                    }
                    Theme.chat_audioTitlePaint.setColor(themedColor);
                    Theme.chat_audioPerformerPaint.setColor(themedColor);
                    Theme.chat_instantViewPaint.setColor(themedColor);
                    Theme.chat_timePaint.setColor(themedColor2);
                    Theme.chat_livePaint.setColor(themedColor2);
                    Theme.chat_locationAddressPaint.setColor(themedColor2);
                    canvas.save();
                    TransitionParams transitionParams4 = this.transitionParams;
                    if (transitionParams4.animateForwardedLayout) {
                        float f27 = transitionParams4.animateChangeProgress;
                        float f28 = (this.namesOffset * f27) + (transitionParams4.animateForwardedNamesOffset * (1.0f - f27));
                        if (this.currentMessageObject.needDrawForwarded()) {
                            f28 -= this.namesOffset;
                        }
                        canvas.translate(0.0f, f28);
                    }
                    if (this.currentMessageObject.isOutOwner()) {
                        dp3 = (this.layoutWidth - this.backgroundWidth) + AndroidUtilities.dp(11.0f);
                    } else if (this.isChat && !this.isThreadPost && this.currentMessageObject.needDrawAvatar()) {
                        dp3 = AndroidUtilities.dp(68.0f);
                    } else {
                        dp3 = AndroidUtilities.dp(20.0f);
                    }
                    int i19 = dp3;
                    if (this.titleLayout != null) {
                        canvas.save();
                        canvas.translate(getExtraTextX() + i19, AndroidUtilities.dp(15.0f) + this.namesOffset);
                        this.titleLayout.draw(canvas);
                        canvas.restore();
                    }
                    StaticLayout staticLayout9 = this.titleLayout;
                    int height = (staticLayout9 != null ? staticLayout9.getHeight() : 0) + AndroidUtilities.dp(20.0f) + this.namesOffset;
                    if (this.docTitleLayout != null) {
                        canvas.save();
                        canvas.translate(this.docTitleOffsetX + i19 + getExtraTextX(), height);
                        this.docTitleLayout.draw(canvas);
                        canvas.restore();
                        TLRPC$TL_messageMediaPoll tLRPC$TL_messageMediaPoll = (TLRPC$TL_messageMediaPoll) MessageObject.getMedia(this.currentMessageObject.messageOwner);
                        if (this.lastPoll.quiz && ((this.pollVoted || this.pollClosed) && !TextUtils.isEmpty(tLRPC$TL_messageMediaPoll.results.solution))) {
                            Drawable themedDrawable = getThemedDrawable(this.currentMessageObject.isOutOwner() ? "drawable_chat_pollHintDrawableOut" : "drawable_chat_pollHintDrawableIn");
                            if (this.pollVoteInProgress) {
                                themedDrawable.setAlpha((int) (this.pollAnimationProgress * 255.0f));
                            } else {
                                themedDrawable.setAlpha(255);
                            }
                            int i20 = this.docTitleOffsetX;
                            if (i20 < 0 || (i20 == 0 && this.docTitleLayout.getLineLeft(0) == 0.0f)) {
                                this.pollHintX = (this.currentBackgroundDrawable.getBounds().right - themedDrawable.getIntrinsicWidth()) - AndroidUtilities.dp(this.currentMessageObject.isOutOwner() ? 17.0f : 11.0f);
                            } else {
                                this.pollHintX = getCurrentBackgroundLeft() + AndroidUtilities.dp(11.0f);
                            }
                            this.pollHintY = height - AndroidUtilities.dp(6.0f);
                            int intrinsicWidth2 = this.pollHintX + (themedDrawable.getIntrinsicWidth() / 2);
                            int intrinsicHeight = this.pollHintY + (themedDrawable.getIntrinsicHeight() / 2);
                            if (this.hintButtonVisible) {
                                float f29 = this.hintButtonProgress;
                                if (f29 < 1.0f) {
                                    f12 = AnimationProperties.overshootInterpolator.getInterpolation(f29);
                                    int intrinsicWidth3 = ((int) (themedDrawable.getIntrinsicWidth() * f12)) / 2;
                                    int intrinsicHeight2 = ((int) (themedDrawable.getIntrinsicHeight() * f12)) / 2;
                                    themedDrawable.setBounds(intrinsicWidth2 - intrinsicWidth3, intrinsicHeight - intrinsicHeight2, intrinsicWidth2 + intrinsicWidth3, intrinsicHeight + intrinsicHeight2);
                                    themedDrawable.draw(canvas);
                                }
                            }
                            f12 = this.hintButtonProgress;
                            int intrinsicWidth32 = ((int) (themedDrawable.getIntrinsicWidth() * f12)) / 2;
                            int intrinsicHeight22 = ((int) (themedDrawable.getIntrinsicHeight() * f12)) / 2;
                            themedDrawable.setBounds(intrinsicWidth2 - intrinsicWidth32, intrinsicHeight - intrinsicHeight22, intrinsicWidth2 + intrinsicWidth32, intrinsicHeight + intrinsicHeight22);
                            themedDrawable.draw(canvas);
                        } else {
                            this.pollHintX = -1;
                        }
                        if (this.pollAvatarImages != null && !this.isBot) {
                            int ceil2 = (int) Math.ceil(this.docTitleLayout.getLineLeft(0));
                            if (this.docTitleOffsetX != 0 || ceil2 != 0) {
                                int i21 = -AndroidUtilities.dp(13.0f);
                                int i22 = this.docTitleOffsetX;
                                if (i22 != 0) {
                                    dp4 = ((i22 + i19) - AndroidUtilities.dp(23.0f)) - getExtraTextX();
                                } else {
                                    dp4 = ((ceil2 + i19) - AndroidUtilities.dp(23.0f)) - getExtraTextX();
                                }
                                i10 = dp4;
                                i11 = i21;
                            } else {
                                i11 = AndroidUtilities.dp(13.0f);
                                i10 = ((int) Math.ceil(this.docTitleLayout.getLineWidth(0))) + i19 + AndroidUtilities.dp(7.0f) + getExtraTextX();
                            }
                            for (int length = this.pollAvatarImages.length - 1; length >= 0; length--) {
                                if (this.pollAvatarImagesVisible[length] && this.pollAvatarImages[length].hasImageSet()) {
                                    this.pollAvatarImages[length].setImageX((i11 * length) + i10);
                                    this.pollAvatarImages[length].setImageY(height - AndroidUtilities.dp(1.0f));
                                    ImageReceiver[] imageReceiverArr = this.pollAvatarImages;
                                    if (length != imageReceiverArr.length - 1) {
                                        canvas.drawCircle(imageReceiverArr[length].getCenterX(), this.pollAvatarImages[length].getCenterY(), AndroidUtilities.dp(9.0f), this.currentBackgroundDrawable.getPaint());
                                    }
                                    if (this.animatePollAvatars && this.animatePollAnswerAlpha) {
                                        if (this.pollUnvoteInProgress) {
                                            f10 = 1.0f;
                                            f11 = (1.0f - this.pollAnimationProgress) / 0.3f;
                                        } else {
                                            f10 = 1.0f;
                                            f11 = this.pollAnimationProgress;
                                        }
                                        this.pollAvatarImages[length].setAlpha(Math.min(f11, f10));
                                    }
                                    this.pollAvatarImages[length].draw(canvas);
                                }
                            }
                        }
                    }
                    if ((!this.pollClosed && !this.pollVoted) || this.pollVoteInProgress) {
                        TLRPC$Poll tLRPC$Poll = this.lastPoll;
                        if (tLRPC$Poll.quiz && tLRPC$Poll.close_period != 0) {
                            long max = Math.max(0L, (this.lastPoll.close_date * 1000) - ConnectionsManager.getInstance(this.currentAccount).getCurrentTimeMillis());
                            if (this.closeTimeText == null || this.lastPollCloseTime != max) {
                                this.closeTimeText = AndroidUtilities.formatDurationNoHours((int) Math.ceil(((float) max) / 1000.0f), false);
                                this.closeTimeWidth = (int) Math.ceil(Theme.chat_timePaint.measureText(formatDurationNoHours));
                                this.lastPollCloseTime = max;
                            }
                            if (max <= 0 && !this.pollClosed) {
                                if (this.currentMessageObject.pollLastCheckTime + 1000 < SystemClock.elapsedRealtime()) {
                                    this.currentMessageObject.pollLastCheckTime = 0L;
                                }
                                this.delegate.needReloadPolls();
                            }
                            int dp9 = (this.currentBackgroundDrawable.getBounds().right - this.closeTimeWidth) - AndroidUtilities.dp(this.currentMessageObject.isOutOwner() ? 40.0f : 34.0f);
                            if (max <= 5000) {
                                Theme.chat_timePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outPollWrongAnswer" : "chat_inPollWrongAnswer"));
                            }
                            if (this.animatePollAnswer) {
                                Theme.chat_timePaint.setAlpha((int) ((1.0f - this.pollAnimationProgress) * 255.0f));
                            }
                            canvas.drawText(this.closeTimeText, dp9, AndroidUtilities.dp(11.0f) + height, Theme.chat_timePaint);
                            Theme.chat_pollTimerPaint.setColor(Theme.chat_timePaint.getColor());
                            int dp10 = dp9 + this.closeTimeWidth + AndroidUtilities.dp(13.0f);
                            int dp11 = AndroidUtilities.dp(5.1f);
                            int dp12 = height + AndroidUtilities.dp(6.0f);
                            if (max <= 60000) {
                                this.rect.set(dp10 - dp11, dp12 - dp11, dp10 + dp11, dp11 + dp12);
                                float min2 = (((float) max) / (Math.min(60, this.lastPoll.close_period) * 1000.0f)) * (-360.0f);
                                i8 = dp12;
                                i9 = dp10;
                                canvas.drawArc(this.rect, -90.0f, min2, false, Theme.chat_pollTimerPaint);
                                this.timerParticles.draw(canvas, Theme.chat_pollTimerPaint, this.rect, min2, this.pollVoteInProgress ? 1.0f - this.pollAnimationProgress : 1.0f);
                            } else {
                                i8 = dp12;
                                i9 = dp10;
                                canvas.drawCircle(i9, i8, dp11, Theme.chat_pollTimerPaint);
                            }
                            if (max > 60000 || this.timerTransitionProgress != 0.0f) {
                                Theme.chat_pollTimerPaint.setAlpha((int) (this.timerTransitionProgress * 255.0f));
                                float f30 = i9;
                                canvas.drawLine(f30 - (AndroidUtilities.dp(2.1f) * this.timerTransitionProgress), i8 - AndroidUtilities.dp(7.5f), f30 + (AndroidUtilities.dp(2.1f) * this.timerTransitionProgress), i8 - AndroidUtilities.dp(7.5f), Theme.chat_pollTimerPaint);
                                float f31 = i8;
                                canvas.drawLine(f30, f31 - (AndroidUtilities.dp(3.0f) * this.timerTransitionProgress), f30, f31, Theme.chat_pollTimerPaint);
                                if (max <= 60000) {
                                    float f32 = this.timerTransitionProgress - (((float) j4) / 180.0f);
                                    this.timerTransitionProgress = f32;
                                    if (f32 < 0.0f) {
                                        this.timerTransitionProgress = 0.0f;
                                    }
                                }
                            }
                            invalidate();
                        }
                    }
                    if (Build.VERSION.SDK_INT >= 21 && this.selectorDrawable[0] != null) {
                        int[] iArr = this.selectorDrawableMaskType;
                        int i23 = iArr[0] != 1 ? 3 : 3;
                        if (iArr[0] == i23) {
                            canvas.save();
                            float f33 = this.hintButtonProgress;
                            canvas.scale(f33, f33, this.selectorDrawable[0].getBounds().centerX(), this.selectorDrawable[0].getBounds().centerY());
                        }
                        this.selectorDrawable[0].draw(canvas);
                        if (this.selectorDrawableMaskType[0] == 3) {
                            canvas.restore();
                        }
                    }
                    int size = this.pollButtons.size();
                    int i24 = 0;
                    for (int i25 = 0; i25 < size; i25++) {
                        PollButton pollButton = this.pollButtons.get(i25);
                        pollButton.x = i19;
                        canvas.save();
                        canvas.translate(AndroidUtilities.dp(35.0f) + i19, pollButton.y + this.namesOffset);
                        pollButton.title.draw(canvas);
                        if (this.animatePollAnswerAlpha) {
                            if (this.pollUnvoteInProgress) {
                                f8 = 1.0f;
                                f9 = 1.0f - this.pollAnimationProgress;
                            } else {
                                f8 = 1.0f;
                                f9 = this.pollAnimationProgress;
                            }
                            f7 = Math.min(f9 / 0.3f, f8) * 255.0f;
                        } else {
                            f7 = 255.0f;
                        }
                        int i26 = (int) f7;
                        boolean z8 = this.pollVoted;
                        if (z8 || this.pollClosed || this.animatePollAnswerAlpha) {
                            if (this.lastPoll.quiz && z8 && pollButton.chosen) {
                                if (pollButton.correct) {
                                    str = this.currentMessageObject.isOutOwner() ? "chat_outPollCorrectAnswer" : "chat_inPollCorrectAnswer";
                                } else {
                                    str = this.currentMessageObject.isOutOwner() ? "chat_outPollWrongAnswer" : "chat_inPollWrongAnswer";
                                }
                                if (!this.currentBackgroundDrawable.hasGradient() || Theme.hasThemeKey(str)) {
                                    Theme.chat_docBackPaint.setColor(getThemedColor(str));
                                } else {
                                    Theme.chat_docBackPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outAudioSeekbarFill" : "chat_inAudioSeekbarFill"));
                                }
                            } else {
                                Theme.chat_docBackPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outAudioSeekbarFill" : "chat_inAudioSeekbarFill"));
                            }
                            if (this.animatePollAnswerAlpha) {
                                float f34 = i26;
                                Theme.chat_instantViewPaint.setAlpha((int) ((Theme.chat_instantViewPaint.getAlpha() / 255.0f) * f34));
                                Theme.chat_docBackPaint.setAlpha((int) (f34 * (Theme.chat_docBackPaint.getAlpha() / 255.0f)));
                            }
                            canvas.drawText(String.format("%d%%", Integer.valueOf((int) Math.ceil(pollButton.prevPercent + ((pollButton.percent - pollButton.prevPercent) * this.pollAnimationProgress)))), (-AndroidUtilities.dp(6.5f)) - ((int) Math.ceil(Theme.chat_instantViewPaint.measureText(format))), AndroidUtilities.dp(14.0f), Theme.chat_instantViewPaint);
                            this.rect.set(0.0f, pollButton.height + AndroidUtilities.dp(6.0f), (this.backgroundWidth - AndroidUtilities.dp(76.0f)) * (pollButton.prevPercentProgress + ((pollButton.percentProgress - pollButton.prevPercentProgress) * this.pollAnimationProgress)), pollButton.height + AndroidUtilities.dp(11.0f));
                            canvas.drawRoundRect(this.rect, AndroidUtilities.dp(2.0f), AndroidUtilities.dp(2.0f), Theme.chat_docBackPaint);
                            if (pollButton.chosen || pollButton.prevChosen || (this.lastPoll.quiz && pollButton.correct && (this.pollVoted || this.pollClosed))) {
                                float dp13 = this.rect.left - AndroidUtilities.dp(13.5f);
                                float centerY = this.rect.centerY();
                                canvas.drawCircle(dp13, centerY, AndroidUtilities.dp(7.0f), Theme.chat_docBackPaint);
                                if (this.lastPoll.quiz && pollButton.chosen && !pollButton.correct) {
                                    drawable2 = Theme.chat_pollCrossDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0];
                                } else {
                                    drawable2 = Theme.chat_pollCheckDrawable[this.currentMessageObject.isOutOwner() ? 1 : 0];
                                }
                                drawable2.setAlpha(i26);
                                BaseCell.setDrawableBounds(drawable2, dp13 - (drawable2.getIntrinsicWidth() / 2), centerY - (drawable2.getIntrinsicHeight() / 2));
                                drawable2.draw(canvas);
                            }
                        }
                        if ((!this.pollVoted && !this.pollClosed) || this.animatePollAnswerAlpha) {
                            if (isDrawSelectionBackground()) {
                                Theme.chat_replyLinePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outVoiceSeekbarSelected" : "chat_inVoiceSeekbarSelected"));
                            } else {
                                Theme.chat_replyLinePaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outVoiceSeekbar" : "chat_inVoiceSeekbar"));
                            }
                            if (this.animatePollAnswerAlpha) {
                                Theme.chat_replyLinePaint.setAlpha((int) ((255 - i26) * (Theme.chat_replyLinePaint.getAlpha() / 255.0f)));
                            }
                            canvas.drawLine(-AndroidUtilities.dp(2.0f), pollButton.height + AndroidUtilities.dp(13.0f), this.backgroundWidth - AndroidUtilities.dp(58.0f), pollButton.height + AndroidUtilities.dp(13.0f), Theme.chat_replyLinePaint);
                            if (this.pollVoteInProgress && i25 == this.pollVoteInProgressNum) {
                                Theme.chat_instantViewRectPaint.setColor(getThemedColor(this.currentMessageObject.isOutOwner() ? "chat_outAudioSeekbarFill" : "chat_inAudioSeekbarFill"));
                                if (this.animatePollAnswerAlpha) {
                                    Theme.chat_instantViewRectPaint.setAlpha((int) ((255 - i26) * (Theme.chat_instantViewRectPaint.getAlpha() / 255.0f)));
                                }
                                this.rect.set((-AndroidUtilities.dp(22.0f)) - AndroidUtilities.dp(8.5f), AndroidUtilities.dp(9.0f) - AndroidUtilities.dp(8.5f), (-AndroidUtilities.dp(23.0f)) + AndroidUtilities.dp(8.5f), AndroidUtilities.dp(9.0f) + AndroidUtilities.dp(8.5f));
                                canvas.drawArc(this.rect, this.voteRadOffset, this.voteCurrentCircleLength, false, Theme.chat_instantViewRectPaint);
                            } else {
                                if (this.currentMessageObject.isOutOwner()) {
                                    Theme.chat_instantViewRectPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outMenuSelected" : "chat_outMenu"));
                                } else {
                                    Theme.chat_instantViewRectPaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inMenuSelected" : "chat_inMenu"));
                                }
                                if (this.animatePollAnswerAlpha) {
                                    Theme.chat_instantViewRectPaint.setAlpha((int) ((255 - i26) * (Theme.chat_instantViewRectPaint.getAlpha() / 255.0f)));
                                }
                                canvas.drawCircle(-AndroidUtilities.dp(22.0f), AndroidUtilities.dp(9.0f), AndroidUtilities.dp(8.5f), Theme.chat_instantViewRectPaint);
                                if (this.lastPoll.multiple_choice) {
                                    int dp14 = AndroidUtilities.dp(8.5f);
                                    String str4 = "checkboxCheck";
                                    if (this.currentMessageObject.isOutOwner() && getThemedColor(str4) == -1) {
                                        str4 = "chat_outBubble";
                                    }
                                    this.pollCheckBox[i25].setColor(null, this.currentMessageObject.isOutOwner() ? "chat_outAudioSeekbarFill" : "chat_inAudioSeekbarFill", str4);
                                    int i27 = dp14 / 2;
                                    this.pollCheckBox[i25].setBounds((-AndroidUtilities.dp(22.0f)) - i27, AndroidUtilities.dp(9.0f) - i27, dp14, dp14);
                                    this.pollCheckBox[i25].draw(canvas);
                                    canvas.restore();
                                    if (i25 != size - 1) {
                                        i24 = pollButton.y + this.namesOffset + pollButton.height;
                                    }
                                }
                            }
                        }
                        canvas.restore();
                        if (i25 != size - 1) {
                        }
                    }
                    if (this.drawInstantView) {
                        int currentBackgroundLeft = getCurrentBackgroundLeft() + AndroidUtilities.dp((this.currentMessageObject.isOutOwner() || this.mediaBackground || this.drawPinnedBottom) ? 2.0f : 8.0f);
                        int dp15 = i24 + AndroidUtilities.dp(13.0f);
                        if (this.currentMessageObject.isOutOwner()) {
                            Theme.chat_instantViewPaint.setColor(getThemedColor("chat_outPreviewInstantText"));
                        } else {
                            Theme.chat_instantViewPaint.setColor(getThemedColor("chat_inPreviewInstantText"));
                        }
                        this.instantButtonRect.set(currentBackgroundLeft, dp15, this.instantWidth + currentBackgroundLeft, AndroidUtilities.dp(44.0f) + dp15);
                        Drawable[] drawableArr2 = this.selectorDrawable;
                        if (drawableArr2[0] != null && this.selectorDrawableMaskType[0] == 2) {
                            drawableArr2[0].setBounds(currentBackgroundLeft, dp15, this.instantWidth + currentBackgroundLeft, AndroidUtilities.dp(44.0f) + dp15);
                            this.selectorDrawable[0].draw(canvas);
                        }
                        if (this.instantViewLayout != null) {
                            canvas.save();
                            canvas.translate(currentBackgroundLeft + this.instantTextX, dp15 + AndroidUtilities.dp(14.5f));
                            this.instantViewLayout.draw(canvas);
                            canvas.restore();
                        }
                    } else if (this.infoLayout != null) {
                        TLRPC$Poll tLRPC$Poll2 = this.lastPoll;
                        if (tLRPC$Poll2.public_voters || tLRPC$Poll2.multiple_choice) {
                            i24 += AndroidUtilities.dp(6.0f);
                        }
                        canvas.save();
                        canvas.translate(i19 + this.infoX, i24 + AndroidUtilities.dp(22.0f));
                        this.infoLayout.draw(canvas);
                        canvas.restore();
                    }
                    updatePollAnimations(j4);
                    canvas.restore();
                } else if (i13 == 12) {
                    if (messageObject.isOutOwner()) {
                        Theme.chat_contactNamePaint.setColor(getThemedColor("chat_outContactNameText"));
                        Theme.chat_contactPhonePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_outContactPhoneSelectedText" : "chat_outContactPhoneText"));
                    } else {
                        Theme.chat_contactNamePaint.setColor(getThemedColor("chat_inContactNameText"));
                        Theme.chat_contactPhonePaint.setColor(getThemedColor(isDrawSelectionBackground() ? "chat_inContactPhoneSelectedText" : "chat_inContactPhoneText"));
                    }
                    if (this.titleLayout != null) {
                        canvas.save();
                        canvas.translate(this.photoImage.getImageX() + this.photoImage.getImageWidth() + AndroidUtilities.dp(9.0f), AndroidUtilities.dp(16.0f) + this.namesOffset);
                        this.titleLayout.draw(canvas);
                        canvas.restore();
                    }
                    if (this.docTitleLayout != null) {
                        canvas.save();
                        canvas.translate(this.photoImage.getImageX() + this.photoImage.getImageWidth() + AndroidUtilities.dp(9.0f), AndroidUtilities.dp(39.0f) + this.namesOffset);
                        this.docTitleLayout.draw(canvas);
                        canvas.restore();
                    }
                    if (this.currentMessageObject.isOutOwner()) {
                        drawable = getThemedDrawable(isDrawSelectionBackground() ? "drawableMsgOutMenuSelected" : "drawableMsgOutMenu");
                    } else {
                        drawable = isDrawSelectionBackground() ? Theme.chat_msgInMenuSelectedDrawable : Theme.chat_msgInMenuDrawable;
                    }
                    int imageX5 = (int) ((this.photoImage.getImageX() + this.backgroundWidth) - AndroidUtilities.dp(48.0f));
                    this.otherX = imageX5;
                    int imageY4 = (int) (this.photoImage.getImageY() - AndroidUtilities.dp(2.0f));
                    this.otherY = imageY4;
                    BaseCell.setDrawableBounds(drawable, imageX5, imageY4);
                    drawable.draw(canvas);
                    if (this.drawInstantView) {
                        int imageX6 = (int) (this.photoImage.getImageX() - AndroidUtilities.dp(2.0f));
                        int dp16 = this.layoutHeight - AndroidUtilities.dp(66.0f);
                        ReactionsLayoutInBubble reactionsLayoutInBubble2 = this.reactionsLayoutInBubble;
                        if (!reactionsLayoutInBubble2.isEmpty && !reactionsLayoutInBubble2.isSmall) {
                            dp16 -= reactionsLayoutInBubble2.totalHeight;
                        }
                        if (this.drawCommentButton) {
                            dp16 -= AndroidUtilities.dp(shouldDrawTimeOnMedia() ? 39.3f : 41.0f);
                        }
                        Paint paint = Theme.chat_instantViewRectPaint;
                        if (this.currentMessageObject.isOutOwner()) {
                            Theme.chat_instantViewPaint.setColor(getThemedColor("chat_outPreviewInstantText"));
                            paint.setColor(getThemedColor("chat_outPreviewInstantText"));
                        } else {
                            Theme.chat_instantViewPaint.setColor(getThemedColor("chat_inPreviewInstantText"));
                            paint.setColor(getThemedColor("chat_inPreviewInstantText"));
                        }
                        this.instantButtonRect.set(imageX6, dp16, this.instantWidth + imageX6, AndroidUtilities.dp(36.0f) + dp16);
                        if (Build.VERSION.SDK_INT >= 21) {
                            this.selectorDrawableMaskType[0] = 0;
                            this.selectorDrawable[0].setBounds(imageX6, dp16, this.instantWidth + imageX6, AndroidUtilities.dp(36.0f) + dp16);
                            this.selectorDrawable[0].draw(canvas);
                        }
                        canvas.drawRoundRect(this.instantButtonRect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), paint);
                        if (this.instantViewLayout != null) {
                            canvas.save();
                            canvas.translate(imageX6 + this.instantTextX, dp16 + AndroidUtilities.dp(10.5f));
                            this.instantViewLayout.draw(canvas);
                            canvas.restore();
                        }
                    }
                }
            }
            if (!this.drawImageButton || !this.photoImage.getVisible()) {
                obj = null;
            } else {
                float f35 = this.controlsAlpha;
                if (f35 != 1.0f) {
                    this.radialProgress.setOverrideAlpha(f35);
                }
                if (this.photoImage.hasImageSet()) {
                    obj = null;
                    this.radialProgress.setBackgroundDrawable(null);
                } else {
                    obj = null;
                    this.radialProgress.setBackgroundDrawable(isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                }
                if (!this.currentMessageObject.needDrawBluredPreview() || !MediaController.getInstance().isPlayingMessage(this.currentMessageObject)) {
                    this.radialProgress.draw(canvas);
                }
            }
            if (this.buttonState == -1 && this.currentMessageObject.needDrawBluredPreview() && !MediaController.getInstance().isPlayingMessage(this.currentMessageObject) && this.photoImage.getVisible()) {
                MessageObject messageObject3 = this.currentMessageObject;
                if (messageObject3.messageOwner.destroyTime != 0) {
                    if (!messageObject3.isOutOwner()) {
                        float max2 = ((float) Math.max(0L, (this.currentMessageObject.messageOwner.destroyTime * 1000) - (System.currentTimeMillis() + (ConnectionsManager.getInstance(this.currentAccount).getTimeDifference() * 1000)))) / (this.currentMessageObject.messageOwner.ttl * 1000.0f);
                        Theme.chat_deleteProgressPaint.setAlpha((int) (this.controlsAlpha * 255.0f));
                        Object obj4 = obj;
                        canvas.drawArc(this.deleteProgressRect, -90.0f, max2 * (-360.0f), true, Theme.chat_deleteProgressPaint);
                        obj2 = obj4;
                        if (max2 != 0.0f) {
                            int dp17 = AndroidUtilities.dp(2.0f);
                            RectF rectF = this.deleteProgressRect;
                            int i28 = ((int) rectF.left) - dp17;
                            int i29 = ((int) rectF.top) - dp17;
                            int i30 = dp17 * 2;
                            invalidate(i28, i29, ((int) rectF.right) + i30, ((int) rectF.bottom) + i30);
                            obj3 = obj4;
                            updateSecretTimeText(this.currentMessageObject);
                            r10 = obj3;
                            if ((!this.drawVideoImageButton || this.animatingDrawVideoImageButton != 0) && this.photoImage.getVisible()) {
                                f = this.controlsAlpha;
                                if (f != 1.0f) {
                                    this.videoRadialProgress.setOverrideAlpha(f);
                                }
                                this.videoRadialProgress.draw(canvas);
                            }
                            if (this.drawMediaCheckBox) {
                                int i31 = this.documentAttachType;
                                if (i31 != 5 && (i31 != 1 || this.drawPhotoImage)) {
                                    int dp18 = AndroidUtilities.dp(21.0f);
                                    this.mediaCheckBox.setBackgroundType(0);
                                    this.mediaCheckBox.setBounds(((int) this.photoImage.getImageX2()) - AndroidUtilities.dp(25.0f), ((int) this.photoImage.getImageY()) + AndroidUtilities.dp(4.0f), dp18, dp18);
                                    this.mediaCheckBox.setColor(r10, r10, this.currentMessageObject.isOutOwner() ? "chat_outBubbleSelected" : "chat_inBubbleSelected");
                                    this.mediaCheckBox.setBackgroundDrawable(r10);
                                    this.mediaCheckBox.draw(canvas);
                                }
                                int dp19 = AndroidUtilities.dp(20.0f);
                                this.mediaCheckBox.setBackgroundType(this.radialProgress.getMiniIcon() != 4 ? 12 : 13);
                                this.mediaCheckBox.setBounds(this.buttonX + AndroidUtilities.dp(28.0f), this.buttonY + AndroidUtilities.dp(28.0f), dp19, dp19);
                                this.mediaCheckBox.setColor(this.currentMessageObject.isOutOwner() ? "chat_outTimeText" : "chat_inTimeText", this.currentMessageObject.isOutOwner() ? "chat_outLoader" : "chat_inLoader", this.currentMessageObject.isOutOwner() ? "chat_outBubble" : "chat_inBubble");
                                this.mediaCheckBox.setBackgroundDrawable(isDrawSelectionBackground() ? this.currentBackgroundSelectedDrawable : this.currentBackgroundDrawable);
                                this.mediaCheckBox.draw(canvas);
                            }
                            if (this.documentAttachType != 7) {
                                return;
                            }
                            boolean isPlayingMessage2 = MediaController.getInstance().isPlayingMessage(this.currentMessageObject);
                            MessageObject messageObject4 = this.currentMessageObject;
                            if (messageObject4.type == 5) {
                                if (messageObject4.isOutOwner()) {
                                    float f36 = (AndroidUtilities.roundPlayingMessageSize - AndroidUtilities.roundMessageSize) * 0.2f;
                                    boolean z9 = this.isPlayingRound;
                                    float f37 = z9 ? f36 : 0.0f;
                                    TransitionParams transitionParams5 = this.transitionParams;
                                    if (transitionParams5.animatePlayingRound) {
                                        f2 = f36 * (z9 ? transitionParams5.animateChangeProgress : 1.0f - transitionParams5.animateChangeProgress);
                                    } else {
                                        f2 = f37;
                                    }
                                } else {
                                    f2 = 0.0f;
                                }
                                float dp20 = this.backgroundDrawableLeft + this.transitionParams.deltaLeft + AndroidUtilities.dp(8.0f) + this.roundPlayingDrawableProgress + f2;
                                float dp21 = this.layoutHeight - AndroidUtilities.dp(28 - (this.drawPinnedBottom ? 2 : 0));
                                if (!this.reactionsLayoutInBubble.isEmpty) {
                                    dp21 -= reactionsLayoutInBubble.totalHeight;
                                }
                                TransitionParams transitionParams6 = this.transitionParams;
                                transitionParams6.lastDrawRoundVideoDotY = dp21;
                                if (transitionParams6.animateRoundVideoDotY) {
                                    float f38 = transitionParams6.animateFromRoundVideoDotY;
                                    float f39 = transitionParams6.animateChangeProgress;
                                    dp21 = (dp21 * f39) + (f38 * (1.0f - f39));
                                }
                                this.rect.set(dp20, dp21, this.timeWidthAudio + dp20 + AndroidUtilities.dp(22.0f), AndroidUtilities.dp(17.0f) + dp21);
                                int alpha6 = getThemedPaint("paintChatActionBackground").getAlpha();
                                getThemedPaint("paintChatActionBackground").setAlpha((int) (alpha6 * this.timeAlpha));
                                applyServiceShaderMatrix();
                                canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), getThemedPaint("paintChatActionBackground"));
                                if (hasGradientService()) {
                                    int alpha7 = Theme.chat_actionBackgroundGradientDarkenPaint.getAlpha();
                                    Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha((int) (alpha7 * this.timeAlpha));
                                    canvas.drawRoundRect(this.rect, AndroidUtilities.dp(6.0f), AndroidUtilities.dp(6.0f), Theme.chat_actionBackgroundGradientDarkenPaint);
                                    Theme.chat_actionBackgroundGradientDarkenPaint.setAlpha(alpha7);
                                }
                                getThemedPaint("paintChatActionBackground").setAlpha(alpha6);
                                boolean z10 = isPlayingMessage2 || !this.currentMessageObject.isContentUnread();
                                if (z10) {
                                    float f40 = this.roundPlayingDrawableProgress;
                                    if (f40 != 1.0f) {
                                        float f41 = f40 + 0.10666667f;
                                        this.roundPlayingDrawableProgress = f41;
                                        if (f41 > 1.0f) {
                                            this.roundPlayingDrawableProgress = 1.0f;
                                        } else {
                                            invalidate();
                                        }
                                        if (z10) {
                                            if (isPlayingMessage2 && !MediaController.getInstance().isMessagePaused()) {
                                                this.roundVideoPlayingDrawable.start();
                                            } else {
                                                this.roundVideoPlayingDrawable.stop();
                                            }
                                        }
                                        if (this.roundPlayingDrawableProgress < 1.0f) {
                                            float dp22 = this.timeWidthAudio + dp20 + AndroidUtilities.dp(12.0f);
                                            float dp23 = AndroidUtilities.dp(8.3f) + dp21;
                                            canvas.save();
                                            float f42 = this.roundPlayingDrawableProgress;
                                            canvas.scale(1.0f - f42, 1.0f - f42, dp22, dp23);
                                            Theme.chat_docBackPaint.setColor(getThemedColor("chat_serviceText"));
                                            Theme.chat_docBackPaint.setAlpha((int) (this.timeAlpha * 255.0f * (1.0f - this.roundPlayingDrawableProgress)));
                                            canvas.drawCircle(dp22, dp23, AndroidUtilities.dp(3.0f), Theme.chat_docBackPaint);
                                            canvas.restore();
                                        }
                                        if (this.roundPlayingDrawableProgress > 0.0f) {
                                            BaseCell.setDrawableBounds(this.roundVideoPlayingDrawable, this.timeWidthAudio + dp20 + AndroidUtilities.dp(6.0f), AndroidUtilities.dp(2.3f) + dp21);
                                            canvas.save();
                                            float f43 = this.roundPlayingDrawableProgress;
                                            canvas.scale(f43, f43, this.roundVideoPlayingDrawable.getBounds().centerX(), this.roundVideoPlayingDrawable.getBounds().centerY());
                                            this.roundVideoPlayingDrawable.setAlpha((int) (this.roundPlayingDrawableProgress * 255.0f));
                                            this.roundVideoPlayingDrawable.draw(canvas);
                                            canvas.restore();
                                        }
                                        dp = dp20 + AndroidUtilities.dp(4.0f);
                                        dp2 = dp21 + AndroidUtilities.dp(1.7f);
                                    }
                                }
                                if (!z10) {
                                    float f44 = this.roundPlayingDrawableProgress;
                                    if (f44 != 0.0f) {
                                        float f45 = f44 - 0.10666667f;
                                        this.roundPlayingDrawableProgress = f45;
                                        if (f45 < 0.0f) {
                                            this.roundPlayingDrawableProgress = 0.0f;
                                        } else {
                                            invalidate();
                                        }
                                    }
                                }
                                if (z10) {
                                }
                                if (this.roundPlayingDrawableProgress < 1.0f) {
                                }
                                if (this.roundPlayingDrawableProgress > 0.0f) {
                                }
                                dp = dp20 + AndroidUtilities.dp(4.0f);
                                dp2 = dp21 + AndroidUtilities.dp(1.7f);
                            } else {
                                dp = this.backgroundDrawableLeft + AndroidUtilities.dp((messageObject4.isOutOwner() || this.drawPinnedBottom) ? 12.0f : 18.0f);
                                dp2 = (this.layoutHeight - AndroidUtilities.dp(6.3f - (this.drawPinnedBottom ? 2 : 0))) - this.timeLayout.getHeight();
                            }
                            if (this.durationLayout == null) {
                                return;
                            }
                            Theme.chat_timePaint.setAlpha((int) (this.timeAlpha * 255.0f));
                            canvas.save();
                            canvas.translate(dp, dp2);
                            this.durationLayout.draw(canvas);
                            canvas.restore();
                            Theme.chat_timePaint.setAlpha(255);
                            return;
                        }
                    } else {
                        obj2 = obj;
                    }
                    obj3 = obj2;
                    updateSecretTimeText(this.currentMessageObject);
                    r10 = obj3;
                    if (!this.drawVideoImageButton) {
                    }
                    f = this.controlsAlpha;
                    if (f != 1.0f) {
                    }
                    this.videoRadialProgress.draw(canvas);
                    if (this.drawMediaCheckBox) {
                    }
                    if (this.documentAttachType != 7) {
                    }
                }
            }
            r10 = obj;
            if (!this.drawVideoImageButton) {
            }
            f = this.controlsAlpha;
            if (f != 1.0f) {
            }
            this.videoRadialProgress.draw(canvas);
            if (this.drawMediaCheckBox) {
            }
            if (this.documentAttachType != 7) {
            }
        }
    }

    @Override // org.telegram.messenger.DownloadController.FileDownloadProgressListener
    public int getObserverTag() {
        return this.TAG;
    }

    public MessageObject getMessageObject() {
        MessageObject messageObject = this.messageObjectToSet;
        return messageObject != null ? messageObject : this.currentMessageObject;
    }

    public TLRPC$Document getStreamingMedia() {
        int i = this.documentAttachType;
        if (i == 4 || i == 7 || i == 2) {
            return this.documentAttach;
        }
        return null;
    }

    public boolean drawPinnedBottom() {
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null && groupedMessages.isDocuments) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            if (groupedMessagePosition != null && (groupedMessagePosition.flags & 8) != 0) {
                return this.pinnedBottom;
            }
            return true;
        }
        return this.pinnedBottom;
    }

    public boolean drawPinnedTop() {
        MessageObject.GroupedMessages groupedMessages = this.currentMessagesGroup;
        if (groupedMessages != null && groupedMessages.isDocuments) {
            MessageObject.GroupedMessagePosition groupedMessagePosition = this.currentPosition;
            if (groupedMessagePosition != null && (groupedMessagePosition.flags & 4) != 0) {
                return this.pinnedTop;
            }
            return true;
        }
        return this.pinnedTop;
    }

    public boolean isPinnedBottom() {
        return this.pinnedBottom;
    }

    public boolean isPinnedTop() {
        return this.pinnedTop;
    }

    public MessageObject.GroupedMessages getCurrentMessagesGroup() {
        return this.currentMessagesGroup;
    }

    public MessageObject.GroupedMessagePosition getCurrentPosition() {
        return this.currentPosition;
    }

    public int getLayoutHeight() {
        return this.layoutHeight;
    }

    @Override // android.view.View
    public boolean performAccessibilityAction(int i, Bundle bundle) {
        ChatMessageCellDelegate chatMessageCellDelegate;
        ChatMessageCellDelegate chatMessageCellDelegate2 = this.delegate;
        if (chatMessageCellDelegate2 == null || !chatMessageCellDelegate2.onAccessibilityAction(i, bundle)) {
            if (i == 16) {
                int iconForCurrentState = getIconForCurrentState();
                if (iconForCurrentState != 4 && iconForCurrentState != 5) {
                    didPressButton(true, false);
                } else if (this.currentMessageObject.type == 16) {
                    this.delegate.didPressOther(this, this.otherX, this.otherY);
                } else {
                    didClickedImage();
                }
                return true;
            }
            if (i == R.id.acc_action_small_button) {
                didPressMiniButton(true);
            } else if (i == R.id.acc_action_msg_options) {
                ChatMessageCellDelegate chatMessageCellDelegate3 = this.delegate;
                if (chatMessageCellDelegate3 != null) {
                    if (this.currentMessageObject.type == 16) {
                        chatMessageCellDelegate3.didLongPress(this, 0.0f, 0.0f);
                    } else {
                        chatMessageCellDelegate3.didPressOther(this, this.otherX, this.otherY);
                    }
                }
            } else if (i == R.id.acc_action_open_forwarded_origin && (chatMessageCellDelegate = this.delegate) != null) {
                TLRPC$Chat tLRPC$Chat = this.currentForwardChannel;
                if (tLRPC$Chat != null) {
                    chatMessageCellDelegate.didPressChannelAvatar(this, tLRPC$Chat, this.currentMessageObject.messageOwner.fwd_from.channel_post, this.lastTouchX, this.lastTouchY);
                } else {
                    TLRPC$User tLRPC$User = this.currentForwardUser;
                    if (tLRPC$User != null) {
                        chatMessageCellDelegate.didPressUserAvatar(this, tLRPC$User, this.lastTouchX, this.lastTouchY);
                    } else if (this.currentForwardName != null) {
                        chatMessageCellDelegate.didPressHiddenForward(this);
                    }
                }
            }
            if ((!this.currentMessageObject.isVoice() && !this.currentMessageObject.isRoundVideo() && (!this.currentMessageObject.isMusic() || !MediaController.getInstance().isPlayingMessage(this.currentMessageObject))) || !this.seekBarAccessibilityDelegate.performAccessibilityActionInternal(i, bundle)) {
                return super.performAccessibilityAction(i, bundle);
            }
            return true;
        }
        return false;
    }

    public void setAnimationRunning(boolean z, boolean z2) {
        this.animationRunning = z;
        if (z) {
            this.willRemoved = z2;
        } else {
            this.willRemoved = false;
        }
        if (getParent() != null || !this.attachedToWindow) {
            return;
        }
        onDetachedFromWindow();
    }

    @Override // android.view.View
    public boolean onHoverEvent(MotionEvent motionEvent) {
        int x = (int) motionEvent.getX();
        int y = (int) motionEvent.getY();
        if (motionEvent.getAction() == 9 || motionEvent.getAction() == 7) {
            for (int i = 0; i < this.accessibilityVirtualViewBounds.size(); i++) {
                if (this.accessibilityVirtualViewBounds.valueAt(i).contains(x, y)) {
                    int keyAt = this.accessibilityVirtualViewBounds.keyAt(i);
                    if (keyAt == this.currentFocusedVirtualView) {
                        return true;
                    }
                    this.currentFocusedVirtualView = keyAt;
                    sendAccessibilityEventForVirtualView(keyAt, 32768);
                    return true;
                }
            }
        } else if (motionEvent.getAction() == 10) {
            this.currentFocusedVirtualView = 0;
        }
        return super.onHoverEvent(motionEvent);
    }

    @Override // android.view.View
    public void onInitializeAccessibilityNodeInfo(AccessibilityNodeInfo accessibilityNodeInfo) {
        super.onInitializeAccessibilityNodeInfo(accessibilityNodeInfo);
    }

    @Override // android.view.View
    public AccessibilityNodeProvider getAccessibilityNodeProvider() {
        return new MessageAccessibilityNodeProvider();
    }

    /* JADX INFO: Access modifiers changed from: private */
    public void sendAccessibilityEventForVirtualView(int i, int i2) {
        sendAccessibilityEventForVirtualView(i, i2, null);
    }

    private void sendAccessibilityEventForVirtualView(int i, int i2, String str) {
        if (((AccessibilityManager) getContext().getSystemService("accessibility")).isTouchExplorationEnabled()) {
            AccessibilityEvent obtain = AccessibilityEvent.obtain(i2);
            obtain.setPackageName(getContext().getPackageName());
            obtain.setSource(this, i);
            if (str != null) {
                obtain.getText().add(str);
            }
            if (getParent() == null) {
                return;
            }
            getParent().requestSendAccessibilityEvent(this, obtain);
        }
    }

    public static Point getMessageSize(int i, int i2) {
        return getMessageSize(i, i2, 0, 0);
    }

    /* JADX WARN: Removed duplicated region for block: B:25:0x0042  */
    /* JADX WARN: Removed duplicated region for block: B:28:0x004c  */
    /*
        Code decompiled incorrectly, please refer to instructions dump.
    */
    private static Point getMessageSize(int i, int i2, int i3, int i4) {
        int min;
        if (i4 == 0 || i3 == 0) {
            if (AndroidUtilities.isTablet()) {
                min = AndroidUtilities.getMinTabletSide();
            } else if (i >= i2) {
                android.graphics.Point point = AndroidUtilities.displaySize;
                i3 = Math.min(point.x, point.y) - AndroidUtilities.dp(64.0f);
                i4 = AndroidUtilities.dp(100.0f) + i3;
                if (i3 > AndroidUtilities.getPhotoSize()) {
                    i3 = AndroidUtilities.getPhotoSize();
                }
                if (i4 > AndroidUtilities.getPhotoSize()) {
                    i4 = AndroidUtilities.getPhotoSize();
                }
            } else {
                android.graphics.Point point2 = AndroidUtilities.displaySize;
                min = Math.min(point2.x, point2.y);
            }
            i3 = (int) (min * 0.7f);
            i4 = AndroidUtilities.dp(100.0f) + i3;
            if (i3 > AndroidUtilities.getPhotoSize()) {
            }
            if (i4 > AndroidUtilities.getPhotoSize()) {
            }
        }
        float f = i;
        float f2 = i3;
        float f3 = f / f2;
        int i5 = (int) (f / f3);
        float f4 = i2;
        int i6 = (int) (f4 / f3);
        if (i5 == 0) {
            i5 = AndroidUtilities.dp(150.0f);
        }
        if (i6 == 0) {
            i6 = AndroidUtilities.dp(150.0f);
        }
        if (i6 > i4) {
            i5 = (int) (i5 / (i6 / i4));
        } else if (i6 < AndroidUtilities.dp(120.0f)) {
            i4 = AndroidUtilities.dp(120.0f);
            float f5 = f / (f4 / i4);
            if (f5 < f2) {
                i5 = (int) f5;
            }
        } else {
            i4 = i6;
        }
        return new Point(i5, i4);
    }

    public StaticLayout getDescriptionlayout() {
        return this.descriptionLayout;
    }

    public void setSelectedBackgroundProgress(float f) {
        this.selectedBackgroundProgress = f;
        invalidate();
    }

    public int computeHeight(MessageObject messageObject, MessageObject.GroupedMessages groupedMessages) {
        this.photoImage.setIgnoreImageSet(true);
        this.avatarImage.setIgnoreImageSet(true);
        this.replyImageReceiver.setIgnoreImageSet(true);
        this.locationImageReceiver.setIgnoreImageSet(true);
        if (groupedMessages != null && groupedMessages.messages.size() != 1) {
            int i = 0;
            for (int i2 = 0; i2 < groupedMessages.messages.size(); i2++) {
                MessageObject messageObject2 = groupedMessages.messages.get(i2);
                MessageObject.GroupedMessagePosition groupedMessagePosition = groupedMessages.positions.get(messageObject2);
                if (groupedMessagePosition != null && (groupedMessagePosition.flags & 1) != 0) {
                    setMessageContent(messageObject2, groupedMessages, false, false);
                    i += this.totalHeight + this.keyboardHeight;
                }
            }
            return i;
        }
        setMessageContent(messageObject, groupedMessages, false, false);
        this.photoImage.setIgnoreImageSet(false);
        this.avatarImage.setIgnoreImageSet(false);
        this.replyImageReceiver.setIgnoreImageSet(false);
        this.locationImageReceiver.setIgnoreImageSet(false);
        return this.totalHeight + this.keyboardHeight;
    }

    public void shakeView() {
        PropertyValuesHolder ofKeyframe = PropertyValuesHolder.ofKeyframe(View.ROTATION, Keyframe.ofFloat(0.0f, 0.0f), Keyframe.ofFloat(0.2f, 3.0f), Keyframe.ofFloat(0.4f, -3.0f), Keyframe.ofFloat(0.6f, 3.0f), Keyframe.ofFloat(0.8f, -3.0f), Keyframe.ofFloat(1.0f, 0.0f));
        Keyframe ofFloat = Keyframe.ofFloat(0.0f, 1.0f);
        Keyframe ofFloat2 = Keyframe.ofFloat(0.5f, 0.97f);
        Keyframe ofFloat3 = Keyframe.ofFloat(1.0f, 1.0f);
        PropertyValuesHolder ofKeyframe2 = PropertyValuesHolder.ofKeyframe(View.SCALE_X, ofFloat, ofFloat2, ofFloat3);
        PropertyValuesHolder ofKeyframe3 = PropertyValuesHolder.ofKeyframe(View.SCALE_Y, ofFloat, ofFloat2, ofFloat3);
        AnimatorSet animatorSet = new AnimatorSet();
        this.shakeAnimation = animatorSet;
        animatorSet.playTogether(ObjectAnimator.ofPropertyValuesHolder(this, ofKeyframe), ObjectAnimator.ofPropertyValuesHolder(this, ofKeyframe2), ObjectAnimator.ofPropertyValuesHolder(this, ofKeyframe3));
        this.shakeAnimation.setDuration(500L);
        this.shakeAnimation.start();
    }

    private void cancelShakeAnimation() {
        AnimatorSet animatorSet = this.shakeAnimation;
        if (animatorSet != null) {
            animatorSet.cancel();
            this.shakeAnimation = null;
            setScaleX(1.0f);
            setScaleY(1.0f);
            setRotation(0.0f);
        }
    }

    public void setSlidingOffset(float f) {
        if (this.slidingOffsetX != f) {
            this.slidingOffsetX = f;
            updateTranslation();
        }
    }

    public void setAnimationOffsetX(float f) {
        if (this.animationOffsetX != f) {
            this.animationOffsetX = f;
            updateTranslation();
        }
    }

    private void updateTranslation() {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            return;
        }
        setTranslationX(this.slidingOffsetX + this.animationOffsetX + (!messageObject.isOutOwner() ? this.checkBoxTranslation : 0));
    }

    public float getNonAnimationTranslationX(boolean z) {
        boolean z2;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject != null && !messageObject.isOutOwner()) {
            if (z && ((z2 = this.checkBoxVisible) || this.checkBoxAnimationInProgress)) {
                this.checkBoxTranslation = (int) Math.ceil((z2 ? CubicBezierInterpolator.EASE_OUT : CubicBezierInterpolator.EASE_IN).getInterpolation(this.checkBoxAnimationProgress) * AndroidUtilities.dp(35.0f));
            }
            return this.slidingOffsetX + this.checkBoxTranslation;
        }
        return this.slidingOffsetX;
    }

    public float getSlidingOffsetX() {
        return this.slidingOffsetX;
    }

    public boolean willRemovedAfterAnimation() {
        return this.willRemoved;
    }

    public float getAnimationOffsetX() {
        return this.animationOffsetX;
    }

    @Override // android.view.View
    public void setTranslationX(float f) {
        super.setTranslationX(f);
    }

    public SeekBar getSeekBar() {
        return this.seekBar;
    }

    public SeekBarWaveform getSeekBarWaveform() {
        return this.seekBarWaveform;
    }

    /* JADX INFO: Access modifiers changed from: private */
    /* loaded from: classes3.dex */
    public class MessageAccessibilityNodeProvider extends AccessibilityNodeProvider {
        private Path linkPath;
        private Rect rect;
        private RectF rectF;

        private MessageAccessibilityNodeProvider() {
            this.linkPath = new Path();
            this.rectF = new RectF();
            this.rect = new Rect();
        }

        /* loaded from: classes3.dex */
        private class ProfileSpan extends ClickableSpan {
            private TLRPC$User user;

            public ProfileSpan(TLRPC$User tLRPC$User) {
                this.user = tLRPC$User;
            }

            @Override // android.text.style.ClickableSpan
            public void onClick(View view) {
                if (ChatMessageCell.this.delegate != null) {
                    ChatMessageCell.this.delegate.didPressUserAvatar(ChatMessageCell.this, this.user, 0.0f, 0.0f);
                }
            }
        }

        @Override // android.view.accessibility.AccessibilityNodeProvider
        public AccessibilityNodeInfo createAccessibilityNodeInfo(int i) {
            int i2;
            String str;
            String formatShortNumber;
            int i3;
            String str2;
            CharacterStyle[] characterStyleArr;
            CharacterStyle[] characterStyleArr2;
            String string;
            AccessibilityNodeInfo.CollectionItemInfo collectionItemInfo;
            CharSequence charSequence;
            CharSequence charSequence2;
            CharacterStyle[] characterStyleArr3;
            TLRPC$ReactionCount tLRPC$ReactionCount;
            boolean z;
            TLRPC$MessagePeerReaction tLRPC$MessagePeerReaction;
            int i4;
            String str3;
            String string2;
            int[] iArr = {0, 0};
            ChatMessageCell.this.getLocationOnScreen(iArr);
            int i5 = 10;
            if (i == -1) {
                AccessibilityNodeInfo obtain = AccessibilityNodeInfo.obtain(ChatMessageCell.this);
                ChatMessageCell.this.onInitializeAccessibilityNodeInfo(obtain);
                if (ChatMessageCell.this.accessibilityText == null) {
                    SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder();
                    ChatMessageCell chatMessageCell = ChatMessageCell.this;
                    if (chatMessageCell.isChat && chatMessageCell.currentUser != null && !ChatMessageCell.this.currentMessageObject.isOut()) {
                        spannableStringBuilder.append((CharSequence) UserObject.getUserName(ChatMessageCell.this.currentUser));
                        spannableStringBuilder.setSpan(new ProfileSpan(ChatMessageCell.this.currentUser), 0, spannableStringBuilder.length(), 33);
                        spannableStringBuilder.append('\n');
                    }
                    if (ChatMessageCell.this.drawForwardedName) {
                        int i6 = 0;
                        while (i6 < 2) {
                            if (ChatMessageCell.this.forwardedNameLayout[i6] != null) {
                                spannableStringBuilder.append(ChatMessageCell.this.forwardedNameLayout[i6].getText());
                                spannableStringBuilder.append(i6 == 0 ? " " : "\n");
                            }
                            i6++;
                        }
                    }
                    if (!TextUtils.isEmpty(ChatMessageCell.this.currentMessageObject.messageText)) {
                        spannableStringBuilder.append(ChatMessageCell.this.currentMessageObject.messageText);
                    }
                    if (ChatMessageCell.this.documentAttach == null || !((ChatMessageCell.this.documentAttachType == 1 || ChatMessageCell.this.documentAttachType == 2 || ChatMessageCell.this.documentAttachType == 4) && ChatMessageCell.this.buttonState == 1 && ChatMessageCell.this.loadingProgressLayout != null)) {
                        charSequence = "\n";
                    } else {
                        spannableStringBuilder.append((CharSequence) "\n");
                        boolean isSending = ChatMessageCell.this.currentMessageObject.isSending();
                        charSequence = "\n";
                        spannableStringBuilder.append((CharSequence) LocaleController.formatString(isSending ? "AccDescrUploadProgress" : "AccDescrDownloadProgress", isSending ? R.string.AccDescrUploadProgress : R.string.AccDescrDownloadProgress, AndroidUtilities.formatFileSize(ChatMessageCell.this.currentMessageObject.loadedFileSize), AndroidUtilities.formatFileSize(ChatMessageCell.this.lastLoadingSizeTotal)));
                    }
                    if (!ChatMessageCell.this.currentMessageObject.isMusic()) {
                        charSequence2 = charSequence;
                        if (ChatMessageCell.this.currentMessageObject.isVoice() || ChatMessageCell.this.isRoundVideo) {
                            spannableStringBuilder.append((CharSequence) ", ");
                            spannableStringBuilder.append((CharSequence) LocaleController.formatDuration(ChatMessageCell.this.currentMessageObject.getDuration()));
                            spannableStringBuilder.append((CharSequence) ", ");
                            if (ChatMessageCell.this.currentMessageObject.isContentUnread()) {
                                spannableStringBuilder.append((CharSequence) LocaleController.getString("AccDescrMsgNotPlayed", R.string.AccDescrMsgNotPlayed));
                            } else {
                                spannableStringBuilder.append((CharSequence) LocaleController.getString("AccDescrMsgPlayed", R.string.AccDescrMsgPlayed));
                            }
                        }
                    } else {
                        charSequence2 = charSequence;
                        spannableStringBuilder.append(charSequence2);
                        spannableStringBuilder.append((CharSequence) LocaleController.formatString("AccDescrMusicInfo", R.string.AccDescrMusicInfo, ChatMessageCell.this.currentMessageObject.getMusicAuthor(), ChatMessageCell.this.currentMessageObject.getMusicTitle()));
                        spannableStringBuilder.append((CharSequence) ", ");
                        spannableStringBuilder.append((CharSequence) LocaleController.formatDuration(ChatMessageCell.this.currentMessageObject.getDuration()));
                    }
                    if (ChatMessageCell.this.lastPoll != null) {
                        spannableStringBuilder.append((CharSequence) ", ");
                        spannableStringBuilder.append((CharSequence) ChatMessageCell.this.lastPoll.question);
                        spannableStringBuilder.append((CharSequence) ", ");
                        if (!ChatMessageCell.this.pollClosed) {
                            if (ChatMessageCell.this.lastPoll.quiz) {
                                if (ChatMessageCell.this.lastPoll.public_voters) {
                                    string2 = LocaleController.getString("QuizPoll", R.string.QuizPoll);
                                } else {
                                    string2 = LocaleController.getString("AnonymousQuizPoll", R.string.AnonymousQuizPoll);
                                }
                            } else if (ChatMessageCell.this.lastPoll.public_voters) {
                                string2 = LocaleController.getString("PublicPoll", R.string.PublicPoll);
                            } else {
                                string2 = LocaleController.getString("AnonymousPoll", R.string.AnonymousPoll);
                            }
                        } else {
                            string2 = LocaleController.getString("FinalResults", R.string.FinalResults);
                        }
                        spannableStringBuilder.append((CharSequence) string2);
                    }
                    if (!ChatMessageCell.this.currentMessageObject.isVoiceTranscriptionOpen()) {
                        if (MessageObject.getMedia(ChatMessageCell.this.currentMessageObject.messageOwner) != null && !TextUtils.isEmpty(ChatMessageCell.this.currentMessageObject.caption)) {
                            spannableStringBuilder.append(charSequence2);
                            spannableStringBuilder.append(ChatMessageCell.this.currentMessageObject.caption);
                        }
                    } else {
                        spannableStringBuilder.append(charSequence2);
                        spannableStringBuilder.append(ChatMessageCell.this.currentMessageObject.getVoiceTranscription());
                    }
                    if (ChatMessageCell.this.documentAttach != null) {
                        if (ChatMessageCell.this.documentAttachType == 4) {
                            spannableStringBuilder.append((CharSequence) ", ");
                            spannableStringBuilder.append((CharSequence) LocaleController.formatDuration(ChatMessageCell.this.currentMessageObject.getDuration()));
                        }
                        if (ChatMessageCell.this.buttonState == 0 || ChatMessageCell.this.documentAttachType == 1) {
                            spannableStringBuilder.append((CharSequence) ", ");
                            spannableStringBuilder.append((CharSequence) AndroidUtilities.formatFileSize(ChatMessageCell.this.documentAttach.size));
                        }
                    }
                    if (ChatMessageCell.this.currentMessageObject.isOut()) {
                        if (!ChatMessageCell.this.currentMessageObject.isSent()) {
                            if (!ChatMessageCell.this.currentMessageObject.isSending()) {
                                if (ChatMessageCell.this.currentMessageObject.isSendError()) {
                                    spannableStringBuilder.append(charSequence2);
                                    spannableStringBuilder.append((CharSequence) LocaleController.getString("AccDescrMsgSendingError", R.string.AccDescrMsgSendingError));
                                }
                            } else {
                                spannableStringBuilder.append(charSequence2);
                                spannableStringBuilder.append((CharSequence) LocaleController.getString("AccDescrMsgSending", R.string.AccDescrMsgSending));
                                float progress = ChatMessageCell.this.radialProgress.getProgress();
                                if (progress > 0.0f) {
                                    spannableStringBuilder.append((CharSequence) ", ").append((CharSequence) Integer.toString(Math.round(progress * 100.0f))).append((CharSequence) "%");
                                }
                            }
                        } else {
                            spannableStringBuilder.append(charSequence2);
                            if (ChatMessageCell.this.currentMessageObject.scheduled) {
                                spannableStringBuilder.append((CharSequence) LocaleController.formatString("AccDescrScheduledDate", R.string.AccDescrScheduledDate, ChatMessageCell.this.currentTimeString));
                            } else {
                                spannableStringBuilder.append((CharSequence) LocaleController.formatString("AccDescrSentDate", R.string.AccDescrSentDate, LocaleController.getString("TodayAt", R.string.TodayAt) + " " + ChatMessageCell.this.currentTimeString));
                                spannableStringBuilder.append((CharSequence) ", ");
                                if (ChatMessageCell.this.currentMessageObject.isUnread()) {
                                    i4 = R.string.AccDescrMsgUnread;
                                    str3 = "AccDescrMsgUnread";
                                } else {
                                    i4 = R.string.AccDescrMsgRead;
                                    str3 = "AccDescrMsgRead";
                                }
                                spannableStringBuilder.append((CharSequence) LocaleController.getString(str3, i4));
                            }
                        }
                    } else {
                        spannableStringBuilder.append(charSequence2);
                        spannableStringBuilder.append((CharSequence) LocaleController.formatString("AccDescrReceivedDate", R.string.AccDescrReceivedDate, LocaleController.getString("TodayAt", R.string.TodayAt) + " " + ChatMessageCell.this.currentTimeString));
                    }
                    if (ChatMessageCell.this.getRepliesCount() > 0 && !ChatMessageCell.this.hasCommentLayout()) {
                        spannableStringBuilder.append(charSequence2);
                        spannableStringBuilder.append((CharSequence) LocaleController.formatPluralString("AccDescrNumberOfReplies", ChatMessageCell.this.getRepliesCount(), new Object[0]));
                    }
                    if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions != null && ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results != null) {
                        String str4 = "";
                        if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.size() == 1) {
                            TLRPC$ReactionCount tLRPC$ReactionCount2 = ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.get(0);
                            TLRPC$Reaction tLRPC$Reaction = tLRPC$ReactionCount2.reaction;
                            String str5 = tLRPC$Reaction instanceof TLRPC$TL_reactionEmoji ? ((TLRPC$TL_reactionEmoji) tLRPC$Reaction).emoticon : str4;
                            int i7 = tLRPC$ReactionCount2.count;
                            if (i7 == 1) {
                                spannableStringBuilder.append(charSequence2);
                                if (ChatMessageCell.this.currentMessageObject.messageOwner.reactions.recent_reactions == null || ChatMessageCell.this.currentMessageObject.messageOwner.reactions.recent_reactions.size() != 1 || (tLRPC$MessagePeerReaction = ChatMessageCell.this.currentMessageObject.messageOwner.reactions.recent_reactions.get(0)) == null) {
                                    z = false;
                                } else {
                                    TLRPC$User user = MessagesController.getInstance(ChatMessageCell.this.currentAccount).getUser(Long.valueOf(MessageObject.getPeerId(tLRPC$MessagePeerReaction.peer_id)));
                                    z = UserObject.isUserSelf(user);
                                    if (user != null) {
                                        str4 = UserObject.getFirstName(user);
                                    }
                                }
                                if (z) {
                                    spannableStringBuilder.append((CharSequence) LocaleController.formatString("AccDescrYouReactedWith", R.string.AccDescrYouReactedWith, str5));
                                } else {
                                    spannableStringBuilder.append((CharSequence) LocaleController.formatString("AccDescrReactedWith", R.string.AccDescrReactedWith, str4, str5));
                                }
                            } else if (i7 > 1) {
                                spannableStringBuilder.append(charSequence2);
                                spannableStringBuilder.append((CharSequence) LocaleController.formatPluralString("AccDescrNumberOfPeopleReactions", tLRPC$ReactionCount2.count, str5));
                            }
                        } else {
                            spannableStringBuilder.append((CharSequence) LocaleController.getString("Reactions", R.string.Reactions)).append((CharSequence) ": ");
                            int size = ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.size();
                            for (int i8 = 0; i8 < size; i8++) {
                                TLRPC$Reaction tLRPC$Reaction2 = ChatMessageCell.this.currentMessageObject.messageOwner.reactions.results.get(i8).reaction;
                                spannableStringBuilder.append((CharSequence) (tLRPC$Reaction2 instanceof TLRPC$TL_reactionEmoji ? ((TLRPC$TL_reactionEmoji) tLRPC$Reaction2).emoticon : str4)).append((CharSequence) " ").append((CharSequence) (tLRPC$ReactionCount.count + str4));
                                if (i8 + 1 < size) {
                                    spannableStringBuilder.append((CharSequence) ", ");
                                }
                            }
                            spannableStringBuilder.append(charSequence2);
                        }
                    }
                    if ((ChatMessageCell.this.currentMessageObject.messageOwner.flags & 1024) != 0) {
                        spannableStringBuilder.append(charSequence2);
                        spannableStringBuilder.append((CharSequence) LocaleController.formatPluralString("AccDescrNumberOfViews", ChatMessageCell.this.currentMessageObject.messageOwner.views, new Object[0]));
                    }
                    spannableStringBuilder.append(charSequence2);
                    for (final CharacterStyle characterStyle : (CharacterStyle[]) spannableStringBuilder.getSpans(0, spannableStringBuilder.length(), ClickableSpan.class)) {
                        int spanStart = spannableStringBuilder.getSpanStart(characterStyle);
                        int spanEnd = spannableStringBuilder.getSpanEnd(characterStyle);
                        spannableStringBuilder.removeSpan(characterStyle);
                        spannableStringBuilder.setSpan(new ClickableSpan() { // from class: org.telegram.ui.Cells.ChatMessageCell.MessageAccessibilityNodeProvider.1
                            @Override // android.text.style.ClickableSpan
                            public void onClick(View view) {
                                CharacterStyle characterStyle2 = characterStyle;
                                if (!(characterStyle2 instanceof ProfileSpan)) {
                                    if (ChatMessageCell.this.delegate == null) {
                                        return;
                                    }
                                    ChatMessageCell.this.delegate.didPressUrl(ChatMessageCell.this, characterStyle, false);
                                    return;
                                }
                                ((ProfileSpan) characterStyle2).onClick(view);
                            }
                        }, spanStart, spanEnd, 33);
                    }
                    ChatMessageCell.this.accessibilityText = spannableStringBuilder;
                }
                int i9 = Build.VERSION.SDK_INT;
                if (i9 < 24) {
                    obtain.setContentDescription(ChatMessageCell.this.accessibilityText.toString());
                } else {
                    obtain.setText(ChatMessageCell.this.accessibilityText);
                }
                obtain.setEnabled(true);
                if (i9 >= 19 && (collectionItemInfo = obtain.getCollectionItemInfo()) != null) {
                    obtain.setCollectionItemInfo(AccessibilityNodeInfo.CollectionItemInfo.obtain(collectionItemInfo.getRowIndex(), 1, 0, 1, false));
                }
                if (i9 >= 21) {
                    obtain.addAction(new AccessibilityNodeInfo.AccessibilityAction(R.id.acc_action_msg_options, LocaleController.getString("AccActionMessageOptions", R.string.AccActionMessageOptions)));
                    int iconForCurrentState = ChatMessageCell.this.getIconForCurrentState();
                    if (iconForCurrentState == 0) {
                        string = LocaleController.getString("AccActionPlay", R.string.AccActionPlay);
                    } else if (iconForCurrentState == 1) {
                        string = LocaleController.getString("AccActionPause", R.string.AccActionPause);
                    } else if (iconForCurrentState == 2) {
                        string = LocaleController.getString("AccActionDownload", R.string.AccActionDownload);
                    } else if (iconForCurrentState == 3) {
                        string = LocaleController.getString("AccActionCancelDownload", R.string.AccActionCancelDownload);
                    } else if (iconForCurrentState == 5) {
                        string = LocaleController.getString("AccActionOpenFile", R.string.AccActionOpenFile);
                    } else {
                        string = ChatMessageCell.this.currentMessageObject.type == 16 ? LocaleController.getString("CallAgain", R.string.CallAgain) : null;
                    }
                    obtain.addAction(new AccessibilityNodeInfo.AccessibilityAction(16, string));
                    obtain.addAction(new AccessibilityNodeInfo.AccessibilityAction(32, LocaleController.getString("AccActionEnterSelectionMode", R.string.AccActionEnterSelectionMode)));
                    if (ChatMessageCell.this.getMiniIconForCurrentState() == 2) {
                        obtain.addAction(new AccessibilityNodeInfo.AccessibilityAction(R.id.acc_action_small_button, LocaleController.getString("AccActionDownload", R.string.AccActionDownload)));
                    }
                } else {
                    obtain.addAction(16);
                    obtain.addAction(32);
                }
                if ((ChatMessageCell.this.currentMessageObject.isVoice() || ChatMessageCell.this.currentMessageObject.isRoundVideo() || ChatMessageCell.this.currentMessageObject.isMusic()) && MediaController.getInstance().isPlayingMessage(ChatMessageCell.this.currentMessageObject)) {
                    ChatMessageCell.this.seekBarAccessibilityDelegate.onInitializeAccessibilityNodeInfoInternal(obtain);
                }
                if (ChatMessageCell.this.useTranscribeButton && ChatMessageCell.this.transcribeButton != null) {
                    obtain.addChild(ChatMessageCell.this, 493);
                }
                if (i9 < 24) {
                    ChatMessageCell chatMessageCell2 = ChatMessageCell.this;
                    if (chatMessageCell2.isChat && chatMessageCell2.currentUser != null && !ChatMessageCell.this.currentMessageObject.isOut()) {
                        obtain.addChild(ChatMessageCell.this, 5000);
                    }
                    if (ChatMessageCell.this.currentMessageObject.messageText instanceof Spannable) {
                        Spannable spannable = (Spannable) ChatMessageCell.this.currentMessageObject.messageText;
                        int i10 = 0;
                        for (CharacterStyle characterStyle2 : (CharacterStyle[]) spannable.getSpans(0, spannable.length(), ClickableSpan.class)) {
                            obtain.addChild(ChatMessageCell.this, i10 + 2000);
                            i10++;
                        }
                    }
                    if ((ChatMessageCell.this.currentMessageObject.caption instanceof Spannable) && ChatMessageCell.this.captionLayout != null) {
                        Spannable spannable2 = (Spannable) ChatMessageCell.this.currentMessageObject.caption;
                        int i11 = 0;
                        for (CharacterStyle characterStyle3 : (CharacterStyle[]) spannable2.getSpans(0, spannable2.length(), ClickableSpan.class)) {
                            obtain.addChild(ChatMessageCell.this, i11 + 3000);
                            i11++;
                        }
                    }
                }
                Iterator it = ChatMessageCell.this.botButtons.iterator();
                int i12 = 0;
                while (it.hasNext()) {
                    BotButton botButton = (BotButton) it.next();
                    obtain.addChild(ChatMessageCell.this, i12 + 1000);
                    i12++;
                }
                if (ChatMessageCell.this.hintButtonVisible && ChatMessageCell.this.pollHintX != -1 && ChatMessageCell.this.currentMessageObject.isPoll()) {
                    obtain.addChild(ChatMessageCell.this, 495);
                }
                Iterator it2 = ChatMessageCell.this.pollButtons.iterator();
                int i13 = 0;
                while (it2.hasNext()) {
                    PollButton pollButton = (PollButton) it2.next();
                    obtain.addChild(ChatMessageCell.this, i13 + 500);
                    i13++;
                }
                if (ChatMessageCell.this.drawInstantView && !ChatMessageCell.this.instantButtonRect.isEmpty()) {
                    obtain.addChild(ChatMessageCell.this, 499);
                }
                if (ChatMessageCell.this.commentLayout != null) {
                    obtain.addChild(ChatMessageCell.this, 496);
                }
                if (ChatMessageCell.this.drawSideButton == 1) {
                    obtain.addChild(ChatMessageCell.this, 498);
                }
                ChatMessageCell chatMessageCell3 = ChatMessageCell.this;
                if (chatMessageCell3.replyNameLayout != null) {
                    obtain.addChild(chatMessageCell3, 497);
                }
                if (ChatMessageCell.this.forwardedNameLayout[0] != null && ChatMessageCell.this.forwardedNameLayout[1] != null) {
                    if (Build.VERSION.SDK_INT >= 21) {
                        obtain.addAction(new AccessibilityNodeInfo.AccessibilityAction(R.id.acc_action_open_forwarded_origin, LocaleController.getString("AccActionOpenForwardedOrigin", R.string.AccActionOpenForwardedOrigin)));
                    } else {
                        obtain.addChild(ChatMessageCell.this, 494);
                    }
                }
                if (ChatMessageCell.this.drawSelectionBackground || ChatMessageCell.this.getBackground() != null) {
                    obtain.setSelected(true);
                }
                return obtain;
            }
            AccessibilityNodeInfo obtain2 = AccessibilityNodeInfo.obtain();
            obtain2.setSource(ChatMessageCell.this, i);
            obtain2.setParent(ChatMessageCell.this);
            obtain2.setPackageName(ChatMessageCell.this.getContext().getPackageName());
            if (i == 5000) {
                if (ChatMessageCell.this.currentUser == null) {
                    return null;
                }
                obtain2.setText(UserObject.getUserName(ChatMessageCell.this.currentUser));
                Rect rect = this.rect;
                int i14 = (int) ChatMessageCell.this.nameX;
                int i15 = (int) ChatMessageCell.this.nameY;
                int i16 = (int) (ChatMessageCell.this.nameX + ChatMessageCell.this.nameWidth);
                float f = ChatMessageCell.this.nameY;
                if (ChatMessageCell.this.nameLayout != null) {
                    i5 = ChatMessageCell.this.nameLayout.getHeight();
                }
                rect.set(i14, i15, i16, (int) (f + i5));
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClassName("android.widget.TextView");
                obtain2.setEnabled(true);
                obtain2.setClickable(true);
                obtain2.setLongClickable(true);
                obtain2.addAction(16);
                obtain2.addAction(32);
            } else if (i >= 3000) {
                if (!(ChatMessageCell.this.currentMessageObject.caption instanceof Spannable) || ChatMessageCell.this.captionLayout == null) {
                    return null;
                }
                Spannable spannable3 = (Spannable) ChatMessageCell.this.currentMessageObject.caption;
                ClickableSpan linkById = getLinkById(i, true);
                if (linkById == null) {
                    return null;
                }
                int[] realSpanStartAndEnd = ChatMessageCell.this.getRealSpanStartAndEnd(spannable3, linkById);
                obtain2.setText(spannable3.subSequence(realSpanStartAndEnd[0], realSpanStartAndEnd[1]).toString());
                ChatMessageCell.this.captionLayout.getText().length();
                ChatMessageCell.this.captionLayout.getSelectionPath(realSpanStartAndEnd[0], realSpanStartAndEnd[1], this.linkPath);
                this.linkPath.computeBounds(this.rectF, true);
                Rect rect2 = this.rect;
                RectF rectF = this.rectF;
                rect2.set((int) rectF.left, (int) rectF.top, (int) rectF.right, (int) rectF.bottom);
                this.rect.offset((int) ChatMessageCell.this.captionX, (int) ChatMessageCell.this.captionY);
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClassName("android.widget.TextView");
                obtain2.setEnabled(true);
                obtain2.setClickable(true);
                obtain2.setLongClickable(true);
                obtain2.addAction(16);
                obtain2.addAction(32);
            } else if (i >= 2000) {
                if (!(ChatMessageCell.this.currentMessageObject.messageText instanceof Spannable)) {
                    return null;
                }
                Spannable spannable4 = (Spannable) ChatMessageCell.this.currentMessageObject.messageText;
                ClickableSpan linkById2 = getLinkById(i, false);
                if (linkById2 == null) {
                    return null;
                }
                int[] realSpanStartAndEnd2 = ChatMessageCell.this.getRealSpanStartAndEnd(spannable4, linkById2);
                obtain2.setText(spannable4.subSequence(realSpanStartAndEnd2[0], realSpanStartAndEnd2[1]).toString());
                Iterator<MessageObject.TextLayoutBlock> it3 = ChatMessageCell.this.currentMessageObject.textLayoutBlocks.iterator();
                while (true) {
                    if (!it3.hasNext()) {
                        break;
                    }
                    MessageObject.TextLayoutBlock next = it3.next();
                    int length = next.textLayout.getText().length();
                    int i17 = next.charactersOffset;
                    if (i17 <= realSpanStartAndEnd2[0] && length + i17 >= realSpanStartAndEnd2[1]) {
                        next.textLayout.getSelectionPath(realSpanStartAndEnd2[0] - i17, realSpanStartAndEnd2[1] - i17, this.linkPath);
                        this.linkPath.computeBounds(this.rectF, true);
                        Rect rect3 = this.rect;
                        RectF rectF2 = this.rectF;
                        rect3.set((int) rectF2.left, (int) rectF2.top, (int) rectF2.right, (int) rectF2.bottom);
                        this.rect.offset(0, (int) next.textYOffset);
                        this.rect.offset(ChatMessageCell.this.textX, ChatMessageCell.this.textY);
                        obtain2.setBoundsInParent(this.rect);
                        if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                            ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                        }
                        this.rect.offset(iArr[0], iArr[1]);
                        obtain2.setBoundsInScreen(this.rect);
                    }
                }
                obtain2.setClassName("android.widget.TextView");
                obtain2.setEnabled(true);
                obtain2.setClickable(true);
                obtain2.setLongClickable(true);
                obtain2.addAction(16);
                obtain2.addAction(32);
            } else if (i >= 1000) {
                int i18 = i - 1000;
                if (i18 >= ChatMessageCell.this.botButtons.size()) {
                    return null;
                }
                BotButton botButton2 = (BotButton) ChatMessageCell.this.botButtons.get(i18);
                obtain2.setText(botButton2.title.getText());
                obtain2.setClassName("android.widget.Button");
                obtain2.setEnabled(true);
                obtain2.setClickable(true);
                obtain2.addAction(16);
                this.rect.set(botButton2.x, botButton2.y, botButton2.x + botButton2.width, botButton2.y + botButton2.height);
                this.rect.offset(ChatMessageCell.this.currentMessageObject.isOutOwner() ? (ChatMessageCell.this.getMeasuredWidth() - ChatMessageCell.this.widthForButtons) - AndroidUtilities.dp(10.0f) : ChatMessageCell.this.backgroundDrawableLeft + AndroidUtilities.dp(ChatMessageCell.this.mediaBackground ? 1.0f : 7.0f), ChatMessageCell.this.layoutHeight);
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
            } else if (i >= 500) {
                int i19 = i - 500;
                if (i19 >= ChatMessageCell.this.pollButtons.size()) {
                    return null;
                }
                PollButton pollButton2 = (PollButton) ChatMessageCell.this.pollButtons.get(i19);
                StringBuilder sb = new StringBuilder(pollButton2.title.getText());
                if (ChatMessageCell.this.pollVoted) {
                    obtain2.setSelected(pollButton2.chosen);
                    sb.append(", ");
                    sb.append(pollButton2.percent);
                    sb.append("%");
                    if (ChatMessageCell.this.lastPoll != null && ChatMessageCell.this.lastPoll.quiz && (pollButton2.chosen || pollButton2.correct)) {
                        sb.append(", ");
                        if (pollButton2.correct) {
                            i3 = R.string.AccDescrQuizCorrectAnswer;
                            str2 = "AccDescrQuizCorrectAnswer";
                        } else {
                            i3 = R.string.AccDescrQuizIncorrectAnswer;
                            str2 = "AccDescrQuizIncorrectAnswer";
                        }
                        sb.append(LocaleController.getString(str2, i3));
                    }
                } else {
                    obtain2.setClassName("android.widget.Button");
                }
                obtain2.setText(sb);
                obtain2.setEnabled(true);
                obtain2.addAction(16);
                int i20 = pollButton2.y + ChatMessageCell.this.namesOffset;
                int dp = ChatMessageCell.this.backgroundWidth - AndroidUtilities.dp(76.0f);
                Rect rect4 = this.rect;
                int i21 = pollButton2.x;
                rect4.set(i21, i20, dp + i21, pollButton2.height + i20);
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClickable(true);
            } else if (i == 495) {
                obtain2.setClassName("android.widget.Button");
                obtain2.setEnabled(true);
                obtain2.setText(LocaleController.getString("AccDescrQuizExplanation", R.string.AccDescrQuizExplanation));
                obtain2.addAction(16);
                this.rect.set(ChatMessageCell.this.pollHintX - AndroidUtilities.dp(8.0f), ChatMessageCell.this.pollHintY - AndroidUtilities.dp(8.0f), ChatMessageCell.this.pollHintX + AndroidUtilities.dp(32.0f), ChatMessageCell.this.pollHintY + AndroidUtilities.dp(32.0f));
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClickable(true);
            } else if (i == 499) {
                obtain2.setClassName("android.widget.Button");
                obtain2.setEnabled(true);
                if (ChatMessageCell.this.instantViewLayout != null) {
                    obtain2.setText(ChatMessageCell.this.instantViewLayout.getText());
                }
                obtain2.addAction(16);
                ChatMessageCell.this.instantButtonRect.round(this.rect);
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClickable(true);
            } else if (i == 498) {
                obtain2.setClassName("android.widget.ImageButton");
                obtain2.setEnabled(true);
                ChatMessageCell chatMessageCell4 = ChatMessageCell.this;
                if (chatMessageCell4.isOpenChatByShare(chatMessageCell4.currentMessageObject)) {
                    obtain2.setContentDescription(LocaleController.getString("AccDescrOpenChat", R.string.AccDescrOpenChat));
                } else {
                    obtain2.setContentDescription(LocaleController.getString("ShareFile", R.string.ShareFile));
                }
                obtain2.addAction(16);
                this.rect.set((int) ChatMessageCell.this.sideStartX, (int) ChatMessageCell.this.sideStartY, ((int) ChatMessageCell.this.sideStartX) + AndroidUtilities.dp(40.0f), ((int) ChatMessageCell.this.sideStartY) + AndroidUtilities.dp(32.0f));
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClickable(true);
            } else if (i == 497) {
                obtain2.setEnabled(true);
                StringBuilder sb2 = new StringBuilder();
                sb2.append(LocaleController.getString("Reply", R.string.Reply));
                sb2.append(", ");
                StaticLayout staticLayout = ChatMessageCell.this.replyNameLayout;
                if (staticLayout != null) {
                    sb2.append(staticLayout.getText());
                    sb2.append(", ");
                }
                StaticLayout staticLayout2 = ChatMessageCell.this.replyTextLayout;
                if (staticLayout2 != null) {
                    sb2.append(staticLayout2.getText());
                }
                obtain2.setContentDescription(sb2.toString());
                obtain2.addAction(16);
                Rect rect5 = this.rect;
                ChatMessageCell chatMessageCell5 = ChatMessageCell.this;
                int i22 = chatMessageCell5.replyStartX;
                rect5.set(i22, chatMessageCell5.replyStartY, Math.max(chatMessageCell5.replyNameWidth, ChatMessageCell.this.replyTextWidth) + i22, ChatMessageCell.this.replyStartY + AndroidUtilities.dp(35.0f));
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClickable(true);
            } else if (i == 494) {
                obtain2.setEnabled(true);
                StringBuilder sb3 = new StringBuilder();
                if (ChatMessageCell.this.forwardedNameLayout[0] != null && ChatMessageCell.this.forwardedNameLayout[1] != null) {
                    int i23 = 0;
                    while (i23 < 2) {
                        sb3.append(ChatMessageCell.this.forwardedNameLayout[i23].getText());
                        sb3.append(i23 == 0 ? " " : "\n");
                        i23++;
                    }
                }
                obtain2.setContentDescription(sb3.toString());
                obtain2.addAction(16);
                int min = (int) Math.min(ChatMessageCell.this.forwardNameX - ChatMessageCell.this.forwardNameOffsetX[0], ChatMessageCell.this.forwardNameX - ChatMessageCell.this.forwardNameOffsetX[1]);
                this.rect.set(min, ChatMessageCell.this.forwardNameY, ChatMessageCell.this.forwardedNameWidth + min, ChatMessageCell.this.forwardNameY + AndroidUtilities.dp(32.0f));
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClickable(true);
            } else if (i == 496) {
                obtain2.setClassName("android.widget.Button");
                obtain2.setEnabled(true);
                int repliesCount = ChatMessageCell.this.getRepliesCount();
                if (ChatMessageCell.this.currentMessageObject != null && !ChatMessageCell.this.currentMessageObject.shouldDrawWithoutBackground() && !ChatMessageCell.this.currentMessageObject.isAnimatedEmoji()) {
                    if (ChatMessageCell.this.isRepliesChat) {
                        formatShortNumber = LocaleController.getString("ViewInChat", R.string.ViewInChat);
                    } else {
                        formatShortNumber = repliesCount == 0 ? LocaleController.getString("LeaveAComment", R.string.LeaveAComment) : LocaleController.formatPluralString("CommentsCount", repliesCount, new Object[0]);
                    }
                } else {
                    formatShortNumber = (ChatMessageCell.this.isRepliesChat || repliesCount <= 0) ? null : LocaleController.formatShortNumber(repliesCount, null);
                }
                if (formatShortNumber != null) {
                    obtain2.setText(formatShortNumber);
                }
                obtain2.addAction(16);
                this.rect.set(ChatMessageCell.this.commentButtonRect);
                obtain2.setBoundsInParent(this.rect);
                if (ChatMessageCell.this.accessibilityVirtualViewBounds.get(i) == null || !((Rect) ChatMessageCell.this.accessibilityVirtualViewBounds.get(i)).equals(this.rect)) {
                    ChatMessageCell.this.accessibilityVirtualViewBounds.put(i, new Rect(this.rect));
                }
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClickable(true);
            } else if (i == 493) {
                obtain2.setClassName("android.widget.Button");
                obtain2.setEnabled(true);
                if (ChatMessageCell.this.currentMessageObject.isVoiceTranscriptionOpen()) {
                    i2 = R.string.AccActionCloseTranscription;
                    str = "AccActionCloseTranscription";
                } else {
                    i2 = R.string.AccActionOpenTranscription;
                    str = "AccActionOpenTranscription";
                }
                obtain2.setText(LocaleController.getString(str, i2));
                obtain2.addAction(16);
                this.rect.set((int) ChatMessageCell.this.transcribeX, (int) ChatMessageCell.this.transcribeY, (int) (ChatMessageCell.this.transcribeX + AndroidUtilities.dp(30.0f)), (int) (ChatMessageCell.this.transcribeY + AndroidUtilities.dp(30.0f)));
                obtain2.setBoundsInParent(this.rect);
                this.rect.offset(iArr[0], iArr[1]);
                obtain2.setBoundsInScreen(this.rect);
                obtain2.setClickable(true);
            }
            obtain2.setFocusable(true);
            obtain2.setVisibleToUser(true);
            return obtain2;
        }

        @Override // android.view.accessibility.AccessibilityNodeProvider
        public boolean performAction(int i, int i2, Bundle bundle) {
            if (i == -1) {
                ChatMessageCell.this.performAccessibilityAction(i2, bundle);
            } else if (i2 == 64) {
                ChatMessageCell.this.sendAccessibilityEventForVirtualView(i, 32768);
            } else {
                boolean z = false;
                if (i2 == 16) {
                    if (i == 5000) {
                        if (ChatMessageCell.this.delegate != null) {
                            ChatMessageCellDelegate chatMessageCellDelegate = ChatMessageCell.this.delegate;
                            ChatMessageCell chatMessageCell = ChatMessageCell.this;
                            chatMessageCellDelegate.didPressUserAvatar(chatMessageCell, chatMessageCell.currentUser, 0.0f, 0.0f);
                        }
                    } else if (i >= 3000) {
                        ClickableSpan linkById = getLinkById(i, true);
                        if (linkById != null) {
                            ChatMessageCell.this.delegate.didPressUrl(ChatMessageCell.this, linkById, false);
                            ChatMessageCell.this.sendAccessibilityEventForVirtualView(i, 1);
                        }
                    } else if (i >= 2000) {
                        ClickableSpan linkById2 = getLinkById(i, false);
                        if (linkById2 != null) {
                            ChatMessageCell.this.delegate.didPressUrl(ChatMessageCell.this, linkById2, false);
                            ChatMessageCell.this.sendAccessibilityEventForVirtualView(i, 1);
                        }
                    } else if (i >= 1000) {
                        int i3 = i - 1000;
                        if (i3 >= ChatMessageCell.this.botButtons.size()) {
                            return false;
                        }
                        BotButton botButton = (BotButton) ChatMessageCell.this.botButtons.get(i3);
                        if (ChatMessageCell.this.delegate != null && botButton.button != null) {
                            ChatMessageCell.this.delegate.didPressBotButton(ChatMessageCell.this, botButton.button);
                        }
                        ChatMessageCell.this.sendAccessibilityEventForVirtualView(i, 1);
                    } else if (i >= 500) {
                        int i4 = i - 500;
                        if (i4 >= ChatMessageCell.this.pollButtons.size()) {
                            return false;
                        }
                        PollButton pollButton = (PollButton) ChatMessageCell.this.pollButtons.get(i4);
                        if (ChatMessageCell.this.delegate != null) {
                            ArrayList<TLRPC$TL_pollAnswer> arrayList = new ArrayList<>();
                            arrayList.add(pollButton.answer);
                            ChatMessageCell.this.delegate.didPressVoteButtons(ChatMessageCell.this, arrayList, -1, 0, 0);
                        }
                        ChatMessageCell.this.sendAccessibilityEventForVirtualView(i, 1);
                    } else if (i == 495) {
                        if (ChatMessageCell.this.delegate != null) {
                            ChatMessageCell.this.delegate.didPressHint(ChatMessageCell.this, 0);
                        }
                    } else if (i == 499) {
                        if (ChatMessageCell.this.delegate != null) {
                            ChatMessageCellDelegate chatMessageCellDelegate2 = ChatMessageCell.this.delegate;
                            ChatMessageCell chatMessageCell2 = ChatMessageCell.this;
                            chatMessageCellDelegate2.didPressInstantButton(chatMessageCell2, chatMessageCell2.drawInstantViewType);
                        }
                    } else if (i == 498) {
                        if (ChatMessageCell.this.delegate != null) {
                            ChatMessageCell.this.delegate.didPressSideButton(ChatMessageCell.this);
                        }
                    } else if (i == 497) {
                        if (ChatMessageCell.this.delegate != null) {
                            ChatMessageCell chatMessageCell3 = ChatMessageCell.this;
                            if ((!chatMessageCell3.isThreadChat || chatMessageCell3.currentMessageObject.getReplyTopMsgId() != 0) && ChatMessageCell.this.currentMessageObject.hasValidReplyMessageObject()) {
                                ChatMessageCellDelegate chatMessageCellDelegate3 = ChatMessageCell.this.delegate;
                                ChatMessageCell chatMessageCell4 = ChatMessageCell.this;
                                chatMessageCellDelegate3.didPressReplyMessage(chatMessageCell4, chatMessageCell4.currentMessageObject.getReplyMsgId());
                            }
                        }
                    } else if (i == 494) {
                        if (ChatMessageCell.this.delegate != null) {
                            if (ChatMessageCell.this.currentForwardChannel != null) {
                                ChatMessageCellDelegate chatMessageCellDelegate4 = ChatMessageCell.this.delegate;
                                ChatMessageCell chatMessageCell5 = ChatMessageCell.this;
                                chatMessageCellDelegate4.didPressChannelAvatar(chatMessageCell5, chatMessageCell5.currentForwardChannel, ChatMessageCell.this.currentMessageObject.messageOwner.fwd_from.channel_post, ChatMessageCell.this.lastTouchX, ChatMessageCell.this.lastTouchY);
                            } else if (ChatMessageCell.this.currentForwardUser != null) {
                                ChatMessageCellDelegate chatMessageCellDelegate5 = ChatMessageCell.this.delegate;
                                ChatMessageCell chatMessageCell6 = ChatMessageCell.this;
                                chatMessageCellDelegate5.didPressUserAvatar(chatMessageCell6, chatMessageCell6.currentForwardUser, ChatMessageCell.this.lastTouchX, ChatMessageCell.this.lastTouchY);
                            } else if (ChatMessageCell.this.currentForwardName != null) {
                                ChatMessageCell.this.delegate.didPressHiddenForward(ChatMessageCell.this);
                            }
                        }
                    } else if (i == 496) {
                        if (ChatMessageCell.this.delegate != null) {
                            ChatMessageCell chatMessageCell7 = ChatMessageCell.this;
                            if (chatMessageCell7.isRepliesChat) {
                                chatMessageCell7.delegate.didPressSideButton(ChatMessageCell.this);
                            } else {
                                chatMessageCell7.delegate.didPressCommentButton(ChatMessageCell.this);
                            }
                        }
                    } else if (i == 493 && ChatMessageCell.this.transcribeButton != null) {
                        ChatMessageCell.this.transcribeButton.onTap();
                    }
                } else if (i2 == 32) {
                    if (i >= 3000) {
                        z = true;
                    }
                    ClickableSpan linkById3 = getLinkById(i, z);
                    if (linkById3 != null) {
                        ChatMessageCell.this.delegate.didPressUrl(ChatMessageCell.this, linkById3, true);
                        ChatMessageCell.this.sendAccessibilityEventForVirtualView(i, 2);
                    }
                }
            }
            return true;
        }

        private ClickableSpan getLinkById(int i, boolean z) {
            if (i == 5000) {
                return null;
            }
            if (z) {
                int i2 = i - 3000;
                if (!(ChatMessageCell.this.currentMessageObject.caption instanceof Spannable) || i2 < 0) {
                    return null;
                }
                Spannable spannable = (Spannable) ChatMessageCell.this.currentMessageObject.caption;
                ClickableSpan[] clickableSpanArr = (ClickableSpan[]) spannable.getSpans(0, spannable.length(), ClickableSpan.class);
                if (clickableSpanArr.length > i2) {
                    return clickableSpanArr[i2];
                }
                return null;
            }
            int i3 = i - 2000;
            if (!(ChatMessageCell.this.currentMessageObject.messageText instanceof Spannable) || i3 < 0) {
                return null;
            }
            Spannable spannable2 = (Spannable) ChatMessageCell.this.currentMessageObject.messageText;
            ClickableSpan[] clickableSpanArr2 = (ClickableSpan[]) spannable2.getSpans(0, spannable2.length(), ClickableSpan.class);
            if (clickableSpanArr2.length > i3) {
                return clickableSpanArr2[i3];
            }
            return null;
        }
    }

    public void setImageCoords(float f, float f2, float f3, float f4) {
        this.photoImage.setImageCoords(f, f2, f3, f4);
        int i = this.documentAttachType;
        if (i == 4 || i == 2) {
            this.videoButtonX = (int) (this.photoImage.getImageX() + AndroidUtilities.dp(8.0f));
            int imageY = (int) (this.photoImage.getImageY() + AndroidUtilities.dp(8.0f));
            this.videoButtonY = imageY;
            RadialProgress2 radialProgress2 = this.videoRadialProgress;
            int i2 = this.videoButtonX;
            radialProgress2.setProgressRect(i2, imageY, AndroidUtilities.dp(24.0f) + i2, this.videoButtonY + AndroidUtilities.dp(24.0f));
            this.buttonX = (int) (f + ((this.photoImage.getImageWidth() - AndroidUtilities.dp(48.0f)) / 2.0f));
            int imageY2 = (int) (this.photoImage.getImageY() + ((this.photoImage.getImageHeight() - AndroidUtilities.dp(48.0f)) / 2.0f));
            this.buttonY = imageY2;
            RadialProgress2 radialProgress22 = this.radialProgress;
            int i3 = this.buttonX;
            radialProgress22.setProgressRect(i3, imageY2, AndroidUtilities.dp(48.0f) + i3, this.buttonY + AndroidUtilities.dp(48.0f));
        }
    }

    @Override // android.view.View
    public float getAlpha() {
        if (this.ALPHA_PROPERTY_WORKAROUND) {
            return this.alphaInternal;
        }
        return super.getAlpha();
    }

    @Override // android.view.View
    public void setAlpha(float f) {
        boolean z = true;
        boolean z2 = f == 1.0f;
        if (getAlpha() != 1.0f) {
            z = false;
        }
        if (z2 != z) {
            invalidate();
        }
        if (this.ALPHA_PROPERTY_WORKAROUND) {
            this.alphaInternal = f;
            invalidate();
            return;
        }
        super.setAlpha(f);
    }

    public int getCurrentBackgroundLeft() {
        int i = this.currentBackgroundDrawable.getBounds().left;
        return (this.currentMessageObject.isOutOwner() || this.transitionParams.changePinnedBottomProgress == 1.0f || this.mediaBackground || this.drawPinnedBottom) ? i : i - AndroidUtilities.dp(6.0f);
    }

    public TransitionParams getTransitionParams() {
        return this.transitionParams;
    }

    public int getTopMediaOffset() {
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null || messageObject.type != 14) {
            return 0;
        }
        return this.mediaOffsetY + this.namesOffset;
    }

    public int getTextX() {
        return this.textX;
    }

    public int getTextY() {
        return this.textY;
    }

    public boolean isPlayingRound() {
        return this.isRoundVideo && this.isPlayingRound;
    }

    public int getParentWidth() {
        int i;
        MessageObject messageObject = this.currentMessageObject;
        if (messageObject == null) {
            messageObject = this.messageObjectToSet;
        }
        return (messageObject == null || !messageObject.preview || (i = this.parentWidth) <= 0) ? AndroidUtilities.displaySize.x : i;
    }

    /* loaded from: classes3.dex */
    public class TransitionParams {
        public boolean animateBackgroundBoundsInner;
        boolean animateBotButtonsChanged;
        private boolean animateButton;
        public boolean animateChange;
        private int animateCommentArrowX;
        private boolean animateCommentDrawUnread;
        private int animateCommentUnreadX;
        private float animateCommentX;
        private boolean animateComments;
        private StaticLayout animateCommentsLayout;
        private boolean animateDrawCommentNumber;
        public boolean animateDrawingTimeAlpha;
        private boolean animateEditedEnter;
        private StaticLayout animateEditedLayout;
        private int animateEditedWidthDiff;
        int animateForwardNameWidth;
        float animateForwardNameX;
        public boolean animateForwardedLayout;
        public int animateForwardedNamesOffset;
        private float animateFromButtonX;
        private float animateFromButtonY;
        public float animateFromReplyY;
        public float animateFromRoundVideoDotY;
        public float animateFromTextY;
        public int animateFromTimeX;
        public float animateFromTimeXPinned;
        private float animateFromTimeXReplies;
        private float animateFromTimeXViews;
        public boolean animateLocationIsExpired;
        boolean animateMessageText;
        private float animateNameX;
        private AnimatedEmojiSpan.EmojiGroupedSpans animateOutAnimateEmoji;
        private StaticLayout animateOutCaptionLayout;
        private ArrayList<MessageObject.TextLayoutBlock> animateOutTextBlocks;
        private boolean animatePinned;
        public boolean animatePlayingRound;
        public boolean animateRadius;
        boolean animateReplaceCaptionLayout;
        private boolean animateReplies;
        private StaticLayout animateRepliesLayout;
        public boolean animateRoundVideoDotY;
        private boolean animateShouldDrawMenuDrawable;
        private boolean animateShouldDrawTimeOnMedia;
        private boolean animateSign;
        public boolean animateText;
        private StaticLayout animateTimeLayout;
        private int animateTimeWidth;
        public float animateToImageH;
        public float animateToImageW;
        public float animateToImageX;
        public float animateToImageY;
        public int[] animateToRadius;
        private int animateTotalCommentWidth;
        private StaticLayout animateViewsLayout;
        public float captionFromX;
        public float captionFromY;
        public float deltaBottom;
        public float deltaLeft;
        public float deltaRight;
        public float deltaTop;
        public boolean drawPinnedBottomBackground;
        public boolean ignoreAlpha;
        public boolean imageChangeBoundsTransition;
        public int lastBackgroundLeft;
        public int lastBackgroundRight;
        private float lastButtonX;
        private float lastButtonY;
        private int lastCommentArrowX;
        private boolean lastCommentDrawUnread;
        private StaticLayout lastCommentLayout;
        private int lastCommentUnreadX;
        private float lastCommentX;
        private int lastCommentsCount;
        private boolean lastDrawCommentNumber;
        public StaticLayout lastDrawDocTitleLayout;
        public StaticLayout lastDrawInfoLayout;
        public float lastDrawLocationExpireProgress;
        public String lastDrawLocationExpireText;
        public float lastDrawReplyY;
        public float lastDrawRoundVideoDotY;
        public boolean lastDrawTime;
        private StaticLayout lastDrawingCaptionLayout;
        public float lastDrawingCaptionX;
        public float lastDrawingCaptionY;
        private boolean lastDrawingEdited;
        public float lastDrawingImageH;
        public float lastDrawingImageW;
        public float lastDrawingImageX;
        public float lastDrawingImageY;
        private ArrayList<MessageObject.TextLayoutBlock> lastDrawingTextBlocks;
        public float lastDrawingTextY;
        public boolean lastDrawnForwardedName;
        int lastForwardNameWidth;
        float lastForwardNameX;
        public int lastForwardedNamesOffset;
        private boolean lastIsPinned;
        private boolean lastIsPlayingRound;
        public boolean lastLocatinIsExpired;
        private int lastRepliesCount;
        private StaticLayout lastRepliesLayout;
        private boolean lastShouldDrawMenuDrawable;
        private boolean lastShouldDrawTimeOnMedia;
        private String lastSignMessage;
        private StaticLayout lastTimeLayout;
        private int lastTimeWidth;
        public int lastTimeX;
        public float lastTimeXPinned;
        private float lastTimeXReplies;
        private float lastTimeXViews;
        public int lastTopOffset;
        private int lastTotalCommentWidth;
        private int lastViewsCount;
        private StaticLayout lastViewsLayout;
        public boolean messageEntering;
        private boolean moveCaption;
        public boolean shouldAnimateTimeX;
        public float toDeltaLeft;
        public float toDeltaRight;
        public boolean transformGroupToSingleMessage;
        public boolean updatePhotoImageX;
        public boolean wasDraw;
        public int[] imageRoundRadius = new int[4];
        public float captionEnterProgress = 1.0f;
        public float changePinnedBottomProgress = 1.0f;
        public Rect lastDrawingBackgroundRect = new Rect();
        public float animateChangeProgress = 1.0f;
        private ArrayList<BotButton> lastDrawBotButtons = new ArrayList<>();
        private ArrayList<BotButton> transitionBotButtons = new ArrayList<>();
        public int lastStatusDrawableParams = -1;
        public StaticLayout[] lastDrawnForwardedNameLayout = new StaticLayout[2];
        public StaticLayout[] animatingForwardedNameLayout = new StaticLayout[2];

        public boolean supportChangeAnimation() {
            return true;
        }

        public TransitionParams() {
        }

        public void recordDrawingState() {
            this.wasDraw = true;
            this.lastDrawingImageX = ChatMessageCell.this.photoImage.getImageX();
            this.lastDrawingImageY = ChatMessageCell.this.photoImage.getImageY();
            this.lastDrawingImageW = ChatMessageCell.this.photoImage.getImageWidth();
            this.lastDrawingImageH = ChatMessageCell.this.photoImage.getImageHeight();
            System.arraycopy(ChatMessageCell.this.photoImage.getRoundRadius(), 0, this.imageRoundRadius, 0, 4);
            if (ChatMessageCell.this.currentBackgroundDrawable != null) {
                this.lastDrawingBackgroundRect.set(ChatMessageCell.this.currentBackgroundDrawable.getBounds());
            }
            this.lastDrawingTextBlocks = ChatMessageCell.this.currentMessageObject.textLayoutBlocks;
            this.lastDrawingEdited = ChatMessageCell.this.edited;
            this.lastDrawingCaptionX = ChatMessageCell.this.captionX;
            this.lastDrawingCaptionY = ChatMessageCell.this.captionY;
            this.lastDrawingCaptionLayout = ChatMessageCell.this.captionLayout;
            this.lastDrawBotButtons.clear();
            if (!ChatMessageCell.this.botButtons.isEmpty()) {
                this.lastDrawBotButtons.addAll(ChatMessageCell.this.botButtons);
            }
            if (ChatMessageCell.this.commentLayout != null) {
                this.lastCommentsCount = ChatMessageCell.this.getRepliesCount();
                this.lastTotalCommentWidth = ChatMessageCell.this.totalCommentWidth;
                this.lastCommentLayout = ChatMessageCell.this.commentLayout;
                this.lastCommentArrowX = ChatMessageCell.this.commentArrowX;
                this.lastCommentUnreadX = ChatMessageCell.this.commentUnreadX;
                this.lastCommentDrawUnread = ChatMessageCell.this.commentDrawUnread;
                this.lastCommentX = ChatMessageCell.this.commentX;
                this.lastDrawCommentNumber = ChatMessageCell.this.drawCommentNumber;
            }
            this.lastRepliesCount = ChatMessageCell.this.getRepliesCount();
            this.lastViewsCount = ChatMessageCell.this.getMessageObject().messageOwner.views;
            this.lastRepliesLayout = ChatMessageCell.this.repliesLayout;
            this.lastViewsLayout = ChatMessageCell.this.viewsLayout;
            ChatMessageCell chatMessageCell = ChatMessageCell.this;
            this.lastIsPinned = chatMessageCell.isPinned;
            this.lastSignMessage = chatMessageCell.lastPostAuthor;
            this.lastButtonX = ChatMessageCell.this.buttonX;
            this.lastButtonY = ChatMessageCell.this.buttonY;
            this.lastDrawTime = !ChatMessageCell.this.forceNotDrawTime;
            this.lastTimeX = ChatMessageCell.this.timeX;
            this.lastTimeLayout = ChatMessageCell.this.timeLayout;
            this.lastTimeWidth = ChatMessageCell.this.timeWidth;
            this.lastShouldDrawTimeOnMedia = ChatMessageCell.this.shouldDrawTimeOnMedia();
            this.lastTopOffset = ChatMessageCell.this.getTopMediaOffset();
            this.lastShouldDrawMenuDrawable = ChatMessageCell.this.shouldDrawMenuDrawable();
            this.lastLocatinIsExpired = ChatMessageCell.this.locationExpired;
            this.lastIsPlayingRound = ChatMessageCell.this.isPlayingRound;
            this.lastDrawingTextY = ChatMessageCell.this.textY;
            int unused = ChatMessageCell.this.textX;
            this.lastDrawnForwardedNameLayout[0] = ChatMessageCell.this.forwardedNameLayout[0];
            this.lastDrawnForwardedNameLayout[1] = ChatMessageCell.this.forwardedNameLayout[1];
            this.lastDrawnForwardedName = ChatMessageCell.this.currentMessageObject.needDrawForwarded();
            this.lastForwardNameX = ChatMessageCell.this.forwardNameX;
            this.lastForwardedNamesOffset = ChatMessageCell.this.namesOffset;
            this.lastForwardNameWidth = ChatMessageCell.this.forwardedNameWidth;
            this.lastBackgroundLeft = ChatMessageCell.this.getCurrentBackgroundLeft();
            this.lastBackgroundRight = ChatMessageCell.this.currentBackgroundDrawable.getBounds().right;
            ChatMessageCell.this.reactionsLayoutInBubble.recordDrawingState();
            ChatMessageCell chatMessageCell2 = ChatMessageCell.this;
            if (chatMessageCell2.replyNameLayout != null) {
                this.lastDrawReplyY = chatMessageCell2.replyStartY;
            } else {
                this.lastDrawReplyY = 0.0f;
            }
        }

        public void recordDrawingStatePreview() {
            this.lastDrawnForwardedNameLayout[0] = ChatMessageCell.this.forwardedNameLayout[0];
            this.lastDrawnForwardedNameLayout[1] = ChatMessageCell.this.forwardedNameLayout[1];
            this.lastDrawnForwardedName = ChatMessageCell.this.currentMessageObject.needDrawForwarded();
            this.lastForwardNameX = ChatMessageCell.this.forwardNameX;
            this.lastForwardedNamesOffset = ChatMessageCell.this.namesOffset;
            this.lastForwardNameWidth = ChatMessageCell.this.forwardedNameWidth;
        }

        /* JADX WARN: Removed duplicated region for block: B:108:0x03e3  */
        /* JADX WARN: Removed duplicated region for block: B:111:0x03f8  */
        /* JADX WARN: Removed duplicated region for block: B:115:0x044a  */
        /* JADX WARN: Removed duplicated region for block: B:118:0x0456  */
        /* JADX WARN: Removed duplicated region for block: B:121:0x0462  */
        /* JADX WARN: Removed duplicated region for block: B:124:0x0472  */
        /* JADX WARN: Removed duplicated region for block: B:127:0x0481  */
        /* JADX WARN: Removed duplicated region for block: B:132:0x04b9  */
        /* JADX WARN: Removed duplicated region for block: B:135:0x04c6  */
        /* JADX WARN: Removed duplicated region for block: B:146:0x04f9  */
        /* JADX WARN: Removed duplicated region for block: B:154:0x03fe  */
        /* JADX WARN: Removed duplicated region for block: B:164:0x0354  */
        /* JADX WARN: Removed duplicated region for block: B:172:0x02c5  */
        /* JADX WARN: Removed duplicated region for block: B:175:0x02cb  */
        /* JADX WARN: Removed duplicated region for block: B:189:0x030a  */
        /* JADX WARN: Removed duplicated region for block: B:197:0x026b  */
        /* JADX WARN: Removed duplicated region for block: B:213:0x00ea  */
        /* JADX WARN: Removed duplicated region for block: B:42:0x00c8  */
        /* JADX WARN: Removed duplicated region for block: B:58:0x01e5  */
        /* JADX WARN: Removed duplicated region for block: B:77:0x02a7  */
        /* JADX WARN: Removed duplicated region for block: B:81:0x031a  */
        /* JADX WARN: Removed duplicated region for block: B:85:0x034f  */
        /* JADX WARN: Removed duplicated region for block: B:88:0x0359  */
        /* JADX WARN: Removed duplicated region for block: B:92:0x0375  */
        /* JADX WARN: Removed duplicated region for block: B:97:0x0391  */
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public boolean animateChange() {
            boolean z;
            StaticLayout staticLayout;
            StaticLayout staticLayout2;
            boolean z2;
            ChatMessageCell chatMessageCell;
            boolean z3;
            ChatMessageCell chatMessageCell2;
            ReactionsLayoutInBubble reactionsLayoutInBubble;
            StaticLayout staticLayout3;
            boolean z4;
            int i = 0;
            if (!this.wasDraw) {
                return false;
            }
            this.animateMessageText = false;
            if (ChatMessageCell.this.currentMessageObject.textLayoutBlocks != this.lastDrawingTextBlocks) {
                if (ChatMessageCell.this.currentMessageObject.textLayoutBlocks != null && this.lastDrawingTextBlocks != null && ChatMessageCell.this.currentMessageObject.textLayoutBlocks.size() == this.lastDrawingTextBlocks.size()) {
                    for (int i2 = 0; i2 < this.lastDrawingTextBlocks.size(); i2++) {
                        String charSequence = ChatMessageCell.this.currentMessageObject.textLayoutBlocks.get(i2).textLayout == null ? null : ChatMessageCell.this.currentMessageObject.textLayoutBlocks.get(i2).textLayout.getText().toString();
                        String charSequence2 = this.lastDrawingTextBlocks.get(i2).textLayout == null ? null : this.lastDrawingTextBlocks.get(i2).textLayout.getText().toString();
                        if ((charSequence != null || charSequence2 == null) && ((charSequence == null || charSequence2 != null) && charSequence.equals(charSequence2))) {
                            ChatMessageCell chatMessageCell3 = ChatMessageCell.this;
                            AnimatedEmojiSpan.EmojiGroupedSpans emojiGroupedSpans = chatMessageCell3.animatedEmojiStack;
                            if (emojiGroupedSpans != null) {
                                emojiGroupedSpans.replaceLayout(chatMessageCell3.currentMessageObject.textLayoutBlocks.get(i2).textLayout, this.lastDrawingTextBlocks.get(i2).textLayout);
                            }
                        }
                    }
                    z4 = true;
                    if (z4) {
                        this.animateMessageText = true;
                        ArrayList<MessageObject.TextLayoutBlock> arrayList = this.lastDrawingTextBlocks;
                        this.animateOutTextBlocks = arrayList;
                        this.animateOutAnimateEmoji = AnimatedEmojiSpan.update(0, (View) ChatMessageCell.this, this.animateOutAnimateEmoji, arrayList, true);
                        ChatMessageCell chatMessageCell4 = ChatMessageCell.this;
                        chatMessageCell4.animatedEmojiStack = AnimatedEmojiSpan.update(0, chatMessageCell4, chatMessageCell4.animatedEmojiStack, chatMessageCell4.currentMessageObject.textLayoutBlocks);
                        z = true;
                        if (ChatMessageCell.this.edited || this.lastDrawingEdited || ChatMessageCell.this.timeLayout == null) {
                            if (!ChatMessageCell.this.edited && this.lastDrawingEdited && ChatMessageCell.this.timeLayout != null) {
                                this.animateTimeLayout = this.lastTimeLayout;
                                int i3 = ChatMessageCell.this.timeWidth;
                                int i4 = this.lastTimeWidth;
                                this.animateEditedWidthDiff = i3 - i4;
                                this.animateEditedEnter = true;
                                this.animateTimeWidth = i4;
                                this.animateFromTimeX = this.lastTimeX;
                                this.shouldAnimateTimeX = true;
                                z = true;
                            }
                            staticLayout = ChatMessageCell.this.captionLayout;
                            staticLayout2 = this.lastDrawingCaptionLayout;
                            if (staticLayout == staticLayout2) {
                                if (ChatMessageCell.this.captionLayout != null && this.lastDrawingCaptionLayout != null) {
                                    ChatMessageCell.this.updateCaptionLayout();
                                    if (this.lastDrawingCaptionX != ChatMessageCell.this.captionX || this.lastDrawingCaptionY != ChatMessageCell.this.captionY) {
                                        this.moveCaption = true;
                                        this.captionFromX = this.lastDrawingCaptionX;
                                        this.captionFromY = this.lastDrawingCaptionY;
                                        z = true;
                                    }
                                }
                            } else {
                                String charSequence3 = staticLayout2 == null ? null : staticLayout2.getText().toString();
                                String charSequence4 = ChatMessageCell.this.captionLayout == null ? null : ChatMessageCell.this.captionLayout.getText().toString();
                                if ((charSequence4 == null) != (charSequence3 == null) || (charSequence3 != null && !charSequence3.equals(charSequence4))) {
                                    this.animateReplaceCaptionLayout = true;
                                    StaticLayout staticLayout4 = this.lastDrawingCaptionLayout;
                                    this.animateOutCaptionLayout = staticLayout4;
                                    this.animateOutAnimateEmoji = AnimatedEmojiSpan.update(0, ChatMessageCell.this, (AnimatedEmojiSpan.EmojiGroupedSpans) null, staticLayout4);
                                    ChatMessageCell chatMessageCell5 = ChatMessageCell.this;
                                    chatMessageCell5.animatedEmojiStack = AnimatedEmojiSpan.update(0, chatMessageCell5, chatMessageCell5.animatedEmojiStack, chatMessageCell5.captionLayout);
                                } else {
                                    ChatMessageCell.this.updateCaptionLayout();
                                    if (this.lastDrawingCaptionX != ChatMessageCell.this.captionX || this.lastDrawingCaptionY != ChatMessageCell.this.captionY) {
                                        this.moveCaption = true;
                                        this.captionFromX = this.lastDrawingCaptionX;
                                        this.captionFromY = this.lastDrawingCaptionY;
                                    }
                                }
                                z = true;
                            }
                            if (this.lastDrawBotButtons.isEmpty() || !ChatMessageCell.this.botButtons.isEmpty()) {
                                if (this.lastDrawBotButtons.size() != ChatMessageCell.this.botButtons.size()) {
                                    this.animateBotButtonsChanged = true;
                                }
                                if (!this.animateBotButtonsChanged) {
                                    for (int i5 = 0; i5 < ChatMessageCell.this.botButtons.size(); i5++) {
                                        BotButton botButton = (BotButton) ChatMessageCell.this.botButtons.get(i5);
                                        BotButton botButton2 = this.lastDrawBotButtons.get(i5);
                                        if (botButton.x != botButton2.x || botButton.width != botButton2.width) {
                                            this.animateBotButtonsChanged = true;
                                            break;
                                        }
                                    }
                                }
                                if (this.animateBotButtonsChanged) {
                                    this.transitionBotButtons.addAll(this.lastDrawBotButtons);
                                }
                            }
                            if ((ChatMessageCell.this.documentAttachType != 3 || ChatMessageCell.this.documentAttachType == 1) && (ChatMessageCell.this.buttonX != this.lastButtonX || ChatMessageCell.this.buttonY != this.lastButtonY)) {
                                this.animateFromButtonX = this.lastButtonX;
                                this.animateFromButtonY = this.lastButtonY;
                                this.animateButton = true;
                                z = true;
                            }
                            z2 = this.lastIsPinned;
                            chatMessageCell = ChatMessageCell.this;
                            if (z2 != chatMessageCell.isPinned) {
                                this.animatePinned = true;
                                z = true;
                                z3 = true;
                            } else {
                                z3 = false;
                            }
                            if ((this.lastRepliesLayout == null || chatMessageCell.repliesLayout != null) && this.lastRepliesCount != ChatMessageCell.this.getRepliesCount()) {
                                this.animateRepliesLayout = this.lastRepliesLayout;
                                this.animateReplies = true;
                                z = true;
                                z3 = true;
                            }
                            if (this.lastViewsLayout != null && this.lastViewsCount != ChatMessageCell.this.getMessageObject().messageOwner.views) {
                                this.animateViewsLayout = this.lastViewsLayout;
                                z = true;
                                z3 = true;
                            }
                            if (ChatMessageCell.this.commentLayout != null && this.lastCommentsCount != ChatMessageCell.this.getRepliesCount()) {
                                staticLayout3 = this.lastCommentLayout;
                                if (staticLayout3 == null && !TextUtils.equals(staticLayout3.getText(), ChatMessageCell.this.commentLayout.getText())) {
                                    this.animateCommentsLayout = this.lastCommentLayout;
                                } else {
                                    this.animateCommentsLayout = null;
                                }
                                this.animateTotalCommentWidth = this.lastTotalCommentWidth;
                                this.animateCommentX = this.lastCommentX;
                                this.animateCommentArrowX = this.lastCommentArrowX;
                                this.animateCommentUnreadX = this.lastCommentUnreadX;
                                this.animateCommentDrawUnread = this.lastCommentDrawUnread;
                                this.animateDrawCommentNumber = this.lastDrawCommentNumber;
                                this.animateComments = true;
                                z = true;
                            }
                            if (!TextUtils.equals(this.lastSignMessage, ChatMessageCell.this.lastPostAuthor)) {
                                this.animateSign = true;
                                this.animateNameX = ChatMessageCell.this.nameX;
                                z = true;
                            }
                            if (this.lastDrawTime == ChatMessageCell.this.forceNotDrawTime) {
                                this.animateDrawingTimeAlpha = true;
                                this.animateViewsLayout = null;
                            } else if (this.lastShouldDrawTimeOnMedia == ChatMessageCell.this.shouldDrawTimeOnMedia()) {
                                if (z3 || Math.abs(ChatMessageCell.this.timeX - this.lastTimeX) > 1) {
                                    this.shouldAnimateTimeX = true;
                                    this.animateTimeWidth = this.lastTimeWidth;
                                    this.animateFromTimeX = this.lastTimeX;
                                    this.animateFromTimeXViews = this.lastTimeXViews;
                                    this.animateFromTimeXReplies = this.lastTimeXReplies;
                                    this.animateFromTimeXPinned = this.lastTimeXPinned;
                                }
                                if (this.lastShouldDrawMenuDrawable != ChatMessageCell.this.shouldDrawMenuDrawable()) {
                                    this.animateShouldDrawMenuDrawable = true;
                                }
                                if (this.lastLocatinIsExpired != ChatMessageCell.this.locationExpired) {
                                    this.animateLocationIsExpired = true;
                                }
                                if (this.lastIsPlayingRound != ChatMessageCell.this.isPlayingRound) {
                                    this.animatePlayingRound = true;
                                    z = true;
                                }
                                if (this.lastDrawingTextY != ChatMessageCell.this.textY) {
                                    this.animateText = true;
                                    this.animateFromTextY = this.lastDrawingTextY;
                                    z = true;
                                }
                                if (ChatMessageCell.this.currentMessageObject != null && this.lastDrawnForwardedName != ChatMessageCell.this.currentMessageObject.needDrawForwarded()) {
                                    this.animateForwardedLayout = true;
                                    StaticLayout[] staticLayoutArr = this.animatingForwardedNameLayout;
                                    StaticLayout[] staticLayoutArr2 = this.lastDrawnForwardedNameLayout;
                                    staticLayoutArr[0] = staticLayoutArr2[0];
                                    staticLayoutArr[1] = staticLayoutArr2[1];
                                    this.animateForwardNameX = this.lastForwardNameX;
                                    this.animateForwardedNamesOffset = this.lastForwardedNamesOffset;
                                    this.animateForwardNameWidth = this.lastForwardNameWidth;
                                    z = true;
                                }
                                ChatMessageCell.this.updateReactionLayoutPosition();
                                if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
                                    z = true;
                                }
                                if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                                    int i6 = ChatMessageCell.this.layoutHeight;
                                    if (ChatMessageCell.this.drawPinnedBottom) {
                                        i = 2;
                                    }
                                    float dp = i6 - AndroidUtilities.dp(28 - i);
                                    if (!ChatMessageCell.this.reactionsLayoutInBubble.isEmpty) {
                                        dp -= reactionsLayoutInBubble.totalHeight;
                                    }
                                    float f = this.lastDrawRoundVideoDotY;
                                    if (dp != f) {
                                        this.animateRoundVideoDotY = true;
                                        this.animateFromRoundVideoDotY = f;
                                        z = true;
                                    }
                                }
                                if (ChatMessageCell.this.replyNameLayout != null) {
                                    float f2 = this.lastDrawReplyY;
                                    if (chatMessageCell2.replyStartX != f2 && f2 != 0.0f) {
                                        this.animateFromReplyY = f2;
                                        return true;
                                    }
                                }
                                return z;
                            } else {
                                this.animateEditedEnter = false;
                                this.animateShouldDrawTimeOnMedia = true;
                                this.animateFromTimeX = this.lastTimeX;
                                this.animateTimeLayout = this.lastTimeLayout;
                                this.animateTimeWidth = this.lastTimeWidth;
                            }
                            z = true;
                            if (this.lastShouldDrawMenuDrawable != ChatMessageCell.this.shouldDrawMenuDrawable()) {
                            }
                            if (this.lastLocatinIsExpired != ChatMessageCell.this.locationExpired) {
                            }
                            if (this.lastIsPlayingRound != ChatMessageCell.this.isPlayingRound) {
                            }
                            if (this.lastDrawingTextY != ChatMessageCell.this.textY) {
                            }
                            if (ChatMessageCell.this.currentMessageObject != null) {
                                this.animateForwardedLayout = true;
                                StaticLayout[] staticLayoutArr3 = this.animatingForwardedNameLayout;
                                StaticLayout[] staticLayoutArr22 = this.lastDrawnForwardedNameLayout;
                                staticLayoutArr3[0] = staticLayoutArr22[0];
                                staticLayoutArr3[1] = staticLayoutArr22[1];
                                this.animateForwardNameX = this.lastForwardNameX;
                                this.animateForwardedNamesOffset = this.lastForwardedNamesOffset;
                                this.animateForwardNameWidth = this.lastForwardNameWidth;
                                z = true;
                            }
                            ChatMessageCell.this.updateReactionLayoutPosition();
                            if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
                            }
                            if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                            }
                            if (ChatMessageCell.this.replyNameLayout != null) {
                            }
                            return z;
                        }
                        String string = LocaleController.getString("EditedMessage", R.string.EditedMessage);
                        String charSequence5 = ChatMessageCell.this.timeLayout.getText().toString();
                        int indexOf = charSequence5.indexOf(string);
                        if (indexOf >= 0) {
                            if (indexOf == 0) {
                                this.animateEditedLayout = new StaticLayout(string, Theme.chat_timePaint, ChatMessageCell.this.timeTextWidth + AndroidUtilities.dp(100.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                SpannableStringBuilder spannableStringBuilder = new SpannableStringBuilder();
                                spannableStringBuilder.append((CharSequence) string);
                                spannableStringBuilder.append((CharSequence) charSequence5.substring(string.length()));
                                spannableStringBuilder.setSpan(new EmptyStubSpan(), 0, string.length(), 0);
                                this.animateTimeLayout = new StaticLayout(spannableStringBuilder, Theme.chat_timePaint, ChatMessageCell.this.timeTextWidth + AndroidUtilities.dp(100.0f), Layout.Alignment.ALIGN_NORMAL, 1.0f, 0.0f, false);
                                this.animateEditedWidthDiff = ChatMessageCell.this.timeWidth - this.lastTimeWidth;
                            } else {
                                this.animateEditedWidthDiff = 0;
                                this.animateEditedLayout = null;
                                this.animateTimeLayout = this.lastTimeLayout;
                            }
                            this.animateEditedEnter = true;
                            this.animateTimeWidth = this.lastTimeWidth;
                            this.animateFromTimeX = this.lastTimeX;
                            this.shouldAnimateTimeX = true;
                            z = true;
                        }
                        staticLayout = ChatMessageCell.this.captionLayout;
                        staticLayout2 = this.lastDrawingCaptionLayout;
                        if (staticLayout == staticLayout2) {
                        }
                        if (this.lastDrawBotButtons.isEmpty()) {
                        }
                        if (this.lastDrawBotButtons.size() != ChatMessageCell.this.botButtons.size()) {
                        }
                        if (!this.animateBotButtonsChanged) {
                        }
                        if (this.animateBotButtonsChanged) {
                        }
                        if (ChatMessageCell.this.documentAttachType != 3) {
                        }
                        this.animateFromButtonX = this.lastButtonX;
                        this.animateFromButtonY = this.lastButtonY;
                        this.animateButton = true;
                        z = true;
                        z2 = this.lastIsPinned;
                        chatMessageCell = ChatMessageCell.this;
                        if (z2 != chatMessageCell.isPinned) {
                        }
                        if (this.lastRepliesLayout == null) {
                        }
                        this.animateRepliesLayout = this.lastRepliesLayout;
                        this.animateReplies = true;
                        z = true;
                        z3 = true;
                        if (this.lastViewsLayout != null) {
                            this.animateViewsLayout = this.lastViewsLayout;
                            z = true;
                            z3 = true;
                        }
                        if (ChatMessageCell.this.commentLayout != null) {
                            staticLayout3 = this.lastCommentLayout;
                            if (staticLayout3 == null) {
                            }
                            this.animateCommentsLayout = null;
                            this.animateTotalCommentWidth = this.lastTotalCommentWidth;
                            this.animateCommentX = this.lastCommentX;
                            this.animateCommentArrowX = this.lastCommentArrowX;
                            this.animateCommentUnreadX = this.lastCommentUnreadX;
                            this.animateCommentDrawUnread = this.lastCommentDrawUnread;
                            this.animateDrawCommentNumber = this.lastDrawCommentNumber;
                            this.animateComments = true;
                            z = true;
                        }
                        if (!TextUtils.equals(this.lastSignMessage, ChatMessageCell.this.lastPostAuthor)) {
                        }
                        if (this.lastDrawTime == ChatMessageCell.this.forceNotDrawTime) {
                        }
                        z = true;
                        if (this.lastShouldDrawMenuDrawable != ChatMessageCell.this.shouldDrawMenuDrawable()) {
                        }
                        if (this.lastLocatinIsExpired != ChatMessageCell.this.locationExpired) {
                        }
                        if (this.lastIsPlayingRound != ChatMessageCell.this.isPlayingRound) {
                        }
                        if (this.lastDrawingTextY != ChatMessageCell.this.textY) {
                        }
                        if (ChatMessageCell.this.currentMessageObject != null) {
                        }
                        ChatMessageCell.this.updateReactionLayoutPosition();
                        if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
                        }
                        if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
                        }
                        if (ChatMessageCell.this.replyNameLayout != null) {
                        }
                        return z;
                    }
                    ChatMessageCell chatMessageCell6 = ChatMessageCell.this;
                    chatMessageCell6.animatedEmojiStack = AnimatedEmojiSpan.update(0, chatMessageCell6, chatMessageCell6.animatedEmojiStack, chatMessageCell6.currentMessageObject.textLayoutBlocks);
                }
                z4 = false;
                if (z4) {
                }
            }
            z = false;
            if (ChatMessageCell.this.edited) {
            }
            if (!ChatMessageCell.this.edited) {
                this.animateTimeLayout = this.lastTimeLayout;
                int i32 = ChatMessageCell.this.timeWidth;
                int i42 = this.lastTimeWidth;
                this.animateEditedWidthDiff = i32 - i42;
                this.animateEditedEnter = true;
                this.animateTimeWidth = i42;
                this.animateFromTimeX = this.lastTimeX;
                this.shouldAnimateTimeX = true;
                z = true;
            }
            staticLayout = ChatMessageCell.this.captionLayout;
            staticLayout2 = this.lastDrawingCaptionLayout;
            if (staticLayout == staticLayout2) {
            }
            if (this.lastDrawBotButtons.isEmpty()) {
            }
            if (this.lastDrawBotButtons.size() != ChatMessageCell.this.botButtons.size()) {
            }
            if (!this.animateBotButtonsChanged) {
            }
            if (this.animateBotButtonsChanged) {
            }
            if (ChatMessageCell.this.documentAttachType != 3) {
            }
            this.animateFromButtonX = this.lastButtonX;
            this.animateFromButtonY = this.lastButtonY;
            this.animateButton = true;
            z = true;
            z2 = this.lastIsPinned;
            chatMessageCell = ChatMessageCell.this;
            if (z2 != chatMessageCell.isPinned) {
            }
            if (this.lastRepliesLayout == null) {
            }
            this.animateRepliesLayout = this.lastRepliesLayout;
            this.animateReplies = true;
            z = true;
            z3 = true;
            if (this.lastViewsLayout != null) {
            }
            if (ChatMessageCell.this.commentLayout != null) {
            }
            if (!TextUtils.equals(this.lastSignMessage, ChatMessageCell.this.lastPostAuthor)) {
            }
            if (this.lastDrawTime == ChatMessageCell.this.forceNotDrawTime) {
            }
            z = true;
            if (this.lastShouldDrawMenuDrawable != ChatMessageCell.this.shouldDrawMenuDrawable()) {
            }
            if (this.lastLocatinIsExpired != ChatMessageCell.this.locationExpired) {
            }
            if (this.lastIsPlayingRound != ChatMessageCell.this.isPlayingRound) {
            }
            if (this.lastDrawingTextY != ChatMessageCell.this.textY) {
            }
            if (ChatMessageCell.this.currentMessageObject != null) {
            }
            ChatMessageCell.this.updateReactionLayoutPosition();
            if (ChatMessageCell.this.reactionsLayoutInBubble.animateChange()) {
            }
            if (ChatMessageCell.this.currentMessageObject.isRoundVideo()) {
            }
            if (ChatMessageCell.this.replyNameLayout != null) {
            }
            return z;
        }

        public void onDetach() {
            this.wasDraw = false;
        }

        public void resetAnimation() {
            this.animateChange = false;
            this.animatePinned = false;
            this.animateBackgroundBoundsInner = false;
            this.deltaLeft = 0.0f;
            this.deltaRight = 0.0f;
            this.deltaBottom = 0.0f;
            this.deltaTop = 0.0f;
            this.toDeltaLeft = 0.0f;
            this.toDeltaRight = 0.0f;
            if (this.imageChangeBoundsTransition && this.animateToImageW != 0.0f && this.animateToImageH != 0.0f) {
                ChatMessageCell.this.photoImage.setImageCoords(this.animateToImageX, this.animateToImageY, this.animateToImageW, this.animateToImageH);
            }
            if (this.animateRadius) {
                ChatMessageCell.this.photoImage.setRoundRadius(this.animateToRadius);
            }
            this.animateToImageX = 0.0f;
            this.animateToImageY = 0.0f;
            this.animateToImageW = 0.0f;
            this.animateToImageH = 0.0f;
            this.imageChangeBoundsTransition = false;
            this.changePinnedBottomProgress = 1.0f;
            this.captionEnterProgress = 1.0f;
            this.animateRadius = false;
            this.animateChangeProgress = 1.0f;
            this.animateMessageText = false;
            this.animateOutTextBlocks = null;
            this.animateEditedLayout = null;
            this.animateTimeLayout = null;
            this.animateEditedEnter = false;
            this.animateReplaceCaptionLayout = false;
            this.transformGroupToSingleMessage = false;
            this.animateOutCaptionLayout = null;
            AnimatedEmojiSpan.release(ChatMessageCell.this, this.animateOutAnimateEmoji);
            this.animateOutAnimateEmoji = null;
            this.moveCaption = false;
            this.animateDrawingTimeAlpha = false;
            this.transitionBotButtons.clear();
            this.animateButton = false;
            this.animateReplies = false;
            this.animateRepliesLayout = null;
            this.animateComments = false;
            this.animateCommentsLayout = null;
            this.animateViewsLayout = null;
            this.animateShouldDrawTimeOnMedia = false;
            this.animateShouldDrawMenuDrawable = false;
            this.shouldAnimateTimeX = false;
            this.animateSign = false;
            this.animateDrawingTimeAlpha = false;
            this.animateLocationIsExpired = false;
            this.animatePlayingRound = false;
            this.animateText = false;
            this.animateForwardedLayout = false;
            StaticLayout[] staticLayoutArr = this.animatingForwardedNameLayout;
            staticLayoutArr[0] = null;
            staticLayoutArr[1] = null;
            this.animateRoundVideoDotY = false;
            ChatMessageCell.this.reactionsLayoutInBubble.resetAnimation();
        }

        /* JADX WARN: Removed duplicated region for block: B:11:0x006b  */
        /* JADX WARN: Removed duplicated region for block: B:14:0x0072  */
        /* JADX WARN: Removed duplicated region for block: B:17:0x0077  */
        /* JADX WARN: Removed duplicated region for block: B:21:0x006d  */
        /*
            Code decompiled incorrectly, please refer to instructions dump.
        */
        public int createStatusDrawableParams() {
            int i;
            boolean z;
            boolean z2;
            int i2 = 8;
            int i3 = 4;
            boolean z3 = true;
            if (ChatMessageCell.this.currentMessageObject.isOutOwner()) {
                if (ChatMessageCell.this.currentMessageObject.isSending() || ChatMessageCell.this.currentMessageObject.isEditing()) {
                    i = 0;
                    z3 = false;
                    z = true;
                } else if (ChatMessageCell.this.currentMessageObject.isSendError()) {
                    i = 0;
                    z3 = false;
                    z = false;
                    z2 = true;
                    int i4 = i | (!z3 ? 2 : 0);
                    if (!z) {
                        i3 = 0;
                    }
                    int i5 = i4 | i3;
                    if (!z2) {
                        i2 = 0;
                    }
                    return i5 | i2;
                } else {
                    if (ChatMessageCell.this.currentMessageObject.isSent()) {
                        i = (ChatMessageCell.this.currentMessageObject.scheduled || ChatMessageCell.this.currentMessageObject.isUnread()) ? 0 : 1;
                    } else {
                        i = 0;
                        z3 = false;
                    }
                    z = false;
                }
                z2 = false;
                int i42 = i | (!z3 ? 2 : 0);
                if (!z) {
                }
                int i52 = i42 | i3;
                if (!z2) {
                }
                return i52 | i2;
            }
            if (!ChatMessageCell.this.currentMessageObject.isSending() && !ChatMessageCell.this.currentMessageObject.isEditing()) {
                z3 = false;
            }
            boolean isSendError = ChatMessageCell.this.currentMessageObject.isSendError();
            if (!z3) {
                i3 = 0;
            }
            if (!isSendError) {
                i2 = 0;
            }
            return i3 | i2;
        }
    }

    private int getThemedColor(String str) {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        Integer color = resourcesProvider != null ? resourcesProvider.getColor(str) : null;
        return color != null ? color.intValue() : Theme.getColor(str);
    }

    private Drawable getThemedDrawable(String str) {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        Drawable drawable = resourcesProvider != null ? resourcesProvider.getDrawable(str) : null;
        return drawable != null ? drawable : Theme.getThemeDrawable(str);
    }

    private Paint getThemedPaint(String str) {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        Paint paint = resourcesProvider != null ? resourcesProvider.getPaint(str) : null;
        return paint != null ? paint : Theme.getThemePaint(str);
    }

    private boolean hasGradientService() {
        Theme.ResourcesProvider resourcesProvider = this.resourcesProvider;
        return resourcesProvider != null ? resourcesProvider.hasGradientService() : Theme.hasGradientService();
    }
}
